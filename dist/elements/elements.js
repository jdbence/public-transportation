function App(){if(this.name="public-transportation!",this._app=null,this.baseURL="/* @echo BASE_URL */",this._app=document.querySelector("#app"),this.supportWebComponents())this.init();else{var e=document.createElement("script");e.async=!0,e.src="bower_components/webcomponentsjs/webcomponents-lite.min.js",e.onload=this.init,document.head.appendChild(e)}}function MakePromise(e){function t(e){if("object"!=typeof this||"function"!=typeof e)throw new TypeError;this._state=null,this._value=null,this._deferreds=[],s(e,o.bind(this),n.bind(this))}function r(t){var r=this;return null===this._state?void this._deferreds.push(t):void e(function(){var e=r._state?t.onFulfilled:t.onRejected;if("function"!=typeof e)return void(r._state?t.resolve:t.reject)(r._value);var o;try{o=e(r._value)}catch(n){return void t.reject(n)}t.resolve(o)})}function o(e){try{if(e===this)throw new TypeError;if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void s(t.bind(e),o.bind(this),n.bind(this))}this._state=!0,this._value=e,i.call(this)}catch(r){n.call(this,r)}}function n(e){this._state=!1,this._value=e,i.call(this)}function i(){for(var e=0,t=this._deferreds.length;e<t;e++)r.call(this,this._deferreds[e]);this._deferreds=null}function s(e,t,r){var o=!1;try{e(function(e){o||(o=!0,t(e))},function(e){o||(o=!0,r(e))})}catch(n){if(o)return;o=!0,r(n)}}return t.prototype["catch"]=function(e){return this.then(null,e)},t.prototype.then=function(e,o){var n=this;return new t(function(t,i){r.call(n,{onFulfilled:e,onRejected:o,resolve:t,reject:i})})},t.resolve=function(e){return e&&"object"==typeof e&&e.constructor===t?e:new t(function(t){t(e)})},t.reject=function(e){return new t(function(t,r){r(e)})},t}function Schema(e){return this.importSchema(lf.schema.create(e,1))}function DB(e,t){this.name=e,this.tables=t,this.db=null,this.schema=new Schema(this.name)}App.prototype.supportWebComponents=function(){return"registerElement"in document&&"import"in document.createElement("link")&&"content"in document.createElement("template")},App.prototype.init=function(){console.log("Application is now ready")},window.app=new App,function(){function e(){document.body.removeAttribute("unresolved")}window.WebComponents?addEventListener("WebComponentsReady",e):"interactive"===document.readyState||"complete"===document.readyState?e():addEventListener("DOMContentLoaded",e)}(),window.Polymer={Settings:function(){for(var e,t=window.Polymer||{},r=location.search.slice(1).split("&"),o=0;o<r.length&&(e=r[o]);o++)e=e.split("="),e[0]&&(t[e[0]]=e[1]||!0);return t.wantShadow="shadow"===t.dom,t.hasShadow=Boolean(Element.prototype.createShadowRoot),t.nativeShadow=t.hasShadow&&!window.ShadowDOMPolyfill,t.useShadow=t.wantShadow&&t.hasShadow,t.hasNativeImports=Boolean("import"in document.createElement("link")),t.useNativeImports=t.hasNativeImports,t.useNativeCustomElements=!window.CustomElements||window.CustomElements.useNative,t.useNativeShadow=t.useShadow&&t.nativeShadow,t.usePolyfillProto=!t.useNativeCustomElements&&!Object.__proto__,t.hasNativeCSSProperties=!navigator.userAgent.match("AppleWebKit/601")&&window.CSS&&CSS.supports&&CSS.supports("box-shadow","0 0 0 var(--foo)"),t.useNativeCSSProperties=t.hasNativeCSSProperties&&t.lazyRegister&&t.useNativeCSSProperties,t}()},function(){var e=window.Polymer;window.Polymer=function(e){"function"==typeof e&&(e=e.prototype),e||(e={});var r=t(e);e=r.prototype;var o={prototype:e};return e["extends"]&&(o["extends"]=e["extends"]),Polymer.telemetry._registrate(e),document.registerElement(e.is,o),r};var t=function(e){var t=Polymer.Base;return e["extends"]&&(t=Polymer.Base._getExtendedPrototype(e["extends"])),e=Polymer.Base.chainObject(e,t),e.registerCallback(),e.constructor};if(e)for(var r in e)Polymer[r]=e[r];Polymer.Class=t}(),Polymer.telemetry={registrations:[],_regLog:function(e){console.log("["+e.is+"]: registered")},_registrate:function(e){this.registrations.push(e),Polymer.log&&this._regLog(e)},dumpRegistrations:function(){this.registrations.forEach(this._regLog)}},Object.defineProperty(window,"currentImport",{enumerable:!0,configurable:!0,get:function(){return(document._currentScript||document.currentScript).ownerDocument}}),Polymer.RenderStatus={_ready:!1,_callbacks:[],whenReady:function(e){this._ready?e():this._callbacks.push(e)},_makeReady:function(){this._ready=!0;for(var e=0;e<this._callbacks.length;e++)this._callbacks[e]();this._callbacks=[]},_catchFirstRender:function(){requestAnimationFrame(function(){Polymer.RenderStatus._makeReady()})},_afterNextRenderQueue:[],_waitingNextRender:!1,afterNextRender:function(e,t,r){this._watchNextRender(),this._afterNextRenderQueue.push([e,t,r])},hasRendered:function(){return this._ready},_watchNextRender:function(){if(!this._waitingNextRender){this._waitingNextRender=!0;var e=function(){Polymer.RenderStatus._flushNextRender()};this._ready?requestAnimationFrame(e):this.whenReady(e)}},_flushNextRender:function(){var e=this;setTimeout(function(){e._flushRenderCallbacks(e._afterNextRenderQueue),e._afterNextRenderQueue=[],e._waitingNextRender=!1})},_flushRenderCallbacks:function(e){for(var t,r=0;r<e.length;r++)t=e[r],t[1].apply(t[0],t[2]||Polymer.nar)}},window.HTMLImports?HTMLImports.whenReady(function(){Polymer.RenderStatus._catchFirstRender()}):Polymer.RenderStatus._catchFirstRender(),Polymer.ImportStatus=Polymer.RenderStatus,Polymer.ImportStatus.whenLoaded=Polymer.ImportStatus.whenReady,function(){"use strict";var e=Polymer.Settings;Polymer.Base={__isPolymerInstance__:!0,_addFeature:function(e){this.extend(this,e)},registerCallback:function(){this._desugarBehaviors(),this._doBehavior("beforeRegister"),this._registerFeatures(),e.lazyRegister||this.ensureRegisterFinished()},createdCallback:function(){this.__hasRegisterFinished||this._ensureRegisterFinished(this.__proto__),Polymer.telemetry.instanceCount++,this.root=this,this._doBehavior("created"),this._initFeatures()},ensureRegisterFinished:function(){this._ensureRegisterFinished(this)},_ensureRegisterFinished:function(t){t.__hasRegisterFinished!==t.is&&(t.__hasRegisterFinished=t.is,t._finishRegisterFeatures&&t._finishRegisterFeatures(),t._doBehavior("registered"),e.usePolyfillProto&&t!==this&&t.extend(this,t))},attachedCallback:function(){var e=this;Polymer.RenderStatus.whenReady(function(){e.isAttached=!0,e._doBehavior("attached")})},detachedCallback:function(){var e=this;Polymer.RenderStatus.whenReady(function(){e.isAttached=!1,e._doBehavior("detached")})},attributeChangedCallback:function(e,t,r){this._attributeChangedImpl(e),this._doBehavior("attributeChanged",[e,t,r])},_attributeChangedImpl:function(e){this._setAttributeToProperty(this,e)},extend:function(e,t){if(e&&t)for(var r,o=Object.getOwnPropertyNames(t),n=0;n<o.length&&(r=o[n]);n++)this.copyOwnProperty(r,t,e);return e||t},mixin:function(e,t){for(var r in t)e[r]=t[r];return e},copyOwnProperty:function(e,t,r){var o=Object.getOwnPropertyDescriptor(t,e);o&&Object.defineProperty(r,e,o)},_logger:function(e,t){switch(1===t.length&&Array.isArray(t[0])&&(t=t[0]),e){case"log":case"warn":case"error":console[e].apply(console,t)}},_log:function(){var e=Array.prototype.slice.call(arguments,0);this._logger("log",e)},_warn:function(){var e=Array.prototype.slice.call(arguments,0);this._logger("warn",e)},_error:function(){var e=Array.prototype.slice.call(arguments,0);this._logger("error",e)},_logf:function(){return this._logPrefix.concat(this.is).concat(Array.prototype.slice.call(arguments,0))}},Polymer.Base._logPrefix=function(){var e=window.chrome&&!/edge/i.test(navigator.userAgent)||/firefox/i.test(navigator.userAgent);return e?["%c[%s::%s]:","font-weight: bold; background-color:#EEEE00;"]:["[%s::%s]:"]}(),Polymer.Base.chainObject=function(e,t){return e&&t&&e!==t&&(Object.__proto__||(e=Polymer.Base.extend(Object.create(t),e)),e.__proto__=t),e},Polymer.Base=Polymer.Base.chainObject(Polymer.Base,HTMLElement.prototype),window.CustomElements?Polymer["instanceof"]=CustomElements["instanceof"]:Polymer["instanceof"]=function(e,t){return e instanceof t},Polymer.isInstance=function(e){return Boolean(e&&e.__isPolymerInstance__)},Polymer.telemetry.instanceCount=0}(),function(){function e(){if(i)for(var e,t=document._currentScript||document.currentScript,r=t&&t.ownerDocument||document,o=r.querySelectorAll("dom-module"),n=o.length-1;n>=0&&(e=o[n]);n--){if(e.__upgraded__)return;CustomElements.upgrade(e)}}var t={},r={},o=function(e){return t[e]||r[e.toLowerCase()]},n=function(){return document.createElement("dom-module")};n.prototype=Object.create(HTMLElement.prototype),Polymer.Base.extend(n.prototype,{constructor:n,createdCallback:function(){this.register()},register:function(e){e=e||this.id||this.getAttribute("name")||this.getAttribute("is"),e&&(this.id=e,t[e]=this,r[e.toLowerCase()]=this)},"import":function(t,r){if(t){var n=o(t);return n||(e(),n=o(t)),n&&r&&(n=n.querySelector(r)),n}}});var i=window.CustomElements&&!CustomElements.useNative;document.registerElement("dom-module",n)}(),Polymer.Base._addFeature({_prepIs:function(){if(!this.is){var e=(document._currentScript||document.currentScript).parentNode;if("dom-module"===e.localName){var t=e.id||e.getAttribute("name")||e.getAttribute("is");this.is=t}}this.is&&(this.is=this.is.toLowerCase())}}),Polymer.Base._addFeature({behaviors:[],_desugarBehaviors:function(){this.behaviors.length&&(this.behaviors=this._desugarSomeBehaviors(this.behaviors))},_desugarSomeBehaviors:function(e){var t=[];e=this._flattenBehaviorsList(e);for(var r=e.length-1;r>=0;r--){var o=e[r];t.indexOf(o)===-1&&(this._mixinBehavior(o),t.unshift(o))}return t},_flattenBehaviorsList:function(e){for(var t=[],r=0;r<e.length;r++){var o=e[r];o instanceof Array?t=t.concat(this._flattenBehaviorsList(o)):o?t.push(o):this._warn(this._logf("_flattenBehaviorsList","behavior is null, check for missing or 404 import"))}return t},_mixinBehavior:function(e){for(var t,r=Object.getOwnPropertyNames(e),o=0;o<r.length&&(t=r[o]);o++)Polymer.Base._behaviorProperties[t]||this.hasOwnProperty(t)||this.copyOwnProperty(t,e,this)},_prepBehaviors:function(){this._prepFlattenedBehaviors(this.behaviors)},_prepFlattenedBehaviors:function(e){for(var t=0,r=e.length;t<r;t++)this._prepBehavior(e[t]);this._prepBehavior(this)},_doBehavior:function(e,t){for(var r=0;r<this.behaviors.length;r++)this._invokeBehavior(this.behaviors[r],e,t);this._invokeBehavior(this,e,t)},_invokeBehavior:function(e,t,r){var o=e[t];o&&o.apply(this,r||Polymer.nar)},_marshalBehaviors:function(){for(var e=0;e<this.behaviors.length;e++)this._marshalBehavior(this.behaviors[e]);this._marshalBehavior(this)}}),Polymer.Base._behaviorProperties={hostAttributes:!0,beforeRegister:!0,registered:!0,properties:!0,observers:!0,listeners:!0,created:!0,attached:!0,detached:!0,attributeChanged:!0,ready:!0},Polymer.Base._addFeature({_getExtendedPrototype:function(e){return this._getExtendedNativePrototype(e)},_nativePrototypes:{},_getExtendedNativePrototype:function(e){var t=this._nativePrototypes[e];if(!t){var r=this.getNativePrototype(e);t=this.extend(Object.create(r),Polymer.Base),this._nativePrototypes[e]=t}return t},getNativePrototype:function(e){return Object.getPrototypeOf(document.createElement(e))}}),Polymer.Base._addFeature({_prepConstructor:function(){this._factoryArgs=this["extends"]?[this["extends"],this.is]:[this.is];var e=function(){return this._factory(arguments)};this.hasOwnProperty("extends")&&(e["extends"]=this["extends"]),Object.defineProperty(this,"constructor",{value:e,writable:!0,configurable:!0}),e.prototype=this},_factory:function(e){var t=document.createElement.apply(document,this._factoryArgs);return this.factoryImpl&&this.factoryImpl.apply(t,e),t}}),Polymer.nob=Object.create(null),Polymer.Base._addFeature({properties:{},getPropertyInfo:function(e){var t=this._getPropertyInfo(e,this.properties);if(!t)for(var r=0;r<this.behaviors.length;r++)if(t=this._getPropertyInfo(e,this.behaviors[r].properties))return t;return t||Polymer.nob},_getPropertyInfo:function(e,t){var r=t&&t[e];return"function"==typeof r&&(r=t[e]={type:r}),r&&(r.defined=!0),r},_prepPropertyInfo:function(){this._propertyInfo={};for(var e=0;e<this.behaviors.length;e++)this._addPropertyInfo(this._propertyInfo,this.behaviors[e].properties);this._addPropertyInfo(this._propertyInfo,this.properties),this._addPropertyInfo(this._propertyInfo,this._propertyEffects)},_addPropertyInfo:function(e,t){if(t){var r,o;for(var n in t)r=e[n],o=t[n],("_"!==n[0]||o.readOnly)&&(e[n]?(r.type||(r.type=o.type),r.readOnly||(r.readOnly=o.readOnly)):e[n]={type:"function"==typeof o?o:o.type,readOnly:o.readOnly,attribute:Polymer.CaseMap.camelToDashCase(n)})}}}),Polymer.CaseMap={_caseMap:{},_rx:{dashToCamel:/-[a-z]/g,camelToDash:/([A-Z])/g},dashToCamelCase:function(e){return this._caseMap[e]||(this._caseMap[e]=e.indexOf("-")<0?e:e.replace(this._rx.dashToCamel,function(e){return e[1].toUpperCase()}))},camelToDashCase:function(e){return this._caseMap[e]||(this._caseMap[e]=e.replace(this._rx.camelToDash,"-$1").toLowerCase())}},Polymer.Base._addFeature({_addHostAttributes:function(e){this._aggregatedAttributes||(this._aggregatedAttributes={}),e&&this.mixin(this._aggregatedAttributes,e)},_marshalHostAttributes:function(){this._aggregatedAttributes&&this._applyAttributes(this,this._aggregatedAttributes)},_applyAttributes:function(e,t){for(var r in t)if(!this.hasAttribute(r)&&"class"!==r){var o=t[r];this.serializeValueToAttribute(o,r,this)}},_marshalAttributes:function(){this._takeAttributesToModel(this)},_takeAttributesToModel:function(e){if(this.hasAttributes())for(var t in this._propertyInfo){var r=this._propertyInfo[t];this.hasAttribute(r.attribute)&&this._setAttributeToProperty(e,r.attribute,t,r)}},_setAttributeToProperty:function(e,t,r,o){if(!this._serializing&&(r=r||Polymer.CaseMap.dashToCamelCase(t),o=o||this._propertyInfo&&this._propertyInfo[r],o&&!o.readOnly)){var n=this.getAttribute(t);e[r]=this.deserialize(n,o.type)}},_serializing:!1,reflectPropertyToAttribute:function(e,t,r){this._serializing=!0,r=void 0===r?this[e]:r,this.serializeValueToAttribute(r,t||Polymer.CaseMap.camelToDashCase(e)),this._serializing=!1},serializeValueToAttribute:function(e,t,r){var o=this.serialize(e);r=r||this,void 0===o?r.removeAttribute(t):r.setAttribute(t,o)},deserialize:function(e,t){switch(t){case Number:e=Number(e);break;case Boolean:e=null!=e;break;case Object:try{e=JSON.parse(e)}catch(r){}break;case Array:try{e=JSON.parse(e)}catch(r){e=null,console.warn("Polymer::Attributes: couldn`t decode Array as JSON")}break;case Date:e=new Date(e);break;case String:}return e},serialize:function(e){switch(typeof e){case"boolean":return e?"":void 0;case"object":if(e instanceof Date)return e.toString();if(e)try{return JSON.stringify(e)}catch(t){return""}default:return null!=e?e:void 0}}}),Polymer.version="1.6.0",Polymer.Base._addFeature({_registerFeatures:function(){this._prepIs(),this._prepBehaviors(),this._prepConstructor(),this._prepPropertyInfo()},_prepBehavior:function(e){this._addHostAttributes(e.hostAttributes)},_marshalBehavior:function(e){},_initFeatures:function(){this._marshalHostAttributes(),this._marshalBehaviors()}}),Polymer.Base._addFeature({_prepTemplate:function(){void 0===this._template&&(this._template=Polymer.DomModule["import"](this.is,"template")),this._template&&this._template.hasAttribute("is")&&this._warn(this._logf("_prepTemplate","top-level Polymer template must not be a type-extension, found",this._template,"Move inside simple <template>.")),this._template&&!this._template.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(this._template)},_stampTemplate:function(){this._template&&(this.root=this.instanceTemplate(this._template))},instanceTemplate:function(e){var t=document.importNode(e._content||e.content,!0);return t}}),function(){var e=Polymer.Base.attachedCallback;Polymer.Base._addFeature({_hostStack:[],ready:function(){},_registerHost:function(e){this.dataHost=e=e||Polymer.Base._hostStack[Polymer.Base._hostStack.length-1],e&&e._clients&&e._clients.push(this),this._clients=null,this._clientsReadied=!1},_beginHosting:function(){Polymer.Base._hostStack.push(this),this._clients||(this._clients=[])},_endHosting:function(){Polymer.Base._hostStack.pop()},_tryReady:function(){this._readied=!1,this._canReady()&&this._ready()},_canReady:function(){return!this.dataHost||this.dataHost._clientsReadied},_ready:function(){this._beforeClientsReady(),this._template&&(this._setupRoot(),this._readyClients()),this._clientsReadied=!0,this._clients=null,this._afterClientsReady(),this._readySelf()},_readyClients:function(){this._beginDistribute();var e=this._clients;if(e)for(var t,r=0,o=e.length;r<o&&(t=e[r]);r++)t._ready();this._finishDistribute()},_readySelf:function(){this._doBehavior("ready"),this._readied=!0,this._attachedPending&&(this._attachedPending=!1,this.attachedCallback())},_beforeClientsReady:function(){},_afterClientsReady:function(){},_beforeAttached:function(){},attachedCallback:function(){this._readied?(this._beforeAttached(),e.call(this)):this._attachedPending=!0}})}(),Polymer.ArraySplice=function(){function e(e,t,r){return{index:e,removed:t,addedCount:r}}function t(){}var r=0,o=1,n=2,i=3;return t.prototype={calcEditDistances:function(e,t,r,o,n,i){for(var s=i-n+1,a=r-t+1,l=new Array(s),c=0;c<s;c++)l[c]=new Array(a),l[c][0]=c;for(var u=0;u<a;u++)l[0][u]=u;for(c=1;c<s;c++)for(u=1;u<a;u++)if(this.equals(e[t+u-1],o[n+c-1]))l[c][u]=l[c-1][u-1];else{var h=l[c-1][u]+1,f=l[c][u-1]+1;l[c][u]=h<f?h:f}return l},spliceOperationsFromEditDistances:function(e){for(var t=e.length-1,s=e[0].length-1,a=e[t][s],l=[];t>0||s>0;)if(0!=t)if(0!=s){var c,u=e[t-1][s-1],h=e[t-1][s],f=e[t][s-1];c=h<f?h<u?h:u:f<u?f:u,c==u?(u==a?l.push(r):(l.push(o),a=u),t--,s--):c==h?(l.push(i),t--,a=h):(l.push(n),s--,a=f)}else l.push(i),t--;else l.push(n),s--;return l.reverse(),l},calcSplices:function(t,s,a,l,c,u){var h=0,f=0,p=Math.min(a-s,u-c);if(0==s&&0==c&&(h=this.sharedPrefix(t,l,p)),a==t.length&&u==l.length&&(f=this.sharedSuffix(t,l,p-h)),s+=h,c+=h,a-=f,u-=f,a-s==0&&u-c==0)return[];if(s==a){for(var d=e(s,[],0);c<u;)d.removed.push(l[c++]);return[d]}if(c==u)return[e(s,[],a-s)];var g=this.spliceOperationsFromEditDistances(this.calcEditDistances(t,s,a,l,c,u));d=void 0;for(var _=[],m=s,y=c,v=0;v<g.length;v++)switch(g[v]){case r:d&&(_.push(d),d=void 0),m++,y++;break;case o:d||(d=e(m,[],0)),d.addedCount++,m++,d.removed.push(l[y]),y++;break;case n:d||(d=e(m,[],0)),d.addedCount++,m++;break;case i:d||(d=e(m,[],0)),d.removed.push(l[y]),y++}return d&&_.push(d),_},sharedPrefix:function(e,t,r){for(var o=0;o<r;o++)if(!this.equals(e[o],t[o]))return o;return r},sharedSuffix:function(e,t,r){for(var o=e.length,n=t.length,i=0;i<r&&this.equals(e[--o],t[--n]);)i++;return i},calculateSplices:function(e,t){return this.calcSplices(e,0,e.length,t,0,t.length)},equals:function(e,t){return e===t}},new t}(),Polymer.domInnerHTML=function(){function e(e){switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"Â ":return"&nbsp;"}}function t(t){return t.replace(s,e)}function r(t){return t.replace(a,e)}function o(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}function n(e,o,n){switch(e.nodeType){case Node.ELEMENT_NODE:for(var s,a=e.localName,u="<"+a,h=e.attributes,f=0;s=h[f];f++)u+=" "+s.name+'="'+t(s.value)+'"';return u+=">",l[a]?u:u+i(e,n)+"</"+a+">";case Node.TEXT_NODE:var p=e.data;return o&&c[o.localName]?p:r(p);case Node.COMMENT_NODE:return"<!--"+e.data+"-->";default:throw console.error(e),new Error("not implemented")}}function i(e,t){e instanceof HTMLTemplateElement&&(e=e.content);for(var r,o="",i=Polymer.dom(e).childNodes,s=0,a=i.length;s<a&&(r=i[s]);s++)o+=n(r,e,t);return o}var s=/[&\u00A0"]/g,a=/[&\u00A0<>]/g,l=o(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),c=o(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);return{getInnerHTML:i}}(),function(){"use strict";var e=Element.prototype.insertBefore,t=Element.prototype.appendChild,r=Element.prototype.removeChild;Polymer.TreeApi={arrayCopyChildNodes:function(e){for(var t=[],r=0,o=e.firstChild;o;o=o.nextSibling)t[r++]=o;return t},arrayCopyChildren:function(e){for(var t=[],r=0,o=e.firstElementChild;o;o=o.nextElementSibling)t[r++]=o;return t},arrayCopy:function(e){for(var t=e.length,r=new Array(t),o=0;o<t;o++)r[o]=e[o];return r}},Polymer.TreeApi.Logical={hasParentNode:function(e){return Boolean(e.__dom&&e.__dom.parentNode)},hasChildNodes:function(e){return Boolean(e.__dom&&void 0!==e.__dom.childNodes)},getChildNodes:function(e){return this.hasChildNodes(e)?this._getChildNodes(e):e.childNodes},_getChildNodes:function(e){if(!e.__dom.childNodes){e.__dom.childNodes=[];for(var t=e.__dom.firstChild;t;t=t.__dom.nextSibling)e.__dom.childNodes.push(t)}return e.__dom.childNodes},getParentNode:function(e){return e.__dom&&void 0!==e.__dom.parentNode?e.__dom.parentNode:e.parentNode},getFirstChild:function(e){return e.__dom&&void 0!==e.__dom.firstChild?e.__dom.firstChild:e.firstChild},getLastChild:function(e){return e.__dom&&void 0!==e.__dom.lastChild?e.__dom.lastChild:e.lastChild},getNextSibling:function(e){return e.__dom&&void 0!==e.__dom.nextSibling?e.__dom.nextSibling:e.nextSibling},getPreviousSibling:function(e){return e.__dom&&void 0!==e.__dom.previousSibling?e.__dom.previousSibling:e.previousSibling},getFirstElementChild:function(e){return e.__dom&&void 0!==e.__dom.firstChild?this._getFirstElementChild(e):e.firstElementChild},_getFirstElementChild:function(e){for(var t=e.__dom.firstChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__dom.nextSibling;return t},getLastElementChild:function(e){return e.__dom&&void 0!==e.__dom.lastChild?this._getLastElementChild(e):e.lastElementChild},_getLastElementChild:function(e){for(var t=e.__dom.lastChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__dom.previousSibling;return t},getNextElementSibling:function(e){return e.__dom&&void 0!==e.__dom.nextSibling?this._getNextElementSibling(e):e.nextElementSibling},_getNextElementSibling:function(e){for(var t=e.__dom.nextSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__dom.nextSibling;return t},getPreviousElementSibling:function(e){return e.__dom&&void 0!==e.__dom.previousSibling?this._getPreviousElementSibling(e):e.previousElementSibling},_getPreviousElementSibling:function(e){for(var t=e.__dom.previousSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__dom.previousSibling;return t},saveChildNodes:function(e){if(!this.hasChildNodes(e)){e.__dom=e.__dom||{},e.__dom.firstChild=e.firstChild,e.__dom.lastChild=e.lastChild,e.__dom.childNodes=[];for(var t=e.firstChild;t;t=t.nextSibling)t.__dom=t.__dom||{},t.__dom.parentNode=e,e.__dom.childNodes.push(t),t.__dom.nextSibling=t.nextSibling,t.__dom.previousSibling=t.previousSibling}},recordInsertBefore:function(e,t,r){if(t.__dom.childNodes=null,e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(var o=e.firstChild;o;o=o.nextSibling)this._linkNode(o,t,r);else this._linkNode(e,t,r)},_linkNode:function(e,t,r){e.__dom=e.__dom||{},t.__dom=t.__dom||{},r&&(r.__dom=r.__dom||{}),e.__dom.previousSibling=r?r.__dom.previousSibling:t.__dom.lastChild,e.__dom.previousSibling&&(e.__dom.previousSibling.__dom.nextSibling=e),e.__dom.nextSibling=r||null,e.__dom.nextSibling&&(e.__dom.nextSibling.__dom.previousSibling=e),e.__dom.parentNode=t,r?r===t.__dom.firstChild&&(t.__dom.firstChild=e):(t.__dom.lastChild=e,t.__dom.firstChild||(t.__dom.firstChild=e)),t.__dom.childNodes=null},recordRemoveChild:function(e,t){e.__dom=e.__dom||{},t.__dom=t.__dom||{},e===t.__dom.firstChild&&(t.__dom.firstChild=e.__dom.nextSibling),e===t.__dom.lastChild&&(t.__dom.lastChild=e.__dom.previousSibling);var r=e.__dom.previousSibling,o=e.__dom.nextSibling;r&&(r.__dom.nextSibling=o),o&&(o.__dom.previousSibling=r),e.__dom.parentNode=e.__dom.previousSibling=e.__dom.nextSibling=void 0,t.__dom.childNodes=null}},Polymer.TreeApi.Composed={getChildNodes:function(e){return Polymer.TreeApi.arrayCopyChildNodes(e)},getParentNode:function(e){return e.parentNode},clearChildNodes:function(e){e.textContent=""},insertBefore:function(t,r,o){return e.call(t,r,o||null)},appendChild:function(e,r){return t.call(e,r)},removeChild:function(e,t){return r.call(e,t)}}}(),Polymer.DomApi=function(){"use strict";var e=Polymer.Settings,t=Polymer.TreeApi,r=function(e){this.node=o?r.wrap(e):e},o=e.hasShadow&&!e.nativeShadow;r.wrap=window.wrap?window.wrap:function(e){return e},r.prototype={flush:function(){Polymer.dom.flush()},deepContains:function(e){if(this.node.contains(e))return!0;for(var t=e,r=e.ownerDocument;t&&t!==r&&t!==this.node;)t=Polymer.dom(t).parentNode||t.host;return t===this.node},queryDistributedElements:function(e){for(var t,o=this.getEffectiveChildNodes(),n=[],i=0,s=o.length;i<s&&(t=o[i]);i++)t.nodeType===Node.ELEMENT_NODE&&r.matchesSelector.call(t,e)&&n.push(t);return n},getEffectiveChildNodes:function(){for(var e,t=[],r=this.childNodes,o=0,s=r.length;o<s&&(e=r[o]);o++)if(e.localName===n)for(var a=i(e).getDistributedNodes(),l=0;l<a.length;l++)t.push(a[l]);else t.push(e);return t},observeNodes:function(e){if(e)return this.observer||(this.observer=this.node.localName===n?new r.DistributedNodesObserver(this):new r.EffectiveNodesObserver(this)),this.observer.addListener(e)},unobserveNodes:function(e){this.observer&&this.observer.removeListener(e)},notifyObserver:function(){this.observer&&this.observer.notify()},_query:function(e,r,o){r=r||this.node;var n=[];return this._queryElements(t.Logical.getChildNodes(r),e,o,n),n},_queryElements:function(e,t,r,o){for(var n,i=0,s=e.length;i<s&&(n=e[i]);i++)if(n.nodeType===Node.ELEMENT_NODE&&this._queryElement(n,t,r,o))return!0},_queryElement:function(e,r,o,n){var i=r(e);return i&&n.push(e),o&&o(i)?i:void this._queryElements(t.Logical.getChildNodes(e),r,o,n)}};var n=r.CONTENT="content",i=r.factory=function(e){return e=e||document,e.__domApi||(e.__domApi=new r.ctor(e)),e.__domApi};r.hasApi=function(e){return Boolean(e.__domApi)},r.ctor=r,Polymer.dom=function(e,t){return e instanceof Event?Polymer.EventApi.factory(e):r.factory(e,t)};var s=Element.prototype;return r.matchesSelector=s.matches||s.matchesSelector||s.mozMatchesSelector||s.msMatchesSelector||s.oMatchesSelector||s.webkitMatchesSelector,r}(),function(){"use strict";var e=Polymer.Settings,t=Polymer.DomApi,r=t.factory,o=Polymer.TreeApi,n=Polymer.domInnerHTML.getInnerHTML,i=t.CONTENT;if(!e.useShadow){var s=Element.prototype.cloneNode,a=Document.prototype.importNode;Polymer.Base.extend(t.prototype,{_lazyDistribute:function(e){e.shadyRoot&&e.shadyRoot._distributionClean&&(e.shadyRoot._distributionClean=!1,Polymer.dom.addDebouncer(e.debounce("_distribute",e._distributeContent)))},appendChild:function(e){return this.insertBefore(e)},insertBefore:function(e,n){if(n&&o.Logical.getParentNode(n)!==this.node)throw Error("The ref_node to be inserted before is not a child of this node");if(e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE){var s=o.Logical.getParentNode(e);s?(t.hasApi(s)&&r(s).notifyObserver(),this._removeNode(e)):this._removeOwnerShadyRoot(e)}if(!this._addNode(e,n)){n&&(n=n.localName===i?this._firstComposedNode(n):n);var a=this.node._isShadyRoot?this.node.host:this.node;n?o.Composed.insertBefore(a,e,n):o.Composed.appendChild(a,e)}return this.notifyObserver(),e},_addNode:function(e,t){var r=this.getOwnerRoot();if(r){var n=this._maybeAddInsertionPoint(e,this.node);r._invalidInsertionPoints||(r._invalidInsertionPoints=n),this._addNodeToHost(r.host,e)}o.Logical.hasChildNodes(this.node)&&o.Logical.recordInsertBefore(e,this.node,t);var i=this._maybeDistribute(e)||this.node.shadyRoot;if(i)if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(;e.firstChild;)o.Composed.removeChild(e,e.firstChild);else{var s=o.Composed.getParentNode(e);s&&o.Composed.removeChild(s,e)}return i},removeChild:function(e){if(o.Logical.getParentNode(e)!==this.node)throw Error("The node to be removed is not a child of this node: "+e);if(!this._removeNode(e)){var t=this.node._isShadyRoot?this.node.host:this.node,r=o.Composed.getParentNode(e);t===r&&o.Composed.removeChild(t,e)}return this.notifyObserver(),e},_removeNode:function(e){var t,n=o.Logical.hasParentNode(e)&&o.Logical.getParentNode(e),i=this._ownerShadyRootForNode(e);return n&&(t=r(e)._maybeDistributeParent(),o.Logical.recordRemoveChild(e,n),i&&this._removeDistributedChildren(i,e)&&(i._invalidInsertionPoints=!0,this._lazyDistribute(i.host))),this._removeOwnerShadyRoot(e),i&&this._removeNodeFromHost(i.host,e),t},replaceChild:function(e,t){return this.insertBefore(e,t),this.removeChild(t),e},_hasCachedOwnerRoot:function(e){return Boolean(void 0!==e._ownerShadyRoot)},getOwnerRoot:function(){return this._ownerShadyRootForNode(this.node)},_ownerShadyRootForNode:function(e){if(e){var t=e._ownerShadyRoot;if(void 0===t){if(e._isShadyRoot)t=e;else{var r=o.Logical.getParentNode(e);t=r?r._isShadyRoot?r:this._ownerShadyRootForNode(r):null}(t||document.documentElement.contains(e))&&(e._ownerShadyRoot=t)}return t}},_maybeDistribute:function(e){var t=e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&!e.__noContent&&r(e).querySelector(i),n=t&&o.Logical.getParentNode(t).nodeType!==Node.DOCUMENT_FRAGMENT_NODE,s=t||e.localName===i;if(s){var a=this.getOwnerRoot();a&&this._lazyDistribute(a.host)}var l=this._nodeNeedsDistribution(this.node);return l&&this._lazyDistribute(this.node),l||s&&!n},_maybeAddInsertionPoint:function(e,t){var n;if(e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE||e.__noContent)e.localName===i&&(o.Logical.saveChildNodes(t),o.Logical.saveChildNodes(e),n=!0);else for(var s,a,l,c=r(e).querySelectorAll(i),u=0;u<c.length&&(s=c[u]);u++)a=o.Logical.getParentNode(s),a===e&&(a=t),l=this._maybeAddInsertionPoint(s,a),n=n||l;return n},_updateInsertionPoints:function(e){for(var t,n=e.shadyRoot._insertionPoints=r(e.shadyRoot).querySelectorAll(i),s=0;s<n.length;s++)t=n[s],o.Logical.saveChildNodes(t),o.Logical.saveChildNodes(o.Logical.getParentNode(t))},_nodeNeedsDistribution:function(e){return e&&e.shadyRoot&&t.hasInsertionPoint(e.shadyRoot)},_addNodeToHost:function(e,t){e._elementAdd&&e._elementAdd(t)},_removeNodeFromHost:function(e,t){e._elementRemove&&e._elementRemove(t)},_removeDistributedChildren:function(e,t){for(var n,i=e._insertionPoints,s=0;s<i.length;s++){var a=i[s];if(this._contains(t,a))for(var l=r(a).getDistributedNodes(),c=0;c<l.length;c++){n=!0;var u=l[c],h=o.Composed.getParentNode(u);h&&o.Composed.removeChild(h,u)}}return n},_contains:function(e,t){for(;t;){if(t==e)return!0;t=o.Logical.getParentNode(t)}},_removeOwnerShadyRoot:function(e){if(this._hasCachedOwnerRoot(e))for(var t,r=o.Logical.getChildNodes(e),n=0,i=r.length;n<i&&(t=r[n]);n++)this._removeOwnerShadyRoot(t);e._ownerShadyRoot=void 0},_firstComposedNode:function(e){for(var t,o,n=r(e).getDistributedNodes(),i=0,s=n.length;i<s&&(t=n[i]);i++)if(o=r(t).getDestinationInsertionPoints(),o[o.length-1]===e)return t},querySelector:function(e){var r=this._query(function(r){return t.matchesSelector.call(r,e)},this.node,function(e){return Boolean(e)})[0];return r||null},querySelectorAll:function(e){return this._query(function(r){return t.matchesSelector.call(r,e)},this.node)},getDestinationInsertionPoints:function(){return this.node._destinationInsertionPoints||[]},getDistributedNodes:function(){return this.node._distributedNodes||[]},_clear:function(){for(;this.childNodes.length;)this.removeChild(this.childNodes[0])},setAttribute:function(e,t){this.node.setAttribute(e,t),this._maybeDistributeParent()},removeAttribute:function(e){this.node.removeAttribute(e),this._maybeDistributeParent()},_maybeDistributeParent:function(){if(this._nodeNeedsDistribution(this.parentNode))return this._lazyDistribute(this.parentNode),!0},cloneNode:function(e){var t=s.call(this.node,!1);if(e)for(var o,n=this.childNodes,i=r(t),a=0;a<n.length;a++)o=r(n[a]).cloneNode(!0),i.appendChild(o);return t},importNode:function(e,t){var n=this.node instanceof Document?this.node:this.node.ownerDocument,i=a.call(n,e,!1);if(t)for(var s,l=o.Logical.getChildNodes(e),c=r(i),u=0;u<l.length;u++)s=r(n).importNode(l[u],!0),
c.appendChild(s);return i},_getComposedInnerHTML:function(){return n(this.node,!0)}}),Object.defineProperties(t.prototype,{activeElement:{get:function(){var e=document.activeElement;if(!e)return null;var t=!!this.node._isShadyRoot;if(this.node!==document){if(!t)return null;if(this.node.host===e||!this.node.host.contains(e))return null}for(var o=r(e).getOwnerRoot();o&&o!==this.node;)e=o.host,o=r(e).getOwnerRoot();return this.node===document?o?null:e:o===this.node?e:null},configurable:!0},childNodes:{get:function(){var e=o.Logical.getChildNodes(this.node);return Array.isArray(e)?e:o.arrayCopyChildNodes(this.node)},configurable:!0},children:{get:function(){return o.Logical.hasChildNodes(this.node)?Array.prototype.filter.call(this.childNodes,function(e){return e.nodeType===Node.ELEMENT_NODE}):o.arrayCopyChildren(this.node)},configurable:!0},parentNode:{get:function(){return o.Logical.getParentNode(this.node)},configurable:!0},firstChild:{get:function(){return o.Logical.getFirstChild(this.node)},configurable:!0},lastChild:{get:function(){return o.Logical.getLastChild(this.node)},configurable:!0},nextSibling:{get:function(){return o.Logical.getNextSibling(this.node)},configurable:!0},previousSibling:{get:function(){return o.Logical.getPreviousSibling(this.node)},configurable:!0},firstElementChild:{get:function(){return o.Logical.getFirstElementChild(this.node)},configurable:!0},lastElementChild:{get:function(){return o.Logical.getLastElementChild(this.node)},configurable:!0},nextElementSibling:{get:function(){return o.Logical.getNextElementSibling(this.node)},configurable:!0},previousElementSibling:{get:function(){return o.Logical.getPreviousElementSibling(this.node)},configurable:!0},textContent:{get:function(){var e=this.node.nodeType;if(e===Node.TEXT_NODE||e===Node.COMMENT_NODE)return this.node.textContent;for(var t,r=[],o=0,n=this.childNodes;t=n[o];o++)t.nodeType!==Node.COMMENT_NODE&&r.push(t.textContent);return r.join("")},set:function(e){var t=this.node.nodeType;t===Node.TEXT_NODE||t===Node.COMMENT_NODE?this.node.textContent=e:(this._clear(),e&&this.appendChild(document.createTextNode(e)))},configurable:!0},innerHTML:{get:function(){var e=this.node.nodeType;return e===Node.TEXT_NODE||e===Node.COMMENT_NODE?null:n(this.node)},set:function(e){var t=this.node.nodeType;if(t!==Node.TEXT_NODE||t!==Node.COMMENT_NODE){this._clear();var r=document.createElement("div");r.innerHTML=e;for(var n=o.arrayCopyChildNodes(r),i=0;i<n.length;i++)this.appendChild(n[i])}},configurable:!0}}),t.hasInsertionPoint=function(e){return Boolean(e&&e._insertionPoints.length)}}}(),function(){"use strict";var e=Polymer.Settings,t=Polymer.TreeApi,r=Polymer.DomApi;if(e.useShadow){Polymer.Base.extend(r.prototype,{querySelectorAll:function(e){return t.arrayCopy(this.node.querySelectorAll(e))},getOwnerRoot:function(){for(var e=this.node;e;){if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host)return e;e=e.parentNode}},importNode:function(e,t){var r=this.node instanceof Document?this.node:this.node.ownerDocument;return r.importNode(e,t)},getDestinationInsertionPoints:function(){var e=this.node.getDestinationInsertionPoints&&this.node.getDestinationInsertionPoints();return e?t.arrayCopy(e):[]},getDistributedNodes:function(){var e=this.node.getDistributedNodes&&this.node.getDistributedNodes();return e?t.arrayCopy(e):[]}}),Object.defineProperties(r.prototype,{activeElement:{get:function(){var e=r.wrap(this.node),t=e.activeElement;return e.contains(t)?t:null},configurable:!0},childNodes:{get:function(){return t.arrayCopyChildNodes(this.node)},configurable:!0},children:{get:function(){return t.arrayCopyChildren(this.node)},configurable:!0},textContent:{get:function(){return this.node.textContent},set:function(e){return this.node.textContent=e},configurable:!0},innerHTML:{get:function(){return this.node.innerHTML},set:function(e){return this.node.innerHTML=e},configurable:!0}});var o=function(e){for(var t=0;t<e.length;t++)n(e[t])},n=function(e){r.prototype[e]=function(){return this.node[e].apply(this.node,arguments)}};o(["cloneNode","appendChild","insertBefore","removeChild","replaceChild","setAttribute","removeAttribute","querySelector"]);var i=function(e){for(var t=0;t<e.length;t++)s(e[t])},s=function(e){Object.defineProperty(r.prototype,e,{get:function(){return this.node[e]},configurable:!0})};i(["parentNode","firstChild","lastChild","nextSibling","previousSibling","firstElementChild","lastElementChild","nextElementSibling","previousElementSibling"])}}(),Polymer.Base.extend(Polymer.dom,{_flushGuard:0,_FLUSH_MAX:100,_needsTakeRecords:!Polymer.Settings.useNativeCustomElements,_debouncers:[],_staticFlushList:[],_finishDebouncer:null,flush:function(){for(this._flushGuard=0,this._prepareFlush();this._debouncers.length&&this._flushGuard<this._FLUSH_MAX;){for(;this._debouncers.length;)this._debouncers.shift().complete();this._finishDebouncer&&this._finishDebouncer.complete(),this._prepareFlush(),this._flushGuard++}this._flushGuard>=this._FLUSH_MAX&&console.warn("Polymer.dom.flush aborted. Flush may not be complete.")},_prepareFlush:function(){this._needsTakeRecords&&CustomElements.takeRecords();for(var e=0;e<this._staticFlushList.length;e++)this._staticFlushList[e]()},addStaticFlush:function(e){this._staticFlushList.push(e)},removeStaticFlush:function(e){var t=this._staticFlushList.indexOf(e);t>=0&&this._staticFlushList.splice(t,1)},addDebouncer:function(e){this._debouncers.push(e),this._finishDebouncer=Polymer.Debounce(this._finishDebouncer,this._finishFlush)},_finishFlush:function(){Polymer.dom._debouncers=[]}}),Polymer.EventApi=function(){"use strict";var e=Polymer.DomApi.ctor,t=Polymer.Settings;e.Event=function(e){this.event=e},t.useShadow?e.Event.prototype={get rootTarget(){return this.event.path[0]},get localTarget(){return this.event.target},get path(){var e=this.event.path;return Array.isArray(e)||(e=Array.prototype.slice.call(e)),e}}:e.Event.prototype={get rootTarget(){return this.event.target},get localTarget(){for(var e=this.event.currentTarget,t=e&&Polymer.dom(e).getOwnerRoot(),r=this.path,o=0;o<r.length;o++)if(Polymer.dom(r[o]).getOwnerRoot()===t)return r[o]},get path(){if(!this.event._path){for(var e=[],t=this.rootTarget;t;){e.push(t);var r=Polymer.dom(t).getDestinationInsertionPoints();if(r.length){for(var o=0;o<r.length-1;o++)e.push(r[o]);t=r[r.length-1]}else t=Polymer.dom(t).parentNode||t.host}e.push(window),this.event._path=e}return this.event._path}};var r=function(t){return t.__eventApi||(t.__eventApi=new e.Event(t)),t.__eventApi};return{factory:r}}(),function(){"use strict";var e=Polymer.DomApi.ctor,t=Polymer.Settings.useShadow;Object.defineProperty(e.prototype,"classList",{get:function(){return this._classList||(this._classList=new e.ClassList(this)),this._classList},configurable:!0}),e.ClassList=function(e){this.domApi=e,this.node=e.node},e.ClassList.prototype={add:function(){this.node.classList.add.apply(this.node.classList,arguments),this._distributeParent()},remove:function(){this.node.classList.remove.apply(this.node.classList,arguments),this._distributeParent()},toggle:function(){this.node.classList.toggle.apply(this.node.classList,arguments),this._distributeParent()},_distributeParent:function(){t||this.domApi._maybeDistributeParent()},contains:function(){return this.node.classList.contains.apply(this.node.classList,arguments)}}}(),function(){"use strict";var e=Polymer.DomApi.ctor,t=Polymer.Settings;if(e.EffectiveNodesObserver=function(e){this.domApi=e,this.node=this.domApi.node,this._listeners=[]},e.EffectiveNodesObserver.prototype={addListener:function(e){this._isSetup||(this._setup(),this._isSetup=!0);var t={fn:e,_nodes:[]};return this._listeners.push(t),this._scheduleNotify(),t},removeListener:function(e){var t=this._listeners.indexOf(e);t>=0&&(this._listeners.splice(t,1),e._nodes=[]),this._hasListeners()||(this._cleanup(),this._isSetup=!1)},_setup:function(){this._observeContentElements(this.domApi.childNodes)},_cleanup:function(){this._unobserveContentElements(this.domApi.childNodes)},_hasListeners:function(){return Boolean(this._listeners.length)},_scheduleNotify:function(){this._debouncer&&this._debouncer.stop(),this._debouncer=Polymer.Debounce(this._debouncer,this._notify),this._debouncer.context=this,Polymer.dom.addDebouncer(this._debouncer)},notify:function(){this._hasListeners()&&this._scheduleNotify()},_notify:function(){this._beforeCallListeners(),this._callListeners()},_beforeCallListeners:function(){this._updateContentElements()},_updateContentElements:function(){this._observeContentElements(this.domApi.childNodes)},_observeContentElements:function(e){for(var t,r=0;r<e.length&&(t=e[r]);r++)this._isContent(t)&&(t.__observeNodesMap=t.__observeNodesMap||new WeakMap,t.__observeNodesMap.has(this)||t.__observeNodesMap.set(this,this._observeContent(t)))},_observeContent:function(e){var t=this,r=Polymer.dom(e).observeNodes(function(){t._scheduleNotify()});return r._avoidChangeCalculation=!0,r},_unobserveContentElements:function(e){for(var t,r,o=0;o<e.length&&(t=e[o]);o++)this._isContent(t)&&(r=t.__observeNodesMap.get(this),r&&(Polymer.dom(t).unobserveNodes(r),t.__observeNodesMap["delete"](this)))},_isContent:function(e){return"content"===e.localName},_callListeners:function(){for(var e,t=this._listeners,r=this._getEffectiveNodes(),o=0;o<t.length&&(e=t[o]);o++){var n=this._generateListenerInfo(e,r);(n||e._alwaysNotify)&&this._callListener(e,n)}},_getEffectiveNodes:function(){return this.domApi.getEffectiveChildNodes()},_generateListenerInfo:function(e,t){if(e._avoidChangeCalculation)return!0;for(var r,o=e._nodes,n={target:this.node,addedNodes:[],removedNodes:[]},i=Polymer.ArraySplice.calculateSplices(t,o),s=0;s<i.length&&(r=i[s]);s++)for(var a,l=0;l<r.removed.length&&(a=r.removed[l]);l++)n.removedNodes.push(a);for(s=0,r;s<i.length&&(r=i[s]);s++)for(l=r.index;l<r.index+r.addedCount;l++)n.addedNodes.push(t[l]);return e._nodes=t,n.addedNodes.length||n.removedNodes.length?n:void 0},_callListener:function(e,t){return e.fn.call(this.node,t)},enableShadowAttributeTracking:function(){}},t.useShadow){var r=e.EffectiveNodesObserver.prototype._setup,o=e.EffectiveNodesObserver.prototype._cleanup;Polymer.Base.extend(e.EffectiveNodesObserver.prototype,{_setup:function(){if(!this._observer){var e=this;this._mutationHandler=function(t){t&&t.length&&e._scheduleNotify()},this._observer=new MutationObserver(this._mutationHandler),this._boundFlush=function(){e._flush()},Polymer.dom.addStaticFlush(this._boundFlush),this._observer.observe(this.node,{childList:!0})}r.call(this)},_cleanup:function(){this._observer.disconnect(),this._observer=null,this._mutationHandler=null,Polymer.dom.removeStaticFlush(this._boundFlush),o.call(this)},_flush:function(){this._observer&&this._mutationHandler(this._observer.takeRecords())},enableShadowAttributeTracking:function(){if(this._observer){this._makeContentListenersAlwaysNotify(),this._observer.disconnect(),this._observer.observe(this.node,{childList:!0,attributes:!0,subtree:!0});var e=this.domApi.getOwnerRoot(),t=e&&e.host;t&&Polymer.dom(t).observer&&Polymer.dom(t).observer.enableShadowAttributeTracking()}},_makeContentListenersAlwaysNotify:function(){for(var e,t=0;t<this._listeners.length;t++)e=this._listeners[t],e._alwaysNotify=e._isContentListener}})}}(),function(){"use strict";var e=Polymer.DomApi.ctor,t=Polymer.Settings;e.DistributedNodesObserver=function(t){e.EffectiveNodesObserver.call(this,t)},e.DistributedNodesObserver.prototype=Object.create(e.EffectiveNodesObserver.prototype),Polymer.Base.extend(e.DistributedNodesObserver.prototype,{_setup:function(){},_cleanup:function(){},_beforeCallListeners:function(){},_getEffectiveNodes:function(){return this.domApi.getDistributedNodes()}}),t.useShadow&&Polymer.Base.extend(e.DistributedNodesObserver.prototype,{_setup:function(){if(!this._observer){var e=this.domApi.getOwnerRoot(),t=e&&e.host;if(t){var r=this;this._observer=Polymer.dom(t).observeNodes(function(){r._scheduleNotify()}),this._observer._isContentListener=!0,this._hasAttrSelect()&&Polymer.dom(t).observer.enableShadowAttributeTracking()}}},_hasAttrSelect:function(){var e=this.node.getAttribute("select");return e&&e.match(/[[.]+/)},_cleanup:function(){var e=this.domApi.getOwnerRoot(),t=e&&e.host;t&&Polymer.dom(t).unobserveNodes(this._observer),this._observer=null}})}(),function(){function e(e,t){t._distributedNodes.push(e);var r=e._destinationInsertionPoints;r?r.push(t):e._destinationInsertionPoints=[t]}function t(e){var t=e._distributedNodes;if(t)for(var r=0;r<t.length;r++){var o=t[r]._destinationInsertionPoints;o&&o.splice(o.indexOf(e)+1,o.length)}}function r(e,t){var r=h.Logical.getParentNode(e);r&&r.shadyRoot&&u.hasInsertionPoint(r.shadyRoot)&&r.shadyRoot._distributionClean&&(r.shadyRoot._distributionClean=!1,t.shadyRoot._dirtyRoots.push(r))}function o(e,t){var r=t._destinationInsertionPoints;return r&&r[r.length-1]===e}function n(e){return"content"==e.localName}function i(e){for(;e&&s(e);)e=e.domHost;return e}function s(e){for(var t,r=h.Logical.getChildNodes(e),o=0;o<r.length;o++)if(t=r[o],t.localName&&"content"===t.localName)return e.domHost}function a(e){for(var t,r=0;r<e._insertionPoints.length;r++)t=e._insertionPoints[r],u.hasApi(t)&&Polymer.dom(t).notifyObserver()}function l(e){u.hasApi(e)&&Polymer.dom(e).notifyObserver()}function c(e){if(f&&e)for(var t=0;t<e.length;t++)CustomElements.upgrade(e[t])}var u=Polymer.DomApi,h=Polymer.TreeApi;Polymer.Base._addFeature({_prepShady:function(){this._useContent=this._useContent||Boolean(this._template)},_setupShady:function(){this.shadyRoot=null,this.__domApi||(this.__domApi=null),this.__dom||(this.__dom=null),this._ownerShadyRoot||(this._ownerShadyRoot=void 0)},_poolContent:function(){this._useContent&&h.Logical.saveChildNodes(this)},_setupRoot:function(){this._useContent&&(this._createLocalRoot(),this.dataHost||c(h.Logical.getChildNodes(this)))},_createLocalRoot:function(){this.shadyRoot=this.root,this.shadyRoot._distributionClean=!1,this.shadyRoot._hasDistributed=!1,this.shadyRoot._isShadyRoot=!0,this.shadyRoot._dirtyRoots=[];var e=this.shadyRoot._insertionPoints=!this._notes||this._notes._hasContent?this.shadyRoot.querySelectorAll("content"):[];h.Logical.saveChildNodes(this.shadyRoot);for(var t,r=0;r<e.length;r++)t=e[r],h.Logical.saveChildNodes(t),h.Logical.saveChildNodes(t.parentNode);this.shadyRoot.host=this},get domHost(){var e=Polymer.dom(this).getOwnerRoot();return e&&e.host},distributeContent:function(e){if(this.shadyRoot){this.shadyRoot._invalidInsertionPoints=this.shadyRoot._invalidInsertionPoints||e;var t=i(this);Polymer.dom(this)._lazyDistribute(t)}},_distributeContent:function(){this._useContent&&!this.shadyRoot._distributionClean&&(this.shadyRoot._invalidInsertionPoints&&(Polymer.dom(this)._updateInsertionPoints(this),this.shadyRoot._invalidInsertionPoints=!1),this._beginDistribute(),this._distributeDirtyRoots(),this._finishDistribute())},_beginDistribute:function(){this._useContent&&u.hasInsertionPoint(this.shadyRoot)&&(this._resetDistribution(),this._distributePool(this.shadyRoot,this._collectPool()))},_distributeDirtyRoots:function(){for(var e,t=this.shadyRoot._dirtyRoots,r=0,o=t.length;r<o&&(e=t[r]);r++)e._distributeContent();this.shadyRoot._dirtyRoots=[]},_finishDistribute:function(){if(this._useContent){if(this.shadyRoot._distributionClean=!0,u.hasInsertionPoint(this.shadyRoot))this._composeTree(),a(this.shadyRoot);else if(this.shadyRoot._hasDistributed){var e=this._composeNode(this);this._updateChildNodes(this,e)}else h.Composed.clearChildNodes(this),this.appendChild(this.shadyRoot);this.shadyRoot._hasDistributed||l(this),this.shadyRoot._hasDistributed=!0}},elementMatches:function(e,t){return t=t||this,u.matchesSelector.call(t,e)},_resetDistribution:function(){for(var e=h.Logical.getChildNodes(this),r=0;r<e.length;r++){var o=e[r];o._destinationInsertionPoints&&(o._destinationInsertionPoints=void 0),n(o)&&t(o)}for(var i=this.shadyRoot,s=i._insertionPoints,a=0;a<s.length;a++)s[a]._distributedNodes=[]},_collectPool:function(){for(var e=[],t=h.Logical.getChildNodes(this),r=0;r<t.length;r++){var o=t[r];n(o)?e.push.apply(e,o._distributedNodes):e.push(o)}return e},_distributePool:function(e,t){for(var o,n=e._insertionPoints,i=0,s=n.length;i<s&&(o=n[i]);i++)this._distributeInsertionPoint(o,t),r(o,this)},_distributeInsertionPoint:function(t,r){for(var o,n=!1,i=0,s=r.length;i<s;i++)o=r[i],o&&this._matchesContentSelect(o,t)&&(e(o,t),r[i]=void 0,n=!0);if(!n)for(var a=h.Logical.getChildNodes(t),l=0;l<a.length;l++)e(a[l],t)},_composeTree:function(){this._updateChildNodes(this,this._composeNode(this));for(var e,t,r=this.shadyRoot._insertionPoints,o=0,n=r.length;o<n&&(e=r[o]);o++)t=h.Logical.getParentNode(e),t._useContent||t===this||t===this.shadyRoot||this._updateChildNodes(t,this._composeNode(t))},_composeNode:function(e){for(var t=[],r=h.Logical.getChildNodes(e.shadyRoot||e),i=0;i<r.length;i++){var s=r[i];if(n(s))for(var a=s._distributedNodes,l=0;l<a.length;l++){var c=a[l];o(s,c)&&t.push(c)}else t.push(s)}return t},_updateChildNodes:function(e,t){for(var r,o=h.Composed.getChildNodes(e),n=Polymer.ArraySplice.calculateSplices(t,o),i=0,s=0;i<n.length&&(r=n[i]);i++){for(var a,l=0;l<r.removed.length&&(a=r.removed[l]);l++)h.Composed.getParentNode(a)===e&&h.Composed.removeChild(e,a),o.splice(r.index+s,1);s-=r.addedCount}for(var r,c,i=0;i<n.length&&(r=n[i]);i++)for(c=o[r.index],l=r.index,a;l<r.index+r.addedCount;l++)a=t[l],h.Composed.insertBefore(e,a,c),o.splice(l,0,a)},_matchesContentSelect:function(e,t){var r=t.getAttribute("select");if(!r)return!0;if(r=r.trim(),!r)return!0;if(!(e instanceof Element))return!1;var o=/^(:not\()?[*.#[a-zA-Z_|]/;return!!o.test(r)&&this.elementMatches(r,e)},_elementAdd:function(){},_elementRemove:function(){}});var f=window.CustomElements&&!CustomElements.useNative}(),Polymer.Settings.useShadow&&Polymer.Base._addFeature({_poolContent:function(){},_beginDistribute:function(){},distributeContent:function(){},_distributeContent:function(){},_finishDistribute:function(){},_createLocalRoot:function(){this.createShadowRoot(),this.shadowRoot.appendChild(this.root),this.root=this.shadowRoot}}),Polymer.Async={_currVal:0,_lastVal:0,_callbacks:[],_twiddleContent:0,_twiddle:document.createTextNode(""),run:function(e,t){return t>0?~setTimeout(e,t):(this._twiddle.textContent=this._twiddleContent++,this._callbacks.push(e),this._currVal++)},cancel:function(e){if(e<0)clearTimeout(~e);else{var t=e-this._lastVal;if(t>=0){if(!this._callbacks[t])throw"invalid async handle: "+e;this._callbacks[t]=null}}},_atEndOfMicrotask:function(){for(var e=this._callbacks.length,t=0;t<e;t++){var r=this._callbacks[t];if(r)try{r()}catch(o){throw t++,this._callbacks.splice(0,t),this._lastVal+=t,this._twiddle.textContent=this._twiddleContent++,o}}this._callbacks.splice(0,e),this._lastVal+=e}},new window.MutationObserver(function(){Polymer.Async._atEndOfMicrotask()}).observe(Polymer.Async._twiddle,{characterData:!0}),Polymer.Debounce=function(){function e(e,t,o){return e?e.stop():e=new r(this),e.go(t,o),e}var t=Polymer.Async,r=function(e){this.context=e;var t=this;this.boundComplete=function(){t.complete()}};return r.prototype={go:function(e,r){var o;this.finish=function(){t.cancel(o)},o=t.run(this.boundComplete,r),this.callback=e},stop:function(){this.finish&&(this.finish(),this.finish=null,this.callback=null)},complete:function(){if(this.finish){var e=this.callback;this.stop(),e.call(this.context)}}},e}(),Polymer.Base._addFeature({_setupDebouncers:function(){this._debouncers={}},debounce:function(e,t,r){return this._debouncers[e]=Polymer.Debounce.call(this,this._debouncers[e],t,r)},isDebouncerActive:function(e){var t=this._debouncers[e];return!(!t||!t.finish)},flushDebouncer:function(e){var t=this._debouncers[e];t&&t.complete()},cancelDebouncer:function(e){var t=this._debouncers[e];t&&t.stop()}}),Polymer.DomModule=document.createElement("dom-module"),Polymer.Base._addFeature({_registerFeatures:function(){this._prepIs(),this._prepBehaviors(),this._prepConstructor(),this._prepTemplate(),this._prepShady(),this._prepPropertyInfo()},_prepBehavior:function(e){this._addHostAttributes(e.hostAttributes)},_initFeatures:function(){this._registerHost(),this._template&&(this._poolContent(),this._beginHosting(),this._stampTemplate(),this._endHosting()),this._marshalHostAttributes(),this._setupDebouncers(),this._marshalBehaviors(),this._tryReady()},_marshalBehavior:function(e){}}),Polymer.nar=[],Polymer.Annotations={parseAnnotations:function(e){var t=[],r=e._content||e.content;return this._parseNodeAnnotations(r,t,e.hasAttribute("strip-whitespace")),t},_parseNodeAnnotations:function(e,t,r){return e.nodeType===Node.TEXT_NODE?this._parseTextNodeAnnotation(e,t):this._parseElementAnnotations(e,t,r)},_bindingRegex:function(){var e="(?:[a-zA-Z_$][\\w.:$\\-*]*)",t="(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)",r="(?:'(?:[^'\\\\]|\\\\.)*')",o='(?:"(?:[^"\\\\]|\\\\.)*")',n="(?:"+r+"|"+o+")",i="(?:"+e+"|"+t+"|"+n+"\\s*)",s="(?:"+i+"(?:,\\s*"+i+")*)",a="(?:\\(\\s*(?:"+s+"?)\\)\\s*)",l="("+e+"\\s*"+a+"?)",c="(\\[\\[|{{)\\s*",u="(?:]]|}})",h="(?:(!)\\s*)?",f=c+h+l+u;return new RegExp(f,"g")}(),_parseBindings:function(e){for(var t,r=this._bindingRegex,o=[],n=0;null!==(t=r.exec(e));){t.index>n&&o.push({literal:e.slice(n,t.index)});var i,s,a,l=t[1][0],c=Boolean(t[2]),u=t[3].trim();"{"==l&&(a=u.indexOf("::"))>0&&(s=u.substring(a+2),u=u.substring(0,a),i=!0),o.push({compoundIndex:o.length,value:u,mode:l,negate:c,event:s,customEvent:i}),n=r.lastIndex}if(n&&n<e.length){var h=e.substring(n);h&&o.push({literal:h})}if(o.length)return o},_literalFromParts:function(e){for(var t="",r=0;r<e.length;r++){var o=e[r].literal;t+=o||""}return t},_parseTextNodeAnnotation:function(e,t){var r=this._parseBindings(e.textContent);if(r){e.textContent=this._literalFromParts(r)||" ";var o={bindings:[{kind:"text",name:"textContent",parts:r,isCompound:1!==r.length}]};return t.push(o),o}},_parseElementAnnotations:function(e,t,r){var o={bindings:[],events:[]};return"content"===e.localName&&(t._hasContent=!0),this._parseChildNodesAnnotations(e,o,t,r),e.attributes&&(this._parseNodeAttributeAnnotations(e,o,t),this.prepElement&&this.prepElement(e)),(o.bindings.length||o.events.length||o.id)&&t.push(o),o},_parseChildNodesAnnotations:function(e,t,r,o){if(e.firstChild)for(var n=e.firstChild,i=0;n;){var s=n.nextSibling;if("template"!==n.localName||n.hasAttribute("preserve-content")||this._parseTemplate(n,i,r,t),n.nodeType===Node.TEXT_NODE){for(var a=s;a&&a.nodeType===Node.TEXT_NODE;)n.textContent+=a.textContent,s=a.nextSibling,e.removeChild(a),a=s;o&&!n.textContent.trim()&&(e.removeChild(n),i--)}if(n.parentNode){var l=this._parseNodeAnnotations(n,r,o);l&&(l.parent=t,l.index=i)}n=s,i++}},_parseTemplate:function(e,t,r,o){var n=document.createDocumentFragment();n._notes=this.parseAnnotations(e),n.appendChild(e.content),r.push({bindings:Polymer.nar,events:Polymer.nar,templateContent:n,parent:o,index:t})},_parseNodeAttributeAnnotations:function(e,t){for(var r,o=Array.prototype.slice.call(e.attributes),n=o.length-1;r=o[n];n--){var i,s=r.name,a=r.value;"on-"===s.slice(0,3)?(e.removeAttribute(s),t.events.push({name:s.slice(3),value:a})):(i=this._parseNodeAttributeAnnotation(e,s,a))?t.bindings.push(i):"id"===s&&(t.id=a)}},_parseNodeAttributeAnnotation:function(e,t,r){var o=this._parseBindings(r);if(o){var n=t,i="property";"$"==t[t.length-1]&&(t=t.slice(0,-1),i="attribute");var s=this._literalFromParts(o);s&&"attribute"==i&&e.setAttribute(t,s),"input"===e.localName&&"value"===n&&e.setAttribute(n,""),e.removeAttribute(n);var a=Polymer.CaseMap.dashToCamelCase(t);return"property"===i&&(t=a),{kind:i,name:t,propertyName:a,parts:o,literal:s,isCompound:1!==o.length}}},findAnnotatedNode:function(e,t){var r=t.parent&&Polymer.Annotations.findAnnotatedNode(e,t.parent);if(!r)return e;for(var o=r.firstChild,n=0;o;o=o.nextSibling)if(t.index===n++)return o}},function(){function e(e,t){return e.replace(a,function(e,o,n,i){return o+"'"+r(n.replace(/["']/g,""),t)+"'"+i})}function t(t,o){for(var n in l)for(var i,s,a,u=l[n],h=0,f=u.length;h<f&&(i=u[h]);h++)"*"!==n&&t.localName!==n||(s=t.attributes[i],a=s&&s.value,a&&a.search(c)<0&&(s.value="style"===i?e(a,o):r(a,o)))}function r(e,t){if(e&&"#"===e[0])return e;var r=n(t);return r.href=e,r.href||e}function o(e,t){return i||(i=document.implementation.createHTMLDocument("temp"),s=i.createElement("base"),i.head.appendChild(s)),s.href=t,r(e,i)}function n(e){return e.__urlResolver||(e.__urlResolver=e.createElement("a"))}var i,s,a=/(url\()([^)]*)(\))/g,l={"*":["href","src","style","url"],form:["action"]},c=/\{\{|\[\[/;Polymer.ResolveUrl={resolveCss:e,resolveAttrs:t,resolveUrl:o}}(),Polymer.Base._addFeature({_prepAnnotations:function(){if(this._template){var e=this;Polymer.Annotations.prepElement=function(t){e._prepElement(t)},this._template._content&&this._template._content._notes?this._notes=this._template._content._notes:(this._notes=Polymer.Annotations.parseAnnotations(this._template),this._processAnnotations(this._notes)),Polymer.Annotations.prepElement=null}else this._notes=[]},_processAnnotations:function(e){for(var t=0;t<e.length;t++){for(var r=e[t],o=0;o<r.bindings.length;o++)for(var n=r.bindings[o],i=0;i<n.parts.length;i++){var s=n.parts[i];if(!s.literal){var a=this._parseMethod(s.value);a?s.signature=a:s.model=this._modelForPath(s.value)}}if(r.templateContent){this._processAnnotations(r.templateContent._notes);var l=r.templateContent._parentProps=this._discoverTemplateParentProps(r.templateContent._notes),c=[];for(var u in l){var h="_parent_"+u;c.push({index:r.index,kind:"property",name:h,propertyName:h,parts:[{mode:"{",model:u,value:u}]})}r.bindings=r.bindings.concat(c)}}},_discoverTemplateParentProps:function(e){for(var t,r={},o=0;o<e.length&&(t=e[o]);o++){for(var n,i=0,s=t.bindings;i<s.length&&(n=s[i]);i++)for(var a,l=0,c=n.parts;l<c.length&&(a=c[l]);l++)if(a.signature){for(var u=a.signature.args,h=0;h<u.length;h++){var f=u[h].model;f&&(r[f]=!0)}a.signature.dynamicFn&&(r[a.signature.method]=!0)}else a.model&&(r[a.model]=!0);if(t.templateContent){var p=t.templateContent._parentProps;Polymer.Base.mixin(r,p)}}return r},_prepElement:function(e){Polymer.ResolveUrl.resolveAttrs(e,this._template.ownerDocument)},_findAnnotatedNode:Polymer.Annotations.findAnnotatedNode,_marshalAnnotationReferences:function(){this._template&&(this._marshalIdNodes(),this._marshalAnnotatedNodes(),this._marshalAnnotatedListeners())},_configureAnnotationReferences:function(){for(var e=this._notes,t=this._nodes,r=0;r<e.length;r++){var o=e[r],n=t[r];this._configureTemplateContent(o,n),this._configureCompoundBindings(o,n)}},_configureTemplateContent:function(e,t){e.templateContent&&(t._content=e.templateContent)},_configureCompoundBindings:function(e,t){for(var r=e.bindings,o=0;o<r.length;o++){var n=r[o];if(n.isCompound){for(var i=t.__compoundStorage__||(t.__compoundStorage__={}),s=n.parts,a=new Array(s.length),l=0;l<s.length;l++)a[l]=s[l].literal;var c=n.name;i[c]=a,n.literal&&"property"==n.kind&&(t._configValue?t._configValue(c,n.literal):t[c]=n.literal)}}},_marshalIdNodes:function(){this.$={};for(var e,t=0,r=this._notes.length;t<r&&(e=this._notes[t]);t++)e.id&&(this.$[e.id]=this._findAnnotatedNode(this.root,e))},_marshalAnnotatedNodes:function(){if(this._notes&&this._notes.length){for(var e=new Array(this._notes.length),t=0;t<this._notes.length;t++)e[t]=this._findAnnotatedNode(this.root,this._notes[t]);this._nodes=e}},_marshalAnnotatedListeners:function(){for(var e,t=0,r=this._notes.length;t<r&&(e=this._notes[t]);t++)if(e.events&&e.events.length)for(var o,n=this._findAnnotatedNode(this.root,e),i=0,s=e.events;i<s.length&&(o=s[i]);i++)this.listen(n,o.name,o.value)}}),Polymer.Base._addFeature({listeners:{},_listenListeners:function(e){var t,r,o;for(o in e)o.indexOf(".")<0?(t=this,r=o):(r=o.split("."),t=this.$[r[0]],r=r[1]),this.listen(t,r,e[o])},listen:function(e,t,r){var o=this._recallEventHandler(this,t,e,r);o||(o=this._createEventHandler(e,t,r)),o._listening||(this._listen(e,t,o),o._listening=!0)},_boundListenerKey:function(e,t){return e+":"+t},_recordEventHandler:function(e,t,r,o,n){var i=e.__boundListeners;i||(i=e.__boundListeners=new WeakMap);var s=i.get(r);s||(s={},i.set(r,s));var a=this._boundListenerKey(t,o);s[a]=n},_recallEventHandler:function(e,t,r,o){var n=e.__boundListeners;if(n){var i=n.get(r);if(i){var s=this._boundListenerKey(t,o);return i[s]}}},_createEventHandler:function(e,t,r){var o=this,n=function(e){o[r]?o[r](e,e.detail):o._warn(o._logf("_createEventHandler","listener method `"+r+"` not defined"))};return n._listening=!1,this._recordEventHandler(o,t,e,r,n),n},unlisten:function(e,t,r){var o=this._recallEventHandler(this,t,e,r);o&&(this._unlisten(e,t,o),o._listening=!1)},_listen:function(e,t,r){e.addEventListener(t,r)},_unlisten:function(e,t,r){e.removeEventListener(t,r)}}),function(){"use strict";function e(e){for(var t,r=0;r<_.length;r++)t=_[r],e?document.addEventListener(t,b,!0):document.removeEventListener(t,b,!0)}function t(){if(!v){S.mouse.mouseIgnoreJob||e(!0);var t=function(){e(),S.mouse.target=null,S.mouse.mouseIgnoreJob=null};S.mouse.mouseIgnoreJob=Polymer.Debounce(S.mouse.mouseIgnoreJob,t,g)}}function r(e){var t=e.type;if(_.indexOf(t)===-1)return!1;if("mousemove"===t){var r=void 0===e.buttons?1:e.buttons;return e instanceof window.MouseEvent&&!y&&(r=m[e.which]||0),Boolean(1&r)}var o=void 0===e.button?0:e.button;return 0===o}function o(e){if("click"===e.type){if(0===e.detail)return!0;var t=E.findOriginalTarget(e),r=t.getBoundingClientRect(),o=e.pageX,n=e.pageY;return!(o>=r.left&&o<=r.right&&n>=r.top&&n<=r.bottom)}return!1}function n(e){for(var t,r=Polymer.dom(e).path,o="auto",n=0;n<r.length;n++)if(t=r[n],t[h]){o=t[h];break}return o}function i(e,t,r){e.movefn=t,e.upfn=r,document.addEventListener("mousemove",t),document.addEventListener("mouseup",r)}function s(e){document.removeEventListener("mousemove",e.movefn),document.removeEventListener("mouseup",e.upfn),e.movefn=null,e.upfn=null}var a=Polymer.DomApi.wrap,l="string"==typeof document.head.style.touchAction,c="__polymerGestures",u="__polymerGesturesHandled",h="__polymerGesturesTouchAction",f=25,p=5,d=2,g=2500,_=["mousedown","mousemove","mouseup","click"],m=[0,1,4,2],y=function(){try{return 1===new MouseEvent("test",{buttons:1}).buttons}catch(e){return!1}}(),v=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/),b=function(e){if(e[u]={skip:!0},"click"===e.type){for(var t=Polymer.dom(e).path,r=0;r<t.length;r++)if(t[r]===S.mouse.target)return;e.preventDefault(),e.stopPropagation()}},S={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}},E={gestures:{},recognizers:[],deepTargetFind:function(e,t){for(var r=document.elementFromPoint(e,t),o=r;o&&o.shadowRoot;)o=o.shadowRoot.elementFromPoint(e,t),o&&(r=o);return r},findOriginalTarget:function(e){return e.path?e.path[0]:e.target},handleNative:function(e){var r,o=e.type,n=a(e.currentTarget),i=n[c];if(i){var s=i[o];if(s){if(!e[u]&&(e[u]={},"touch"===o.slice(0,5))){var h=e.changedTouches[0];if("touchstart"===o&&1===e.touches.length&&(S.touch.id=h.identifier),S.touch.id!==h.identifier)return;l||"touchstart"!==o&&"touchmove"!==o||E.handleTouchAction(e),"touchend"===o&&(S.mouse.target=Polymer.dom(e).rootTarget,t())}if(r=e[u],!r.skip){for(var f,p=E.recognizers,d=0;d<p.length;d++)f=p[d],s[f.name]&&!r[f.name]&&f.flow&&f.flow.start.indexOf(e.type)>-1&&f.reset&&f.reset();for(d=0,f;d<p.length;d++)f=p[d],s[f.name]&&!r[f.name]&&(r[f.name]=!0,f[o](e))}}}},handleTouchAction:function(e){var t=e.changedTouches[0],r=e.type;if("touchstart"===r)S.touch.x=t.clientX,S.touch.y=t.clientY,S.touch.scrollDecided=!1;else if("touchmove"===r){if(S.touch.scrollDecided)return;S.touch.scrollDecided=!0;var o=n(e),i=!1,s=Math.abs(S.touch.x-t.clientX),a=Math.abs(S.touch.y-t.clientY);e.cancelable&&("none"===o?i=!0:"pan-x"===o?i=a>s:"pan-y"===o&&(i=s>a)),i?e.preventDefault():E.prevent("track")}},add:function(e,t,r){e=a(e);var o=this.gestures[t],n=o.deps,i=o.name,s=e[c];s||(e[c]=s={});for(var l,u,h=0;h<n.length;h++)l=n[h],
v&&_.indexOf(l)>-1||(u=s[l],u||(s[l]=u={_count:0}),0===u._count&&e.addEventListener(l,this.handleNative),u[i]=(u[i]||0)+1,u._count=(u._count||0)+1);e.addEventListener(t,r),o.touchAction&&this.setTouchAction(e,o.touchAction)},remove:function(e,t,r){e=a(e);var o=this.gestures[t],n=o.deps,i=o.name,s=e[c];if(s)for(var l,u,h=0;h<n.length;h++)l=n[h],u=s[l],u&&u[i]&&(u[i]=(u[i]||1)-1,u._count=(u._count||1)-1,0===u._count&&e.removeEventListener(l,this.handleNative));e.removeEventListener(t,r)},register:function(e){this.recognizers.push(e);for(var t=0;t<e.emits.length;t++)this.gestures[e.emits[t]]=e},findRecognizerByEvent:function(e){for(var t,r=0;r<this.recognizers.length;r++){t=this.recognizers[r];for(var o,n=0;n<t.emits.length;n++)if(o=t.emits[n],o===e)return t}return null},setTouchAction:function(e,t){l&&(e.style.touchAction=t),e[h]=t},fire:function(e,t,r){var o=Polymer.Base.fire(t,r,{node:e,bubbles:!0,cancelable:!0});if(o.defaultPrevented){var n=r.preventer||r.sourceEvent;n&&n.preventDefault&&n.preventDefault()}},prevent:function(e){var t=this.findRecognizerByEvent(e);t.info&&(t.info.prevent=!0)},resetMouseCanceller:function(){S.mouse.mouseIgnoreJob&&S.mouse.mouseIgnoreJob.complete()}};E.register({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset:function(){s(this.info)},mousedown:function(e){if(r(e)){var t=E.findOriginalTarget(e),o=this,n=function(e){r(e)||(o.fire("up",t,e),s(o.info))},a=function(e){r(e)&&o.fire("up",t,e),s(o.info)};i(this.info,n,a),this.fire("down",t,e)}},touchstart:function(e){this.fire("down",E.findOriginalTarget(e),e.changedTouches[0],e)},touchend:function(e){this.fire("up",E.findOriginalTarget(e),e.changedTouches[0],e)},fire:function(e,t,r,o){E.fire(t,e,{x:r.clientX,y:r.clientY,sourceEvent:r,preventer:o,prevent:function(e){return E.prevent(e)}})}}),E.register({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove:function(e){this.moves.length>d&&this.moves.shift(),this.moves.push(e)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,s(this.info)},hasMovedEnough:function(e,t){if(this.info.prevent)return!1;if(this.info.started)return!0;var r=Math.abs(this.info.x-e),o=Math.abs(this.info.y-t);return r>=p||o>=p},mousedown:function(e){if(r(e)){var t=E.findOriginalTarget(e),o=this,n=function(e){var n=e.clientX,i=e.clientY;o.hasMovedEnough(n,i)&&(o.info.state=o.info.started?"mouseup"===e.type?"end":"track":"start","start"===o.info.state&&E.prevent("tap"),o.info.addMove({x:n,y:i}),r(e)||(o.info.state="end",s(o.info)),o.fire(t,e),o.info.started=!0)},a=function(e){o.info.started&&n(e),s(o.info)};i(this.info,n,a),this.info.x=e.clientX,this.info.y=e.clientY}},touchstart:function(e){var t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchmove:function(e){var t=E.findOriginalTarget(e),r=e.changedTouches[0],o=r.clientX,n=r.clientY;this.hasMovedEnough(o,n)&&("start"===this.info.state&&E.prevent("tap"),this.info.addMove({x:o,y:n}),this.fire(t,r),this.info.state="track",this.info.started=!0)},touchend:function(e){var t=E.findOriginalTarget(e),r=e.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:r.clientX,y:r.clientY}),this.fire(t,r,e))},fire:function(e,t,r){var o,n=this.info.moves[this.info.moves.length-2],i=this.info.moves[this.info.moves.length-1],s=i.x-this.info.x,a=i.y-this.info.y,l=0;return n&&(o=i.x-n.x,l=i.y-n.y),E.fire(e,"track",{state:this.info.state,x:t.clientX,y:t.clientY,dx:s,dy:a,ddx:o,ddy:l,sourceEvent:t,preventer:r,hover:function(){return E.deepTargetFind(t.clientX,t.clientY)}})}}),E.register({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},save:function(e){this.info.x=e.clientX,this.info.y=e.clientY},mousedown:function(e){r(e)&&this.save(e)},click:function(e){r(e)&&this.forward(e)},touchstart:function(e){this.save(e.changedTouches[0],e)},touchend:function(e){this.forward(e.changedTouches[0],e)},forward:function(e,t){var r=Math.abs(e.clientX-this.info.x),n=Math.abs(e.clientY-this.info.y),i=E.findOriginalTarget(e);(isNaN(r)||isNaN(n)||r<=f&&n<=f||o(e))&&(this.info.prevent||E.fire(i,"tap",{x:e.clientX,y:e.clientY,sourceEvent:e,preventer:t}))}});var T={x:"pan-x",y:"pan-y",none:"none",all:"auto"};Polymer.Base._addFeature({_setupGestures:function(){this.__polymerGestures=null},_listen:function(e,t,r){E.gestures[t]?E.add(e,t,r):e.addEventListener(t,r)},_unlisten:function(e,t,r){E.gestures[t]?E.remove(e,t,r):e.removeEventListener(t,r)},setScrollDirection:function(e,t){t=t||this,E.setTouchAction(t,T[e]||"auto")}}),Polymer.Gestures=E}(),function(){"use strict";if(Polymer.Base._addFeature({$$:function(e){return Polymer.dom(this.root).querySelector(e)},toggleClass:function(e,t,r){r=r||this,1==arguments.length&&(t=!r.classList.contains(e)),t?Polymer.dom(r).classList.add(e):Polymer.dom(r).classList.remove(e)},toggleAttribute:function(e,t,r){r=r||this,1==arguments.length&&(t=!r.hasAttribute(e)),t?Polymer.dom(r).setAttribute(e,""):Polymer.dom(r).removeAttribute(e)},classFollows:function(e,t,r){r&&Polymer.dom(r).classList.remove(e),t&&Polymer.dom(t).classList.add(e)},attributeFollows:function(e,t,r){r&&Polymer.dom(r).removeAttribute(e),t&&Polymer.dom(t).setAttribute(e,"")},getEffectiveChildNodes:function(){return Polymer.dom(this).getEffectiveChildNodes()},getEffectiveChildren:function(){var e=Polymer.dom(this).getEffectiveChildNodes();return e.filter(function(e){return e.nodeType===Node.ELEMENT_NODE})},getEffectiveTextContent:function(){for(var e,t=this.getEffectiveChildNodes(),r=[],o=0;e=t[o];o++)e.nodeType!==Node.COMMENT_NODE&&r.push(Polymer.dom(e).textContent);return r.join("")},queryEffectiveChildren:function(e){var t=Polymer.dom(this).queryDistributedElements(e);return t&&t[0]},queryAllEffectiveChildren:function(e){return Polymer.dom(this).queryDistributedElements(e)},getContentChildNodes:function(e){var t=Polymer.dom(this.root).querySelector(e||"content");return t?Polymer.dom(t).getDistributedNodes():[]},getContentChildren:function(e){return this.getContentChildNodes(e).filter(function(e){return e.nodeType===Node.ELEMENT_NODE})},fire:function(e,t,r){r=r||Polymer.nob;var o=r.node||this;t=null===t||void 0===t?{}:t;var n=void 0===r.bubbles||r.bubbles,i=Boolean(r.cancelable),s=r._useCache,a=this._getEvent(e,n,i,s);return a.detail=t,s&&(this.__eventCache[e]=null),o.dispatchEvent(a),s&&(this.__eventCache[e]=a),a},__eventCache:{},_getEvent:function(e,t,r,o){var n=o&&this.__eventCache[e];return n&&n.bubbles==t&&n.cancelable==r||(n=new Event(e,{bubbles:Boolean(t),cancelable:r})),n},async:function(e,t){var r=this;return Polymer.Async.run(function(){e.call(r)},t)},cancelAsync:function(e){Polymer.Async.cancel(e)},arrayDelete:function(e,t){var r;if(Array.isArray(e)){if(r=e.indexOf(t),r>=0)return e.splice(r,1)}else{var o=this._get(e);if(r=o.indexOf(t),r>=0)return this.splice(e,r,1)}},transform:function(e,t){t=t||this,t.style.webkitTransform=e,t.style.transform=e},translate3d:function(e,t,r,o){o=o||this,this.transform("translate3d("+e+","+t+","+r+")",o)},importHref:function(e,t,r,o){var n=document.createElement("link");n.rel="import",n.href=e;var i=Polymer.Base.importHref.imported=Polymer.Base.importHref.imported||{},s=i[n.href],a=s||n,l=this;if(t){var c=function(e){return e.target.__firedLoad=!0,e.target.removeEventListener("load",c),t.call(l,e)};a.addEventListener("load",c)}if(r){var u=function(e){return e.target.__firedError=!0,e.target.removeEventListener("error",u),r.call(l,e)};a.addEventListener("error",u)}return s?(s.__firedLoad&&s.dispatchEvent(new Event("load")),s.__firedError&&s.dispatchEvent(new Event("error"))):(i[n.href]=n,o=Boolean(o),o&&n.setAttribute("async",""),document.head.appendChild(n)),a},create:function(e,t){var r=document.createElement(e);if(t)for(var o in t)r[o]=t[o];return r},isLightDescendant:function(e){return this!==e&&this.contains(e)&&Polymer.dom(this).getOwnerRoot()===Polymer.dom(e).getOwnerRoot()},isLocalDescendant:function(e){return this.root===Polymer.dom(e).getOwnerRoot()}}),!Polymer.Settings.useNativeCustomElements){var e=Polymer.Base.importHref;Polymer.Base.importHref=function(t,r,o,n){CustomElements.ready=!1;var i=function(e){if(CustomElements.upgradeDocumentTree(document),CustomElements.ready=!0,r)return r.call(this,e)};return e.call(this,t,i,o,n)}}}(),Polymer.Bind={prepareModel:function(e){Polymer.Base.mixin(e,this._modelApi)},_modelApi:{_notifyChange:function(e,t,r){r=void 0===r?this[e]:r,t=t||Polymer.CaseMap.camelToDashCase(e)+"-changed",this.fire(t,{value:r},{bubbles:!1,cancelable:!1,_useCache:!0})},_propertySetter:function(e,t,r,o){var n=this.__data__[e];return n===t||n!==n&&t!==t||(this.__data__[e]=t,"object"==typeof t&&this._clearPath(e),this._propertyChanged&&this._propertyChanged(e,t,n),r&&this._effectEffects(e,t,r,n,o)),n},__setProperty:function(e,t,r,o){o=o||this;var n=o._propertyEffects&&o._propertyEffects[e];n?o._propertySetter(e,t,n,r):o[e]=t},_effectEffects:function(e,t,r,o,n){for(var i,s=0,a=r.length;s<a&&(i=r[s]);s++)i.fn.call(this,e,this[e],i.effect,o,n)},_clearPath:function(e){for(var t in this.__data__)0===t.indexOf(e+".")&&(this.__data__[t]=void 0)}},ensurePropertyEffects:function(e,t){e._propertyEffects||(e._propertyEffects={});var r=e._propertyEffects[t];return r||(r=e._propertyEffects[t]=[]),r},addPropertyEffect:function(e,t,r,o){var n=this.ensurePropertyEffects(e,t),i={kind:r,effect:o,fn:Polymer.Bind["_"+r+"Effect"]};return n.push(i),i},createBindings:function(e){var t=e._propertyEffects;if(t)for(var r in t){var o=t[r];o.sort(this._sortPropertyEffects),this._createAccessors(e,r,o)}},_sortPropertyEffects:function(){var e={compute:0,annotation:1,annotatedComputation:2,reflect:3,notify:4,observer:5,complexObserver:6,"function":7};return function(t,r){return e[t.kind]-e[r.kind]}}(),_createAccessors:function(e,t,r){var o={get:function(){return this.__data__[t]}},n=function(e){this._propertySetter(t,e,r)},i=e.getPropertyInfo&&e.getPropertyInfo(t);i&&i.readOnly?i.computed||(e["_set"+this.upper(t)]=n):o.set=n,Object.defineProperty(e,t,o)},upper:function(e){return e[0].toUpperCase()+e.substring(1)},_addAnnotatedListener:function(e,t,r,o,n,i){e._bindListeners||(e._bindListeners=[]);var s=this._notedListenerFactory(r,o,this._isStructured(o),i),a=n||Polymer.CaseMap.camelToDashCase(r)+"-changed";e._bindListeners.push({index:t,property:r,path:o,changedFn:s,event:a})},_isStructured:function(e){return e.indexOf(".")>0},_isEventBogus:function(e,t){return e.path&&e.path[0]!==t},_notedListenerFactory:function(e,t,r,o){return function(n,i,s){s?this._notifyPath(this._fixPath(t,e,s),i):(i=n[e],o&&(i=!i),r?this.__data__[t]!=i&&this.set(t,i):this[t]=i)}},prepareInstance:function(e){e.__data__=Object.create(null)},setupBindListeners:function(e){for(var t,r=e._bindListeners,o=0,n=r.length;o<n&&(t=r[o]);o++){var i=e._nodes[t.index];this._addNotifyListener(i,e,t.event,t.changedFn)}},_addNotifyListener:function(e,t,r,o){e.addEventListener(r,function(e){return t._notifyListener(o,e)})}},Polymer.Base.extend(Polymer.Bind,{_shouldAddListener:function(e){return e.name&&"attribute"!=e.kind&&"text"!=e.kind&&!e.isCompound&&"{"===e.parts[0].mode},_annotationEffect:function(e,t,r){e!=r.value&&(t=this._get(r.value),this.__data__[r.value]=t),this._applyEffectValue(r,t)},_reflectEffect:function(e,t,r){this.reflectPropertyToAttribute(e,r.attribute,t)},_notifyEffect:function(e,t,r,o,n){n||this._notifyChange(e,r.event,t)},_functionEffect:function(e,t,r,o,n){r.call(this,e,t,o,n)},_observerEffect:function(e,t,r,o){var n=this[r.method];n?n.call(this,t,o):this._warn(this._logf("_observerEffect","observer method `"+r.method+"` not defined"))},_complexObserverEffect:function(e,t,r){var o=this[r.method];if(o){var n=Polymer.Bind._marshalArgs(this.__data__,r,e,t);n&&o.apply(this,n)}else r.dynamicFn||this._warn(this._logf("_complexObserverEffect","observer method `"+r.method+"` not defined"))},_computeEffect:function(e,t,r){var o=this[r.method];if(o){var n=Polymer.Bind._marshalArgs(this.__data__,r,e,t);if(n){var i=o.apply(this,n);this.__setProperty(r.name,i)}}else r.dynamicFn||this._warn(this._logf("_computeEffect","compute method `"+r.method+"` not defined"))},_annotatedComputationEffect:function(e,t,r){var o=this._rootDataHost||this,n=o[r.method];if(n){var i=Polymer.Bind._marshalArgs(this.__data__,r,e,t);if(i){var s=n.apply(o,i);this._applyEffectValue(r,s)}}else r.dynamicFn||o._warn(o._logf("_annotatedComputationEffect","compute method `"+r.method+"` not defined"))},_marshalArgs:function(e,t,r,o){for(var n=[],i=t.args,s=i.length>1||t.dynamicFn,a=0,l=i.length;a<l;a++){var c,u=i[a],h=u.name;if(u.literal?c=u.value:r===h?c=o:(c=e[h],void 0===c&&u.structured&&(c=Polymer.Base._get(h,e))),s&&void 0===c)return;if(u.wildcard){var f=0===r.indexOf(h+".");n[a]={path:f?r:h,value:f?o:c,base:c}}else n[a]=c}return n}}),Polymer.Base._addFeature({_addPropertyEffect:function(e,t,r){var o=Polymer.Bind.addPropertyEffect(this,e,t,r);o.pathFn=this["_"+o.kind+"PathEffect"]},_prepEffects:function(){Polymer.Bind.prepareModel(this),this._addAnnotationEffects(this._notes)},_prepBindings:function(){Polymer.Bind.createBindings(this)},_addPropertyEffects:function(e){if(e)for(var t in e){var r=e[t];if(r.observer&&this._addObserverEffect(t,r.observer),r.computed&&(r.readOnly=!0,this._addComputedEffect(t,r.computed)),r.notify&&this._addPropertyEffect(t,"notify",{event:Polymer.CaseMap.camelToDashCase(t)+"-changed"}),r.reflectToAttribute){var o=Polymer.CaseMap.camelToDashCase(t);"-"===o[0]?this._warn(this._logf("_addPropertyEffects","Property "+t+" cannot be reflected to attribute "+o+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.')):this._addPropertyEffect(t,"reflect",{attribute:o})}r.readOnly&&Polymer.Bind.ensurePropertyEffects(this,t)}},_addComputedEffect:function(e,t){for(var r,o=this._parseMethod(t),n=o.dynamicFn,i=0;i<o.args.length&&(r=o.args[i]);i++)this._addPropertyEffect(r.model,"compute",{method:o.method,args:o.args,trigger:r,name:e,dynamicFn:n});n&&this._addPropertyEffect(o.method,"compute",{method:o.method,args:o.args,trigger:null,name:e,dynamicFn:n})},_addObserverEffect:function(e,t){this._addPropertyEffect(e,"observer",{method:t,property:e})},_addComplexObserverEffects:function(e){if(e)for(var t,r=0;r<e.length&&(t=e[r]);r++)this._addComplexObserverEffect(t)},_addComplexObserverEffect:function(e){var t=this._parseMethod(e);if(!t)throw new Error("Malformed observer expression '"+e+"'");for(var r,o=t.dynamicFn,n=0;n<t.args.length&&(r=t.args[n]);n++)this._addPropertyEffect(r.model,"complexObserver",{method:t.method,args:t.args,trigger:r,dynamicFn:o});o&&this._addPropertyEffect(t.method,"complexObserver",{method:t.method,args:t.args,trigger:null,dynamicFn:o})},_addAnnotationEffects:function(e){for(var t,r=0;r<e.length&&(t=e[r]);r++)for(var o,n=t.bindings,i=0;i<n.length&&(o=n[i]);i++)this._addAnnotationEffect(o,r)},_addAnnotationEffect:function(e,t){Polymer.Bind._shouldAddListener(e)&&Polymer.Bind._addAnnotatedListener(this,t,e.name,e.parts[0].value,e.parts[0].event,e.parts[0].negate);for(var r=0;r<e.parts.length;r++){var o=e.parts[r];o.signature?this._addAnnotatedComputationEffect(e,o,t):o.literal||("attribute"===e.kind&&"-"===e.name[0]?this._warn(this._logf("_addAnnotationEffect","Cannot set attribute "+e.name+' because "-" is not a valid attribute starting character')):this._addPropertyEffect(o.model,"annotation",{kind:e.kind,index:t,name:e.name,propertyName:e.propertyName,value:o.value,isCompound:e.isCompound,compoundIndex:o.compoundIndex,event:o.event,customEvent:o.customEvent,negate:o.negate}))}},_addAnnotatedComputationEffect:function(e,t,r){var o=t.signature;if(o["static"])this.__addAnnotatedComputationEffect("__static__",r,e,t,null);else{for(var n,i=0;i<o.args.length&&(n=o.args[i]);i++)n.literal||this.__addAnnotatedComputationEffect(n.model,r,e,t,n);o.dynamicFn&&this.__addAnnotatedComputationEffect(o.method,r,e,t,null)}},__addAnnotatedComputationEffect:function(e,t,r,o,n){this._addPropertyEffect(e,"annotatedComputation",{index:t,isCompound:r.isCompound,compoundIndex:o.compoundIndex,kind:r.kind,name:r.name,negate:o.negate,method:o.signature.method,args:o.signature.args,trigger:n,dynamicFn:o.signature.dynamicFn})},_parseMethod:function(e){var t=e.match(/([^\s]+?)\(([\s\S]*)\)/);if(t){var r={method:t[1],"static":!0};if(this.getPropertyInfo(r.method)!==Polymer.nob&&(r["static"]=!1,r.dynamicFn=!0),t[2].trim()){var o=t[2].replace(/\\,/g,"&comma;").split(",");return this._parseArgs(o,r)}return r.args=Polymer.nar,r}},_parseArgs:function(e,t){return t.args=e.map(function(e){var r=this._parseArg(e);return r.literal||(t["static"]=!1),r},this),t},_parseArg:function(e){var t=e.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1"),r={name:t},o=t[0];switch("-"===o&&(o=t[1]),o>="0"&&o<="9"&&(o="#"),o){case"'":case'"':r.value=t.slice(1,-1),r.literal=!0;break;case"#":r.value=Number(t),r.literal=!0}return r.literal||(r.model=this._modelForPath(t),r.structured=t.indexOf(".")>0,r.structured&&(r.wildcard=".*"==t.slice(-2),r.wildcard&&(r.name=t.slice(0,-2)))),r},_marshalInstanceEffects:function(){Polymer.Bind.prepareInstance(this),this._bindListeners&&Polymer.Bind.setupBindListeners(this)},_applyEffectValue:function(e,t){var r=this._nodes[e.index],o=e.name;if(t=this._computeFinalAnnotationValue(r,o,t,e),!e.customEvent||r[o]!==t)if("attribute"==e.kind)this.serializeValueToAttribute(t,o,r);else{var n=r._propertyInfo&&r._propertyInfo[o];if(n&&n.readOnly)return;this.__setProperty(o,t,!1,r)}},_computeFinalAnnotationValue:function(e,t,r,o){if(o.negate&&(r=!r),o.isCompound){var n=e.__compoundStorage__[t];n[o.compoundIndex]=r,r=n.join("")}return"attribute"!==o.kind&&("className"===t&&(r=this._scopeElementClass(e,r)),("textContent"===t||"input"==e.localName&&"value"==t)&&(r=void 0==r?"":r)),r},_executeStaticEffects:function(){this._propertyEffects&&this._propertyEffects.__static__&&this._effectEffects("__static__",null,this._propertyEffects.__static__)}}),function(){var e=Polymer.Settings.usePolyfillProto;Polymer.Base._addFeature({_setupConfigure:function(e){if(this._config={},this._handlers=[],this._aboveConfig=null,e)for(var t in e)void 0!==e[t]&&(this._config[t]=e[t])},_marshalAttributes:function(){this._takeAttributesToModel(this._config)},_attributeChangedImpl:function(e){var t=this._clientsReadied?this:this._config;this._setAttributeToProperty(t,e)},_configValue:function(e,t){var r=this._propertyInfo[e];r&&r.readOnly||(this._config[e]=t)},_beforeClientsReady:function(){this._configure()},_configure:function(){this._configureAnnotationReferences(),this._aboveConfig=this.mixin({},this._config);for(var e={},t=0;t<this.behaviors.length;t++)this._configureProperties(this.behaviors[t].properties,e);this._configureProperties(this.properties,e),this.mixin(e,this._aboveConfig),this._config=e,this._clients&&this._clients.length&&this._distributeConfig(this._config)},_configureProperties:function(t,r){for(var o in t){var n=t[o];if(!e&&this.hasOwnProperty(o)&&this._propertyEffects&&this._propertyEffects[o])r[o]=this[o],delete this[o];else if(void 0!==n.value){var i=n.value;"function"==typeof i&&(i=i.call(this,this._config)),r[o]=i}}},_distributeConfig:function(e){var t=this._propertyEffects;if(t)for(var r in e){var o=t[r];if(o)for(var n,i=0,s=o.length;i<s&&(n=o[i]);i++)if("annotation"===n.kind){var a=this._nodes[n.effect.index],l=n.effect.propertyName,c="attribute"==n.effect.kind,u=a._propertyEffects&&a._propertyEffects[l];if(a._configValue&&(u||!c)){var h=r===n.effect.value?e[r]:this._get(n.effect.value,e);h=this._computeFinalAnnotationValue(a,l,h,n.effect),c&&(h=a.deserialize(this.serialize(h),a._propertyInfo[l].type)),a._configValue(l,h)}}}},_afterClientsReady:function(){this._executeStaticEffects(),this._applyConfig(this._config,this._aboveConfig),this._flushHandlers()},_applyConfig:function(e,t){for(var r in e)void 0===this[r]&&this.__setProperty(r,e[r],r in t)},_notifyListener:function(e,t){if(!Polymer.Bind._isEventBogus(t,t.target)){var r,o;if(t.detail&&(r=t.detail.value,o=t.detail.path),this._clientsReadied)return e.call(this,t.target,r,o);this._queueHandler([e,t.target,r,o])}},_queueHandler:function(e){this._handlers.push(e)},_flushHandlers:function(){for(var e,t=this._handlers,r=0,o=t.length;r<o&&(e=t[r]);r++)e[0].call(this,e[1],e[2],e[3]);this._handlers=[]}})}(),function(){"use strict";Polymer.Base._addFeature({notifyPath:function(e,t,r){var o={},n=this._get(e,this,o);1===arguments.length&&(t=n),o.path&&this._notifyPath(o.path,t,r)},_notifyPath:function(e,t,r){var o=this._propertySetter(e,t);if(o!==t&&(o===o||t===t))return this._pathEffector(e,t),r||this._notifyPathUp(e,t),!0},_getPathParts:function(e){if(Array.isArray(e)){for(var t=[],r=0;r<e.length;r++)for(var o=e[r].toString().split("."),n=0;n<o.length;n++)t.push(o[n]);return t}return e.toString().split(".")},set:function(e,t,r){var o,n=r||this,i=this._getPathParts(e),s=i[i.length-1];if(i.length>1){for(var a=0;a<i.length-1;a++){var l=i[a];if(o&&"#"==l[0]?n=Polymer.Collection.get(o).getItem(l):(n=n[l],o&&parseInt(l,10)==l&&(i[a]=Polymer.Collection.get(o).getKey(n))),!n)return;o=Array.isArray(n)?n:null}if(o){var c,u,h=Polymer.Collection.get(o);"#"==s[0]?(u=s,c=h.getItem(u),s=o.indexOf(c),h.setItem(u,t)):parseInt(s,10)==s&&(c=n[s],u=h.getKey(c),i[a]=u,h.setItem(u,t))}n[s]=t,r||this._notifyPath(i.join("."),t)}else n[e]=t},get:function(e,t){return this._get(e,t)},_get:function(e,t,r){for(var o,n=t||this,i=this._getPathParts(e),s=0;s<i.length;s++){if(!n)return;var a=i[s];o&&"#"==a[0]?n=Polymer.Collection.get(o).getItem(a):(n=n[a],r&&o&&parseInt(a,10)==a&&(i[s]=Polymer.Collection.get(o).getKey(n))),o=Array.isArray(n)?n:null}return r&&(r.path=i.join(".")),n},_pathEffector:function(e,t){var r=this._modelForPath(e),o=this._propertyEffects&&this._propertyEffects[r];if(o)for(var n,i=0;i<o.length&&(n=o[i]);i++){var s=n.pathFn;s&&s.call(this,e,t,n.effect)}this._boundPaths&&this._notifyBoundPaths(e,t)},_annotationPathEffect:function(e,t,r){if(r.value===e||0===r.value.indexOf(e+"."))Polymer.Bind._annotationEffect.call(this,e,t,r);else if(0===e.indexOf(r.value+".")&&!r.negate){var o=this._nodes[r.index];if(o&&o._notifyPath){var n=this._fixPath(r.name,r.value,e);o._notifyPath(n,t,!0)}}},_complexObserverPathEffect:function(e,t,r){this._pathMatchesEffect(e,r)&&Polymer.Bind._complexObserverEffect.call(this,e,t,r)},_computePathEffect:function(e,t,r){this._pathMatchesEffect(e,r)&&Polymer.Bind._computeEffect.call(this,e,t,r)},_annotatedComputationPathEffect:function(e,t,r){this._pathMatchesEffect(e,r)&&Polymer.Bind._annotatedComputationEffect.call(this,e,t,r)},_pathMatchesEffect:function(e,t){var r=t.trigger.name;return r==e||0===r.indexOf(e+".")||t.trigger.wildcard&&0===e.indexOf(r+".")},linkPaths:function(e,t){this._boundPaths=this._boundPaths||{},t?this._boundPaths[e]=t:this.unlinkPaths(e)},unlinkPaths:function(e){this._boundPaths&&delete this._boundPaths[e]},_notifyBoundPaths:function(e,t){for(var r in this._boundPaths){var o=this._boundPaths[r];0==e.indexOf(r+".")?this._notifyPath(this._fixPath(o,r,e),t):0==e.indexOf(o+".")&&this._notifyPath(this._fixPath(r,o,e),t)}},_fixPath:function(e,t,r){return e+r.slice(t.length)},_notifyPathUp:function(e,t){var r=this._modelForPath(e),o=Polymer.CaseMap.camelToDashCase(r),n=o+this._EVENT_CHANGED;this.fire(n,{path:e,value:t},{bubbles:!1,_useCache:!0})},_modelForPath:function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)},_EVENT_CHANGED:"-changed",notifySplices:function(e,t){var r={},o=this._get(e,this,r);this._notifySplices(o,r.path,t)},_notifySplices:function(e,t,r){var o={keySplices:Polymer.Collection.applySplices(e,r),indexSplices:r},n=t+".splices";this._notifyPath(n,o),this._notifyPath(t+".length",e.length),this.__data__[n]={keySplices:null,indexSplices:null}},_notifySplice:function(e,t,r,o,n){this._notifySplices(e,t,[{index:r,addedCount:o,removed:n,object:e,type:"splice"}])},push:function(e){var t={},r=this._get(e,this,t),o=Array.prototype.slice.call(arguments,1),n=r.length,i=r.push.apply(r,o);return o.length&&this._notifySplice(r,t.path,n,o.length,[]),i},pop:function(e){var t={},r=this._get(e,this,t),o=Boolean(r.length),n=Array.prototype.slice.call(arguments,1),i=r.pop.apply(r,n);return o&&this._notifySplice(r,t.path,r.length,0,[i]),i},splice:function(e,t){var r={},o=this._get(e,this,r);t=t<0?o.length-Math.floor(-t):Math.floor(t),t||(t=0);var n=Array.prototype.slice.call(arguments,1),i=o.splice.apply(o,n),s=Math.max(n.length-2,0);return(s||i.length)&&this._notifySplice(o,r.path,t,s,i),i},shift:function(e){var t={},r=this._get(e,this,t),o=Boolean(r.length),n=Array.prototype.slice.call(arguments,1),i=r.shift.apply(r,n);return o&&this._notifySplice(r,t.path,0,0,[i]),i},unshift:function(e){var t={},r=this._get(e,this,t),o=Array.prototype.slice.call(arguments,1),n=r.unshift.apply(r,o);return o.length&&this._notifySplice(r,t.path,0,o.length,[]),n},prepareModelNotifyPath:function(e){this.mixin(e,{fire:Polymer.Base.fire,_getEvent:Polymer.Base._getEvent,__eventCache:Polymer.Base.__eventCache,notifyPath:Polymer.Base.notifyPath,_get:Polymer.Base._get,_EVENT_CHANGED:Polymer.Base._EVENT_CHANGED,_notifyPath:Polymer.Base._notifyPath,_notifyPathUp:Polymer.Base._notifyPathUp,_pathEffector:Polymer.Base._pathEffector,_annotationPathEffect:Polymer.Base._annotationPathEffect,_complexObserverPathEffect:Polymer.Base._complexObserverPathEffect,_annotatedComputationPathEffect:Polymer.Base._annotatedComputationPathEffect,_computePathEffect:Polymer.Base._computePathEffect,_modelForPath:Polymer.Base._modelForPath,_pathMatchesEffect:Polymer.Base._pathMatchesEffect,_notifyBoundPaths:Polymer.Base._notifyBoundPaths,_getPathParts:Polymer.Base._getPathParts})}})}(),Polymer.Base._addFeature({resolveUrl:function(e){var t=Polymer.DomModule["import"](this.is),r="";if(t){var o=t.getAttribute("assetpath")||"";r=Polymer.ResolveUrl.resolveUrl(o,t.ownerDocument.baseURI)}return Polymer.ResolveUrl.resolveUrl(e,r)}}),Polymer.CssParse=function(){return{parse:function(e){return e=this._clean(e),this._parseCss(this._lex(e),e)},_clean:function(e){return e.replace(this._rx.comments,"").replace(this._rx.port,"")},_lex:function(e){for(var t={start:0,end:e.length},r=t,o=0,n=e.length;o<n;o++)switch(e[o]){case this.OPEN_BRACE:r.rules||(r.rules=[]);var i=r,s=i.rules[i.rules.length-1];r={start:o+1,parent:i,previous:s},i.rules.push(r);break;case this.CLOSE_BRACE:r.end=o+1,r=r.parent||t}return t},_parseCss:function(e,t){var r=t.substring(e.start,e.end-1);if(e.parsedCssText=e.cssText=r.trim(),e.parent){var o=e.previous?e.previous.end:e.parent.start;r=t.substring(o,e.start-1),r=this._expandUnicodeEscapes(r),r=r.replace(this._rx.multipleSpaces," "),r=r.substring(r.lastIndexOf(";")+1);var n=e.parsedSelector=e.selector=r.trim();e.atRule=0===n.indexOf(this.AT_START),e.atRule?0===n.indexOf(this.MEDIA_START)?e.type=this.types.MEDIA_RULE:n.match(this._rx.keyframesRule)&&(e.type=this.types.KEYFRAMES_RULE,e.keyframesName=e.selector.split(this._rx.multipleSpaces).pop()):0===n.indexOf(this.VAR_START)?e.type=this.types.MIXIN_RULE:e.type=this.types.STYLE_RULE}var i=e.rules;if(i)for(var s,a=0,l=i.length;a<l&&(s=i[a]);a++)this._parseCss(s,t);return e},_expandUnicodeEscapes:function(e){return e.replace(/\\([0-9a-f]{1,6})\s/gi,function(){for(var e=arguments[1],t=6-e.length;t--;)e="0"+e;return"\\"+e})},stringify:function(e,t,r){r=r||"";var o="";if(e.cssText||e.rules){var n=e.rules;if(n&&!this._hasMixinRules(n))for(var i,s=0,a=n.length;s<a&&(i=n[s]);s++)o=this.stringify(i,t,o);else o=t?e.cssText:this.removeCustomProps(e.cssText),o=o.trim(),o&&(o="  "+o+"\n")}return o&&(e.selector&&(r+=e.selector+" "+this.OPEN_BRACE+"\n"),r+=o,e.selector&&(r+=this.CLOSE_BRACE+"\n\n")),r},_hasMixinRules:function(e){return 0===e[0].selector.indexOf(this.VAR_START)},removeCustomProps:function(e){return e=this.removeCustomPropAssignment(e),this.removeCustomPropApply(e)},removeCustomPropAssignment:function(e){return e.replace(this._rx.customProp,"").replace(this._rx.mixinProp,"")},removeCustomPropApply:function(e){return e.replace(this._rx.mixinApply,"").replace(this._rx.varApply,"")},types:{STYLE_RULE:1,KEYFRAMES_RULE:7,MEDIA_RULE:4,MIXIN_RULE:1e3},OPEN_BRACE:"{",CLOSE_BRACE:"}",_rx:{comments:/\/\*[^*]*\*+([^\/*][^*]*\*+)*\//gim,port:/@import[^;]*;/gim,customProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,mixinProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,mixinApply:/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,varApply:/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,keyframesRule:/^@[^\s]*keyframes/,multipleSpaces:/\s+/g},VAR_START:"--",MEDIA_START:"@media",AT_START:"@"}}(),Polymer.StyleUtil=function(){var e=Polymer.Settings;return{NATIVE_VARIABLES:Polymer.Settings.useNativeCSSProperties,MODULE_STYLES_SELECTOR:"style, link[rel=import][type~=css], template",INCLUDE_ATTR:"include",toCssText:function(e,t){return"string"==typeof e&&(e=this.parser.parse(e)),t&&this.forEachRule(e,t),this.parser.stringify(e,this.NATIVE_VARIABLES)},forRulesInStyles:function(e,t,r){if(e)for(var o,n=0,i=e.length;n<i&&(o=e[n]);n++)this.forEachRuleInStyle(o,t,r)},forActiveRulesInStyles:function(e,t,r){if(e)for(var o,n=0,i=e.length;n<i&&(o=e[n]);n++)this.forEachRuleInStyle(o,t,r,!0)},rulesForStyle:function(e){return!e.__cssRules&&e.textContent&&(e.__cssRules=this.parser.parse(e.textContent)),e.__cssRules},isKeyframesSelector:function(e){return e.parent&&e.parent.type===this.ruleTypes.KEYFRAMES_RULE},forEachRuleInStyle:function(e,t,r,o){var n,i,s=this.rulesForStyle(e);t&&(n=function(r){t(r,e)}),r&&(i=function(t){r(t,e)}),this.forEachRule(s,n,i,o)},forEachRule:function(e,t,r,o){if(e){var n=!1;if(o&&e.type===this.ruleTypes.MEDIA_RULE){var i=e.selector.match(this.rx.MEDIA_MATCH);i&&(window.matchMedia(i[1]).matches||(n=!0))}e.type===this.ruleTypes.STYLE_RULE?t(e):r&&e.type===this.ruleTypes.KEYFRAMES_RULE?r(e):e.type===this.ruleTypes.MIXIN_RULE&&(n=!0);var s=e.rules;if(s&&!n)for(var a,l=0,c=s.length;l<c&&(a=s[l]);l++)this.forEachRule(a,t,r,o)}},applyCss:function(e,t,r,o){var n=this.createScopeStyle(e,t);return this.applyStyle(n,r,o)},applyStyle:function(e,t,r){t=t||document.head;var o=r&&r.nextSibling||t.firstChild;return this.__lastHeadApplyNode=e,t.insertBefore(e,o)},createScopeStyle:function(e,t){var r=document.createElement("style");return t&&r.setAttribute("scope",t),r.textContent=e,r},__lastHeadApplyNode:null,applyStylePlaceHolder:function(e){var t=document.createComment(" Shady DOM styles for "+e+" "),r=this.__lastHeadApplyNode?this.__lastHeadApplyNode.nextSibling:null,o=document.head;return o.insertBefore(t,r||o.firstChild),this.__lastHeadApplyNode=t,t},cssFromModules:function(e,t){for(var r=e.trim().split(" "),o="",n=0;n<r.length;n++)o+=this.cssFromModule(r[n],t);return o},cssFromModule:function(e,t){var r=Polymer.DomModule["import"](e);return r&&!r._cssText&&(r._cssText=this.cssFromElement(r)),!r&&t&&console.warn("Could not find style data in module named",e),r&&r._cssText||""},cssFromElement:function(e){for(var t,r="",o=e.content||e,n=Polymer.TreeApi.arrayCopy(o.querySelectorAll(this.MODULE_STYLES_SELECTOR)),i=0;i<n.length;i++)if(t=n[i],"template"===t.localName)r+=this.cssFromElement(t);else if("style"===t.localName){var s=t.getAttribute(this.INCLUDE_ATTR);s&&(r+=this.cssFromModules(s,!0)),t=t.__appliedElement||t,t.parentNode.removeChild(t),r+=this.resolveCss(t.textContent,e.ownerDocument)}else t["import"]&&t["import"].body&&(r+=this.resolveCss(t["import"].body.textContent,t["import"]));return r},isTargetedBuild:function(t){return e.useNativeShadow?"shadow"===t:"shady"===t;
},cssBuildTypeForModule:function(e){var t=Polymer.DomModule["import"](e);if(t)return this.getCssBuildType(t)},getCssBuildType:function(e){return e.getAttribute("css-build")},rx:{VAR_ASSIGN:/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:([^;{]*)|{([^}]*)})(?:(?=[;\s}])|$)/gi,MIXIN_MATCH:/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,VAR_MATCH:/(^|\W+)var\([\s]*([^,)]*)[\s]*,?[\s]*((?:[^,()]*)|(?:[^;()]*\([^;)]*\)+))[\s]*?\)/gi,VAR_CONSUMED:/(--[\w-]+)\s*([:,;)]|$)/gi,ANIMATION_MATCH:/(animation\s*:)|(animation-name\s*:)/,MEDIA_MATCH:/@media[^(]*(\([^)]*\))/,IS_VAR:/^--/,BRACKETED:/\{[^}]*\}/g,HOST_PREFIX:"(?:^|[^.#[:])",HOST_SUFFIX:"($|[.:[\\s>+~])"},resolveCss:Polymer.ResolveUrl.resolveCss,parser:Polymer.CssParse,ruleTypes:Polymer.CssParse.types}}(),Polymer.StyleTransformer=function(){var e=Polymer.StyleUtil,t=Polymer.Settings,r={dom:function(e,t,r,o){this._transformDom(e,t||"",r,o)},_transformDom:function(e,t,r,o){e.setAttribute&&this.element(e,t,r,o);for(var n=Polymer.dom(e).childNodes,i=0;i<n.length;i++)this._transformDom(n[i],t,r,o)},element:function(e,t,r,n){if(r)n?e.removeAttribute(o):e.setAttribute(o,t);else if(t)if(e.classList)n?(e.classList.remove(o),e.classList.remove(t)):(e.classList.add(o),e.classList.add(t));else if(e.getAttribute){var i=e.getAttribute(v);n?i&&e.setAttribute(v,i.replace(o,"").replace(t,"")):e.setAttribute(v,(i?i+" ":"")+o+" "+t)}},elementStyles:function(r,o){for(var n,i=r._styles,s="",a=r.__cssBuild,l=0,c=i.length;l<c&&(n=i[l]);l++){var u=e.rulesForStyle(n);s+=t.useNativeShadow||"shady"===a?e.toCssText(u,o):this.css(u,r.is,r["extends"],o,r._scopeCssViaAttr)+"\n\n"}return s.trim()},css:function(t,r,o,n,i){var s=this._calcHostScope(r,o);r=this._calcElementScope(r,i);var a=this;return e.toCssText(t,function(e){e.isScoped||(a.rule(e,r,s),e.isScoped=!0),n&&n(e,r,s)})},_calcElementScope:function(e,t){return e?t?_+e+m:g+e:""},_calcHostScope:function(e,t){return t?"[is="+e+"]":e},rule:function(e,t,r){this._transformRule(e,this._transformComplexSelector,t,r)},_transformRule:function(e,t,r,o){e.selector=e.transformedSelector=this._transformRuleCss(e,t,r,o)},_transformRuleCss:function(t,r,o,n){var s=t.selector.split(i);if(!e.isKeyframesSelector(t))for(var a,l=0,c=s.length;l<c&&(a=s[l]);l++)s[l]=r.call(this,a,o,n);return s.join(i)},_transformComplexSelector:function(e,t,r){var o=!1,n=!1,a=this;return e=e.trim(),e=e.replace(b,l+" $1"),e=e.replace(s,function(e,i,s){if(o)s=s.replace(d," ");else{var l=a._transformCompoundSelector(s,i,t,r);o=o||l.stop,n=n||l.hostContext,i=l.combinator,s=l.value}return i+s}),n&&(e=e.replace(f,function(e,t,o,n){return t+o+" "+r+n+i+" "+t+r+o+n})),e},_transformCompoundSelector:function(e,t,r,o){var n=e.search(d),i=!1;e.indexOf(h)>=0?i=!0:e.indexOf(l)>=0?e=this._transformHostSelector(e,o):0!==n&&(e=r?this._transformSimpleSelector(e,r):e),e.indexOf(p)>=0&&(t="");var s;return n>=0&&(e=e.replace(d," "),s=!0),{value:e,combinator:t,stop:s,hostContext:i}},_transformSimpleSelector:function(e,t){var r=e.split(y);return r[0]+=t,r.join(y)},_transformHostSelector:function(e,t){var r=e.match(u),o=r&&r[2].trim()||"";if(o){if(o[0].match(a))return e.replace(u,function(e,r,o){return t+o});var n=o.split(a)[0];return n===t?o:S}return e.replace(l,t)},documentRule:function(e){e.selector=e.parsedSelector,this.normalizeRootSelector(e),t.useNativeShadow||this._transformRule(e,this._transformDocumentSelector)},normalizeRootSelector:function(e){e.selector===c&&(e.selector="html")},_transformDocumentSelector:function(e){return e.match(d)?this._transformComplexSelector(e,n):this._transformSimpleSelector(e.trim(),n)},SCOPE_NAME:"style-scope"},o=r.SCOPE_NAME,n=":not(["+o+"]):not(."+o+")",i=",",s=/(^|[\s>+~]+)((?:\[.+?\]|[^\s>+~=\[])+)/g,a=/[[.:#*]/,l=":host",c=":root",u=/(:host)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,h=":host-context",f=/(.*)(?::host-context)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))(.*)/,p="::content",d=/::content|::shadow|\/deep\//,g=".",_="["+o+"~=",m="]",y=":",v="class",b=new RegExp("^("+p+")"),S="should_not_match";return r}(),Polymer.StyleExtends=function(){var e=Polymer.StyleUtil;return{hasExtends:function(e){return Boolean(e.match(this.rx.EXTEND))},transform:function(t){var r=e.rulesForStyle(t),o=this;return e.forEachRule(r,function(e){if(o._mapRuleOntoParent(e),e.parent)for(var t;t=o.rx.EXTEND.exec(e.cssText);){var r=t[1],n=o._findExtendor(r,e);n&&o._extendRule(e,n)}e.cssText=e.cssText.replace(o.rx.EXTEND,"")}),e.toCssText(r,function(e){e.selector.match(o.rx.STRIP)&&(e.cssText="")},!0)},_mapRuleOntoParent:function(e){if(e.parent){for(var t,r=e.parent.map||(e.parent.map={}),o=e.selector.split(","),n=0;n<o.length;n++)t=o[n],r[t.trim()]=e;return r}},_findExtendor:function(e,t){return t.parent&&t.parent.map&&t.parent.map[e]||this._findExtendor(e,t.parent)},_extendRule:function(e,t){e.parent!==t.parent&&this._cloneAndAddRuleToParent(t,e.parent),e["extends"]=e["extends"]||[],e["extends"].push(t),t.selector=t.selector.replace(this.rx.STRIP,""),t.selector=(t.selector&&t.selector+",\n")+e.selector,t["extends"]&&t["extends"].forEach(function(t){this._extendRule(e,t)},this)},_cloneAndAddRuleToParent:function(e,t){e=Object.create(e),e.parent=t,e["extends"]&&(e["extends"]=e["extends"].slice()),t.rules.push(e)},rx:{EXTEND:/@extends\(([^)]*)\)\s*?;/gim,STRIP:/%[^,]*$/}}}(),Polymer.ApplyShim=function(){"use strict";function e(e,t){e=e.trim(),p[e]=t}function t(e){return e=e.trim(),p[e]}function r(e){for(var t,r,o=e.split(";"),n={},i=0;i<o.length;i++)t=o[i],t&&(r=t.split(":"),r.length>1&&(n[r[0].trim()]=r.slice(1).join(":")));return n}function o(o,n,i,a){if(i){u.lastIndex=0;var l=u.exec(i);if(l){var c=l[2];t(c)&&(a="@apply "+c+";")}}if(!a)return o;var h=s(a),p=o.slice(0,o.indexOf("--")),d=r(h),g=t(n),_=d;g?_=Polymer.Base.mixin(g,d):e(n,_);var m,y,v=[];for(m in _)y=d[m],void 0===y&&(y="initial"),v.push(n+f+m+": "+y);return p+v.join("; ")+";"}function n(e,t,r,o){return o&&0===o.indexOf("--")?[t,"var(",r,", var(",o,"));"].join(""):e}function i(e,r){e=e.replace(h,"");var o=[],n=t(e);if(n){var i,s,a;for(i in n)a=r&&r[i],s=[i,": var(",e,f,i],a&&s.push(",",a),s.push(")"),o.push(s.join(""))}return o.join("; ")}function s(e){for(var t;t=l.exec(e);){var o=t[0],n=t[1],s=t.index,a=s+o.indexOf("@apply"),c=s+o.length,u=e.slice(0,a),h=e.slice(c),f=r(u),p=i(n,f);e=[u,p,h].join(""),l.lastIndex=s+p.length}return e}var a=Polymer.StyleUtil,l=a.rx.MIXIN_MATCH,c=a.rx.VAR_ASSIGN,u=a.rx.VAR_MATCH,h=/;\s*/m,f="_-_",p={},d={_map:p,_separator:f,transform:function(e){a.forRulesInStyles(e,this._boundTransformRule)},transformRule:function(e){e.cssText=this.transformCssText(e.parsedCssText),":root"===e.selector&&(e.selector=":host > *")},transformCssText:function(e){return e=e.replace(u,n),e=e.replace(c,o),s(e)}};return d._boundTransformRule=d.transformRule.bind(d),d}(),function(){var e=Polymer.Base._prepElement,t=Polymer.Settings.useNativeShadow,r=Polymer.StyleUtil,o=Polymer.StyleTransformer,n=Polymer.StyleExtends,i=Polymer.ApplyShim,s=Polymer.Settings;Polymer.Base._addFeature({_prepElement:function(t){this._encapsulateStyle&&"shady"!==this.__cssBuild&&o.element(t,this.is,this._scopeCssViaAttr),e.call(this,t)},_prepStyles:function(){void 0===this._encapsulateStyle&&(this._encapsulateStyle=!t),t||(this._scopeStyle=r.applyStylePlaceHolder(this.is)),this.__cssBuild=r.cssBuildTypeForModule(this.is)},_prepShimStyles:function(){if(this._template){var e=r.isTargetedBuild(this.__cssBuild);if(s.useNativeCSSProperties&&"shadow"===this.__cssBuild&&e)return;this._styles=this._styles||this._collectStyles(),s.useNativeCSSProperties&&!this.__cssBuild&&i.transform(this._styles);var n=s.useNativeCSSProperties&&e?this._styles.length&&this._styles[0].textContent.trim():o.elementStyles(this);this._prepStyleProperties(),!this._needsStyleProperties()&&n&&r.applyCss(n,this.is,t?this._template.content:null,this._scopeStyle)}else this._styles=[]},_collectStyles:function(){var e=[],t="",o=this.styleModules;if(o)for(var i,s=0,a=o.length;s<a&&(i=o[s]);s++)t+=r.cssFromModule(i);t+=r.cssFromModule(this.is);var l=this._template&&this._template.parentNode;if(!this._template||l&&l.id.toLowerCase()===this.is||(t+=r.cssFromElement(this._template)),t){var c=document.createElement("style");c.textContent=t,n.hasExtends(c.textContent)&&(t=n.transform(c)),e.push(c)}return e},_elementAdd:function(e){this._encapsulateStyle&&(e.__styleScoped?e.__styleScoped=!1:o.dom(e,this.is,this._scopeCssViaAttr))},_elementRemove:function(e){this._encapsulateStyle&&o.dom(e,this.is,this._scopeCssViaAttr,!0)},scopeSubtree:function(e,r){if(!t){var o=this,n=function(e){if(e.nodeType===Node.ELEMENT_NODE){var t=e.getAttribute("class");e.setAttribute("class",o._scopeElementClass(e,t));for(var r,n=e.querySelectorAll("*"),i=0;i<n.length&&(r=n[i]);i++)t=r.getAttribute("class"),r.setAttribute("class",o._scopeElementClass(r,t))}};if(n(e),r){var i=new MutationObserver(function(e){for(var t,r=0;r<e.length&&(t=e[r]);r++)if(t.addedNodes)for(var o=0;o<t.addedNodes.length;o++)n(t.addedNodes[o])});return i.observe(e,{childList:!0,subtree:!0}),i}}}})}(),Polymer.StyleProperties=function(){"use strict";function e(e,t){var r=parseInt(e/32),o=1<<e%32;t[r]=(t[r]||0)|o}var t=Polymer.DomApi.matchesSelector,r=Polymer.StyleUtil,o=Polymer.StyleTransformer,n=Polymer.Settings;return{decorateStyles:function(e,t){var n=this,i={},s=[],a=0,l=o._calcHostScope(t.is,t["extends"]);r.forRulesInStyles(e,function(e,o){n.decorateRule(e),e.index=a++,n.whenHostOrRootRule(t,e,o,function(o){if(e.parent.type===r.ruleTypes.MEDIA_RULE&&(t.__notStyleScopeCacheable=!0),o.isHost){var n=o.selector.split(" ").some(function(e){return 0===e.indexOf(l)&&e.length!==l.length});t.__notStyleScopeCacheable=t.__notStyleScopeCacheable||n}}),n.collectPropertiesInCssText(e.propertyInfo.cssText,i)},function(e){s.push(e)}),e._keyframes=s;var c=[];for(var u in i)c.push(u);return c},decorateRule:function(e){if(e.propertyInfo)return e.propertyInfo;var t={},r={},o=this.collectProperties(e,r);return o&&(t.properties=r,e.rules=null),t.cssText=this.collectCssText(e),e.propertyInfo=t,t},collectProperties:function(e,t){var r=e.propertyInfo;if(!r){for(var o,n,i=this.rx.VAR_ASSIGN,s=e.parsedCssText;o=i.exec(s);)t[o[1].trim()]=(o[2]||o[3]).trim(),n=!0;return n}if(r.properties)return Polymer.Base.mixin(t,r.properties),!0},collectCssText:function(e){return this.collectConsumingCssText(e.parsedCssText)},collectConsumingCssText:function(e){return e.replace(this.rx.BRACKETED,"").replace(this.rx.VAR_ASSIGN,"")},collectPropertiesInCssText:function(e,t){for(var r;r=this.rx.VAR_CONSUMED.exec(e);){var o=r[1];":"!==r[2]&&(t[o]=!0)}},reify:function(e){for(var t,r=Object.getOwnPropertyNames(e),o=0;o<r.length;o++)t=r[o],e[t]=this.valueForProperty(e[t],e)},valueForProperty:function(e,t){if(e)if(e.indexOf(";")>=0)e=this.valueForProperties(e,t);else{var r=this,o=function(e,o,n,i){var s=r.valueForProperty(t[n],t)||r.valueForProperty(t[i]||i,t)||i;return o+(s||"")};e=e.replace(this.rx.VAR_MATCH,o)}return e&&e.trim()||""},valueForProperties:function(e,t){for(var r,o,n=e.split(";"),i=0;i<n.length;i++)if(r=n[i]){if(this.rx.MIXIN_MATCH.lastIndex=0,o=this.rx.MIXIN_MATCH.exec(r))r=this.valueForProperty(t[o[1]],t);else{var s=r.indexOf(":");if(s!==-1){var a=r.substring(s);a=a.trim(),a=this.valueForProperty(a,t)||a,r=r.substring(0,s)+a}}n[i]=r&&r.lastIndexOf(";")===r.length-1?r.slice(0,-1):r||""}return n.join(";")},applyProperties:function(e,t){var r="";e.propertyInfo||this.decorateRule(e),e.propertyInfo.cssText&&(r=this.valueForProperties(e.propertyInfo.cssText,t)),e.cssText=r},applyKeyframeTransforms:function(e,t){var r=e.cssText,o=e.cssText;if(null==e.hasAnimations&&(e.hasAnimations=this.rx.ANIMATION_MATCH.test(r)),e.hasAnimations){var n;if(null==e.keyframeNamesToTransform){e.keyframeNamesToTransform=[];for(var i in t)n=t[i],o=n(r),r!==o&&(r=o,e.keyframeNamesToTransform.push(i))}else{for(var s=0;s<e.keyframeNamesToTransform.length;++s)n=t[e.keyframeNamesToTransform[s]],r=n(r);o=r}}e.cssText=o},propertyDataFromStyles:function(o,n){var i={},s=this,a=[];return r.forActiveRulesInStyles(o,function(r){r.propertyInfo||s.decorateRule(r);var o=r.transformedSelector||r.parsedSelector;n&&r.propertyInfo.properties&&o&&t.call(n,o)&&(s.collectProperties(r,i),e(r.index,a))}),{properties:i,key:a}},whenHostOrRootRule:function(e,t,r,i){if(t.propertyInfo||self.decorateRule(t),t.propertyInfo.properties){var s=e.is?o._calcHostScope(e.is,e["extends"]):"html",a=t.parsedSelector,l=":root"===a,c=0===a.indexOf(":host"),u=e.__cssBuild||r.__cssBuild;if("shady"===u&&(l=a===s+"> *."+s||a.indexOf("html")!==-1,c=!l&&0===a.indexOf(s)),"shadow"===u&&(l=":host > *"===a||"html"===a,c=c&&!l),l||c){var h=s;c&&(n.useNativeShadow&&!t.transformedSelector&&(t.transformedSelector=o._transformRuleCss(t,o._transformComplexSelector,e.is,s)),h=t.transformedSelector||s),i({selector:h,isHost:c,isRoot:l})}}},hostAndRootPropertiesForScope:function(e){var o={},n={},i=this;return r.forActiveRulesInStyles(e._styles,function(r,s){i.whenHostOrRootRule(e,r,s,function(s){var a=e._element||e;t.call(a,s.selector)&&(s.isHost?i.collectProperties(r,o):i.collectProperties(r,n))})}),{rootProps:n,hostProps:o}},transformStyles:function(e,t,r){var i=this,s=o._calcHostScope(e.is,e["extends"]),a=e["extends"]?"\\"+s.slice(0,-1)+"\\]":s,l=new RegExp(this.rx.HOST_PREFIX+a+this.rx.HOST_SUFFIX),c=this._elementKeyframeTransforms(e,r);return o.elementStyles(e,function(o){i.applyProperties(o,t),n.useNativeShadow||Polymer.StyleUtil.isKeyframesSelector(o)||!o.cssText||(i.applyKeyframeTransforms(o,c),i._scopeSelector(o,l,s,e._scopeCssViaAttr,r))})},_elementKeyframeTransforms:function(e,t){var r=e._styles._keyframes,o={};if(!n.useNativeShadow&&r)for(var i=0,s=r[i];i<r.length;s=r[++i])this._scopeKeyframes(s,t),o[s.keyframesName]=this._keyframesRuleTransformer(s);return o},_keyframesRuleTransformer:function(e){return function(t){return t.replace(e.keyframesNameRx,e.transformedKeyframesName)}},_scopeKeyframes:function(e,t){e.keyframesNameRx=new RegExp(e.keyframesName,"g"),e.transformedKeyframesName=e.keyframesName+"-"+t,e.transformedSelector=e.transformedSelector||e.selector,e.selector=e.transformedSelector.replace(e.keyframesName,e.transformedKeyframesName)},_scopeSelector:function(e,t,r,n,i){e.transformedSelector=e.transformedSelector||e.selector;for(var s,a=e.transformedSelector,l=n?"["+o.SCOPE_NAME+"~="+i+"]":"."+i,c=a.split(","),u=0,h=c.length;u<h&&(s=c[u]);u++)c[u]=s.match(t)?s.replace(r,l):l+" "+s;e.selector=c.join(",")},applyElementScopeSelector:function(e,t,r,n){var i=n?e.getAttribute(o.SCOPE_NAME):e.getAttribute("class")||"",s=r?i.replace(r,t):(i?i+" ":"")+this.XSCOPE_NAME+" "+t;i!==s&&(n?e.setAttribute(o.SCOPE_NAME,s):e.setAttribute("class",s))},applyElementStyle:function(e,t,o,i){var s=i?i.textContent||"":this.transformStyles(e,t,o),a=e._customStyle;return a&&!n.useNativeShadow&&a!==i&&(a._useCount--,a._useCount<=0&&a.parentNode&&a.parentNode.removeChild(a)),n.useNativeShadow?e._customStyle?(e._customStyle.textContent=s,i=e._customStyle):s&&(i=r.applyCss(s,o,e.root,e._scopeStyle)):i?i.parentNode||r.applyStyle(i,null,e._scopeStyle):s&&(i=r.applyCss(s,o,null,e._scopeStyle)),i&&(i._useCount=i._useCount||0,e._customStyle!=i&&i._useCount++,e._customStyle=i),i},mixinCustomStyle:function(e,t){var r;for(var o in t)r=t[o],(r||0===r)&&(e[o]=r)},updateNativeStyleProperties:function(e,t){for(var r=0;r<e.style.length;r++)e.style.removeProperty(e.style[r]);for(var o in t)null!==t[o]&&e.style.setProperty(o,t[o])},rx:r.rx,XSCOPE_NAME:"x-scope"}}(),function(){Polymer.StyleCache=function(){this.cache={}},Polymer.StyleCache.prototype={MAX:100,store:function(e,t,r,o){t.keyValues=r,t.styles=o;var n=this.cache[e]=this.cache[e]||[];n.push(t),n.length>this.MAX&&n.shift()},retrieve:function(e,t,r){var o=this.cache[e];if(o)for(var n,i=o.length-1;i>=0;i--)if(n=o[i],r===n.styles&&this._objectsEqual(t,n.keyValues))return n},clear:function(){this.cache={}},_objectsEqual:function(e,t){var r,o;for(var n in e)if(r=e[n],o=t[n],!("object"==typeof r&&r?this._objectsStrictlyEqual(r,o):r===o))return!1;return!Array.isArray(e)||e.length===t.length},_objectsStrictlyEqual:function(e,t){return this._objectsEqual(e,t)&&this._objectsEqual(t,e)}}}(),Polymer.StyleDefaults=function(){var e=Polymer.StyleProperties,t=Polymer.StyleCache,r=Polymer.Settings.useNativeCSSProperties,o={_styles:[],_properties:null,customStyle:{},_styleCache:new t,_element:Polymer.DomApi.wrap(document.documentElement),addStyle:function(e){this._styles.push(e),this._properties=null},get _styleProperties(){return this._properties||(e.decorateStyles(this._styles,this),this._styles._scopeStyleProperties=null,this._properties=e.hostAndRootPropertiesForScope(this).rootProps,e.mixinCustomStyle(this._properties,this.customStyle),e.reify(this._properties)),this._properties},hasStyleProperties:function(){return Boolean(this._properties)},_needsStyleProperties:function(){},_computeStyleProperties:function(){return this._styleProperties},updateStyles:function(t){this._properties=null,t&&Polymer.Base.mixin(this.customStyle,t),this._styleCache.clear();for(var o,n=0;n<this._styles.length;n++)o=this._styles[n],o=o.__importElement||o,o._apply();r&&e.updateNativeStyleProperties(document.documentElement,this.customStyle)}};return o}(),function(){"use strict";var e=Polymer.Base.serializeValueToAttribute,t=Polymer.StyleProperties,r=Polymer.StyleTransformer,o=Polymer.StyleDefaults,n=Polymer.Settings.useNativeShadow,i=Polymer.Settings.useNativeCSSProperties;Polymer.Base._addFeature({_prepStyleProperties:function(){i||(this._ownStylePropertyNames=this._styles&&this._styles.length?t.decorateStyles(this._styles,this):null)},customStyle:null,getComputedStyleValue:function(e){return!i&&this._styleProperties&&this._styleProperties[e]||getComputedStyle(this).getPropertyValue(e)},_setupStyleProperties:function(){this.customStyle={},this._styleCache=null,this._styleProperties=null,this._scopeSelector=null,this._ownStyleProperties=null,this._customStyle=null},_needsStyleProperties:function(){return Boolean(!i&&this._ownStylePropertyNames&&this._ownStylePropertyNames.length)},_beforeAttached:function(){this._scopeSelector&&!this.__stylePropertiesInvalid||!this._needsStyleProperties()||(this.__stylePropertiesInvalid=!1,this._updateStyleProperties())},_findStyleHost:function(){for(var e,t=this;e=Polymer.dom(t).getOwnerRoot();){if(Polymer.isInstance(e.host))return e.host;t=e.host}return o},_updateStyleProperties:function(){var e,r=this._findStyleHost();r._styleCache||(r._styleCache=new Polymer.StyleCache);var o=t.propertyDataFromStyles(r._styles,this),i=!this.__notStyleScopeCacheable;i&&(o.key.customStyle=this.customStyle,e=r._styleCache.retrieve(this.is,o.key,this._styles));var a=Boolean(e);a?this._styleProperties=e._styleProperties:this._computeStyleProperties(o.properties),this._computeOwnStyleProperties(),a||(e=s.retrieve(this.is,this._ownStyleProperties,this._styles));var l=Boolean(e)&&!a,c=this._applyStyleProperties(e);a||(c=c&&n?c.cloneNode(!0):c,e={style:c,_scopeSelector:this._scopeSelector,_styleProperties:this._styleProperties},i&&(o.key.customStyle={},this.mixin(o.key.customStyle,this.customStyle),r._styleCache.store(this.is,e,o.key,this._styles)),l||s.store(this.is,Object.create(e),this._ownStyleProperties,this._styles))},_computeStyleProperties:function(e){var r=this._findStyleHost();r._styleProperties||r._computeStyleProperties();var o=Object.create(r._styleProperties),n=t.hostAndRootPropertiesForScope(this);this.mixin(o,n.hostProps),e=e||t.propertyDataFromStyles(r._styles,this).properties,this.mixin(o,e),this.mixin(o,n.rootProps),t.mixinCustomStyle(o,this.customStyle),t.reify(o),this._styleProperties=o},_computeOwnStyleProperties:function(){for(var e,t={},r=0;r<this._ownStylePropertyNames.length;r++)e=this._ownStylePropertyNames[r],t[e]=this._styleProperties[e];this._ownStyleProperties=t},_scopeCount:0,_applyStyleProperties:function(e){var r=this._scopeSelector;this._scopeSelector=e?e._scopeSelector:this.is+"-"+this.__proto__._scopeCount++;var o=t.applyElementStyle(this,this._styleProperties,this._scopeSelector,e&&e.style);return n||t.applyElementScopeSelector(this,this._scopeSelector,r,this._scopeCssViaAttr),o},serializeValueToAttribute:function(t,r,o){if(o=o||this,"class"===r&&!n){var i=o===this?this.domHost||this.dataHost:this;i&&(t=i._scopeElementClass(o,t))}o=this.shadyRoot&&this.shadyRoot._hasDistributed?Polymer.dom(o):o,e.call(this,t,r,o)},_scopeElementClass:function(e,t){return n||this._scopeCssViaAttr||(t=(t?t+" ":"")+a+" "+this.is+(e._scopeSelector?" "+l+" "+e._scopeSelector:"")),t},updateStyles:function(e){e&&this.mixin(this.customStyle,e),i?t.updateNativeStyleProperties(this,this.customStyle):(this.isAttached?this._needsStyleProperties()?this._updateStyleProperties():this._styleProperties=null:this.__stylePropertiesInvalid=!0,this._styleCache&&this._styleCache.clear(),this._updateRootStyles())},_updateRootStyles:function(e){e=e||this.root;for(var t,r=Polymer.dom(e)._query(function(e){return e.shadyRoot||e.shadowRoot}),o=0,n=r.length;o<n&&(t=r[o]);o++)t.updateStyles&&t.updateStyles()}}),Polymer.updateStyles=function(e){o.updateStyles(e),Polymer.Base._updateRootStyles(document)};var s=new Polymer.StyleCache;Polymer.customStyleCache=s;var a=r.SCOPE_NAME,l=t.XSCOPE_NAME}(),Polymer.Base._addFeature({_registerFeatures:function(){this._prepIs(),this._prepConstructor(),this._prepStyles()},_finishRegisterFeatures:function(){this._prepTemplate(),this._prepShimStyles(),this._prepAnnotations(),this._prepEffects(),this._prepBehaviors(),this._prepPropertyInfo(),this._prepBindings(),this._prepShady()},_prepBehavior:function(e){this._addPropertyEffects(e.properties),this._addComplexObserverEffects(e.observers),this._addHostAttributes(e.hostAttributes)},_initFeatures:function(){this._setupGestures(),this._setupConfigure(),this._setupStyleProperties(),this._setupDebouncers(),this._setupShady(),this._registerHost(),this._template&&(this._poolContent(),this._beginHosting(),this._stampTemplate(),this._endHosting(),this._marshalAnnotationReferences()),this._marshalInstanceEffects(),this._marshalBehaviors(),this._marshalHostAttributes(),this._marshalAttributes(),this._tryReady()},_marshalBehavior:function(e){e.listeners&&this._listenListeners(e.listeners)}}),function(){var e,t=Polymer.StyleProperties,r=Polymer.StyleUtil,o=Polymer.CssParse,n=Polymer.StyleDefaults,i=Polymer.StyleTransformer,s=Polymer.ApplyShim,a=Polymer.Debounce,l=Polymer.Settings;Polymer({is:"custom-style","extends":"style",_template:null,properties:{include:String},ready:function(){this.__appliedElement=this.__appliedElement||this,this.__cssBuild=r.getCssBuildType(this),this.__appliedElement!==this&&(this.__appliedElement.__cssBuild=this.__cssBuild),this._tryApply()},attached:function(){this._tryApply()},_tryApply:function(){if(!this._appliesToDocument&&this.parentNode&&"dom-module"!==this.parentNode.localName){this._appliesToDocument=!0;var e=this.__appliedElement;if(l.useNativeCSSProperties||(this.__needsUpdateStyles=n.hasStyleProperties(),n.addStyle(e)),e.textContent||this.include)this._apply(!0);else{var t=this,r=new MutationObserver(function(){r.disconnect(),t._apply(!0)});r.observe(e,{childList:!0})}}},_updateStyles:function(){Polymer.updateStyles()},_apply:function(e){var t=this.__appliedElement;if(this.include&&(t.textContent=r.cssFromModules(this.include,!0)+t.textContent),t.textContent){var o=this.__cssBuild,n=r.isTargetedBuild(o);if(!l.useNativeCSSProperties||!n){var a=r.rulesForStyle(t);if(n||r.forEachRule(a,function(e){i.documentRule(e),l.useNativeCSSProperties&&!o&&s.transformRule(e)}),l.useNativeCSSProperties)t.textContent=r.toCssText(a);else{var c=this,u=function(){c._flushCustomProperties()};e?Polymer.RenderStatus.whenReady(u):u()}}}},_flushCustomProperties:function(){this.__needsUpdateStyles?(this.__needsUpdateStyles=!1,e=a(e,this._updateStyles)):this._applyCustomProperties()},_applyCustomProperties:function(){var e=this.__appliedElement;this._computeStyleProperties();var n=this._styleProperties,i=r.rulesForStyle(e);i&&(e.textContent=r.toCssText(i,function(e){var r=e.cssText=e.parsedCssText;e.propertyInfo&&e.propertyInfo.cssText&&(r=o.removeCustomPropAssignment(r),e.cssText=t.valueForProperties(r,n))}))}})}(),Polymer.Templatizer={properties:{__hideTemplateChildren__:{observer:"_showHideChildren"}},_instanceProps:Polymer.nob,_parentPropPrefix:"_parent_",templatize:function(e){if(this._templatized=e,e._content||(e._content=e.content),e._content._ctor)return this.ctor=e._content._ctor,void this._prepParentProperties(this.ctor.prototype,e);var t=Object.create(Polymer.Base);this._customPrepAnnotations(t,e),this._prepParentProperties(t,e),t._prepEffects(),this._customPrepEffects(t),t._prepBehaviors(),t._prepPropertyInfo(),t._prepBindings(),t._notifyPathUp=this._notifyPathUpImpl,t._scopeElementClass=this._scopeElementClassImpl,t.listen=this._listenImpl,t._showHideChildren=this._showHideChildrenImpl,t.__setPropertyOrig=this.__setProperty,t.__setProperty=this.__setPropertyImpl;var r=this._constructorImpl,o=function(e,t){r.call(this,e,t)};o.prototype=t,t.constructor=o,e._content._ctor=o,this.ctor=o},_getRootDataHost:function(){return this.dataHost&&this.dataHost._rootDataHost||this.dataHost},_showHideChildrenImpl:function(e){for(var t=this._children,r=0;r<t.length;r++){var o=t[r];Boolean(e)!=Boolean(o.__hideTemplateChildren__)&&(o.nodeType===Node.TEXT_NODE?e?(o.__polymerTextContent__=o.textContent,o.textContent=""):o.textContent=o.__polymerTextContent__:o.style&&(e?(o.__polymerDisplay__=o.style.display,o.style.display="none"):o.style.display=o.__polymerDisplay__)),o.__hideTemplateChildren__=e}},__setPropertyImpl:function(e,t,r,o){o&&o.__hideTemplateChildren__&&"textContent"==e&&(e="__polymerTextContent__"),this.__setPropertyOrig(e,t,r,o)},_debounceTemplate:function(e){Polymer.dom.addDebouncer(this.debounce("_debounceTemplate",e))},_flushTemplates:function(){Polymer.dom.flush()},_customPrepEffects:function(e){var t=e._parentProps;for(var r in t)e._addPropertyEffect(r,"function",this._createHostPropEffector(r));for(r in this._instanceProps)e._addPropertyEffect(r,"function",this._createInstancePropEffector(r))},_customPrepAnnotations:function(e,t){e._template=t;var r=t._content;if(!r._notes){var o=e._rootDataHost;o&&(Polymer.Annotations.prepElement=function(){o._prepElement()}),r._notes=Polymer.Annotations.parseAnnotations(t),Polymer.Annotations.prepElement=null,this._processAnnotations(r._notes)}e._notes=r._notes,e._parentProps=r._parentProps},_prepParentProperties:function(e,t){var r=this._parentProps=e._parentProps;if(this._forwardParentProp&&r){var o,n=e._parentPropProto;if(!n){for(o in this._instanceProps)delete r[o];n=e._parentPropProto=Object.create(null),t!=this&&(Polymer.Bind.prepareModel(n),Polymer.Base.prepareModelNotifyPath(n));for(o in r){var i=this._parentPropPrefix+o,s=[{kind:"function",effect:this._createForwardPropEffector(o),fn:Polymer.Bind._functionEffect},{kind:"notify",fn:Polymer.Bind._notifyEffect,effect:{event:Polymer.CaseMap.camelToDashCase(i)+"-changed"}}];Polymer.Bind._createAccessors(n,i,s)}}var a=this;t!=this&&(Polymer.Bind.prepareInstance(t),t._forwardParentProp=function(e,t){a._forwardParentProp(e,t)}),this._extendTemplate(t,n),t._pathEffector=function(e,t,r){return a._pathEffectorImpl(e,t,r)}}},_createForwardPropEffector:function(e){return function(t,r){this._forwardParentProp(e,r)}},_createHostPropEffector:function(e){var t=this._parentPropPrefix;return function(r,o){this.dataHost._templatized[t+e]=o}},_createInstancePropEffector:function(e){return function(t,r,o,n){n||this.dataHost._forwardInstanceProp(this,e,r)}},_extendTemplate:function(e,t){var r=Object.getOwnPropertyNames(t);t._propertySetter&&(e._propertySetter=t._propertySetter);for(var o,n=0;n<r.length&&(o=r[n]);n++){var i=e[o],s=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(e,o,s),void 0!==i&&e._propertySetter(o,i)}},_showHideChildren:function(e){},_forwardInstancePath:function(e,t,r){},_forwardInstanceProp:function(e,t,r){},_notifyPathUpImpl:function(e,t){var r=this.dataHost,o=e.indexOf("."),n=o<0?e:e.slice(0,o);r._forwardInstancePath.call(r,this,e,t),n in r._parentProps&&r._templatized._notifyPath(r._parentPropPrefix+e,t)},_pathEffectorImpl:function(e,t,r){if(this._forwardParentPath&&0===e.indexOf(this._parentPropPrefix)){var o=e.substring(this._parentPropPrefix.length),n=this._modelForPath(o);n in this._parentProps&&this._forwardParentPath(o,t)}Polymer.Base._pathEffector.call(this._templatized,e,t,r)},_constructorImpl:function(e,t){this._rootDataHost=t._getRootDataHost(),this._setupConfigure(e),this._registerHost(t),this._beginHosting(),this.root=this.instanceTemplate(this._template),this.root.__noContent=!this._notes._hasContent,this.root.__styleScoped=!0,this._endHosting(),this._marshalAnnotatedNodes(),this._marshalInstanceEffects(),this._marshalAnnotatedListeners();for(var r=[],o=this.root.firstChild;o;o=o.nextSibling)r.push(o),o._templateInstance=this;this._children=r,t.__hideTemplateChildren__&&this._showHideChildren(!0),this._tryReady()},_listenImpl:function(e,t,r){var o=this,n=this._rootDataHost,i=n._createEventHandler(e,t,r),s=function(e){e.model=o,i(e)};n._listen(e,t,s)},_scopeElementClassImpl:function(e,t){var r=this._rootDataHost;return r?r._scopeElementClass(e,t):t},stamp:function(e){if(e=e||{},this._parentProps){var t=this._templatized;for(var r in this._parentProps)void 0===e[r]&&(e[r]=t[this._parentPropPrefix+r])}return new this.ctor(e,this)},modelForElement:function(e){for(var t;e;)if(t=e._templateInstance){if(t.dataHost==this)return t;e=t.dataHost}else e=e.parentNode}},Polymer({is:"dom-template","extends":"template",_template:null,behaviors:[Polymer.Templatizer],ready:function(){this.templatize(this)}}),Polymer._collections=new WeakMap,Polymer.Collection=function(e){Polymer._collections.set(e,this),this.userArray=e,this.store=e.slice(),this.initMap()},Polymer.Collection.prototype={constructor:Polymer.Collection,initMap:function(){for(var e=this.omap=new WeakMap,t=this.pmap={},r=this.store,o=0;o<r.length;o++){var n=r[o];n&&"object"==typeof n?e.set(n,o):t[n]=o}},add:function(e){var t=this.store.push(e)-1;return e&&"object"==typeof e?this.omap.set(e,t):this.pmap[e]=t,"#"+t},removeKey:function(e){(e=this._parseKey(e))&&(this._removeFromMap(this.store[e]),delete this.store[e])},_removeFromMap:function(e){e&&"object"==typeof e?this.omap["delete"](e):delete this.pmap[e]},remove:function(e){var t=this.getKey(e);return this.removeKey(t),t},getKey:function(e){var t;if(t=e&&"object"==typeof e?this.omap.get(e):this.pmap[e],void 0!=t)return"#"+t},getKeys:function(){return Object.keys(this.store).map(function(e){return"#"+e})},_parseKey:function(e){if(e&&"#"==e[0])return e.slice(1)},setItem:function(e,t){if(e=this._parseKey(e)){var r=this.store[e];r&&this._removeFromMap(r),t&&"object"==typeof t?this.omap.set(t,e):this.pmap[t]=e,this.store[e]=t}},getItem:function(e){if(e=this._parseKey(e))return this.store[e]},getItems:function(){var e=[],t=this.store;for(var r in t)e.push(t[r]);return e},_applySplices:function(e){for(var t,r,o={},n=0;n<e.length&&(r=e[n]);n++){r.addedKeys=[];for(var i=0;i<r.removed.length;i++)t=this.getKey(r.removed[i]),o[t]=o[t]?null:-1;for(i=0;i<r.addedCount;i++){var s=this.userArray[r.index+i];t=this.getKey(s),t=void 0===t?this.add(s):t,o[t]=o[t]?null:1,r.addedKeys.push(t)}}var a=[],l=[];for(t in o)o[t]<0&&(this.removeKey(t),a.push(t)),o[t]>0&&l.push(t);return[{removed:a,added:l}]}},Polymer.Collection.get=function(e){return Polymer._collections.get(e)||new Polymer.Collection(e)},Polymer.Collection.applySplices=function(e,t){var r=Polymer._collections.get(e);return r?r._applySplices(t):null},Polymer({is:"dom-repeat","extends":"template",_template:null,properties:{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},sort:{type:Function,observer:"_sortChanged"},filter:{type:Function,observer:"_filterChanged"},observe:{type:String,observer:"_observeChanged"},delay:Number,renderedItemCount:{type:Number,notify:!0,readOnly:!0},initialCount:{
type:Number,observer:"_initializeChunking"},targetFramerate:{type:Number,value:20},_targetFrameTime:{type:Number,computed:"_computeFrameTime(targetFramerate)"}},behaviors:[Polymer.Templatizer],observers:["_itemsChanged(items.*)"],created:function(){this._instances=[],this._pool=[],this._limit=1/0;var e=this;this._boundRenderChunk=function(){e._renderChunk()}},detached:function(){this.__isDetached=!0;for(var e=0;e<this._instances.length;e++)this._detachInstance(e)},attached:function(){if(this.__isDetached){this.__isDetached=!1;for(var e=Polymer.dom(Polymer.dom(this).parentNode),t=0;t<this._instances.length;t++)this._attachInstance(t,e)}},ready:function(){this._instanceProps={__key__:!0},this._instanceProps[this.as]=!0,this._instanceProps[this.indexAs]=!0,this.ctor||this.templatize(this)},_sortChanged:function(e){var t=this._getRootDataHost();this._sortFn=e&&("function"==typeof e?e:function(){return t[e].apply(t,arguments)}),this._needFullRefresh=!0,this.items&&this._debounceTemplate(this._render)},_filterChanged:function(e){var t=this._getRootDataHost();this._filterFn=e&&("function"==typeof e?e:function(){return t[e].apply(t,arguments)}),this._needFullRefresh=!0,this.items&&this._debounceTemplate(this._render)},_computeFrameTime:function(e){return Math.ceil(1e3/e)},_initializeChunking:function(){this.initialCount&&(this._limit=this.initialCount,this._chunkCount=this.initialCount,this._lastChunkTime=performance.now())},_tryRenderChunk:function(){this.items&&this._limit<this.items.length&&this.debounce("renderChunk",this._requestRenderChunk)},_requestRenderChunk:function(){requestAnimationFrame(this._boundRenderChunk)},_renderChunk:function(){var e=performance.now(),t=this._targetFrameTime/(e-this._lastChunkTime);this._chunkCount=Math.round(this._chunkCount*t)||1,this._limit+=this._chunkCount,this._lastChunkTime=e,this._debounceTemplate(this._render)},_observeChanged:function(){this._observePaths=this.observe&&this.observe.replace(".*",".").split(" ")},_itemsChanged:function(e){if("items"==e.path)Array.isArray(this.items)?this.collection=Polymer.Collection.get(this.items):this.items?this._error(this._logf("dom-repeat","expected array for `items`, found",this.items)):this.collection=null,this._keySplices=[],this._indexSplices=[],this._needFullRefresh=!0,this._initializeChunking(),this._debounceTemplate(this._render);else if("items.splices"==e.path)this._keySplices=this._keySplices.concat(e.value.keySplices),this._indexSplices=this._indexSplices.concat(e.value.indexSplices),this._debounceTemplate(this._render);else{var t=e.path.slice(6);this._forwardItemPath(t,e.value),this._checkObservedPaths(t)}},_checkObservedPaths:function(e){if(this._observePaths){e=e.substring(e.indexOf(".")+1);for(var t=this._observePaths,r=0;r<t.length;r++)if(0===e.indexOf(t[r]))return this._needFullRefresh=!0,void(this.delay?this.debounce("render",this._render,this.delay):this._debounceTemplate(this._render))}},render:function(){this._needFullRefresh=!0,this._debounceTemplate(this._render),this._flushTemplates()},_render:function(){this._needFullRefresh?(this._applyFullRefresh(),this._needFullRefresh=!1):this._keySplices.length&&(this._sortFn?this._applySplicesUserSort(this._keySplices):this._filterFn?this._applyFullRefresh():this._applySplicesArrayOrder(this._indexSplices)),this._keySplices=[],this._indexSplices=[];for(var e=this._keyToInstIdx={},t=this._instances.length-1;t>=0;t--){var r=this._instances[t];r.isPlaceholder&&t<this._limit?r=this._insertInstance(t,r.__key__):!r.isPlaceholder&&t>=this._limit&&(r=this._downgradeInstance(t,r.__key__)),e[r.__key__]=t,r.isPlaceholder||r.__setProperty(this.indexAs,t,!0)}this._pool.length=0,this._setRenderedItemCount(this._instances.length),this.fire("dom-change"),this._tryRenderChunk()},_applyFullRefresh:function(){var e,t=this.collection;if(this._sortFn)e=t?t.getKeys():[];else{e=[];var r=this.items;if(r)for(var o=0;o<r.length;o++)e.push(t.getKey(r[o]))}var n=this;for(this._filterFn&&(e=e.filter(function(e){return n._filterFn(t.getItem(e))})),this._sortFn&&e.sort(function(e,r){return n._sortFn(t.getItem(e),t.getItem(r))}),o=0;o<e.length;o++){var i=e[o],s=this._instances[o];s?(s.__key__=i,!s.isPlaceholder&&o<this._limit&&s.__setProperty(this.as,t.getItem(i),!0)):o<this._limit?this._insertInstance(o,i):this._insertPlaceholder(o,i)}for(var a=this._instances.length-1;a>=o;a--)this._detachAndRemoveInstance(a)},_numericSort:function(e,t){return e-t},_applySplicesUserSort:function(e){for(var t,r,o=this.collection,n={},i=0;i<e.length&&(r=e[i]);i++){for(var s=0;s<r.removed.length;s++)t=r.removed[s],n[t]=n[t]?null:-1;for(s=0;s<r.added.length;s++)t=r.added[s],n[t]=n[t]?null:1}var a=[],l=[];for(t in n)n[t]===-1&&a.push(this._keyToInstIdx[t]),1===n[t]&&l.push(t);if(a.length)for(a.sort(this._numericSort),i=a.length-1;i>=0;i--){var c=a[i];void 0!==c&&this._detachAndRemoveInstance(c)}var u=this;if(l.length){this._filterFn&&(l=l.filter(function(e){return u._filterFn(o.getItem(e))})),l.sort(function(e,t){return u._sortFn(o.getItem(e),o.getItem(t))});var h=0;for(i=0;i<l.length;i++)h=this._insertRowUserSort(h,l[i])}},_insertRowUserSort:function(e,t){for(var r=this.collection,o=r.getItem(t),n=this._instances.length-1,i=-1;e<=n;){var s=e+n>>1,a=this._instances[s].__key__,l=this._sortFn(r.getItem(a),o);if(l<0)e=s+1;else{if(!(l>0)){i=s;break}n=s-1}}return i<0&&(i=n+1),this._insertPlaceholder(i,t),i},_applySplicesArrayOrder:function(e){for(var t,r=0;r<e.length&&(t=e[r]);r++){for(var o=0;o<t.removed.length;o++)this._detachAndRemoveInstance(t.index);for(o=0;o<t.addedKeys.length;o++)this._insertPlaceholder(t.index+o,t.addedKeys[o])}},_detachInstance:function(e){var t=this._instances[e];if(!t.isPlaceholder){for(var r=0;r<t._children.length;r++){var o=t._children[r];Polymer.dom(t.root).appendChild(o)}return t}},_attachInstance:function(e,t){var r=this._instances[e];r.isPlaceholder||t.insertBefore(r.root,this)},_detachAndRemoveInstance:function(e){var t=this._detachInstance(e);t&&this._pool.push(t),this._instances.splice(e,1)},_insertPlaceholder:function(e,t){this._instances.splice(e,0,{isPlaceholder:!0,__key__:t})},_stampInstance:function(e,t){var r={__key__:t};return r[this.as]=this.collection.getItem(t),r[this.indexAs]=e,this.stamp(r)},_insertInstance:function(e,t){var r=this._pool.pop();r?(r.__setProperty(this.as,this.collection.getItem(t),!0),r.__setProperty("__key__",t,!0)):r=this._stampInstance(e,t);var o=this._instances[e+1],n=o&&!o.isPlaceholder?o._children[0]:this,i=Polymer.dom(this).parentNode;return Polymer.dom(i).insertBefore(r.root,n),this._instances[e]=r,r},_downgradeInstance:function(e,t){var r=this._detachInstance(e);return r&&this._pool.push(r),r={isPlaceholder:!0,__key__:t},this._instances[e]=r,r},_showHideChildren:function(e){for(var t=0;t<this._instances.length;t++)this._instances[t]._showHideChildren(e)},_forwardInstanceProp:function(e,t,r){if(t==this.as){var o;o=this._sortFn||this._filterFn?this.items.indexOf(this.collection.getItem(e.__key__)):e[this.indexAs],this.set("items."+o,r)}},_forwardInstancePath:function(e,t,r){0===t.indexOf(this.as+".")&&this._notifyPath("items."+e.__key__+"."+t.slice(this.as.length+1),r)},_forwardParentProp:function(e,t){for(var r,o=this._instances,n=0;n<o.length&&(r=o[n]);n++)r.isPlaceholder||r.__setProperty(e,t,!0)},_forwardParentPath:function(e,t){for(var r,o=this._instances,n=0;n<o.length&&(r=o[n]);n++)r.isPlaceholder||r._notifyPath(e,t,!0)},_forwardItemPath:function(e,t){if(this._keyToInstIdx){var r=e.indexOf("."),o=e.substring(0,r<0?e.length:r),n=this._keyToInstIdx[o],i=this._instances[n];i&&!i.isPlaceholder&&(r>=0?(e=this.as+"."+e.substring(r+1),i._notifyPath(e,t,!0)):i.__setProperty(this.as,t,!0))}},itemForElement:function(e){var t=this.modelForElement(e);return t&&t[this.as]},keyForElement:function(e){var t=this.modelForElement(e);return t&&t.__key__},indexForElement:function(e){var t=this.modelForElement(e);return t&&t[this.indexAs]}}),Polymer({is:"array-selector",_template:null,properties:{items:{type:Array,observer:"clearSelection"},multi:{type:Boolean,value:!1,observer:"clearSelection"},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}},clearSelection:function(){if(Array.isArray(this.selected))for(var e=0;e<this.selected.length;e++)this.unlinkPaths("selected."+e);else this.unlinkPaths("selected"),this.unlinkPaths("selectedItem");this.multi?this.selected&&!this.selected.length||(this.selected=[],this._selectedColl=Polymer.Collection.get(this.selected)):(this.selected=null,this._selectedColl=null),this.selectedItem=null},isSelected:function(e){return this.multi?void 0!==this._selectedColl.getKey(e):this.selected==e},deselect:function(e){if(this.multi){if(this.isSelected(e)){var t=this._selectedColl.getKey(e);this.arrayDelete("selected",e),this.unlinkPaths("selected."+t)}}else this.selected=null,this.selectedItem=null,this.unlinkPaths("selected"),this.unlinkPaths("selectedItem")},select:function(e){var t=Polymer.Collection.get(this.items),r=t.getKey(e);if(this.multi)if(this.isSelected(e))this.toggle&&this.deselect(e);else{this.push("selected",e);var o=this._selectedColl.getKey(e);this.linkPaths("selected."+o,"items."+r)}else this.toggle&&e==this.selected?this.deselect():(this.selected=e,this.selectedItem=e,this.linkPaths("selected","items."+r),this.linkPaths("selectedItem","items."+r))}}),Polymer({is:"dom-if","extends":"template",_template:null,properties:{"if":{type:Boolean,value:!1,observer:"_queueRender"},restamp:{type:Boolean,value:!1,observer:"_queueRender"}},behaviors:[Polymer.Templatizer],_queueRender:function(){this._debounceTemplate(this._render)},detached:function(){this.parentNode&&(this.parentNode.nodeType!=Node.DOCUMENT_FRAGMENT_NODE||Polymer.Settings.hasShadow&&this.parentNode instanceof ShadowRoot)||this._teardownInstance()},attached:function(){this["if"]&&this.ctor&&this.async(this._ensureInstance)},render:function(){this._flushTemplates()},_render:function(){this["if"]?(this.ctor||this.templatize(this),this._ensureInstance(),this._showHideChildren()):this.restamp&&this._teardownInstance(),!this.restamp&&this._instance&&this._showHideChildren(),this["if"]!=this._lastIf&&(this.fire("dom-change"),this._lastIf=this["if"])},_ensureInstance:function(){var e=Polymer.dom(this).parentNode;if(e){var t=Polymer.dom(e);if(this._instance){var r=this._instance._children;if(r&&r.length){var o=Polymer.dom(this).previousSibling;if(o!==r[r.length-1])for(var n,i=0;i<r.length&&(n=r[i]);i++)t.insertBefore(n,this)}}else{this._instance=this.stamp();var s=this._instance.root;t.insertBefore(s,this)}}},_teardownInstance:function(){if(this._instance){var e=this._instance._children;if(e&&e.length)for(var t,r=Polymer.dom(Polymer.dom(e[0]).parentNode),o=0;o<e.length&&(t=e[o]);o++)r.removeChild(t);this._instance=null}},_showHideChildren:function(){var e=this.__hideTemplateChildren__||!this["if"];this._instance&&this._instance._showHideChildren(e)},_forwardParentProp:function(e,t){this._instance&&(this._instance[e]=t)},_forwardParentPath:function(e,t){this._instance&&this._instance._notifyPath(e,t,!0)}}),Polymer({is:"dom-bind","extends":"template",_template:null,created:function(){var e=this;Polymer.RenderStatus.whenReady(function(){"loading"==document.readyState?document.addEventListener("DOMContentLoaded",function(){e._markImportsReady()}):e._markImportsReady()})},_ensureReady:function(){this._readied||this._readySelf()},_markImportsReady:function(){this._importsReady=!0,this._ensureReady()},_registerFeatures:function(){this._prepConstructor()},_insertChildren:function(){var e=Polymer.dom(Polymer.dom(this).parentNode);e.insertBefore(this.root,this)},_removeChildren:function(){if(this._children)for(var e=0;e<this._children.length;e++)this.root.appendChild(this._children[e])},_initFeatures:function(){},_scopeElementClass:function(e,t){return this.dataHost?this.dataHost._scopeElementClass(e,t):t},_prepConfigure:function(){var e={};for(var t in this._propertyEffects)e[t]=this[t];var r=this._setupConfigure;this._setupConfigure=function(){r.call(this,e)}},attached:function(){this._importsReady&&this.render()},detached:function(){this._removeChildren()},render:function(){this._ensureReady(),this._children||(this._template=this,this._prepAnnotations(),this._prepEffects(),this._prepBehaviors(),this._prepConfigure(),this._prepBindings(),this._prepPropertyInfo(),Polymer.Base._initFeatures.call(this),this._children=Polymer.TreeApi.arrayCopyChildNodes(this.root)),this._insertChildren(),this.fire("dom-change")}}),Polymer({is:"app-route",properties:{route:{type:Object,notify:!0},pattern:{type:String},data:{type:Object,value:function(){return{}},notify:!0},queryParams:{type:Object,value:function(){return{}},notify:!0},tail:{type:Object,value:function(){return{path:null,prefix:null,__queryParams:null}},notify:!0},active:{type:Boolean,notify:!0,readOnly:!0},_queryParamsUpdating:{type:Boolean,value:!1},_matched:{type:String,value:""}},observers:["__tryToMatch(route.path, pattern)","__updatePathOnDataChange(data.*)","__tailPathChanged(tail.path)","__routeQueryParamsChanged(route.__queryParams)","__tailQueryParamsChanged(tail.__queryParams)","__queryParamsChanged(queryParams.*)"],created:function(){this.linkPaths("route.__queryParams","tail.__queryParams"),this.linkPaths("tail.__queryParams","route.__queryParams")},__routeQueryParamsChanged:function(e){if(e&&this.tail){if(this.set("tail.__queryParams",e),!this.active||this._queryParamsUpdating)return;var t={},r=!1;for(var o in e)t[o]=e[o],!r&&this.queryParams&&e[o]===this.queryParams[o]||(r=!0);for(var o in this.queryParams)if(r||!(o in e)){r=!0;break}if(!r)return;this._queryParamsUpdating=!0,this.set("queryParams",t),this._queryParamsUpdating=!1}},__tailQueryParamsChanged:function(e){e&&this.route&&this.set("route.__queryParams",e)},__queryParamsChanged:function(e){this.active&&!this._queryParamsUpdating&&this.set("route.__"+e.path,e.value)},__resetProperties:function(){this._setActive(!1),this._matched=null},__tryToMatch:function(){if(this.route){var e=this.route.path,t=this.pattern;if(t){if(!e)return void this.__resetProperties();for(var r=e.split("/"),o=t.split("/"),n=[],i={},s=0;s<o.length;s++){var a=o[s];if(!a&&""!==a)break;var l=r.shift();if(!l&&""!==l)return void this.__resetProperties();if(n.push(l),":"==a.charAt(0))i[a.slice(1)]=l;else if(a!==l)return void this.__resetProperties()}this._matched=n.join("/");var c={};this.active||(c.active=!0);var u=this.route.prefix+this._matched,h=r.join("/");r.length>0&&(h="/"+h),this.tail&&this.tail.prefix===u&&this.tail.path===h||(c.tail={prefix:u,path:h,__queryParams:this.route.__queryParams}),c.data=i,this._dataInUrl={};for(var f in i)this._dataInUrl[f]=i[f];this.__setMulti(c)}}},__tailPathChanged:function(){if(this.active){var e=this.tail.path,t=this._matched;e&&("/"!==e.charAt(0)&&(e="/"+e),t+=e),this.set("route.path",t)}},__updatePathOnDataChange:function(){if(this.route&&this.active){var e=this.__getLink({}),t=this.__getLink(this._dataInUrl);e!==t&&this.set("route.path",e)}},__getLink:function(e){var t={tail:null};for(var r in this.data)t[r]=this.data[r];for(var r in e)t[r]=e[r];var o=this.pattern.split("/"),n=o.map(function(e){return":"==e[0]&&(e=t[e.slice(1)]),e},this);return t.tail&&t.tail.path&&(n.length>0&&"/"===t.tail.path.charAt(0)?n.push(t.tail.path.slice(1)):n.push(t.tail.path)),n.join("/")},__setMulti:function(e){for(var t in e)this._propertySetter(t,e[t]);for(var t in e)this._pathEffector(t,this[t]),this._notifyPathUp(t,this[t])}}),Polymer({is:"iron-location",properties:{path:{type:String,notify:!0,value:function(){return window.location.pathname}},query:{type:String,notify:!0,value:function(){return window.location.search.slice(1)}},hash:{type:String,notify:!0,value:function(){return window.location.hash.slice(1)}},dwellTime:{type:Number,value:2e3},urlSpaceRegex:{type:String,value:""},_urlSpaceRegExp:{computed:"_makeRegExp(urlSpaceRegex)"},_lastChangedAt:{type:Number},_initialized:{type:Boolean,value:!1}},hostAttributes:{hidden:!0},observers:["_updateUrl(path, query, hash)"],attached:function(){this.listen(window,"hashchange","_hashChanged"),this.listen(window,"location-changed","_urlChanged"),this.listen(window,"popstate","_urlChanged"),this.listen(document.body,"click","_globalOnClick"),this._lastChangedAt=window.performance.now()-(this.dwellTime-200),this._initialized=!0,this._urlChanged()},detached:function(){this.unlisten(window,"hashchange","_hashChanged"),this.unlisten(window,"location-changed","_urlChanged"),this.unlisten(window,"popstate","_urlChanged"),this.unlisten(document.body,"click","_globalOnClick"),this._initialized=!1},_hashChanged:function(){this.hash=window.location.hash.substring(1)},_urlChanged:function(){this._dontUpdateUrl=!0,this._hashChanged(),this.path=window.location.pathname,this.query=window.location.search.substring(1),this._dontUpdateUrl=!1,this._updateUrl()},_getUrl:function(){var e=this.path,t=this.query;return t&&(e+="?"+t),this.hash&&(e+="#"+this.hash),e},_updateUrl:function(){if(!this._dontUpdateUrl&&this._initialized){var e=this._getUrl(),t=window.location.pathname+window.location.search+window.location.hash;if(e!=t){var r=new URL(e,window.location.protocol+"//"+window.location.host).href,o=window.performance.now(),n=this._lastChangedAt+this.dwellTime>o;this._lastChangedAt=o,n?window.history.replaceState({},"",r):window.history.pushState({},"",r),this.fire("location-changed",{},{node:window})}}},_globalOnClick:function(e){if(!e.defaultPrevented){var t=this._getSameOriginLinkHref(e);t&&(e.preventDefault(),t!==window.location.href&&(window.history.pushState({},"",t),this.fire("location-changed",{},{node:window})))}},_getSameOriginLinkHref:function(e){if(0!==e.button)return null;if(e.metaKey||e.ctrlKey)return null;for(var t=Polymer.dom(e).path,r=null,o=0;o<t.length;o++){var n=t[o];if("A"===n.tagName&&n.href){r=n;break}}if(!r)return null;if("_blank"===r.target)return null;if(("_top"===r.target||"_parent"===r.target)&&window.top!==window)return null;var i,s=r.href;i=null!=document.baseURI?new URL(s,document.baseURI):new URL(s);var a;if(window.location.origin?a=window.location.origin:(a=window.location.protocol+"//"+window.location.hostname,window.location.port&&(a+=":"+window.location.port)),i.origin!==a)return null;var l=i.pathname+i.search+i.hash;if(this._urlSpaceRegExp&&!this._urlSpaceRegExp.test(l))return null;var c=new URL(l,window.location.href).href;return c},_makeRegExp:function(e){return RegExp(e)}}),Polymer({is:"iron-query-params",properties:{paramsString:{type:String,notify:!0,observer:"paramsStringChanged"},paramsObject:{type:Object,notify:!0,value:function(){return{}}},_dontReact:{type:Boolean,value:!1}},hostAttributes:{hidden:!0},observers:["paramsObjectChanged(paramsObject.*)"],paramsStringChanged:function(){this._dontReact=!0,this.paramsObject=this._decodeParams(this.paramsString),this._dontReact=!1},paramsObjectChanged:function(){this._dontReact||(this.paramsString=this._encodeParams(this.paramsObject))},_encodeParams:function(e){var t=[];for(var r in e){var o=e[r];""===o?t.push(encodeURIComponent(r)):o&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(o.toString()))}return t.join("&")},_decodeParams:function(e){for(var t={},r=(e||"").split("&"),o=0;o<r.length;o++){var n=r[o].split("=");n[0]&&(t[decodeURIComponent(n[0])]=decodeURIComponent(n[1]||""))}return t}}),Polymer.AppRouteConverterBehavior={properties:{route:{type:Object,notify:!0},queryParams:{type:Object,notify:!0},path:{type:String,notify:!0}},observers:["_locationChanged(path, queryParams)","_routeChanged(route.prefix, route.path)","_routeQueryParamsChanged(route.__queryParams)"],created:function(){this.linkPaths("route.__queryParams","queryParams"),this.linkPaths("queryParams","route.__queryParams")},_locationChanged:function(){this.route&&this.route.path===this.path&&this.queryParams===this.route.__queryParams||(this.route={prefix:"",path:this.path,__queryParams:this.queryParams})},_routeChanged:function(){this.route&&(this.path=this.route.prefix+this.route.path)},_routeQueryParamsChanged:function(e){this.route&&(this.queryParams=e)}},Polymer({is:"app-location",properties:{route:{type:Object,notify:!0},useHashAsPath:{type:Boolean,value:!1},urlSpaceRegex:{type:String,notify:!0},__queryParams:{type:Object},__path:{type:String},__query:{type:String},__hash:{type:String},path:{type:String,observer:"__onPathChanged"}},behaviors:[Polymer.AppRouteConverterBehavior],observers:["__computeRoutePath(useHashAsPath, __hash, __path)"],__computeRoutePath:function(){this.path=this.useHashAsPath?this.__hash:this.__path},__onPathChanged:function(){this._readied&&(this.useHashAsPath?this.__hash=this.path:this.__path=this.path)}}),Polymer({is:"app-route-converter",behaviors:[Polymer.AppRouteConverterBehavior]}),Polymer.AppLayout=Polymer.AppLayout||{},Polymer.AppLayout._scrollEffects=Polymer.AppLayout._scrollEffects||{},Polymer.AppLayout.scrollTimingFunction=function(e,t,r,o){return e/=o,-r*e*(e-2)+t},Polymer.AppLayout.registerEffect=function(e,t){if(null!=Polymer.AppLayout._scrollEffects[e])throw new Error("effect `"+e+"` is already registered.");Polymer.AppLayout._scrollEffects[e]=t},Polymer.AppLayout.scroll=function(e){e=e||{};var t=document.documentElement,r=e.target||t,o="scrollBehavior"in r.style&&r.scroll,n="app-layout-silent-scroll",i=e.top||0,s=e.left||0,a=r===t?window.scrollTo:function(e,t){r.scrollLeft=e,r.scrollTop=t};if("smooth"===e.behavior)if(o)r.scroll(e);else{var l=Polymer.AppLayout.scrollTimingFunction,c=Date.now(),u=r===t?window.pageYOffset:r.scrollTop,h=r===t?window.pageXOffset:r.scrollLeft,f=i-u,p=s-h,d=300,g=function _(){var e=Date.now(),t=e-c;t<d?(a(l(t,h,p,d),l(t,u,f,d)),requestAnimationFrame(_)):a(s,i)}.bind(this);g()}else"silent"===e.behavior?(t.classList.add(n),clearInterval(Polymer.AppLayout._scrollTimer),Polymer.AppLayout._scrollTimer=setTimeout(function(){t.classList.remove(n),Polymer.AppLayout._scrollTimer=null},100),a(s,i)):a(s,i)},Polymer({is:"app-drawer",properties:{opened:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},persistent:{type:Boolean,value:!1,reflectToAttribute:!0},transitionDuration:{type:Number,value:200},align:{type:String,value:"left"},position:{type:String,readOnly:!0,reflectToAttribute:!0},swipeOpen:{type:Boolean,value:!1,reflectToAttribute:!0},noFocusTrap:{type:Boolean,value:!1}},observers:["resetLayout(position, isAttached)","_resetPosition(align, isAttached)","_styleTransitionDuration(transitionDuration)","_openedPersistentChanged(opened, persistent)"],_translateOffset:0,_trackDetails:null,_drawerState:0,_boundEscKeydownHandler:null,_firstTabStop:null,_lastTabStop:null,attached:function(){this._styleTransitionDuration(0),Polymer.RenderStatus.afterNextRender(this,function(){this._styleTransitionDuration(this.transitionDuration),this._boundEscKeydownHandler=this._escKeydownHandler.bind(this),this._resetDrawerState(),this.$.scrim.addEventListener("transitionend",this._transitionend.bind(this)),this.$.contentContainer.addEventListener("transitionend",this._transitionend.bind(this)),this.addEventListener("keydown",this._tabKeydownHandler.bind(this)),this.listen(this,"track","_track"),this.setScrollDirection("y")}),this.fire("app-drawer-attached")},detached:function(){document.removeEventListener("keydown",this._boundEscKeydownHandler)},open:function(){this.opened=!0},close:function(){this.opened=!1},toggle:function(){this.opened=!this.opened},getWidth:function(){return this.$.contentContainer.offsetWidth},resetLayout:function(){this.fire("app-drawer-reset-layout")},_isRTL:function(){return"rtl"===window.getComputedStyle(this).direction},_resetPosition:function(){switch(this.align){case"start":return void this._setPosition(this._isRTL()?"right":"left");case"end":return void this._setPosition(this._isRTL()?"left":"right")}this._setPosition(this.align)},_escKeydownHandler:function(e){var t=27;e.keyCode===t&&(e.preventDefault(),this.close())},_track:function(e){if(!this.persistent)switch(e.preventDefault(),e.detail.state){case"start":this._trackStart(e);break;case"track":this._trackMove(e);break;case"end":this._trackEnd(e)}},_trackStart:function(e){this._drawerState=this._DRAWER_STATE.TRACKING,this._styleTransitionDuration(0),this.style.visibility="visible";var t=this.$.contentContainer.getBoundingClientRect();"left"===this.position?this._translateOffset=t.left:this._translateOffset=t.right-window.innerWidth,this._trackDetails=[]},_trackMove:function(e){this._translateDrawer(e.detail.dx+this._translateOffset),this._trackDetails.push({dx:e.detail.dx,timeStamp:Date.now()})},_trackEnd:function(e){var t=e.detail.dx+this._translateOffset,r=this.getWidth(),o="left"===this.position,n=o?t>=0||t<=-r:t<=0||t>=r;if(!n){var i=this._trackDetails;if(this._trackDetails=null,this._flingDrawer(e,i),this._drawerState===this._DRAWER_STATE.FLINGING)return}var s=r/2;e.detail.dx<-s?this.opened="right"===this.position:e.detail.dx>s&&(this.opened="left"===this.position),n&&this._resetDrawerState(),this._styleTransitionDuration(this.transitionDuration),this._resetDrawerTranslate(),this.style.visibility=""},_calculateVelocity:function(e,t){for(var r,o=Date.now(),n=o-100,i=0,s=t.length-1;i<=s;){var a=i+s>>1,l=t[a];l.timeStamp>=n?(r=l,s=a-1):i=a+1}if(r){var c=e.detail.dx-r.dx,u=o-r.timeStamp||1;return c/u}return 0},_flingDrawer:function(e,t){var r=this._calculateVelocity(e,t);if(!(Math.abs(r)<this._MIN_FLING_THRESHOLD)){this._drawerState=this._DRAWER_STATE.FLINGING;var o,n=e.detail.dx+this._translateOffset,i=this.getWidth(),s="left"===this.position,a=r>0,l=!a&&s,c=a&&!s;o=l?-(n+i):c?i-n:-n,a?(r=Math.max(r,this._MIN_TRANSITION_VELOCITY),this.opened="left"===this.position):(r=Math.min(r,-this._MIN_TRANSITION_VELOCITY),this.opened="right"===this.position),this._styleTransitionDuration(this._FLING_INITIAL_SLOPE*o/r),this._styleTransitionTimingFunction(this._FLING_TIMING_FUNCTION),this._resetDrawerTranslate()}},_transitionend:function(){this._drawerState===this._DRAWER_STATE.FLINGING&&(this._styleTransitionDuration(this.transitionDuration),this._styleTransitionTimingFunction(""),this.style.visibility=""),this._resetDrawerState()},_styleTransitionDuration:function(e){this.style.transitionDuration=e+"ms",this.$.contentContainer.style.transitionDuration=e+"ms",this.$.scrim.style.transitionDuration=e+"ms"},_styleTransitionTimingFunction:function(e){this.$.contentContainer.style.transitionTimingFunction=e,this.$.scrim.style.transitionTimingFunction=e},_translateDrawer:function(e){var t=this.getWidth();"left"===this.position?(e=Math.max(-t,Math.min(e,0)),this.$.scrim.style.opacity=1+e/t):(e=Math.max(0,Math.min(e,t)),this.$.scrim.style.opacity=1-e/t),this.translate3d(e+"px","0","0",this.$.contentContainer)},_resetDrawerTranslate:function(){this.$.scrim.style.opacity="",this.transform("",this.$.contentContainer)},_resetDrawerState:function(){var e=this._drawerState;this.opened?this._drawerState=this.persistent?this._DRAWER_STATE.OPENED_PERSISTENT:this._DRAWER_STATE.OPENED:this._drawerState=this._DRAWER_STATE.CLOSED,e!==this._drawerState&&(this._drawerState===this._DRAWER_STATE.OPENED?(this._setKeyboardFocusTrap(),document.addEventListener("keydown",this._boundEscKeydownHandler),document.body.style.overflow="hidden"):(document.removeEventListener("keydown",this._boundEscKeydownHandler),document.body.style.overflow=""),e!==this._DRAWER_STATE.INIT&&this.fire("app-drawer-transitioned"))},_setKeyboardFocusTrap:function(){if(!this.noFocusTrap){var e=['a[href]:not([tabindex="-1"])','area[href]:not([tabindex="-1"])','input:not([disabled]):not([tabindex="-1"])','select:not([disabled]):not([tabindex="-1"])','textarea:not([disabled]):not([tabindex="-1"])','button:not([disabled]):not([tabindex="-1"])','iframe:not([tabindex="-1"])','[tabindex]:not([tabindex="-1"])','[contentEditable=true]:not([tabindex="-1"])'].join(","),t=Polymer.dom(this).querySelectorAll(e);t.length>0?(this._firstTabStop=t[0],this._lastTabStop=t[t.length-1]):(this._firstTabStop=null,this._lastTabStop=null);var r=this.getAttribute("tabindex");r&&parseInt(r,10)>-1?this.focus():this._firstTabStop&&this._firstTabStop.focus()}},_tabKeydownHandler:function(e){if(!this.noFocusTrap){var t=9;this._drawerState===this._DRAWER_STATE.OPENED&&e.keyCode===t&&(e.shiftKey?this._firstTabStop&&Polymer.dom(e).localTarget===this._firstTabStop&&(e.preventDefault(),this._lastTabStop.focus()):this._lastTabStop&&Polymer.dom(e).localTarget===this._lastTabStop&&(e.preventDefault(),this._firstTabStop.focus()))}},_openedPersistentChanged:function(){0===this.transitionDuration&&this._resetDrawerState()},_MIN_FLING_THRESHOLD:.2,_MIN_TRANSITION_VELOCITY:1.2,_FLING_TIMING_FUNCTION:"cubic-bezier(0.667, 1, 0.667, 1)",_FLING_INITIAL_SLOPE:1.5,_DRAWER_STATE:{INIT:0,OPENED:1,OPENED_PERSISTENT:2,CLOSED:3,TRACKING:4,FLINGING:5}}),Polymer({is:"iron-media-query",properties:{queryMatches:{type:Boolean,value:!1,readOnly:!0,notify:!0},query:{type:String,observer:"queryChanged"},full:{type:Boolean,value:!1},_boundMQHandler:{value:function(){return this.queryHandler.bind(this)}},_mq:{value:null}},attached:function(){this.style.display="none",this.queryChanged()},detached:function(){this._remove()},_add:function(){this._mq&&this._mq.addListener(this._boundMQHandler)},_remove:function(){this._mq&&this._mq.removeListener(this._boundMQHandler),this._mq=null},queryChanged:function(){this._remove();var e=this.query;e&&(this.full||"("===e[0]||(e="("+e+")"),this._mq=window.matchMedia(e),this._add(),this.queryHandler(this._mq))},queryHandler:function(e){this._setQueryMatches(e.matches)}}),Polymer.IronResizableBehavior={properties:{_parentResizable:{type:Object,observer:"_parentResizableChanged"},_notifyingDescendant:{type:Boolean,value:!1}},listeners:{"iron-request-resize-notifications":"_onIronRequestResizeNotifications"},created:function(){this._interestedResizables=[],this._boundNotifyResize=this.notifyResize.bind(this)},attached:function(){this.fire("iron-request-resize-notifications",null,{node:this,bubbles:!0,cancelable:!0}),this._parentResizable||(window.addEventListener("resize",this._boundNotifyResize),this.notifyResize())},detached:function(){this._parentResizable?this._parentResizable.stopResizeNotificationsFor(this):window.removeEventListener("resize",this._boundNotifyResize),this._parentResizable=null},notifyResize:function(){this.isAttached&&(this._interestedResizables.forEach(function(e){this.resizerShouldNotify(e)&&this._notifyDescendant(e)},this),this._fireResize())},assignParentResizable:function(e){this._parentResizable=e},stopResizeNotificationsFor:function(e){var t=this._interestedResizables.indexOf(e);t>-1&&(this._interestedResizables.splice(t,1),this.unlisten(e,"iron-resize","_onDescendantIronResize"))},resizerShouldNotify:function(e){return!0},_onDescendantIronResize:function(e){return this._notifyingDescendant?void e.stopPropagation():void(Polymer.Settings.useShadow||this._fireResize())},_fireResize:function(){this.fire("iron-resize",null,{node:this,bubbles:!1})},_onIronRequestResizeNotifications:function(e){var t=e.path?e.path[0]:e.target;t!==this&&(this._interestedResizables.indexOf(t)===-1&&(this._interestedResizables.push(t),this.listen(t,"iron-resize","_onDescendantIronResize")),t.assignParentResizable(this),this._notifyDescendant(t),e.stopPropagation())},_parentResizableChanged:function(e){e&&window.removeEventListener("resize",this._boundNotifyResize)},_notifyDescendant:function(e){this.isAttached&&(this._notifyingDescendant=!0,e.notifyResize(),this._notifyingDescendant=!1)}},Polymer({is:"app-drawer-layout",behaviors:[Polymer.IronResizableBehavior],properties:{forceNarrow:{type:Boolean,value:!1},responsiveWidth:{type:String,value:"640px"},narrow:{type:Boolean,readOnly:!0,notify:!0},openedWhenNarrow:{type:Boolean,value:!1}},listeners:{tap:"_tapHandler","app-drawer-attached":"_resetDrawerState","app-drawer-reset-layout":"resetLayout","iron-resize":"resetLayout"},observers:["resetLayout(narrow, isAttached)","_narrowChanged(narrow, isAttached)"],get drawer(){return Polymer.dom(this.$.drawerContent).getDistributedNodes()[0];
},_tapHandler:function(e){var t=Polymer.dom(e).localTarget;if(t&&t.hasAttribute("drawer-toggle")){var r=this.drawer;r&&!r.persistent&&r.toggle()}},resetLayout:function(){this.debounce("_resetLayout",function(){var e=this.drawer,t=this.$.contentContainer;if(this.narrow||!e)t.style.marginLeft="",t.style.marginRight="";else{var r=e.getWidth();"right"==e.position?(t.style.marginLeft="",t.style.marginRight=r+"px"):(t.style.marginLeft=r+"px",t.style.marginRight="")}})},_resetDrawerState:function(){this.debounce("_resetDrawerState",function(){var e=this.drawer;e&&(this.narrow?(e.opened=this.openedWhenNarrow,e.persistent=!1):e.opened=e.persistent=!0)})},_narrowChanged:function(e){this.toggleClass("narrow",e,this.$.contentContainer),this._resetDrawerState(),this.notifyResize()},_onQueryMatchesChanged:function(e){this._setNarrow(e.detail.value)},_computeMediaQuery:function(e,t){return e?"(min-width: 0px)":"(max-width: "+t+")"}}),Polymer.IronScrollTargetBehavior={properties:{scrollTarget:{type:HTMLElement,value:function(){return this._defaultScrollTarget}}},observers:["_scrollTargetChanged(scrollTarget, isAttached)"],_scrollTargetChanged:function(e,t){var r;this._oldScrollTarget&&(r=this._oldScrollTarget===this._doc?window:this._oldScrollTarget,r.removeEventListener("scroll",this._boundScrollHandler),this._oldScrollTarget=null),t&&("document"===e?this.scrollTarget=this._doc:"string"==typeof e?this.scrollTarget=this.domHost?this.domHost.$[e]:Polymer.dom(this.ownerDocument).querySelector("#"+e):this._isValidScrollTarget()&&(r=e===this._doc?window:e,this._boundScrollHandler=this._boundScrollHandler||this._scrollHandler.bind(this),this._oldScrollTarget=e,r.addEventListener("scroll",this._boundScrollHandler)))},_scrollHandler:function(){},get _defaultScrollTarget(){return this._doc},get _doc(){return this.ownerDocument.documentElement},get _scrollTop(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.pageYOffset:this.scrollTarget.scrollTop:0},get _scrollLeft(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.pageXOffset:this.scrollTarget.scrollLeft:0},set _scrollTop(e){this.scrollTarget===this._doc?window.scrollTo(window.pageXOffset,e):this._isValidScrollTarget()&&(this.scrollTarget.scrollTop=e)},set _scrollLeft(e){this.scrollTarget===this._doc?window.scrollTo(e,window.pageYOffset):this._isValidScrollTarget()&&(this.scrollTarget.scrollLeft=e)},scroll:function(e,t){this.scrollTarget===this._doc?window.scrollTo(e,t):this._isValidScrollTarget()&&(this.scrollTarget.scrollLeft=e,this.scrollTarget.scrollTop=t)},get _scrollTargetWidth(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.innerWidth:this.scrollTarget.offsetWidth:0},get _scrollTargetHeight(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.innerHeight:this.scrollTarget.offsetHeight:0},_isValidScrollTarget:function(){return this.scrollTarget instanceof HTMLElement}},Polymer.AppScrollEffectsBehavior=[Polymer.IronScrollTargetBehavior,{properties:{effects:{type:String},effectsConfig:{type:Object,value:function(){return{}}},disabled:{type:Boolean,reflectToAttribute:!0,value:!1},threshold:{type:Number,value:0},thresholdTriggered:{type:Boolean,notify:!0,readOnly:!0,reflectToAttribute:!0}},observers:["_effectsChanged(effects, effectsConfig, isAttached)"],_updateScrollState:function(){},isOnScreen:function(){return!1},isContentBelow:function(){return!1},_effectsRunFn:null,_effects:null,get _clampedScrollTop(){return Math.max(0,this._scrollTop)},detached:function(){this._tearDownEffects()},createEffect:function(e,t){var r=Polymer.AppLayout._scrollEffects[e];if(!r)throw new ReferenceError(this._getUndefinedMsg(e));var o=this._boundEffect(r,t||{});return o.setUp(),o},_effectsChanged:function(e,t,r){this._tearDownEffects(),""!==e&&r&&(e.split(" ").forEach(function(e){var r;""!==e&&((r=Polymer.AppLayout._scrollEffects[e])?this._effects.push(this._boundEffect(r,t[e])):this._warn(this._logf("_effectsChanged",this._getUndefinedMsg(e))))},this),this._setUpEffect())},_layoutIfDirty:function(){return this.offsetWidth},_boundEffect:function(e,t){t=t||{};var r=parseFloat(t.startsAt||0),o=parseFloat(t.endsAt||1),n=o-r,i=function(){},s=0===r&&1===o?e.run:function(t,o){e.run.call(this,Math.max(0,(t-r)/n),o)};return{setUp:e.setUp?e.setUp.bind(this,t):i,run:e.run?s.bind(this):i,tearDown:e.tearDown?e.tearDown.bind(this):i}},_setUpEffect:function(){this.isAttached&&this._effects&&(this._effectsRunFn=[],this._effects.forEach(function(e){e.setUp()!==!1&&this._effectsRunFn.push(e.run)},this))},_tearDownEffects:function(){this._effects&&this._effects.forEach(function(e){e.tearDown()}),this._effectsRunFn=[],this._effects=[]},_runEffects:function(e,t){this._effectsRunFn&&this._effectsRunFn.forEach(function(r){r(e,t)})},_scrollHandler:function(){if(!this.disabled){var e=this._clampedScrollTop;this._updateScrollState(e),this.threshold>0&&this._setThresholdTriggered(e>=this.threshold)}},_getDOMRef:function(e){this._warn(this._logf("_getDOMRef","`"+e+"` is undefined"))},_getUndefinedMsg:function(e){return"Scroll effect `"+e+"` is undefined. Did you forget to import app-layout/app-scroll-effects/effects/"+e+".html ?"}}],Polymer({is:"app-header",behaviors:[Polymer.AppScrollEffectsBehavior,Polymer.IronResizableBehavior],properties:{condenses:{type:Boolean,value:!1},fixed:{type:Boolean,value:!1},reveals:{type:Boolean,value:!1},shadow:{type:Boolean,reflectToAttribute:!0,value:!1}},observers:["resetLayout(isAttached, condenses, fixed)"],listeners:{"iron-resize":"_resizeHandler"},_height:0,_dHeight:0,_stickyElTop:0,_stickyEl:null,_top:0,_progress:0,_wasScrollingDown:!1,_initScrollTop:0,_initTimestamp:0,_lastTimestamp:0,_lastScrollTop:0,get _maxHeaderTop(){return this.fixed?this._dHeight:this._height+5},_getStickyEl:function(){for(var e,t=Polymer.dom(this.$.content).getDistributedNodes(),r=0;r<t.length;r++)if(t[r].nodeType===Node.ELEMENT_NODE){var o=t[r];if(o.hasAttribute("sticky")){e=o;break}e||(e=o)}return e},resetLayout:function(){this.fire("app-header-reset-layout"),this.debounce("_resetLayout",function(){if(0!==this.offsetWidth||0!==this.offsetHeight){var e=this._clampedScrollTop,t=0===this._height||0===e,r=this.disabled;this._height=this.offsetHeight,this._stickyEl=this._getStickyEl(),this.disabled=!0,t||this._updateScrollState(0,!0),this._mayMove()?this._dHeight=this._stickyEl?this._height-this._stickyEl.offsetHeight:0:this._dHeight=0,this._stickyElTop=this._stickyEl?this._stickyEl.offsetTop:0,this._setUpEffect(),t?this._updateScrollState(e,!0):(this._updateScrollState(this._lastScrollTop,!0),this._layoutIfDirty()),this.disabled=r}})},_updateScrollState:function(e,t){if(0!==this._height){var r=0,o=0,n=this._top,i=(this._lastScrollTop,this._maxHeaderTop),s=e-this._lastScrollTop,a=Math.abs(s),l=e>this._lastScrollTop,c=Date.now();if(this._mayMove()&&(o=this._clamp(this.reveals?n+s:e,0,i)),e>=this._dHeight&&(o=this.condenses&&!this.fixed?Math.max(this._dHeight,o):o,this.style.transitionDuration="0ms"),this.reveals&&!this.disabled&&a<100&&((c-this._initTimestamp>300||this._wasScrollingDown!==l)&&(this._initScrollTop=e,this._initTimestamp=c),e>=i))if(Math.abs(this._initScrollTop-e)>30||a>10){l&&e>=i?o=i:!l&&e>=this._dHeight&&(o=this.condenses&&!this.fixed?this._dHeight:0);var u=s/(c-this._lastTimestamp);this.style.transitionDuration=this._clamp((o-n)/u,0,300)+"ms"}else o=this._top;r=0===this._dHeight?e>0?1:0:o/this._dHeight,t||(this._lastScrollTop=e,this._top=o,this._wasScrollingDown=l,this._lastTimestamp=c),(t||r!==this._progress||n!==o||0===e)&&(this._progress=r,this._runEffects(r,o),this._transformHeader(o))}},_mayMove:function(){return this.condenses||!this.fixed},willCondense:function(){return this._dHeight>0&&this.condenses},isOnScreen:function(){return 0!==this._height&&this._top<this._height},isContentBelow:function(){return 0===this._top?this._clampedScrollTop>0:this._clampedScrollTop-this._maxHeaderTop>=0},_transformHeader:function(e){this.translate3d(0,-e+"px",0),this._stickyEl&&this.condenses&&e>=this._stickyElTop&&this.translate3d(0,Math.min(e,this._dHeight)-this._stickyElTop+"px",0,this._stickyEl)},_resizeHandler:function(){this.resetLayout()},_clamp:function(e,t,r){return Math.min(r,Math.max(t,e))},_ensureBgContainers:function(){this._bgContainer||(this._bgContainer=document.createElement("div"),this._bgContainer.id="background",this._bgRear=document.createElement("div"),this._bgRear.id="backgroundRearLayer",this._bgContainer.appendChild(this._bgRear),this._bgFront=document.createElement("div"),this._bgFront.id="backgroundFrontLayer",this._bgContainer.appendChild(this._bgFront),Polymer.dom(this.root).insertBefore(this._bgContainer,this.$.contentContainer))},_getDOMRef:function(e){switch(e){case"backgroundFrontLayer":return this._ensureBgContainers(),this._bgFront;case"backgroundRearLayer":return this._ensureBgContainers(),this._bgRear;case"background":return this._ensureBgContainers(),this._bgContainer;case"mainTitle":return Polymer.dom(this).querySelector("[main-title]");case"condensedTitle":return Polymer.dom(this).querySelector("[condensed-title]")}return null},getScrollState:function(){return{progress:this._progress,top:this._top}}}),Polymer({is:"app-header-layout",behaviors:[Polymer.IronResizableBehavior],properties:{hasScrollingRegion:{type:Boolean,value:!1,reflectToAttribute:!0}},listeners:{"iron-resize":"_resizeHandler","app-header-reset-layout":"resetLayout"},observers:["resetLayout(isAttached, hasScrollingRegion)"],get header(){return Polymer.dom(this.$.header).getDistributedNodes()[0]},resetLayout:function(){this._updateScroller(),this.debounce("_resetLayout",this._updateContentPosition)},_updateContentPosition:function(){var e=this.header;if(this.isAttached&&e){var t=e.offsetHeight;if(this.hasScrollingRegion)e.style.left="",e.style.right="";else{var r=this.getBoundingClientRect(),o=document.documentElement.clientWidth-r.right;e.style.left=r.left+"px",e.style.right=o+"px"}var n=this.$.contentContainer.style;e.fixed&&!e.willCondense()&&this.hasScrollingRegion?(n.marginTop=t+"px",n.paddingTop=""):(n.paddingTop=t+"px",n.marginTop="")}},_updateScroller:function(){if(this.isAttached){var e=this.header;e&&(e.scrollTarget=this.hasScrollingRegion?this.$.contentContainer:this.ownerDocument.documentElement)}},_resizeHandler:function(){this.resetLayout()}}),Polymer({is:"app-scrollpos-control",behaviors:[Polymer.IronScrollTargetBehavior],properties:{selected:{type:String,observer:"_selectedChanged"},reset:{type:Boolean,value:!1}},observers:["_updateScrollPos(selected, reset)"],created:function(){this._scrollposMap={}},_selectedChanged:function(e,t){null!=t&&(this._scrollposMap[t]={x:this._scrollLeft,y:this._scrollTop})},_updateScrollPos:function(e,t){this.debounce("_updateScrollPos",function(){var e=this._scrollposMap[this.selected];null==e||this.reset?this.scroll(0,0):this.scroll(e.x,e.y)})}}),Polymer({is:"app-toolbar"}),Polymer({is:"app-box",behaviors:[Polymer.AppScrollEffectsBehavior,Polymer.IronResizableBehavior],listeners:{"iron-resize":"_resizeHandler"},_progress:0,attached:function(){this.resetLayout()},resetLayout:function(){this.debounce("_resetLayout",function(){if(0!==this.offsetWidth||0!==this.offsetHeight){var e=this._clampedScrollTop,t=this.disabled;this.disabled=!0,this._elementTop=this._getElementTop(),this._elementHeight=this.offsetHeight,this._cachedScrollTargetHeight=this._scrollTargetHeight,this._setUpEffect(),this._updateScrollState(e),this.disabled=t}},1)},_getElementTop:function(){for(var e=this,t=0;e&&e!==this.scrollTarget;)t+=e.offsetTop,e=e.offsetParent;return t},_updateScrollState:function(e){if(this.isOnScreen()){var t=this._elementTop-e;this._progress=1-(t+this._elementHeight)/this._cachedScrollTargetHeight,this._runEffects(this._progress,e)}},isOnScreen:function(){return this._elementTop<this._scrollTop+this._cachedScrollTargetHeight&&this._elementTop+this._elementHeight>this._scrollTop},_resizeHandler:function(){this.resetLayout()},_getDOMRef:function(e){return"background"===e?this.$.background:"backgroundFrontLayer"===e?this.$.backgroundFrontLayer:void 0},getScrollState:function(){return{progress:this._progress}}}),function(){var e={},t={},r=null;Polymer.IronMeta=Polymer({is:"iron-meta",properties:{type:{type:String,value:"default",observer:"_typeChanged"},key:{type:String,observer:"_keyChanged"},value:{type:Object,notify:!0,observer:"_valueChanged"},self:{type:Boolean,observer:"_selfChanged"},list:{type:Array,notify:!0}},hostAttributes:{hidden:!0},factoryImpl:function(e){if(e)for(var t in e)switch(t){case"type":case"key":case"value":this[t]=e[t]}},created:function(){this._metaDatas=e,this._metaArrays=t},_keyChanged:function(e,t){this._resetRegistration(t)},_valueChanged:function(e){this._resetRegistration(this.key)},_selfChanged:function(e){e&&(this.value=this)},_typeChanged:function(r){this._unregisterKey(this.key),e[r]||(e[r]={}),this._metaData=e[r],t[r]||(t[r]=[]),this.list=t[r],this._registerKeyValue(this.key,this.value)},byKey:function(e){return this._metaData&&this._metaData[e]},_resetRegistration:function(e){this._unregisterKey(e),this._registerKeyValue(this.key,this.value)},_unregisterKey:function(e){this._unregister(e,this._metaData,this.list)},_registerKeyValue:function(e,t){this._register(e,t,this._metaData,this.list)},_register:function(e,t,r,o){e&&r&&void 0!==t&&(r[e]=t,o.push(t))},_unregister:function(e,t,r){if(e&&t&&e in t){var o=t[e];delete t[e],this.arrayDelete(r,o)}}}),Polymer.IronMeta.getIronMeta=function(){return null===r&&(r=new Polymer.IronMeta),r},Polymer.IronMetaQuery=Polymer({is:"iron-meta-query",properties:{type:{type:String,value:"default",observer:"_typeChanged"},key:{type:String,observer:"_keyChanged"},value:{type:Object,notify:!0,readOnly:!0},list:{type:Array,notify:!0}},factoryImpl:function(e){if(e)for(var t in e)switch(t){case"type":case"key":this[t]=e[t]}},created:function(){this._metaDatas=e,this._metaArrays=t},_keyChanged:function(e){this._setValue(this._metaData&&this._metaData[e])},_typeChanged:function(r){this._metaData=e[r],this.list=t[r],this.key&&this._keyChanged(this.key)},byKey:function(e){return this._metaData&&this._metaData[e]}})}(),Polymer({is:"iron-icon",properties:{icon:{type:String,observer:"_iconChanged"},theme:{type:String,observer:"_updateIcon"},src:{type:String,observer:"_srcChanged"},_meta:{value:Polymer.Base.create("iron-meta",{type:"iconset"}),observer:"_updateIcon"}},_DEFAULT_ICONSET:"icons",_iconChanged:function(e){var t=(e||"").split(":");this._iconName=t.pop(),this._iconsetName=t.pop()||this._DEFAULT_ICONSET,this._updateIcon()},_srcChanged:function(e){this._updateIcon()},_usesIconset:function(){return this.icon||!this.src},_updateIcon:function(){this._usesIconset()?(this._img&&this._img.parentNode&&Polymer.dom(this.root).removeChild(this._img),""===this._iconName?this._iconset&&this._iconset.removeIcon(this):this._iconsetName&&this._meta&&(this._iconset=this._meta.byKey(this._iconsetName),this._iconset?(this._iconset.applyIcon(this,this._iconName,this.theme),this.unlisten(window,"iron-iconset-added","_updateIcon")):this.listen(window,"iron-iconset-added","_updateIcon"))):(this._iconset&&this._iconset.removeIcon(this),this._img||(this._img=document.createElement("img"),this._img.style.width="100%",this._img.style.height="100%",this._img.draggable=!1),this._img.src=this.src,Polymer.dom(this.root).appendChild(this._img))}}),Polymer({is:"iron-iconset-svg",properties:{name:{type:String,observer:"_nameChanged"},size:{type:Number,value:24}},attached:function(){this.style.display="none"},getIconNames:function(){return this._icons=this._createIconMap(),Object.keys(this._icons).map(function(e){return this.name+":"+e},this)},applyIcon:function(e,t){e=e.root||e,this.removeIcon(e);var r=this._cloneIcon(t);if(r){var o=Polymer.dom(e);return o.insertBefore(r,o.childNodes[0]),e._svgIcon=r}return null},removeIcon:function(e){e._svgIcon&&(Polymer.dom(e).removeChild(e._svgIcon),e._svgIcon=null)},_nameChanged:function(){new Polymer.IronMeta({type:"iconset",key:this.name,value:this}),this.async(function(){this.fire("iron-iconset-added",this,{node:window})})},_createIconMap:function(){var e=Object.create(null);return Polymer.dom(this).querySelectorAll("[id]").forEach(function(t){e[t.id]=t}),e},_cloneIcon:function(e){return this._icons=this._icons||this._createIconMap(),this._prepareSvgClone(this._icons[e],this.size)},_prepareSvgClone:function(e,t){if(e){var r=e.cloneNode(!0),o=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=r.getAttribute("viewBox")||"0 0 "+t+" "+t;return o.setAttribute("viewBox",n),o.setAttribute("preserveAspectRatio","xMidYMid meet"),o.style.cssText="pointer-events: none; display: block; width: 100%; height: 100%;",o.appendChild(r).removeAttribute("id"),o}return null}}),Polymer.IronSelection=function(e){this.selection=[],this.selectCallback=e},Polymer.IronSelection.prototype={get:function(){return this.multi?this.selection.slice():this.selection[0]},clear:function(e){this.selection.slice().forEach(function(t){(!e||e.indexOf(t)<0)&&this.setItemSelected(t,!1)},this)},isSelected:function(e){return this.selection.indexOf(e)>=0},setItemSelected:function(e,t){if(null!=e&&t!==this.isSelected(e)){if(t)this.selection.push(e);else{var r=this.selection.indexOf(e);r>=0&&this.selection.splice(r,1)}this.selectCallback&&this.selectCallback(e,t)}},select:function(e){this.multi?this.toggle(e):this.get()!==e&&(this.setItemSelected(this.get(),!1),this.setItemSelected(e,!0))},toggle:function(e){this.setItemSelected(e,!this.isSelected(e))}},Polymer.IronSelectableBehavior={properties:{attrForSelected:{type:String,value:null},selected:{type:String,notify:!0},selectedItem:{type:Object,readOnly:!0,notify:!0},activateEvent:{type:String,value:"tap",observer:"_activateEventChanged"},selectable:String,selectedClass:{type:String,value:"iron-selected"},selectedAttribute:{type:String,value:null},fallbackSelection:{type:String,value:null},items:{type:Array,readOnly:!0,notify:!0,value:function(){return[]}},_excludedLocalNames:{type:Object,value:function(){return{template:1}}}},observers:["_updateAttrForSelected(attrForSelected)","_updateSelected(selected)","_checkFallback(fallbackSelection)"],created:function(){this._bindFilterItem=this._filterItem.bind(this),this._selection=new Polymer.IronSelection(this._applySelection.bind(this))},attached:function(){this._observer=this._observeItems(this),this._updateItems(),this._shouldUpdateSelection||this._updateSelected(),this._addListener(this.activateEvent)},detached:function(){this._observer&&Polymer.dom(this).unobserveNodes(this._observer),this._removeListener(this.activateEvent)},indexOf:function(e){return this.items.indexOf(e)},select:function(e){this.selected=e},selectPrevious:function(){var e=this.items.length,t=(Number(this._valueToIndex(this.selected))-1+e)%e;this.selected=this._indexToValue(t)},selectNext:function(){var e=(Number(this._valueToIndex(this.selected))+1)%this.items.length;this.selected=this._indexToValue(e)},selectIndex:function(e){this.select(this._indexToValue(e))},forceSynchronousItemUpdate:function(){this._updateItems()},get _shouldUpdateSelection(){return null!=this.selected},_checkFallback:function(){this._shouldUpdateSelection&&this._updateSelected()},_addListener:function(e){this.listen(this,e,"_activateHandler")},_removeListener:function(e){this.unlisten(this,e,"_activateHandler")},_activateEventChanged:function(e,t){this._removeListener(t),this._addListener(e)},_updateItems:function(){var e=Polymer.dom(this).queryDistributedElements(this.selectable||"*");e=Array.prototype.filter.call(e,this._bindFilterItem),this._setItems(e)},_updateAttrForSelected:function(){this._shouldUpdateSelection&&(this.selected=this._indexToValue(this.indexOf(this.selectedItem)))},_updateSelected:function(){this._selectSelected(this.selected)},_selectSelected:function(e){this._selection.select(this._valueToItem(this.selected)),this.fallbackSelection&&this.items.length&&void 0===this._selection.get()&&(this.selected=this.fallbackSelection)},_filterItem:function(e){return!this._excludedLocalNames[e.localName]},_valueToItem:function(e){return null==e?null:this.items[this._valueToIndex(e)]},_valueToIndex:function(e){if(!this.attrForSelected)return Number(e);for(var t,r=0;t=this.items[r];r++)if(this._valueForItem(t)==e)return r},_indexToValue:function(e){if(!this.attrForSelected)return e;var t=this.items[e];return t?this._valueForItem(t):void 0},_valueForItem:function(e){var t=e[Polymer.CaseMap.dashToCamelCase(this.attrForSelected)];return void 0!=t?t:e.getAttribute(this.attrForSelected)},_applySelection:function(e,t){this.selectedClass&&this.toggleClass(this.selectedClass,t,e),this.selectedAttribute&&this.toggleAttribute(this.selectedAttribute,t,e),this._selectionChange(),this.fire("iron-"+(t?"select":"deselect"),{item:e})},_selectionChange:function(){this._setSelectedItem(this._selection.get())},_observeItems:function(e){return Polymer.dom(e).observeNodes(function(e){this._updateItems(),this._shouldUpdateSelection&&this._updateSelected(),this.fire("iron-items-changed",e,{bubbles:!1,cancelable:!1})})},_activateHandler:function(e){for(var t=e.target,r=this.items;t&&t!=this;){var o=r.indexOf(t);if(o>=0){var n=this._indexToValue(o);return void this._itemActivate(n,t)}t=t.parentNode}},_itemActivate:function(e,t){this.fire("iron-activate",{selected:e,item:t},{cancelable:!0}).defaultPrevented||this.select(e)}},Polymer({is:"iron-pages",behaviors:[Polymer.IronResizableBehavior,Polymer.IronSelectableBehavior],properties:{activateEvent:{type:String,value:null}},observers:["_selectedPageChanged(selected)"],_selectedPageChanged:function(e,t){this.async(this.notifyResize)}}),function(){function e(e,r){var o=new CustomEvent("iron-signal-"+e,{bubbles:!1,detail:r});t.forEach(function(e){e.dispatchEvent(o)})}Polymer({is:"iron-signals",attached:function(){t.push(this)},detached:function(){var e=t.indexOf(this);e>=0&&t.splice(e,1)}});var t=[];document.addEventListener("iron-signal",function(t){e(t.detail.name,t.detail.data)})}(),function(){"use strict";function e(e,t){var r="";if(e){var o=e.toLowerCase();" "===o||p.test(o)?r="space":d.test(o)?r="esc":1==o.length?t&&!u.test(o)||(r=o):r=f.test(o)?o.replace("arrow",""):"multiply"==o?"*":o}return r}function t(e){var t="";return e&&(e in a?t=a[e]:h.test(e)?(e=parseInt(e.replace("U+","0x"),16),t=String.fromCharCode(e).toLowerCase()):t=e.toLowerCase()),t}function r(e){var t="";return Number(e)&&(t=e>=65&&e<=90?String.fromCharCode(32+e):e>=112&&e<=123?"f"+(e-112):e>=48&&e<=57?String(e-48):e>=96&&e<=105?String(e-96):l[e]),t}function o(o,n){return e(o.key,n)||t(o.keyIdentifier)||r(o.keyCode)||e(o.detail?o.detail.key:o.detail,n)||""}function n(e,t){var r=o(t,e.hasModifiers);return r===e.key&&(!e.hasModifiers||!!t.shiftKey==!!e.shiftKey&&!!t.ctrlKey==!!e.ctrlKey&&!!t.altKey==!!e.altKey&&!!t.metaKey==!!e.metaKey)}function i(e){return 1===e.length?{combo:e,key:e,event:"keydown"}:e.split("+").reduce(function(e,t){var r=t.split(":"),o=r[0],n=r[1];return o in c?(e[c[o]]=!0,e.hasModifiers=!0):(e.key=o,e.event=n||"keydown"),e},{combo:e.split(":").shift()})}function s(e){return e.trim().split(" ").map(function(e){return i(e)})}var a={"U+0008":"backspace","U+0009":"tab","U+001B":"esc","U+0020":"space","U+007F":"del"},l={8:"backspace",9:"tab",13:"enter",27:"esc",33:"pageup",34:"pagedown",35:"end",36:"home",32:"space",37:"left",38:"up",39:"right",40:"down",46:"del",106:"*"},c={shift:"shiftKey",ctrl:"ctrlKey",alt:"altKey",meta:"metaKey"},u=/[a-z0-9*]/,h=/U\+/,f=/^arrow/,p=/^space(bar)?/,d=/^escape$/;Polymer.IronA11yKeysBehavior={properties:{keyEventTarget:{type:Object,value:function(){return this}},stopKeyboardEventPropagation:{type:Boolean,value:!1},_boundKeyHandlers:{type:Array,value:function(){return[]}},_imperativeKeyBindings:{type:Object,value:function(){return{}}}},observers:["_resetKeyEventListeners(keyEventTarget, _boundKeyHandlers)"],keyBindings:{},registered:function(){this._prepKeyBindings()},attached:function(){this._listenKeyEventListeners()},detached:function(){this._unlistenKeyEventListeners()},addOwnKeyBinding:function(e,t){this._imperativeKeyBindings[e]=t,this._prepKeyBindings(),this._resetKeyEventListeners()},removeOwnKeyBindings:function(){this._imperativeKeyBindings={},this._prepKeyBindings(),this._resetKeyEventListeners()},keyboardEventMatchesKeys:function(e,t){for(var r=s(t),o=0;o<r.length;++o)if(n(r[o],e))return!0;return!1},_collectKeyBindings:function(){var e=this.behaviors.map(function(e){return e.keyBindings});return e.indexOf(this.keyBindings)===-1&&e.push(this.keyBindings),e},_prepKeyBindings:function(){this._keyBindings={},this._collectKeyBindings().forEach(function(e){for(var t in e)this._addKeyBinding(t,e[t])},this);for(var e in this._imperativeKeyBindings)this._addKeyBinding(e,this._imperativeKeyBindings[e]);for(var t in this._keyBindings)this._keyBindings[t].sort(function(e,t){var r=e[0].hasModifiers,o=t[0].hasModifiers;return r===o?0:r?-1:1})},_addKeyBinding:function(e,t){s(e).forEach(function(e){this._keyBindings[e.event]=this._keyBindings[e.event]||[],this._keyBindings[e.event].push([e,t])},this)},_resetKeyEventListeners:function(){this._unlistenKeyEventListeners(),this.isAttached&&this._listenKeyEventListeners()},_listenKeyEventListeners:function(){this.keyEventTarget&&Object.keys(this._keyBindings).forEach(function(e){var t=this._keyBindings[e],r=this._onKeyBindingEvent.bind(this,t);this._boundKeyHandlers.push([this.keyEventTarget,e,r]),this.keyEventTarget.addEventListener(e,r)},this)},_unlistenKeyEventListeners:function(){for(var e,t,r,o;this._boundKeyHandlers.length;)e=this._boundKeyHandlers.pop(),t=e[0],r=e[1],o=e[2],t.removeEventListener(r,o)},_onKeyBindingEvent:function(e,t){if(this.stopKeyboardEventPropagation&&t.stopPropagation(),!t.defaultPrevented)for(var r=0;r<e.length;r++){var o=e[r][0],i=e[r][1];if(n(o,t)&&(this._triggerKeyHandler(o,i,t),t.defaultPrevented))return}},_triggerKeyHandler:function(e,t,r){var o=Object.create(e);o.keyboardEvent=r;var n=new CustomEvent(e.event,{detail:o,cancelable:!0});this[t].call(this,n),n.defaultPrevented&&r.preventDefault()}}}(),Polymer.IronControlState={properties:{focused:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},disabled:{type:Boolean,value:!1,notify:!0,observer:"_disabledChanged",reflectToAttribute:!0},_oldTabIndex:{type:Number},_boundFocusBlurHandler:{type:Function,value:function(){return this._focusBlurHandler.bind(this)}}},observers:["_changedControlState(focused, disabled)"],ready:function(){this.addEventListener("focus",this._boundFocusBlurHandler,!0),this.addEventListener("blur",this._boundFocusBlurHandler,!0)},_focusBlurHandler:function(e){if(e.target===this)this._setFocused("focus"===e.type);else if(!this.shadowRoot){var t=Polymer.dom(e).localTarget;this.isLightDescendant(t)||this.fire(e.type,{sourceEvent:e},{node:this,bubbles:e.bubbles,cancelable:e.cancelable})}},_disabledChanged:function(e,t){this.setAttribute("aria-disabled",e?"true":"false"),this.style.pointerEvents=e?"none":"",e?(this._oldTabIndex=this.tabIndex,this._setFocused(!1),this.tabIndex=-1,this.blur()):void 0!==this._oldTabIndex&&(this.tabIndex=this._oldTabIndex)},_changedControlState:function(){this._controlStateChanged&&this._controlStateChanged()}},Polymer.IronButtonStateImpl={properties:{pressed:{type:Boolean,readOnly:!0,value:!1,reflectToAttribute:!0,observer:"_pressedChanged"},toggles:{type:Boolean,value:!1,reflectToAttribute:!0},active:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},pointerDown:{type:Boolean,readOnly:!0,value:!1},receivedFocusFromKeyboard:{type:Boolean,readOnly:!0},ariaActiveAttribute:{type:String,value:"aria-pressed",observer:"_ariaActiveAttributeChanged"}},listeners:{down:"_downHandler",up:"_upHandler",tap:"_tapHandler"},observers:["_detectKeyboardFocus(focused)","_activeChanged(active, ariaActiveAttribute)"],keyBindings:{"enter:keydown":"_asyncClick","space:keydown":"_spaceKeyDownHandler","space:keyup":"_spaceKeyUpHandler"},_mouseEventRe:/^mouse/,_tapHandler:function(){this.toggles?this._userActivate(!this.active):this.active=!1},_detectKeyboardFocus:function(e){this._setReceivedFocusFromKeyboard(!this.pointerDown&&e)},_userActivate:function(e){this.active!==e&&(this.active=e,this.fire("change"))},_downHandler:function(e){this._setPointerDown(!0),this._setPressed(!0),this._setReceivedFocusFromKeyboard(!1)},_upHandler:function(){this._setPointerDown(!1),this._setPressed(!1)},_spaceKeyDownHandler:function(e){var t=e.detail.keyboardEvent,r=Polymer.dom(t).localTarget;this.isLightDescendant(r)||(t.preventDefault(),t.stopImmediatePropagation(),this._setPressed(!0))},_spaceKeyUpHandler:function(e){var t=e.detail.keyboardEvent,r=Polymer.dom(t).localTarget;this.isLightDescendant(r)||(this.pressed&&this._asyncClick(),this._setPressed(!1))},_asyncClick:function(){this.async(function(){this.click()},1)},_pressedChanged:function(e){this._changedButtonState()},_ariaActiveAttributeChanged:function(e,t){t&&t!=e&&this.hasAttribute(t)&&this.removeAttribute(t)},_activeChanged:function(e,t){this.toggles?this.setAttribute(this.ariaActiveAttribute,e?"true":"false"):this.removeAttribute(this.ariaActiveAttribute),this._changedButtonState()},_controlStateChanged:function(){this.disabled?this._setPressed(!1):this._changedButtonState()},_changedButtonState:function(){this._buttonStateChanged&&this._buttonStateChanged()}},Polymer.IronButtonState=[Polymer.IronA11yKeysBehavior,Polymer.IronButtonStateImpl],function(){function e(e){this.element=e,this.width=this.boundingRect.width,this.height=this.boundingRect.height,this.size=Math.max(this.width,this.height)}function t(e){this.element=e,this.color=window.getComputedStyle(e).color,this.wave=document.createElement("div"),this.waveContainer=document.createElement("div"),this.wave.style.backgroundColor=this.color,this.wave.classList.add("wave"),this.waveContainer.classList.add("wave-container"),Polymer.dom(this.waveContainer).appendChild(this.wave),this.resetInteractionState()}var r={distance:function(e,t,r,o){var n=e-r,i=t-o;return Math.sqrt(n*n+i*i)},now:window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now};e.prototype={get boundingRect(){return this.element.getBoundingClientRect()},furthestCornerDistanceFrom:function(e,t){var o=r.distance(e,t,0,0),n=r.distance(e,t,this.width,0),i=r.distance(e,t,0,this.height),s=r.distance(e,t,this.width,this.height);return Math.max(o,n,i,s)}},t.MAX_RADIUS=300,t.prototype={get recenters(){return this.element.recenters},get center(){return this.element.center},get mouseDownElapsed(){var e;return this.mouseDownStart?(e=r.now()-this.mouseDownStart,this.mouseUpStart&&(e-=this.mouseUpElapsed),e):0},get mouseUpElapsed(){return this.mouseUpStart?r.now()-this.mouseUpStart:0},get mouseDownElapsedSeconds(){return this.mouseDownElapsed/1e3},get mouseUpElapsedSeconds(){return this.mouseUpElapsed/1e3},get mouseInteractionSeconds(){return this.mouseDownElapsedSeconds+this.mouseUpElapsedSeconds},get initialOpacity(){return this.element.initialOpacity},get opacityDecayVelocity(){return this.element.opacityDecayVelocity},get radius(){var e=this.containerMetrics.width*this.containerMetrics.width,r=this.containerMetrics.height*this.containerMetrics.height,o=1.1*Math.min(Math.sqrt(e+r),t.MAX_RADIUS)+5,n=1.1-.2*(o/t.MAX_RADIUS),i=this.mouseInteractionSeconds/n,s=o*(1-Math.pow(80,-i));return Math.abs(s)},get opacity(){return this.mouseUpStart?Math.max(0,this.initialOpacity-this.mouseUpElapsedSeconds*this.opacityDecayVelocity):this.initialOpacity},get outerOpacity(){var e=.3*this.mouseUpElapsedSeconds,t=this.opacity;return Math.max(0,Math.min(e,t))},get isOpacityFullyDecayed(){return this.opacity<.01&&this.radius>=Math.min(this.maxRadius,t.MAX_RADIUS)},get isRestingAtMaxRadius(){return this.opacity>=this.initialOpacity&&this.radius>=Math.min(this.maxRadius,t.MAX_RADIUS)},get isAnimationComplete(){return this.mouseUpStart?this.isOpacityFullyDecayed:this.isRestingAtMaxRadius;
},get translationFraction(){return Math.min(1,this.radius/this.containerMetrics.size*2/Math.sqrt(2))},get xNow(){return this.xEnd?this.xStart+this.translationFraction*(this.xEnd-this.xStart):this.xStart},get yNow(){return this.yEnd?this.yStart+this.translationFraction*(this.yEnd-this.yStart):this.yStart},get isMouseDown(){return this.mouseDownStart&&!this.mouseUpStart},resetInteractionState:function(){this.maxRadius=0,this.mouseDownStart=0,this.mouseUpStart=0,this.xStart=0,this.yStart=0,this.xEnd=0,this.yEnd=0,this.slideDistance=0,this.containerMetrics=new e(this.element)},draw:function(){var e,t,r;this.wave.style.opacity=this.opacity,e=this.radius/(this.containerMetrics.size/2),t=this.xNow-this.containerMetrics.width/2,r=this.yNow-this.containerMetrics.height/2,this.waveContainer.style.webkitTransform="translate("+t+"px, "+r+"px)",this.waveContainer.style.transform="translate3d("+t+"px, "+r+"px, 0)",this.wave.style.webkitTransform="scale("+e+","+e+")",this.wave.style.transform="scale3d("+e+","+e+",1)"},downAction:function(e){var t=this.containerMetrics.width/2,o=this.containerMetrics.height/2;this.resetInteractionState(),this.mouseDownStart=r.now(),this.center?(this.xStart=t,this.yStart=o,this.slideDistance=r.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)):(this.xStart=e?e.detail.x-this.containerMetrics.boundingRect.left:this.containerMetrics.width/2,this.yStart=e?e.detail.y-this.containerMetrics.boundingRect.top:this.containerMetrics.height/2),this.recenters&&(this.xEnd=t,this.yEnd=o,this.slideDistance=r.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)),this.maxRadius=this.containerMetrics.furthestCornerDistanceFrom(this.xStart,this.yStart),this.waveContainer.style.top=(this.containerMetrics.height-this.containerMetrics.size)/2+"px",this.waveContainer.style.left=(this.containerMetrics.width-this.containerMetrics.size)/2+"px",this.waveContainer.style.width=this.containerMetrics.size+"px",this.waveContainer.style.height=this.containerMetrics.size+"px"},upAction:function(e){this.isMouseDown&&(this.mouseUpStart=r.now())},remove:function(){Polymer.dom(this.waveContainer.parentNode).removeChild(this.waveContainer)}},Polymer({is:"paper-ripple",behaviors:[Polymer.IronA11yKeysBehavior],properties:{initialOpacity:{type:Number,value:.25},opacityDecayVelocity:{type:Number,value:.8},recenters:{type:Boolean,value:!1},center:{type:Boolean,value:!1},ripples:{type:Array,value:function(){return[]}},animating:{type:Boolean,readOnly:!0,reflectToAttribute:!0,value:!1},holdDown:{type:Boolean,value:!1,observer:"_holdDownChanged"},noink:{type:Boolean,value:!1},_animating:{type:Boolean},_boundAnimate:{type:Function,value:function(){return this.animate.bind(this)}}},get target(){return this.keyEventTarget},keyBindings:{"enter:keydown":"_onEnterKeydown","space:keydown":"_onSpaceKeydown","space:keyup":"_onSpaceKeyup"},attached:function(){11==this.parentNode.nodeType?this.keyEventTarget=Polymer.dom(this).getOwnerRoot().host:this.keyEventTarget=this.parentNode;var e=this.keyEventTarget;this.listen(e,"up","uiUpAction"),this.listen(e,"down","uiDownAction")},detached:function(){this.unlisten(this.keyEventTarget,"up","uiUpAction"),this.unlisten(this.keyEventTarget,"down","uiDownAction"),this.keyEventTarget=null},get shouldKeepAnimating(){for(var e=0;e<this.ripples.length;++e)if(!this.ripples[e].isAnimationComplete)return!0;return!1},simulatedRipple:function(){this.downAction(null),this.async(function(){this.upAction()},1)},uiDownAction:function(e){this.noink||this.downAction(e)},downAction:function(e){if(!(this.holdDown&&this.ripples.length>0)){var t=this.addRipple();t.downAction(e),this._animating||(this._animating=!0,this.animate())}},uiUpAction:function(e){this.noink||this.upAction(e)},upAction:function(e){this.holdDown||(this.ripples.forEach(function(t){t.upAction(e)}),this._animating=!0,this.animate())},onAnimationComplete:function(){this._animating=!1,this.$.background.style.backgroundColor=null,this.fire("transitionend")},addRipple:function(){var e=new t(this);return Polymer.dom(this.$.waves).appendChild(e.waveContainer),this.$.background.style.backgroundColor=e.color,this.ripples.push(e),this._setAnimating(!0),e},removeRipple:function(e){var t=this.ripples.indexOf(e);t<0||(this.ripples.splice(t,1),e.remove(),this.ripples.length||this._setAnimating(!1))},animate:function(){if(this._animating){var e,t;for(e=0;e<this.ripples.length;++e)t=this.ripples[e],t.draw(),this.$.background.style.opacity=t.outerOpacity,t.isOpacityFullyDecayed&&!t.isRestingAtMaxRadius&&this.removeRipple(t);this.shouldKeepAnimating||0!==this.ripples.length?window.requestAnimationFrame(this._boundAnimate):this.onAnimationComplete()}},_onEnterKeydown:function(){this.uiDownAction(),this.async(this.uiUpAction,1)},_onSpaceKeydown:function(){this.uiDownAction()},_onSpaceKeyup:function(){this.uiUpAction()},_holdDownChanged:function(e,t){void 0!==t&&(e?this.downAction():this.upAction())}})}(),Polymer.PaperRippleBehavior={properties:{noink:{type:Boolean,observer:"_noinkChanged"},_rippleContainer:{type:Object}},_buttonStateChanged:function(){this.focused&&this.ensureRipple()},_downHandler:function(e){Polymer.IronButtonStateImpl._downHandler.call(this,e),this.pressed&&this.ensureRipple(e)},ensureRipple:function(e){if(!this.hasRipple()){this._ripple=this._createRipple(),this._ripple.noink=this.noink;var t=this._rippleContainer||this.root;if(t&&Polymer.dom(t).appendChild(this._ripple),e){var r=Polymer.dom(this._rippleContainer||this),o=Polymer.dom(e).rootTarget;r.deepContains(o)&&this._ripple.uiDownAction(e)}}},getRipple:function(){return this.ensureRipple(),this._ripple},hasRipple:function(){return Boolean(this._ripple)},_createRipple:function(){return document.createElement("paper-ripple")},_noinkChanged:function(e){this.hasRipple()&&(this._ripple.noink=e)}},Polymer.PaperInkyFocusBehaviorImpl={observers:["_focusedChanged(receivedFocusFromKeyboard)"],_focusedChanged:function(e){e&&this.ensureRipple(),this.hasRipple()&&(this._ripple.holdDown=e)},_createRipple:function(){var e=Polymer.PaperRippleBehavior._createRipple();return e.id="ink",e.setAttribute("center",""),e.classList.add("circle"),e}},Polymer.PaperInkyFocusBehavior=[Polymer.IronButtonState,Polymer.IronControlState,Polymer.PaperRippleBehavior,Polymer.PaperInkyFocusBehaviorImpl],Polymer({is:"paper-icon-button",hostAttributes:{role:"button",tabindex:"0"},behaviors:[Polymer.PaperInkyFocusBehavior],properties:{src:{type:String},icon:{type:String},alt:{type:String,observer:"_altChanged"}},_altChanged:function(e,t){var r=this.getAttribute("aria-label");r&&t!=r||this.setAttribute("aria-label",e)}}),function(){"use strict";var e=1,t=2,r={outerScroll:{scroll:!0},shadowMode:{standard:t,waterfall:e,"waterfall-tall":e},tallMode:{"waterfall-tall":!0}};Polymer({is:"paper-header-panel",properties:{mode:{type:String,value:"standard",observer:"_modeChanged",reflectToAttribute:!0},shadow:{type:Boolean,value:!1},tallClass:{type:String,value:"tall"},atTop:{type:Boolean,value:!0,notify:!0,readOnly:!0,reflectToAttribute:!0}},observers:["_computeDropShadowHidden(atTop, mode, shadow)"],ready:function(){this.scrollHandler=this._scroll.bind(this)},attached:function(){this._addListener(),this._keepScrollingState()},detached:function(){this._removeListener()},get header(){return Polymer.dom(this.$.headerContent).getDistributedNodes()[0]},get scroller(){return this._getScrollerForMode(this.mode)},get visibleShadow(){return this.$.dropShadow.classList.contains("has-shadow")},_computeDropShadowHidden:function(o,n,i){var s=r.shadowMode[n];this.shadow?this.toggleClass("has-shadow",!0,this.$.dropShadow):s===t?this.toggleClass("has-shadow",!0,this.$.dropShadow):s!==e||o?this.toggleClass("has-shadow",!1,this.$.dropShadow):this.toggleClass("has-shadow",!0,this.$.dropShadow)},_computeMainContainerClass:function(e){var t={};return t.flex="cover"!==e,Object.keys(t).filter(function(e){return t[e]}).join(" ")},_addListener:function(){this.scroller.addEventListener("scroll",this.scrollHandler,!1)},_removeListener:function(){this.scroller.removeEventListener("scroll",this.scrollHandler)},_modeChanged:function(e,t){var o=r,n=this.header,i=200;n&&(o.tallMode[t]&&!o.tallMode[e]?(n.classList.remove(this.tallClass),this.async(function(){n.classList.remove("animate")},i)):this.toggleClass("animate",o.tallMode[e],n)),this._keepScrollingState()},_keepScrollingState:function(){var e=this.scroller,t=this.header;this._setAtTop(0===e.scrollTop),t&&this.tallClass&&r.tallMode[this.mode]&&this.toggleClass(this.tallClass,this.atTop||t.classList.contains(this.tallClass)&&e.scrollHeight<this.offsetHeight,t)},_scroll:function(){this._keepScrollingState(),this.fire("content-scroll",{target:this.scroller},{bubbles:!1})},_getScrollerForMode:function(e){return r.outerScroll[e]?this:this.$.mainContainer}})}(),Polymer.IronMultiSelectableBehaviorImpl={properties:{multi:{type:Boolean,value:!1,observer:"multiChanged"},selectedValues:{type:Array,notify:!0},selectedItems:{type:Array,readOnly:!0,notify:!0}},observers:["_updateSelected(selectedValues.splices)"],select:function(e){this.multi?this.selectedValues?this._toggleSelected(e):this.selectedValues=[e]:this.selected=e},multiChanged:function(e){this._selection.multi=e},get _shouldUpdateSelection(){return null!=this.selected||null!=this.selectedValues&&this.selectedValues.length},_updateAttrForSelected:function(){this.multi?this._shouldUpdateSelection&&(this.selectedValues=this.selectedItems.map(function(e){return this._indexToValue(this.indexOf(e))},this).filter(function(e){return null!=e},this)):Polymer.IronSelectableBehavior._updateAttrForSelected.apply(this)},_updateSelected:function(){this.multi?this._selectMulti(this.selectedValues):this._selectSelected(this.selected)},_selectMulti:function(e){if(e){var t=this._valuesToItems(e);this._selection.clear(t);for(var r=0;r<t.length;r++)this._selection.setItemSelected(t[r],!0);if(this.fallbackSelection&&this.items.length&&!this._selection.get().length){var o=this._valueToItem(this.fallbackSelection);o&&(this.selectedValues=[this.fallbackSelection])}}else this._selection.clear()},_selectionChange:function(){var e=this._selection.get();this.multi?this._setSelectedItems(e):(this._setSelectedItems([e]),this._setSelectedItem(e))},_toggleSelected:function(e){var t=this.selectedValues.indexOf(e),r=t<0;r?this.push("selectedValues",e):this.splice("selectedValues",t,1)},_valuesToItems:function(e){return null==e?null:e.map(function(e){return this._valueToItem(e)},this)}},Polymer.IronMultiSelectableBehavior=[Polymer.IronSelectableBehavior,Polymer.IronMultiSelectableBehaviorImpl],Polymer({is:"iron-selector",behaviors:[Polymer.IronMultiSelectableBehavior]}),function(){"use strict";function e(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&e[r]&&t.push(r);return t.join(" ")}var t=null;Polymer({is:"paper-drawer-panel",behaviors:[Polymer.IronResizableBehavior],properties:{defaultSelected:{type:String,value:"main"},disableEdgeSwipe:{type:Boolean,value:!1},disableSwipe:{type:Boolean,value:!1},dragging:{type:Boolean,value:!1,readOnly:!0,notify:!0},drawerWidth:{type:String,value:"256px"},edgeSwipeSensitivity:{type:Number,value:30},forceNarrow:{type:Boolean,value:!1},hasTransform:{type:Boolean,value:function(){return"transform"in this.style}},hasWillChange:{type:Boolean,value:function(){return"willChange"in this.style}},narrow:{reflectToAttribute:!0,type:Boolean,value:!1,readOnly:!0,notify:!0},peeking:{type:Boolean,value:!1,readOnly:!0,notify:!0},responsiveWidth:{type:String,value:"600px"},rightDrawer:{type:Boolean,value:!1},selected:{reflectToAttribute:!0,notify:!0,type:String,value:null},drawerToggleAttribute:{type:String,value:"paper-drawer-toggle"},drawerFocusSelector:{type:String,value:'a[href]:not([tabindex="-1"]),area[href]:not([tabindex="-1"]),input:not([disabled]):not([tabindex="-1"]),select:not([disabled]):not([tabindex="-1"]),textarea:not([disabled]):not([tabindex="-1"]),button:not([disabled]):not([tabindex="-1"]),iframe:not([tabindex="-1"]),[tabindex]:not([tabindex="-1"]),[contentEditable=true]:not([tabindex="-1"])'},_transition:{type:Boolean,value:!1}},listeners:{tap:"_onTap",track:"_onTrack",down:"_downHandler",up:"_upHandler",transitionend:"_onTransitionEnd"},observers:["_forceNarrowChanged(forceNarrow, defaultSelected)","_toggleFocusListener(selected)"],ready:function(){this._transition=!0,this._boundFocusListener=this._didFocus.bind(this)},togglePanel:function(){this._isMainSelected()?this.openDrawer():this.closeDrawer()},openDrawer:function(){this.selected="drawer"},closeDrawer:function(){this.selected="main"},_onTransitionEnd:function(e){var t=Polymer.dom(e).localTarget;if(t===this&&("left"!==e.propertyName&&"right"!==e.propertyName||this.notifyResize(),"transform"===e.propertyName&&"drawer"===this.selected)){var r=this._getAutoFocusedNode();r&&r.focus()}},_computeIronSelectorClass:function(t,r,o,n,i){return e({dragging:o,"narrow-layout":t,"right-drawer":n,"left-drawer":!n,transition:r,peeking:i})},_computeDrawerStyle:function(e){return"width:"+e+";"},_computeMainStyle:function(e,t,r){var o="";return o+="left:"+(e||t?"0":r)+";",t&&(o+="right:"+(e?"":r)+";"),o},_computeMediaQuery:function(e,t){return e?"":"(max-width: "+t+")"},_computeSwipeOverlayHidden:function(e,t){return!e||t},_onTrack:function(e){if(!t||this===t)switch(e.detail.state){case"start":this._trackStart(e);break;case"track":this._trackX(e);break;case"end":this._trackEnd(e)}},_responsiveChange:function(e){this._setNarrow(e),this.selected=this.narrow?this.defaultSelected:null,this.setScrollDirection(this._swipeAllowed()?"y":"all"),this.fire("paper-responsive-change",{narrow:this.narrow})},_onQueryMatchesChanged:function(e){this._responsiveChange(e.detail.value)},_forceNarrowChanged:function(){this._responsiveChange(this.forceNarrow||this.$.mq.queryMatches)},_swipeAllowed:function(){return this.narrow&&!this.disableSwipe},_isMainSelected:function(){return"main"===this.selected},_startEdgePeek:function(){this.width=this.$.drawer.offsetWidth,this._moveDrawer(this._translateXForDeltaX(this.rightDrawer?-this.edgeSwipeSensitivity:this.edgeSwipeSensitivity)),this._setPeeking(!0)},_stopEdgePeek:function(){this.peeking&&(this._setPeeking(!1),this._moveDrawer(null))},_downHandler:function(e){!this.dragging&&this._isMainSelected()&&this._isEdgeTouch(e)&&!t&&(this._startEdgePeek(),e.preventDefault(),t=this)},_upHandler:function(){this._stopEdgePeek(),t=null},_onTap:function(e){var t=Polymer.dom(e).localTarget,r=t&&this.drawerToggleAttribute&&t.hasAttribute(this.drawerToggleAttribute);r&&this.togglePanel()},_isEdgeTouch:function(e){var t=e.detail.x;return!this.disableEdgeSwipe&&this._swipeAllowed()&&(this.rightDrawer?t>=this.offsetWidth-this.edgeSwipeSensitivity:t<=this.edgeSwipeSensitivity)},_trackStart:function(e){this._swipeAllowed()&&(t=this,this._setDragging(!0),this._isMainSelected()&&this._setDragging(this.peeking||this._isEdgeTouch(e)),this.dragging&&(this.width=this.$.drawer.offsetWidth,this._transition=!1))},_translateXForDeltaX:function(e){var t=this._isMainSelected();return this.rightDrawer?Math.max(0,t?this.width+e:e):Math.min(0,t?e-this.width:e)},_trackX:function(e){if(this.dragging){var t=e.detail.dx;if(this.peeking){if(Math.abs(t)<=this.edgeSwipeSensitivity)return;this._setPeeking(!1)}this._moveDrawer(this._translateXForDeltaX(t))}},_trackEnd:function(e){if(this.dragging){var r=e.detail.dx>0;this._setDragging(!1),this._transition=!0,t=null,this._moveDrawer(null),this.rightDrawer?this[r?"closeDrawer":"openDrawer"]():this[r?"openDrawer":"closeDrawer"]()}},_transformForTranslateX:function(e){return null===e?"":this.hasWillChange?"translateX("+e+"px)":"translate3d("+e+"px, 0, 0)"},_moveDrawer:function(e){this.transform(this._transformForTranslateX(e),this.$.drawer)},_getDrawerContent:function(){return Polymer.dom(this.$.drawerContent).getDistributedNodes()[0]},_getAutoFocusedNode:function(){var e=this._getDrawerContent();return this.drawerFocusSelector?Polymer.dom(e).querySelector(this.drawerFocusSelector)||e:null},_toggleFocusListener:function(e){"drawer"===e?this.addEventListener("focus",this._boundFocusListener,!0):this.removeEventListener("focus",this._boundFocusListener,!0)},_didFocus:function(e){var t=this._getAutoFocusedNode();if(t){var r=Polymer.dom(e).path,o=(r[0],this._getDrawerContent()),n=r.indexOf(o)!==-1;n||(e.stopPropagation(),t.focus())}},_isDrawerClosed:function(e,t){return!e||"drawer"!==t}})}(),Polymer({is:"paper-toolbar",hostAttributes:{role:"toolbar"},properties:{bottomJustify:{type:String,value:""},justify:{type:String,value:""},middleJustify:{type:String,value:""}},attached:function(){this._observer=this._observe(this),this._updateAriaLabelledBy()},detached:function(){this._observer&&this._observer.disconnect()},_observe:function(e){var t=new MutationObserver(function(){this._updateAriaLabelledBy()}.bind(this));return t.observe(e,{childList:!0,subtree:!0}),t},_updateAriaLabelledBy:function(){for(var e,t=[],r=Polymer.dom(this.root).querySelectorAll("content"),o=0;e=r[o];o++)for(var n,i=Polymer.dom(e).getDistributedNodes(),s=0;n=i[s];s++)if(n.classList&&n.classList.contains("title"))if(n.id)t.push(n.id);else{var a="paper-toolbar-label-"+Math.floor(1e4*Math.random());n.id=a,t.push(a)}t.length>0&&this.setAttribute("aria-labelledby",t.join(" "))},_computeBarExtraClasses:function(e){return e?e+("justified"===e?"":"-justified"):""}}),Polymer({is:"paper-material",properties:{elevation:{type:Number,reflectToAttribute:!0,value:1},animated:{type:Boolean,reflectToAttribute:!0,value:!1}}}),Polymer.IronMenuBehaviorImpl={properties:{focusedItem:{observer:"_focusedItemChanged",readOnly:!0,type:Object},attrForItemTitle:{type:String}},hostAttributes:{role:"menu",tabindex:"0"},observers:["_updateMultiselectable(multi)"],listeners:{focus:"_onFocus",keydown:"_onKeydown","iron-items-changed":"_onIronItemsChanged"},keyBindings:{up:"_onUpKey",down:"_onDownKey",esc:"_onEscKey","shift+tab:keydown":"_onShiftTabDown"},attached:function(){this._resetTabindices()},select:function(e){this._defaultFocusAsync&&(this.cancelAsync(this._defaultFocusAsync),this._defaultFocusAsync=null);var t=this._valueToItem(e);t&&t.hasAttribute("disabled")||(this._setFocusedItem(t),Polymer.IronMultiSelectableBehaviorImpl.select.apply(this,arguments))},_resetTabindices:function(){var e=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this.items.forEach(function(t){t.setAttribute("tabindex",t===e?"0":"-1")},this)},_updateMultiselectable:function(e){e?this.setAttribute("aria-multiselectable","true"):this.removeAttribute("aria-multiselectable")},_focusWithKeyboardEvent:function(e){for(var t,r=0;t=this.items[r];r++){var o=this.attrForItemTitle||"textContent",n=t[o]||t.getAttribute(o);if(!t.hasAttribute("disabled")&&n&&n.trim().charAt(0).toLowerCase()===String.fromCharCode(e.keyCode).toLowerCase()){this._setFocusedItem(t);break}}},_focusPrevious:function(){for(var e=this.items.length,t=Number(this.indexOf(this.focusedItem)),r=1;r<e+1;r++){var o=this.items[(t-r+e)%e];if(!o.hasAttribute("disabled"))return void this._setFocusedItem(o)}},_focusNext:function(){for(var e=this.items.length,t=Number(this.indexOf(this.focusedItem)),r=1;r<e+1;r++){var o=this.items[(t+r)%e];if(!o.hasAttribute("disabled"))return void this._setFocusedItem(o)}},_applySelection:function(e,t){t?e.setAttribute("aria-selected","true"):e.removeAttribute("aria-selected"),Polymer.IronSelectableBehavior._applySelection.apply(this,arguments)},_focusedItemChanged:function(e,t){t&&t.setAttribute("tabindex","-1"),e&&(e.setAttribute("tabindex","0"),e.focus())},_onIronItemsChanged:function(e){e.detail.addedNodes.length&&this._resetTabindices()},_onShiftTabDown:function(e){var t=this.getAttribute("tabindex");Polymer.IronMenuBehaviorImpl._shiftTabPressed=!0,this._setFocusedItem(null),this.setAttribute("tabindex","-1"),this.async(function(){this.setAttribute("tabindex",t),Polymer.IronMenuBehaviorImpl._shiftTabPressed=!1},1)},_onFocus:function(e){if(!Polymer.IronMenuBehaviorImpl._shiftTabPressed){var t=Polymer.dom(e).rootTarget;(t===this||"undefined"==typeof t.tabIndex||this.isLightDescendant(t))&&(this._defaultFocusAsync=this.async(function(){var e=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this._setFocusedItem(null),e?this._setFocusedItem(e):this.items[0]&&this._focusNext()}))}},_onUpKey:function(e){this._focusPrevious(),e.detail.keyboardEvent.preventDefault()},_onDownKey:function(e){this._focusNext(),e.detail.keyboardEvent.preventDefault()},_onEscKey:function(e){this.focusedItem.blur()},_onKeydown:function(e){this.keyboardEventMatchesKeys(e,"up down esc")||this._focusWithKeyboardEvent(e),e.stopPropagation()},_activateHandler:function(e){Polymer.IronSelectableBehavior._activateHandler.call(this,e),e.stopPropagation()}},Polymer.IronMenuBehaviorImpl._shiftTabPressed=!1,Polymer.IronMenuBehavior=[Polymer.IronMultiSelectableBehavior,Polymer.IronA11yKeysBehavior,Polymer.IronMenuBehaviorImpl],function(){Polymer({is:"paper-menu",behaviors:[Polymer.IronMenuBehavior]})}(),Polymer.IronFitBehavior={properties:{sizingTarget:{type:Object,value:function(){return this}},fitInto:{type:Object,value:window},noOverlap:{type:Boolean},positionTarget:{type:Element},horizontalAlign:{type:String},verticalAlign:{type:String},dynamicAlign:{type:Boolean},horizontalOffset:{type:Number,value:0,notify:!0},verticalOffset:{type:Number,value:0,notify:!0},autoFitOnAttach:{type:Boolean,value:!1},_fitInfo:{type:Object}},get _fitWidth(){var e;return e=this.fitInto===window?this.fitInto.innerWidth:this.fitInto.getBoundingClientRect().width},get _fitHeight(){var e;return e=this.fitInto===window?this.fitInto.innerHeight:this.fitInto.getBoundingClientRect().height},get _fitLeft(){var e;return e=this.fitInto===window?0:this.fitInto.getBoundingClientRect().left},get _fitTop(){var e;return e=this.fitInto===window?0:this.fitInto.getBoundingClientRect().top},get _defaultPositionTarget(){var e=Polymer.dom(this).parentNode;return e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e},get _localeHorizontalAlign(){if(this._isRTL){if("right"===this.horizontalAlign)return"left";if("left"===this.horizontalAlign)return"right"}return this.horizontalAlign},attached:function(){this._isRTL="rtl"==window.getComputedStyle(this).direction,this.positionTarget=this.positionTarget||this._defaultPositionTarget,this.autoFitOnAttach&&("none"===window.getComputedStyle(this).display?setTimeout(function(){this.fit()}.bind(this)):this.fit())},fit:function(){this.position(),this.constrain(),this.center()},_discoverInfo:function(){if(!this._fitInfo){var e=window.getComputedStyle(this),t=window.getComputedStyle(this.sizingTarget);this._fitInfo={inlineStyle:{top:this.style.top||"",left:this.style.left||"",position:this.style.position||""},sizerInlineStyle:{maxWidth:this.sizingTarget.style.maxWidth||"",maxHeight:this.sizingTarget.style.maxHeight||"",boxSizing:this.sizingTarget.style.boxSizing||""},positionedBy:{vertically:"auto"!==e.top?"top":"auto"!==e.bottom?"bottom":null,horizontally:"auto"!==e.left?"left":"auto"!==e.right?"right":null},sizedBy:{height:"none"!==t.maxHeight,width:"none"!==t.maxWidth,minWidth:parseInt(t.minWidth,10)||0,minHeight:parseInt(t.minHeight,10)||0},margin:{top:parseInt(e.marginTop,10)||0,right:parseInt(e.marginRight,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0}},this.verticalOffset&&(this._fitInfo.margin.top=this._fitInfo.margin.bottom=this.verticalOffset,this._fitInfo.inlineStyle.marginTop=this.style.marginTop||"",this._fitInfo.inlineStyle.marginBottom=this.style.marginBottom||"",this.style.marginTop=this.style.marginBottom=this.verticalOffset+"px"),this.horizontalOffset&&(this._fitInfo.margin.left=this._fitInfo.margin.right=this.horizontalOffset,this._fitInfo.inlineStyle.marginLeft=this.style.marginLeft||"",this._fitInfo.inlineStyle.marginRight=this.style.marginRight||"",this.style.marginLeft=this.style.marginRight=this.horizontalOffset+"px")}},resetFit:function(){var e=this._fitInfo||{};for(var t in e.sizerInlineStyle)this.sizingTarget.style[t]=e.sizerInlineStyle[t];for(var t in e.inlineStyle)this.style[t]=e.inlineStyle[t];this._fitInfo=null},refit:function(){var e=this.sizingTarget.scrollLeft,t=this.sizingTarget.scrollTop;this.resetFit(),this.fit(),this.sizingTarget.scrollLeft=e,this.sizingTarget.scrollTop=t},position:function(){if(this.horizontalAlign||this.verticalAlign){this._discoverInfo(),this.style.position="fixed",this.sizingTarget.style.boxSizing="border-box",this.style.left="0px",this.style.top="0px";var e=this.getBoundingClientRect(),t=this.__getNormalizedRect(this.positionTarget),r=this.__getNormalizedRect(this.fitInto),o=this._fitInfo.margin,n={width:e.width+o.left+o.right,height:e.height+o.top+o.bottom},i=this.__getPosition(this._localeHorizontalAlign,this.verticalAlign,n,t,r),s=i.left+o.left,a=i.top+o.top,l=Math.min(r.right-o.right,s+e.width),c=Math.min(r.bottom-o.bottom,a+e.height),u=this._fitInfo.sizedBy.minWidth,h=this._fitInfo.sizedBy.minHeight;s<o.left&&(s=o.left,l-s<u&&(s=l-u)),a<o.top&&(a=o.top,c-a<h&&(a=c-h)),this.sizingTarget.style.maxWidth=l-s+"px",this.sizingTarget.style.maxHeight=c-a+"px",this.style.left=s-e.left+"px",this.style.top=a-e.top+"px"}},constrain:function(){if(!this.horizontalAlign&&!this.verticalAlign){this._discoverInfo();var e=this._fitInfo;e.positionedBy.vertically||(this.style.position="fixed",this.style.top="0px"),e.positionedBy.horizontally||(this.style.position="fixed",this.style.left="0px"),this.sizingTarget.style.boxSizing="border-box";var t=this.getBoundingClientRect();e.sizedBy.height||this.__sizeDimension(t,e.positionedBy.vertically,"top","bottom","Height"),e.sizedBy.width||this.__sizeDimension(t,e.positionedBy.horizontally,"left","right","Width")}},_sizeDimension:function(e,t,r,o,n){this.__sizeDimension(e,t,r,o,n)},__sizeDimension:function(e,t,r,o,n){var i=this._fitInfo,s=this.__getNormalizedRect(this.fitInto),a="Width"===n?s.width:s.height,l=t===o,c=l?a-e[o]:e[r],u=i.margin[l?r:o],h="offset"+n,f=this[h]-this.sizingTarget[h];this.sizingTarget.style["max"+n]=a-u-c-f+"px"},center:function(){if(!this.horizontalAlign&&!this.verticalAlign){this._discoverInfo();var e=this._fitInfo.positionedBy;if(!e.vertically||!e.horizontally){this.style.position="fixed",e.vertically||(this.style.top="0px"),e.horizontally||(this.style.left="0px");var t=this.getBoundingClientRect(),r=this.__getNormalizedRect(this.fitInto);if(!e.vertically){var o=r.top-t.top+(r.height-t.height)/2;this.style.top=o+"px"}if(!e.horizontally){var n=r.left-t.left+(r.width-t.width)/2;this.style.left=n+"px"}}}},__getNormalizedRect:function(e){return e===document.documentElement||e===window?{top:0,left:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:e.getBoundingClientRect()},__getCroppedArea:function(e,t,r){var o=Math.min(0,e.top)+Math.min(0,r.bottom-(e.top+t.height)),n=Math.min(0,e.left)+Math.min(0,r.right-(e.left+t.width));return Math.abs(o)*t.width+Math.abs(n)*t.height},__getPosition:function(e,t,r,o,n){var i=[{verticalAlign:"top",horizontalAlign:"left",top:o.top,left:o.left},{verticalAlign:"top",horizontalAlign:"right",top:o.top,left:o.right-r.width},{verticalAlign:"bottom",horizontalAlign:"left",top:o.bottom-r.height,left:o.left},{verticalAlign:"bottom",horizontalAlign:"right",top:o.bottom-r.height,left:o.right-r.width}];if(this.noOverlap){for(var s=0,a=i.length;s<a;s++){var l={};for(var c in i[s])l[c]=i[s][c];i.push(l)}i[0].top=i[1].top+=o.height,i[2].top=i[3].top-=o.height,i[4].left=i[6].left+=o.width,i[5].left=i[7].left-=o.width}t="auto"===t?null:t,e="auto"===e?null:e;for(var u,s=0;s<i.length;s++){var h=i[s];if(!this.dynamicAlign&&!this.noOverlap&&h.verticalAlign===t&&h.horizontalAlign===e){u=h;break}var f=!(t&&h.verticalAlign!==t||e&&h.horizontalAlign!==e);if(this.dynamicAlign||f){u=u||h,h.croppedArea=this.__getCroppedArea(h,r,n);var p=h.croppedArea-u.croppedArea;if((p<0||0===p&&f)&&(u=h),0===u.croppedArea&&f)break}}return u}},function(){"use strict";Polymer({is:"iron-overlay-backdrop",properties:{opened:{reflectToAttribute:!0,type:Boolean,value:!1,observer:"_openedChanged"}},listeners:{transitionend:"_onTransitionend"},created:function(){this.__openedRaf=null},attached:function(){this.opened&&this._openedChanged(this.opened)},prepare:function(){this.opened&&!this.parentNode&&Polymer.dom(document.body).appendChild(this)},open:function(){this.opened=!0},close:function(){this.opened=!1},complete:function(){this.opened||this.parentNode!==document.body||Polymer.dom(this.parentNode).removeChild(this)},_onTransitionend:function(e){e&&e.target===this&&this.complete()},_openedChanged:function(e){if(e)this.prepare();else{var t=window.getComputedStyle(this);"0s"!==t.transitionDuration&&0!=t.opacity||this.complete()}this.isAttached&&(this.__openedRaf&&(window.cancelAnimationFrame(this.__openedRaf),this.__openedRaf=null),this.scrollTop=this.scrollTop,this.__openedRaf=window.requestAnimationFrame(function(){this.__openedRaf=null,this.toggleClass("opened",this.opened)}.bind(this)))}})}(),Polymer.IronOverlayManagerClass=function(){this._overlays=[],this._minimumZ=101,this._backdropElement=null,Polymer.Gestures.add(document,"tap",null),document.addEventListener("tap",this._onCaptureClick.bind(this),!0),document.addEventListener("focus",this._onCaptureFocus.bind(this),!0),document.addEventListener("keydown",this._onCaptureKeyDown.bind(this),!0)},Polymer.IronOverlayManagerClass.prototype={constructor:Polymer.IronOverlayManagerClass,get backdropElement(){return this._backdropElement||(this._backdropElement=document.createElement("iron-overlay-backdrop")),this._backdropElement},get deepActiveElement(){for(var e=document.activeElement||document.body;e.root&&Polymer.dom(e.root).activeElement;)e=Polymer.dom(e.root).activeElement;return e},_bringOverlayAtIndexToFront:function(e){var t=this._overlays[e];if(t){var r=this._overlays.length-1,o=this._overlays[r];if(o&&this._shouldBeBehindOverlay(t,o)&&r--,!(e>=r)){var n=Math.max(this.currentOverlayZ(),this._minimumZ);for(this._getZ(t)<=n&&this._applyOverlayZ(t,n);e<r;)this._overlays[e]=this._overlays[e+1],e++;this._overlays[r]=t}}},addOrRemoveOverlay:function(e){e.opened?this.addOverlay(e):this.removeOverlay(e)},addOverlay:function(e){var t=this._overlays.indexOf(e);if(t>=0)return this._bringOverlayAtIndexToFront(t),void this.trackBackdrop();var r=this._overlays.length,o=this._overlays[r-1],n=Math.max(this._getZ(o),this._minimumZ),i=this._getZ(e);if(o&&this._shouldBeBehindOverlay(e,o)){this._applyOverlayZ(o,n),r--;var s=this._overlays[r-1];n=Math.max(this._getZ(s),this._minimumZ)}i<=n&&this._applyOverlayZ(e,n),this._overlays.splice(r,0,e);var a=this.deepActiveElement;e.restoreFocusNode=this._overlayParent(a)?null:a,this.trackBackdrop()},removeOverlay:function(e){var t=this._overlays.indexOf(e);if(t!==-1){this._overlays.splice(t,1);var r=e.restoreFocusOnClose?e.restoreFocusNode:null;e.restoreFocusNode=null,r&&Polymer.dom(document.body).deepContains(r)&&r.focus(),this.trackBackdrop()}},currentOverlay:function(){var e=this._overlays.length-1;return this._overlays[e]},currentOverlayZ:function(){return this._getZ(this.currentOverlay())},ensureMinimumZ:function(e){this._minimumZ=Math.max(this._minimumZ,e)},focusOverlay:function(){var e=this.currentOverlay();e&&!e.transitioning&&e._applyFocus()},trackBackdrop:function(){var e=this._overlayWithBackdrop();(e||this._backdropElement)&&(this.backdropElement.style.zIndex=this._getZ(e)-1,this.backdropElement.opened=!!e)},getBackdrops:function(){for(var e=[],t=0;t<this._overlays.length;t++)this._overlays[t].withBackdrop&&e.push(this._overlays[t]);return e},backdropZ:function(){return this._getZ(this._overlayWithBackdrop())-1},_overlayWithBackdrop:function(){for(var e=0;e<this._overlays.length;e++)if(this._overlays[e].withBackdrop)return this._overlays[e]},_getZ:function(e){var t=this._minimumZ;if(e){var r=Number(e.style.zIndex||window.getComputedStyle(e).zIndex);r===r&&(t=r)}return t},_setZ:function(e,t){e.style.zIndex=t;
},_applyOverlayZ:function(e,t){this._setZ(e,t+2)},_overlayParent:function(e){for(;e&&e!==document.body;){if(e._manager===this)return e;e=Polymer.dom(e).parentNode||e.host}},_overlayInPath:function(e){e=e||[];for(var t=0;t<e.length;t++)if(e[t]._manager===this)return e[t]},_onCaptureClick:function(e){var t=this.currentOverlay();t&&this._overlayInPath(Polymer.dom(e).path)!==t&&t._onCaptureClick(e)},_onCaptureFocus:function(e){var t=this.currentOverlay();t&&t._onCaptureFocus(e)},_onCaptureKeyDown:function(e){var t=this.currentOverlay();t&&(Polymer.IronA11yKeysBehavior.keyboardEventMatchesKeys(e,"esc")?t._onCaptureEsc(e):Polymer.IronA11yKeysBehavior.keyboardEventMatchesKeys(e,"tab")&&t._onCaptureTab(e))},_shouldBeBehindOverlay:function(e,t){return!e.alwaysOnTop&&t.alwaysOnTop}},Polymer.IronOverlayManager=new Polymer.IronOverlayManagerClass,function(){"use strict";Polymer.IronOverlayBehaviorImpl={properties:{opened:{observer:"_openedChanged",type:Boolean,value:!1,notify:!0},canceled:{observer:"_canceledChanged",readOnly:!0,type:Boolean,value:!1},withBackdrop:{observer:"_withBackdropChanged",type:Boolean},noAutoFocus:{type:Boolean,value:!1},noCancelOnEscKey:{type:Boolean,value:!1},noCancelOnOutsideClick:{type:Boolean,value:!1},closingReason:{type:Object},restoreFocusOnClose:{type:Boolean,value:!1},alwaysOnTop:{type:Boolean},_manager:{type:Object,value:Polymer.IronOverlayManager},_focusedChild:{type:Object}},listeners:{"iron-resize":"_onIronResize"},get backdropElement(){return this._manager.backdropElement},get _focusNode(){return this._focusedChild||Polymer.dom(this).querySelector("[autofocus]")||this},get _focusableNodes(){var e=["a[href]","area[href]","iframe","[tabindex]","[contentEditable=true]"],t=["input","select","textarea","button"],r=e.join(':not([tabindex="-1"]),')+':not([tabindex="-1"]),'+t.join(':not([disabled]):not([tabindex="-1"]),')+':not([disabled]):not([tabindex="-1"])',o=Polymer.dom(this).querySelectorAll(r);return this.tabIndex>=0&&o.splice(0,0,this),o.sort(function(e,t){return e.tabIndex===t.tabIndex?0:0===e.tabIndex||e.tabIndex>t.tabIndex?1:-1})},ready:function(){this.__isAnimating=!1,this.__shouldRemoveTabIndex=!1,this.__firstFocusableNode=this.__lastFocusableNode=null,this.__openChangedAsync=null,this.__onIronResizeAsync=null,this._ensureSetup()},attached:function(){this.opened&&this._openedChanged(),this._observer=Polymer.dom(this).observeNodes(this._onNodesChange)},detached:function(){Polymer.dom(this).unobserveNodes(this._observer),this._observer=null,this.opened=!1},toggle:function(){this._setCanceled(!1),this.opened=!this.opened},open:function(){this._setCanceled(!1),this.opened=!0},close:function(){this._setCanceled(!1),this.opened=!1},cancel:function(e){var t=this.fire("iron-overlay-canceled",e,{cancelable:!0});t.defaultPrevented||(this._setCanceled(!0),this.opened=!1)},_ensureSetup:function(){this._overlaySetup||(this._overlaySetup=!0,this.style.outline="none",this.style.display="none")},_openedChanged:function(){this.opened?this.removeAttribute("aria-hidden"):this.setAttribute("aria-hidden","true"),this._overlaySetup&&(this.__openChangedAsync&&window.cancelAnimationFrame(this.__openChangedAsync),this.opened||this._manager.removeOverlay(this),this.isAttached&&(this.__isAnimating=!0,this.__openChangedAsync=window.requestAnimationFrame(function(){this.__openChangedAsync=null,this.opened?(this._manager.addOverlay(this),this._prepareRenderOpened(),this._renderOpened()):(this._applyFocus(),this._renderClosed())}.bind(this))))},_canceledChanged:function(){this.closingReason=this.closingReason||{},this.closingReason.canceled=this.canceled},_withBackdropChanged:function(){this.withBackdrop&&!this.hasAttribute("tabindex")?(this.setAttribute("tabindex","-1"),this.__shouldRemoveTabIndex=!0):this.__shouldRemoveTabIndex&&(this.removeAttribute("tabindex"),this.__shouldRemoveTabIndex=!1),this.opened&&this.isAttached&&this._manager.trackBackdrop()},_prepareRenderOpened:function(){this._preparePositioning(),this.refit(),this._finishPositioning(),this._applyFocus(),this.noAutoFocus&&document.activeElement===this._focusNode&&this._focusNode.blur()},_renderOpened:function(){this._finishRenderOpened()},_renderClosed:function(){this._finishRenderClosed()},_finishRenderOpened:function(){this.notifyResize(),this.__isAnimating=!1;var e=this._focusableNodes;this.__firstFocusableNode=e[0],this.__lastFocusableNode=e[e.length-1],this.fire("iron-overlay-opened")},_finishRenderClosed:function(){this.style.display="none",this.style.zIndex="",this.notifyResize(),this.__isAnimating=!1,this.fire("iron-overlay-closed",this.closingReason)},_preparePositioning:function(){this.style.transition=this.style.webkitTransition="none",this.style.transform=this.style.webkitTransform="none",this.style.display=""},_finishPositioning:function(){this.style.display="none",this.scrollTop=this.scrollTop,this.style.transition=this.style.webkitTransition="",this.style.transform=this.style.webkitTransform="",this.style.display="",this.scrollTop=this.scrollTop},_applyFocus:function(){this.opened?this.noAutoFocus||this._focusNode.focus():(this._focusNode.blur(),this._focusedChild=null,this._manager.focusOverlay())},_onCaptureClick:function(e){this.noCancelOnOutsideClick||this.cancel(e)},_onCaptureFocus:function(e){if(this.withBackdrop){var t=Polymer.dom(e).path;t.indexOf(this)===-1?(e.stopPropagation(),this._applyFocus()):this._focusedChild=t[0]}},_onCaptureEsc:function(e){this.noCancelOnEscKey||this.cancel(e)},_onCaptureTab:function(e){if(this.withBackdrop){var t=e.shiftKey,r=t?this.__firstFocusableNode:this.__lastFocusableNode,o=t?this.__lastFocusableNode:this.__firstFocusableNode,n=!1;if(r===o)n=!0;else{var i=this._manager.deepActiveElement;n=i===r||i===this}n&&(e.preventDefault(),this._focusedChild=o,this._applyFocus())}},_onIronResize:function(){this.__onIronResizeAsync&&(window.cancelAnimationFrame(this.__onIronResizeAsync),this.__onIronResizeAsync=null),this.opened&&!this.__isAnimating&&(this.__onIronResizeAsync=window.requestAnimationFrame(function(){this.__onIronResizeAsync=null,this.refit()}.bind(this)))},_onNodesChange:function(){this.opened&&!this.__isAnimating&&this.notifyResize()}},Polymer.IronOverlayBehavior=[Polymer.IronFitBehavior,Polymer.IronResizableBehavior,Polymer.IronOverlayBehaviorImpl]}(),Polymer.NeonAnimatableBehavior={properties:{animationConfig:{type:Object},entryAnimation:{observer:"_entryAnimationChanged",type:String},exitAnimation:{observer:"_exitAnimationChanged",type:String}},_entryAnimationChanged:function(){this.animationConfig=this.animationConfig||{},this.animationConfig.entry=[{name:this.entryAnimation,node:this}]},_exitAnimationChanged:function(){this.animationConfig=this.animationConfig||{},this.animationConfig.exit=[{name:this.exitAnimation,node:this}]},_copyProperties:function(e,t){for(var r in t)e[r]=t[r]},_cloneConfig:function(e){var t={isClone:!0};return this._copyProperties(t,e),t},_getAnimationConfigRecursive:function(e,t,r){if(this.animationConfig){if(this.animationConfig.value&&"function"==typeof this.animationConfig.value)return void this._warn(this._logf("playAnimation","Please put 'animationConfig' inside of your components 'properties' object instead of outside of it."));var o;if(o=e?this.animationConfig[e]:this.animationConfig,Array.isArray(o)||(o=[o]),o)for(var n,i=0;n=o[i];i++)if(n.animatable)n.animatable._getAnimationConfigRecursive(n.type||e,t,r);else if(n.id){var s=t[n.id];s?(s.isClone||(t[n.id]=this._cloneConfig(s),s=t[n.id]),this._copyProperties(s,n)):t[n.id]=n}else r.push(n)}},getAnimationConfig:function(e){var t={},r=[];this._getAnimationConfigRecursive(e,t,r);for(var o in t)r.push(t[o]);return r}},Polymer.NeonAnimationRunnerBehaviorImpl={_configureAnimations:function(e){var t=[];if(e.length>0)for(var r,o=0;r=e[o];o++){var n=document.createElement(r.name);if(n.isNeonAnimation){var i=null;try{i=n.configure(r),"function"!=typeof i.cancel&&(i=document.timeline.play(i))}catch(s){i=null,console.warn("Couldnt play","(",r.name,").",s)}i&&t.push({neonAnimation:n,config:r,animation:i})}else console.warn(this.is+":",r.name,"not found!")}return t},_shouldComplete:function(e){for(var t=!0,r=0;r<e.length;r++)if("finished"!=e[r].animation.playState){t=!1;break}return t},_complete:function(e){for(var t=0;t<e.length;t++)e[t].neonAnimation.complete(e[t].config);for(var t=0;t<e.length;t++)e[t].animation.cancel()},playAnimation:function(e,t){var r=this.getAnimationConfig(e);if(r){this._active=this._active||{},this._active[e]&&(this._complete(this._active[e]),delete this._active[e]);var o=this._configureAnimations(r);if(0==o.length)return void this.fire("neon-animation-finish",t,{bubbles:!1});this._active[e]=o;for(var n=0;n<o.length;n++)o[n].animation.onfinish=function(){this._shouldComplete(o)&&(this._complete(o),delete this._active[e],this.fire("neon-animation-finish",t,{bubbles:!1}))}.bind(this)}},cancelAnimation:function(){for(var e in this._animations)this._animations[e].cancel();this._animations={}}},Polymer.NeonAnimationRunnerBehavior=[Polymer.NeonAnimatableBehavior,Polymer.NeonAnimationRunnerBehaviorImpl],Polymer.NeonAnimationBehavior={properties:{animationTiming:{type:Object,value:function(){return{duration:500,easing:"cubic-bezier(0.4, 0, 0.2, 1)",fill:"both"}}}},isNeonAnimation:!0,timingFromConfig:function(e){if(e.timing)for(var t in e.timing)this.animationTiming[t]=e.timing[t];return this.animationTiming},setPrefixedProperty:function(e,t,r){for(var o,n={transform:["webkitTransform"],transformOrigin:["mozTransformOrigin","webkitTransformOrigin"]},i=n[t],s=0;o=i[s];s++)e.style[o]=r;e.style[t]=r},complete:function(){}},!function(a,b){var c={},d={},e={},f=null;!function(e,t){function r(e){if("number"==typeof e)return e;var t={};for(var r in e)t[r]=e[r];return t}function o(){this._delay=0,this._endDelay=0,this._fill="none",this._iterationStart=0,this._iterations=1,this._duration=0,this._playbackRate=1,this._direction="normal",this._easing="linear",this._easingFunction=E}function n(){return e.isDeprecated("Invalid timing inputs","2016-03-02","TypeError exceptions will be thrown instead.",!0)}function i(t,r,n){var i=new o;return r&&(i.fill="both",i.duration="auto"),"number"!=typeof t||isNaN(t)?void 0!==t&&Object.getOwnPropertyNames(t).forEach(function(r){if("auto"!=t[r]){if(("number"==typeof i[r]||"duration"==r)&&("number"!=typeof t[r]||isNaN(t[r])))return;if("fill"==r&&-1==b.indexOf(t[r]))return;if("direction"==r&&-1==S.indexOf(t[r]))return;if("playbackRate"==r&&1!==t[r]&&e.isDeprecated("AnimationEffectTiming.playbackRate","2014-11-28","Use Animation.playbackRate instead."))return;i[r]=t[r]}}):i.duration=t,i}function s(e){return"number"==typeof e&&(e=isNaN(e)?{duration:0}:{duration:e}),e}function a(t,r){return t=e.numericTimingToObject(t),i(t,r)}function l(e,t,r,o){return 0>e||e>1||0>r||r>1?E:function(n){function i(e,t,r){return 3*e*(1-r)*(1-r)*r+3*t*(1-r)*r*r+r*r*r}if(0==n||1==n)return n;for(var s=0,a=1;;){var l=(s+a)/2,c=i(e,r,l);if(Math.abs(n-c)<1e-4)return i(t,o,l);n>c?s=l:a=l}}}function c(e,t){return function(r){if(r>=1)return 1;var o=1/e;return r+=t*o,r-r%o}}function u(e){A||(A=document.createElement("div").style),A.animationTimingFunction="",A.animationTimingFunction=e;var t=A.animationTimingFunction;if(""==t&&n())throw new TypeError(e+" is not a valid value for easing");var r=x.exec(t);if(r)return l.apply(this,r.slice(1).map(Number));var o=R.exec(t);if(o)return c(Number(o[1]),{start:T,middle:C,end:P}[o[2]]);var i=N[t];return i?i:E}function h(e){return Math.abs(f(e)/e.playbackRate)}function f(e){return e.duration*e.iterations}function p(e,t,r){return null==t?I:t<r.delay?k:t>=r.delay+e?O:B}function d(e,t,r,o,n){switch(o){case k:return"backwards"==t||"both"==t?0:null;case B:return r-n;case O:return"forwards"==t||"both"==t?e:null;case I:return null}}function g(e,t,r,o){return(o.playbackRate<0?t-e:t)*o.playbackRate+r}function _(e,t,r,o,n){return r===1/0||r===-(1/0)||r-o==t&&n.iterations&&(n.iterations+n.iterationStart)%1==0?e:r%e}function m(e,t,r,o){return 0===r?0:t==e?o.iterationStart+o.iterations-1:Math.floor(r/e)}function y(e,t,r,o){var n=e%2>=1,i="normal"==o.direction||o.direction==(n?"alternate-reverse":"alternate"),s=i?r:t-r,a=s/t;return t*o._easingFunction(a)}function v(e,t,r){var o=p(e,t,r),n=d(e,r.fill,t,o,r.delay);if(null===n)return null;if(0===e)return o===k?0:1;var i=r.iterationStart*r.duration,s=g(e,n,i,r),a=_(r.duration,f(r),s,i,r),l=m(r.duration,a,s,r);return y(l,r.duration,a,r)/r.duration}var b="backwards|forwards|both|none".split("|"),S="reverse|alternate|alternate-reverse".split("|"),E=function(e){return e};o.prototype={_setMember:function(t,r){this["_"+t]=r,this._effect&&(this._effect._timingInput[t]=r,this._effect._timing=e.normalizeTimingInput(this._effect._timingInput),this._effect.activeDuration=e.calculateActiveDuration(this._effect._timing),this._effect._animation&&this._effect._animation._rebuildUnderlyingAnimation())},get playbackRate(){return this._playbackRate},set delay(e){this._setMember("delay",e)},get delay(){return this._delay},set endDelay(e){this._setMember("endDelay",e)},get endDelay(){return this._endDelay},set fill(e){this._setMember("fill",e)},get fill(){return this._fill},set iterationStart(e){if((isNaN(e)||0>e)&&n())throw new TypeError("iterationStart must be a non-negative number, received: "+timing.iterationStart);this._setMember("iterationStart",e)},get iterationStart(){return this._iterationStart},set duration(e){if("auto"!=e&&(isNaN(e)||0>e)&&n())throw new TypeError("duration must be non-negative or auto, received: "+e);this._setMember("duration",e)},get duration(){return this._duration},set direction(e){this._setMember("direction",e)},get direction(){return this._direction},set easing(e){this._easingFunction=u(e),this._setMember("easing",e)},get easing(){return this._easing},set iterations(e){if((isNaN(e)||0>e)&&n())throw new TypeError("iterations must be non-negative, received: "+e);this._setMember("iterations",e)},get iterations(){return this._iterations}};var T=1,C=.5,P=0,N={ease:l(.25,.1,.25,1),"ease-in":l(.42,0,1,1),"ease-out":l(0,0,.58,1),"ease-in-out":l(.42,0,.58,1),"step-start":c(1,T),"step-middle":c(1,C),"step-end":c(1,P)},A=null,w="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",x=new RegExp("cubic-bezier\\("+w+","+w+","+w+","+w+"\\)"),R=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/,I=0,k=1,O=2,B=3;e.cloneTimingInput=r,e.makeTiming=i,e.numericTimingToObject=s,e.normalizeTimingInput=a,e.calculateActiveDuration=h,e.calculateTimeFraction=v,e.calculatePhase=p,e.toTimingFunction=u}(c,f),function(e,t){function r(e,t){return e in c?c[e][t]||t:t}function o(e,t,o){var n=s[e];if(n){a.style[e]=t;for(var i in n){var l=n[i],c=a.style[l];o[l]=r(l,c)}}else o[e]=r(e,t)}function n(e){var t=[];for(var r in e)if(!(r in["easing","offset","composite"])){var o=e[r];Array.isArray(o)||(o=[o]);for(var n,i=o.length,s=0;i>s;s++)n={},"offset"in e?n.offset=e.offset:1==i?n.offset=1:n.offset=s/(i-1),"easing"in e&&(n.easing=e.easing),"composite"in e&&(n.composite=e.composite),n[r]=o[s],t.push(n)}return t.sort(function(e,t){return e.offset-t.offset}),t}function i(e){function t(){var e=r.length;null==r[e-1].offset&&(r[e-1].offset=1),e>1&&null==r[0].offset&&(r[0].offset=0);for(var t=0,o=r[0].offset,n=1;e>n;n++){var i=r[n].offset;if(null!=i){for(var s=1;n-t>s;s++)r[t+s].offset=o+(i-o)*s/(n-t);t=n,o=i}}}if(null==e)return[];window.Symbol&&Symbol.iterator&&Array.prototype.from&&e[Symbol.iterator]&&(e=Array.from(e)),Array.isArray(e)||(e=n(e));for(var r=e.map(function(e){var t={};for(var r in e){var n=e[r];if("offset"==r){if(null!=n&&(n=Number(n),!isFinite(n)))throw new TypeError("keyframe offsets must be numbers.")}else{if("composite"==r)throw{type:DOMException.NOT_SUPPORTED_ERR,name:"NotSupportedError",message:"add compositing is not supported"};n=""+n}o(r,n,t)}return void 0==t.offset&&(t.offset=null),t}),i=!0,s=-(1/0),a=0;a<r.length;a++){var l=r[a].offset;if(null!=l){if(s>l)throw{code:DOMException.INVALID_MODIFICATION_ERR,name:"InvalidModificationError",message:"Keyframes are not loosely sorted by offset. Sort or specify offsets."};s=l}else i=!1}return r=r.filter(function(e){return e.offset>=0&&e.offset<=1}),i||t(),r}var s={background:["backgroundImage","backgroundPosition","backgroundSize","backgroundRepeat","backgroundAttachment","backgroundOrigin","backgroundClip","backgroundColor"],border:["borderTopColor","borderTopStyle","borderTopWidth","borderRightColor","borderRightStyle","borderRightWidth","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeftColor","borderLeftStyle","borderLeftWidth"],borderBottom:["borderBottomWidth","borderBottomStyle","borderBottomColor"],borderColor:["borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"],borderLeft:["borderLeftWidth","borderLeftStyle","borderLeftColor"],borderRadius:["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],borderRight:["borderRightWidth","borderRightStyle","borderRightColor"],borderTop:["borderTopWidth","borderTopStyle","borderTopColor"],borderWidth:["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"],flex:["flexGrow","flexShrink","flexBasis"],font:["fontFamily","fontSize","fontStyle","fontVariant","fontWeight","lineHeight"],margin:["marginTop","marginRight","marginBottom","marginLeft"],outline:["outlineColor","outlineStyle","outlineWidth"],padding:["paddingTop","paddingRight","paddingBottom","paddingLeft"]},a=document.createElementNS("http://www.w3.org/1999/xhtml","div"),l={thin:"1px",medium:"3px",thick:"5px"},c={borderBottomWidth:l,borderLeftWidth:l,borderRightWidth:l,borderTopWidth:l,fontSize:{"xx-small":"60%","x-small":"75%",small:"89%",medium:"100%",large:"120%","x-large":"150%","xx-large":"200%"},fontWeight:{normal:"400",bold:"700"},outlineWidth:l,textShadow:{none:"0px 0px 0px transparent"},boxShadow:{none:"0px 0px 0px 0px transparent"}};e.convertToArrayForm=n,e.normalizeKeyframes=i}(c,f),function(e){var t={};e.isDeprecated=function(e,r,o,n){var i=n?"are":"is",s=new Date,a=new Date(r);return a.setMonth(a.getMonth()+3),!(a>s)||(e in t||console.warn("Web Animations: "+e+" "+i+" deprecated and will stop working on "+a.toDateString()+". "+o),t[e]=!0,!1)},e.deprecated=function(t,r,o,n){var i=n?"are":"is";if(e.isDeprecated(t,r,o,n))throw new Error(t+" "+i+" no longer supported. "+o)}}(c),function(){if(document.documentElement.animate){var a=document.documentElement.animate([],0),b=!0;if(a&&(b=!1,"play|currentTime|pause|reverse|playbackRate|cancel|finish|startTime|playState".split("|").forEach(function(e){void 0===a[e]&&(b=!0)})),!b)return}!function(e,t,r){function o(e){for(var t={},r=0;r<e.length;r++)for(var o in e[r])if("offset"!=o&&"easing"!=o&&"composite"!=o){var n={offset:e[r].offset,easing:e[r].easing,value:e[r][o]};t[o]=t[o]||[],t[o].push(n)}for(var i in t){var s=t[i];if(0!=s[0].offset||1!=s[s.length-1].offset)throw{type:DOMException.NOT_SUPPORTED_ERR,name:"NotSupportedError",message:"Partial keyframes are not supported"}}return t}function n(r){var o=[];for(var n in r)for(var i=r[n],s=0;s<i.length-1;s++){var a=i[s].offset,l=i[s+1].offset,c=i[s].value,u=i[s+1].value,h=i[s].easing;a==l&&(1==l?c=u:u=c),o.push({startTime:a,endTime:l,easing:e.toTimingFunction(h?h:"linear"),property:n,interpolation:t.propertyInterpolation(n,c,u)})}return o.sort(function(e,t){return e.startTime-t.startTime}),o}t.convertEffectInput=function(r){var i=e.normalizeKeyframes(r),s=o(i),a=n(s);return function(e,r){if(null!=r)a.filter(function(e){return 0>=r&&0==e.startTime||r>=1&&1==e.endTime||r>=e.startTime&&r<=e.endTime}).forEach(function(o){var n=r-o.startTime,i=o.endTime-o.startTime,s=0==i?0:o.easing(n/i);t.apply(e,o.property,o.interpolation(s))});else for(var o in s)"offset"!=o&&"easing"!=o&&"composite"!=o&&t.clear(e,o)}}}(c,d,f),function(e,t,r){function o(e){return e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})}function n(e,t,r){a[r]=a[r]||[],a[r].push([e,t])}function i(e,t,r){for(var i=0;i<r.length;i++){var s=r[i];n(e,t,o(s))}}function s(r,n,i){var s=r;/-/.test(r)&&!e.isDeprecated("Hyphenated property names","2016-03-22","Use camelCase instead.",!0)&&(s=o(r)),"initial"!=n&&"initial"!=i||("initial"==n&&(n=l[s]),"initial"==i&&(i=l[s]));for(var c=n==i?[]:a[s],u=0;c&&u<c.length;u++){var h=c[u][0](n),f=c[u][0](i);if(void 0!==h&&void 0!==f){var p=c[u][1](h,f);if(p){var d=t.Interpolation.apply(null,p);return function(e){return 0==e?n:1==e?i:d(e)}}}}return t.Interpolation(!1,!0,function(e){return e?i:n})}var a={};t.addPropertiesHandler=i;var l={backgroundColor:"transparent",backgroundPosition:"0% 0%",borderBottomColor:"currentColor",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",borderBottomWidth:"3px",borderLeftColor:"currentColor",borderLeftWidth:"3px",borderRightColor:"currentColor",borderRightWidth:"3px",borderSpacing:"2px",borderTopColor:"currentColor",borderTopLeftRadius:"0px",borderTopRightRadius:"0px",borderTopWidth:"3px",bottom:"auto",clip:"rect(0px, 0px, 0px, 0px)",color:"black",fontSize:"100%",fontWeight:"400",height:"auto",left:"auto",letterSpacing:"normal",lineHeight:"120%",marginBottom:"0px",marginLeft:"0px",marginRight:"0px",marginTop:"0px",maxHeight:"none",maxWidth:"none",minHeight:"0px",minWidth:"0px",opacity:"1.0",outlineColor:"invert",outlineOffset:"0px",outlineWidth:"3px",paddingBottom:"0px",paddingLeft:"0px",paddingRight:"0px",paddingTop:"0px",right:"auto",textIndent:"0px",textShadow:"0px 0px 0px transparent",top:"auto",transform:"",verticalAlign:"0px",visibility:"visible",width:"auto",wordSpacing:"normal",zIndex:"auto"};t.propertyInterpolation=s}(c,d,f),function(e,t,r){function o(t){var r=e.calculateActiveDuration(t),o=function(o){return e.calculateTimeFraction(r,o,t)};return o._totalDuration=t.delay+r+t.endDelay,o._isCurrent=function(o){var n=e.calculatePhase(r,o,t);return n===PhaseActive||n===PhaseBefore},o}t.KeyframeEffect=function(r,n,i,s){var a,l=o(e.normalizeTimingInput(i)),c=t.convertEffectInput(n),u=function(){c(r,a)};return u._update=function(e){return a=l(e),null!==a},u._clear=function(){c(r,null)},u._hasSameTarget=function(e){return r===e},u._isCurrent=l._isCurrent,u._totalDuration=l._totalDuration,u._id=s,u},t.NullEffect=function(e){var t=function(){e&&(e(),e=null)};return t._update=function(){return null},t._totalDuration=0,t._isCurrent=function(){return!1},t._hasSameTarget=function(){return!1},t}}(c,d,f),function(e,t){e.apply=function(t,r,o){t.style[e.propertyName(r)]=o},e.clear=function(t,r){t.style[e.propertyName(r)]=""}}(d,f),function(e){window.Element.prototype.animate=function(t,r){var o="";return r&&r.id&&(o=r.id),e.timeline._play(e.KeyframeEffect(this,t,r,o))}}(d),function(e,t){function r(e,t,o){if("number"==typeof e&&"number"==typeof t)return e*(1-o)+t*o;if("boolean"==typeof e&&"boolean"==typeof t)return.5>o?e:t;if(e.length==t.length){for(var n=[],i=0;i<e.length;i++)n.push(r(e[i],t[i],o));return n}throw"Mismatched interpolation arguments "+e+":"+t}e.Interpolation=function(e,t,o){return function(n){return o(r(e,t,n))}}}(d,f),function(e,t,r){e.sequenceNumber=0;var o=function(e,t,r){this.target=e,this.currentTime=t,this.timelineTime=r,this.type="finish",this.bubbles=!1,this.cancelable=!1,this.currentTarget=e,this.defaultPrevented=!1,this.eventPhase=Event.AT_TARGET,this.timeStamp=Date.now()};t.Animation=function(t){this.id="",t&&t._id&&(this.id=t._id),this._sequenceNumber=e.sequenceNumber++,this._currentTime=0,this._startTime=null,this._paused=!1,this._playbackRate=1,this._inTimeline=!0,this._finishedFlag=!0,this.onfinish=null,this._finishHandlers=[],this._effect=t,this._inEffect=this._effect._update(0),this._idle=!0,this._currentTimePending=!1},t.Animation.prototype={_ensureAlive:function(){this.playbackRate<0&&0===this.currentTime?this._inEffect=this._effect._update(-1):this._inEffect=this._effect._update(this.currentTime),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,t.timeline._animations.push(this))},_tickCurrentTime:function(e,t){e!=this._currentTime&&(this._currentTime=e,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this._ensureAlive())},get currentTime(){return this._idle||this._currentTimePending?null:this._currentTime},set currentTime(e){e=+e,isNaN(e)||(t.restart(),this._paused||null==this._startTime||(this._startTime=this._timeline.currentTime-e/this._playbackRate),this._currentTimePending=!1,this._currentTime!=e&&(this._tickCurrentTime(e,!0),t.invalidateEffects()))},get startTime(){return this._startTime},set startTime(e){e=+e,isNaN(e)||this._paused||this._idle||(this._startTime=e,this._tickCurrentTime((this._timeline.currentTime-this._startTime)*this.playbackRate),t.invalidateEffects())},get playbackRate(){return this._playbackRate},set playbackRate(e){if(e!=this._playbackRate){var t=this.currentTime;this._playbackRate=e,this._startTime=null,"paused"!=this.playState&&"idle"!=this.playState&&this.play(),null!=t&&(this.currentTime=t)}},get _isFinished(){return!this._idle&&(this._playbackRate>0&&this._currentTime>=this._totalDuration||this._playbackRate<0&&this._currentTime<=0)},get _totalDuration(){return this._effect._totalDuration},get playState(){return this._idle?"idle":null==this._startTime&&!this._paused&&0!=this.playbackRate||this._currentTimePending?"pending":this._paused?"paused":this._isFinished?"finished":"running"},play:function(){this._paused=!1,(this._isFinished||this._idle)&&(this._currentTime=this._playbackRate>0?0:this._totalDuration,this._startTime=null),this._finishedFlag=!1,this._idle=!1,this._ensureAlive(),t.invalidateEffects()},pause:function(){this._isFinished||this._paused||this._idle||(this._currentTimePending=!0),this._startTime=null,this._paused=!0},finish:function(){this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this._currentTimePending=!1,t.invalidateEffects())},cancel:function(){this._inEffect&&(this._inEffect=!1,this._idle=!0,this._finishedFlag=!0,this.currentTime=0,this._startTime=null,this._effect._update(null),t.invalidateEffects())},reverse:function(){this.playbackRate*=-1,this.play()},addEventListener:function(e,t){"function"==typeof t&&"finish"==e&&this._finishHandlers.push(t)},removeEventListener:function(e,t){if("finish"==e){var r=this._finishHandlers.indexOf(t);r>=0&&this._finishHandlers.splice(r,1)}},_fireEvents:function(e){if(this._isFinished){if(!this._finishedFlag){var t=new o(this,this._currentTime,e),r=this._finishHandlers.concat(this.onfinish?[this.onfinish]:[]);setTimeout(function(){r.forEach(function(e){e.call(t.target,t)})},0),this._finishedFlag=!0}}else this._finishedFlag=!1},_tick:function(e,t){this._idle||this._paused||(null==this._startTime?t&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this._tickCurrentTime((e-this._startTime)*this.playbackRate)),t&&(this._currentTimePending=!1,this._fireEvents(e))},get _needsTick(){return this.playState in{pending:1,running:1}||!this._finishedFlag}}}(c,d,f),function(e,t,r){function o(e){var t=c;c=[],e<g.currentTime&&(e=g.currentTime),a(e,!0),t.forEach(function(t){t[1](e)}),s(),h=void 0}function n(e,t){return e._sequenceNumber-t._sequenceNumber}function i(){this._animations=[],this.currentTime=window.performance&&performance.now?performance.now():0}function s(){d.forEach(function(e){e()}),d.length=0}function a(e,r){p=!1;var o=t.timeline;o.currentTime=e,o._animations.sort(n),f=!1;var i=o._animations;o._animations=[];var s=[],a=[];i=i.filter(function(t){t._tick(e,r),t._inEffect?a.push(t._effect):s.push(t._effect),t._needsTick&&(f=!0);var o=t._inEffect||t._needsTick;return t._inTimeline=o,o}),d.push.apply(d,s),d.push.apply(d,a),o._animations.push.apply(o._animations,i),f&&requestAnimationFrame(function(){})}var l=window.requestAnimationFrame,c=[],u=0;window.requestAnimationFrame=function(e){var t=u++;return 0==c.length&&l(o),c.push([t,e]),t},window.cancelAnimationFrame=function(e){c.forEach(function(t){t[0]==e&&(t[1]=function(){})})},i.prototype={_play:function(r){r._timing=e.normalizeTimingInput(r.timing);var o=new t.Animation(r);return o._idle=!1,o._timeline=this,this._animations.push(o),t.restart(),t.invalidateEffects(),o}};var h=void 0,f=!1,p=!1;t.restart=function(){return f||(f=!0,requestAnimationFrame(function(){}),p=!0),p},t.invalidateEffects=function(){a(t.timeline.currentTime,!1),s()};var d=[],g=new i;t.timeline=g}(c,d,f),function(e){function t(e,t){var r=e.exec(t);return r?(r=e.ignoreCase?r[0].toLowerCase():r[0],[r,t.substr(r.length)]):void 0}function r(e,t){t=t.replace(/^\s*/,"");var r=e(t);return r?[r[0],r[1].replace(/^\s*/,"")]:void 0}function o(e,o,n){e=r.bind(null,e);for(var i=[];;){var s=e(n);if(!s)return[i,n];if(i.push(s[0]),n=s[1],s=t(o,n),!s||""==s[1])return[i,n];n=s[1]}}function n(e,t){for(var r=0,o=0;o<t.length&&(!/\s|,/.test(t[o])||0!=r);o++)if("("==t[o])r++;else if(")"==t[o]&&(r--,0==r&&o++,0>=r))break;var n=e(t.substr(0,o));return void 0==n?void 0:[n,t.substr(o)]}function i(e,t){for(var r=e,o=t;r&&o;)r>o?r%=o:o%=r;return r=e*t/(r+o)}function s(e){return function(t){var r=e(t);return r&&(r[0]=void 0),r}}function a(e,t){return function(r){var o=e(r);return o?o:[t,r]}}function l(t,r){for(var o=[],n=0;n<t.length;n++){var i=e.consumeTrimmed(t[n],r);if(!i||""==i[0])return;void 0!==i[0]&&o.push(i[0]),r=i[1]}return""==r?o:void 0}function c(e,t,r,o,n){for(var s=[],a=[],l=[],c=i(o.length,n.length),u=0;c>u;u++){var h=t(o[u%o.length],n[u%n.length]);if(!h)return;s.push(h[0]),a.push(h[1]),l.push(h[2])}return[s,a,function(t){var o=t.map(function(e,t){return l[t](e)}).join(r);return e?e(o):o}]}function u(e,t,r){for(var o=[],n=[],i=[],s=0,a=0;a<r.length;a++)if("function"==typeof r[a]){var l=r[a](e[s],t[s++]);o.push(l[0]),n.push(l[1]),i.push(l[2])}else!function(e){o.push(!1),n.push(!1),i.push(function(){return r[e]})}(a);return[o,n,function(e){for(var t="",r=0;r<e.length;r++)t+=i[r](e[r]);return t}]}e.consumeToken=t,e.consumeTrimmed=r,e.consumeRepeated=o,e.consumeParenthesised=n,e.ignore=s,e.optional=a,e.consumeList=l,e.mergeNestedRepeated=c.bind(null,null),e.mergeWrappedNestedRepeated=c,e.mergeList=u}(d),function(e){function t(t){function r(t){var r=e.consumeToken(/^inset/i,t);if(r)return o.inset=!0,r;var r=e.consumeLengthOrPercent(t);if(r)return o.lengths.push(r[0]),r;var r=e.consumeColor(t);return r?(o.color=r[0],r):void 0}var o={inset:!1,lengths:[],color:null},n=e.consumeRepeated(r,/^/,t);return n&&n[0].length?[o,n[1]]:void 0}function r(r){var o=e.consumeRepeated(t,/^,/,r);return o&&""==o[1]?o[0]:void 0}function o(t,r){for(;t.lengths.length<Math.max(t.lengths.length,r.lengths.length);)t.lengths.push({px:0});for(;r.lengths.length<Math.max(t.lengths.length,r.lengths.length);)r.lengths.push({px:0});if(t.inset==r.inset&&!!t.color==!!r.color){for(var o,n=[],i=[[],0],s=[[],0],a=0;a<t.lengths.length;a++){var l=e.mergeDimensions(t.lengths[a],r.lengths[a],2==a);i[0].push(l[0]),s[0].push(l[1]),n.push(l[2])}if(t.color&&r.color){var c=e.mergeColors(t.color,r.color);i[1]=c[0],s[1]=c[1],o=c[2]}return[i,s,function(e){for(var r=t.inset?"inset ":" ",i=0;i<n.length;i++)r+=n[i](e[0][i])+" ";return o&&(r+=o(e[1])),r}]}}function n(t,r,o,n){function i(e){return{inset:e,color:[0,0,0,0],lengths:[{px:0},{px:0},{px:0},{px:0}]}}for(var s=[],a=[],l=0;l<o.length||l<n.length;l++){var c=o[l]||i(n[l].inset),u=n[l]||i(o[l].inset);s.push(c),a.push(u)}return e.mergeNestedRepeated(t,r,s,a)}var i=n.bind(null,o,", ");e.addPropertiesHandler(r,i,["box-shadow","text-shadow"])}(d),function(e,t){function r(e){return e.toFixed(3).replace(".000","")}function o(e,t,r){return Math.min(t,Math.max(e,r))}function n(e){return/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?Number(e):void 0}function i(e,t){return[e,t,r]}function s(e,t){return 0!=e?l(0,1/0)(e,t):void 0}function a(e,t){return[e,t,function(e){return Math.round(o(1,1/0,e))}]}function l(e,t){return function(n,i){return[n,i,function(n){return r(o(e,t,n))}]}}function c(e,t){return[e,t,Math.round]}e.clamp=o,e.addPropertiesHandler(n,l(0,1/0),["border-image-width","line-height"]),e.addPropertiesHandler(n,l(0,1),["opacity","shape-image-threshold"]),
e.addPropertiesHandler(n,s,["flex-grow","flex-shrink"]),e.addPropertiesHandler(n,a,["orphans","widows"]),e.addPropertiesHandler(n,c,["z-index"]),e.parseNumber=n,e.mergeNumbers=i,e.numberToString=r}(d,f),function(e,t){function r(e,t){return"visible"==e||"visible"==t?[0,1,function(r){return 0>=r?e:r>=1?t:"visible"}]:void 0}e.addPropertiesHandler(String,r,["visibility"])}(d),function(e,t){function r(e){e=e.trim(),i.fillStyle="#000",i.fillStyle=e;var t=i.fillStyle;if(i.fillStyle="#fff",i.fillStyle=e,t==i.fillStyle){i.fillRect(0,0,1,1);var r=i.getImageData(0,0,1,1).data;i.clearRect(0,0,1,1);var o=r[3]/255;return[r[0]*o,r[1]*o,r[2]*o,o]}}function o(t,r){return[t,r,function(t){function r(e){return Math.max(0,Math.min(255,e))}if(t[3])for(var o=0;3>o;o++)t[o]=Math.round(r(t[o]/t[3]));return t[3]=e.numberToString(e.clamp(0,1,t[3])),"rgba("+t.join(",")+")"}]}var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=n.height=1;var i=n.getContext("2d");e.addPropertiesHandler(r,o,["background-color","border-bottom-color","border-left-color","border-right-color","border-top-color","color","outline-color","text-decoration-color"]),e.consumeColor=e.consumeParenthesised.bind(null,r),e.mergeColors=o}(d,f),function(a,b){function c(a,b){if(b=b.trim().toLowerCase(),"0"==b&&"px".search(a)>=0)return{px:0};if(/^[^(]*$|^calc/.test(b)){b=b.replace(/calc\(/g,"(");var c={};b=b.replace(a,function(e){return c[e]=null,"U"+e});for(var d="U("+a.source+")",e=b.replace(/[-+]?(\d*\.)?\d+/g,"N").replace(new RegExp("N"+d,"g"),"D").replace(/\s[+-]\s/g,"O").replace(/\s/g,""),f=[/N\*(D)/g,/(N|D)[*\/]N/g,/(N|D)O\1/g,/\((N|D)\)/g],g=0;g<f.length;)f[g].test(e)?(e=e.replace(f[g],"$1"),g=0):g++;if("D"==e){for(var h in c){var i=eval(b.replace(new RegExp("U"+h,"g"),"").replace(new RegExp(d,"g"),"*0"));if(!isFinite(i))return;c[h]=i}return c}}}function d(t,r){return e(t,r,!0)}function e(e,t,r){var o,n=[];for(o in e)n.push(o);for(o in t)n.indexOf(o)<0&&n.push(o);return e=n.map(function(t){return e[t]||0}),t=n.map(function(e){return t[e]||0}),[e,t,function(e){var t=e.map(function(t,o){return 1==e.length&&r&&(t=Math.max(t,0)),a.numberToString(t)+n[o]}).join(" + ");return e.length>1?"calc("+t+")":t}]}var f="px|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc",g=c.bind(null,new RegExp(f,"g")),h=c.bind(null,new RegExp(f+"|%","g")),i=c.bind(null,/deg|rad|grad|turn/g);a.parseLength=g,a.parseLengthOrPercent=h,a.consumeLengthOrPercent=a.consumeParenthesised.bind(null,h),a.parseAngle=i,a.mergeDimensions=e;var j=a.consumeParenthesised.bind(null,g),k=a.consumeRepeated.bind(void 0,j,/^/),l=a.consumeRepeated.bind(void 0,k,/^,/);a.consumeSizePairList=l;var m=function(e){var t=l(e);return t&&""==t[1]?t[0]:void 0},n=a.mergeNestedRepeated.bind(void 0,d," "),o=a.mergeNestedRepeated.bind(void 0,n,",");a.mergeNonNegativeSizePair=n,a.addPropertiesHandler(m,o,["background-size"]),a.addPropertiesHandler(h,d,["border-bottom-width","border-image-width","border-left-width","border-right-width","border-top-width","flex-basis","font-size","height","line-height","max-height","max-width","outline-width","width"]),a.addPropertiesHandler(h,e,["border-bottom-left-radius","border-bottom-right-radius","border-top-left-radius","border-top-right-radius","bottom","left","letter-spacing","margin-bottom","margin-left","margin-right","margin-top","min-height","min-width","outline-offset","padding-bottom","padding-left","padding-right","padding-top","perspective","right","shape-margin","text-indent","top","vertical-align","word-spacing"])}(d,f),function(e,t){function r(t){return e.consumeLengthOrPercent(t)||e.consumeToken(/^auto/,t)}function o(t){var o=e.consumeList([e.ignore(e.consumeToken.bind(null,/^rect/)),e.ignore(e.consumeToken.bind(null,/^\(/)),e.consumeRepeated.bind(null,r,/^,/),e.ignore(e.consumeToken.bind(null,/^\)/))],t);return o&&4==o[0].length?o[0]:void 0}function n(t,r){return"auto"==t||"auto"==r?[!0,!1,function(o){var n=o?t:r;if("auto"==n)return"auto";var i=e.mergeDimensions(n,n);return i[2](i[0])}]:e.mergeDimensions(t,r)}function i(e){return"rect("+e+")"}var s=e.mergeWrappedNestedRepeated.bind(null,i,n,", ");e.parseBox=o,e.mergeBoxes=s,e.addPropertiesHandler(o,s,["clip"])}(d,f),function(e,t){function r(e){return function(t){var r=0;return e.map(function(e){return e===u?t[r++]:e})}}function o(e){return e}function n(t){if(t=t.toLowerCase().trim(),"none"==t)return[];for(var r,o=/\s*(\w+)\(([^)]*)\)/g,n=[],i=0;r=o.exec(t);){if(r.index!=i)return;i=r.index+r[0].length;var s=r[1],a=p[s];if(!a)return;var l=r[2].split(","),c=a[0];if(c.length<l.length)return;for(var u=[],d=0;d<c.length;d++){var g,_=l[d],m=c[d];if(g=_?{A:function(t){return"0"==t.trim()?f:e.parseAngle(t)},N:e.parseNumber,T:e.parseLengthOrPercent,L:e.parseLength}[m.toUpperCase()](_):{a:f,n:u[0],t:h}[m],void 0===g)return;u.push(g)}if(n.push({t:s,d:u}),o.lastIndex==t.length)return n}}function i(e){return e.toFixed(6).replace(".000000","")}function s(t,r){if(t.decompositionPair!==r){t.decompositionPair=r;var o=e.makeMatrixDecomposition(t)}if(r.decompositionPair!==t){r.decompositionPair=t;var n=e.makeMatrixDecomposition(r)}return null==o[0]||null==n[0]?[[!1],[!0],function(e){return e?r[0].d:t[0].d}]:(o[0].push(0),n[0].push(1),[o,n,function(t){var r=e.quat(o[0][3],n[0][3],t[5]),s=e.composeMatrix(t[0],t[1],t[2],r,t[4]),a=s.map(i).join(",");return a}])}function a(e){return e.replace(/[xy]/,"")}function l(e){return e.replace(/(x|y|z|3d)?$/,"3d")}function c(t,r){var o=e.makeMatrixDecomposition&&!0,n=!1;if(!t.length||!r.length){t.length||(n=!0,t=r,r=[]);for(var i=0;i<t.length;i++){var c=t[i].t,u=t[i].d,h="scale"==c.substr(0,5)?1:0;r.push({t:c,d:u.map(function(e){if("number"==typeof e)return h;var t={};for(var r in e)t[r]=h;return t})})}}var f=function(e,t){return"perspective"==e&&"perspective"==t||("matrix"==e||"matrix3d"==e)&&("matrix"==t||"matrix3d"==t)},d=[],g=[],_=[];if(t.length!=r.length){if(!o)return;var m=s(t,r);d=[m[0]],g=[m[1]],_=[["matrix",[m[2]]]]}else for(var i=0;i<t.length;i++){var c,y=t[i].t,v=r[i].t,b=t[i].d,S=r[i].d,E=p[y],T=p[v];if(f(y,v)){if(!o)return;var m=s([t[i]],[r[i]]);d.push(m[0]),g.push(m[1]),_.push(["matrix",[m[2]]])}else{if(y==v)c=y;else if(E[2]&&T[2]&&a(y)==a(v))c=a(y),b=E[2](b),S=T[2](S);else{if(!E[1]||!T[1]||l(y)!=l(v)){if(!o)return;var m=s(t,r);d=[m[0]],g=[m[1]],_=[["matrix",[m[2]]]];break}c=l(y),b=E[1](b),S=T[1](S)}for(var C=[],P=[],N=[],A=0;A<b.length;A++){var w="number"==typeof b[A]?e.mergeNumbers:e.mergeDimensions,m=w(b[A],S[A]);C[A]=m[0],P[A]=m[1],N.push(m[2])}d.push(C),g.push(P),_.push([c,N])}}if(n){var x=d;d=g,g=x}return[d,g,function(e){return e.map(function(e,t){var r=e.map(function(e,r){return _[t][1][r](e)}).join(",");return"matrix"==_[t][0]&&16==r.split(",").length&&(_[t][0]="matrix3d"),_[t][0]+"("+r+")"}).join(" ")}]}var u=null,h={px:0},f={deg:0},p={matrix:["NNNNNN",[u,u,0,0,u,u,0,0,0,0,1,0,u,u,0,1],o],matrix3d:["NNNNNNNNNNNNNNNN",o],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",r([u,u,1]),o],scalex:["N",r([u,1,1]),r([u,1])],scaley:["N",r([1,u,1]),r([1,u])],scalez:["N",r([1,1,u])],scale3d:["NNN",o],skew:["Aa",null,o],skewx:["A",null,r([u,f])],skewy:["A",null,r([f,u])],translate:["Tt",r([u,u,h]),o],translatex:["T",r([u,h,h]),r([u,h])],translatey:["T",r([h,u,h]),r([h,u])],translatez:["L",r([h,h,u])],translate3d:["TTL",o]};e.addPropertiesHandler(n,c,["transform"])}(d,f),function(e,t){function r(e,t){t.concat([e]).forEach(function(t){t in document.documentElement.style&&(o[e]=t)})}var o={};r("transform",["webkitTransform","msTransform"]),r("transformOrigin",["webkitTransformOrigin"]),r("perspective",["webkitPerspective"]),r("perspectiveOrigin",["webkitPerspectiveOrigin"]),e.propertyName=function(e){return o[e]||e}}(d,f)}(),!function(){if(void 0===document.createElement("div").animate([]).oncancel){var e;if(window.performance&&performance.now)var e=function(){return performance.now()};else var e=function(){return Date.now()};var t=function(e,t,r){this.target=e,this.currentTime=t,this.timelineTime=r,this.type="cancel",this.bubbles=!1,this.cancelable=!1,this.currentTarget=e,this.defaultPrevented=!1,this.eventPhase=Event.AT_TARGET,this.timeStamp=Date.now()},r=window.Element.prototype.animate;window.Element.prototype.animate=function(o,n){var i=r.call(this,o,n);i._cancelHandlers=[],i.oncancel=null;var s=i.cancel;i.cancel=function(){s.call(this);var r=new t(this,null,e()),o=this._cancelHandlers.concat(this.oncancel?[this.oncancel]:[]);setTimeout(function(){o.forEach(function(e){e.call(r.target,r)})},0)};var a=i.addEventListener;i.addEventListener=function(e,t){"function"==typeof t&&"cancel"==e?this._cancelHandlers.push(t):a.call(this,e,t)};var l=i.removeEventListener;return i.removeEventListener=function(e,t){if("cancel"==e){var r=this._cancelHandlers.indexOf(t);r>=0&&this._cancelHandlers.splice(r,1)}else l.call(this,e,t)},i}}}(),function(e){var t=document.documentElement,r=null,o=!1;try{var n=getComputedStyle(t).getPropertyValue("opacity"),i="0"==n?"1":"0";r=t.animate({opacity:[i,i]},{duration:1}),r.currentTime=0,o=getComputedStyle(t).getPropertyValue("opacity")==i}catch(s){}finally{r&&r.cancel()}if(!o){var a=window.Element.prototype.animate;window.Element.prototype.animate=function(t,r){return window.Symbol&&Symbol.iterator&&Array.prototype.from&&t[Symbol.iterator]&&(t=Array.from(t)),Array.isArray(t)||null===t||(t=e.convertToArrayForm(t)),a.call(this,t,r)}}}(c),!function(e,t,r){function o(e){var t=window.document.timeline;t.currentTime=e,t._discardAnimations(),0==t._animations.length?i=!1:requestAnimationFrame(o)}var n=window.requestAnimationFrame;window.requestAnimationFrame=function(e){return n(function(t){window.document.timeline._updateAnimationsPromises(),e(t),window.document.timeline._updateAnimationsPromises()})},t.AnimationTimeline=function(){this._animations=[],this.currentTime=void 0},t.AnimationTimeline.prototype={getAnimations:function(){return this._discardAnimations(),this._animations.slice()},_updateAnimationsPromises:function(){t.animationsWithPromises=t.animationsWithPromises.filter(function(e){return e._updatePromises()})},_discardAnimations:function(){this._updateAnimationsPromises(),this._animations=this._animations.filter(function(e){return"finished"!=e.playState&&"idle"!=e.playState})},_play:function(e){var r=new t.Animation(e,this);return this._animations.push(r),t.restartWebAnimationsNextTick(),r._updatePromises(),r._animation.play(),r._updatePromises(),r},play:function(e){return e&&e.remove(),this._play(e)}};var i=!1;t.restartWebAnimationsNextTick=function(){i||(i=!0,requestAnimationFrame(o))};var s=new t.AnimationTimeline;t.timeline=s;try{Object.defineProperty(window.document,"timeline",{configurable:!0,get:function(){return s}})}catch(a){}try{window.document.timeline=s}catch(a){}}(c,e,f),function(e,t,r){t.animationsWithPromises=[],t.Animation=function(t,r){if(this.id="",t&&t._id&&(this.id=t._id),this.effect=t,t&&(t._animation=this),!r)throw new Error("Animation with null timeline is not supported");this._timeline=r,this._sequenceNumber=e.sequenceNumber++,this._holdTime=0,this._paused=!1,this._isGroup=!1,this._animation=null,this._childAnimations=[],this._callback=null,this._oldPlayState="idle",this._rebuildUnderlyingAnimation(),this._animation.cancel(),this._updatePromises()},t.Animation.prototype={_updatePromises:function(){var e=this._oldPlayState,t=this.playState;return this._readyPromise&&t!==e&&("idle"==t?(this._rejectReadyPromise(),this._readyPromise=void 0):"pending"==e?this._resolveReadyPromise():"pending"==t&&(this._readyPromise=void 0)),this._finishedPromise&&t!==e&&("idle"==t?(this._rejectFinishedPromise(),this._finishedPromise=void 0):"finished"==t?this._resolveFinishedPromise():"finished"==e&&(this._finishedPromise=void 0)),this._oldPlayState=this.playState,this._readyPromise||this._finishedPromise},_rebuildUnderlyingAnimation:function(){this._updatePromises();var e,r,o,n,i=!!this._animation;i&&(e=this.playbackRate,r=this._paused,o=this.startTime,n=this.currentTime,this._animation.cancel(),this._animation._wrapper=null,this._animation=null),(!this.effect||this.effect instanceof window.KeyframeEffect)&&(this._animation=t.newUnderlyingAnimationForKeyframeEffect(this.effect),t.bindAnimationForKeyframeEffect(this)),(this.effect instanceof window.SequenceEffect||this.effect instanceof window.GroupEffect)&&(this._animation=t.newUnderlyingAnimationForGroup(this.effect),t.bindAnimationForGroup(this)),this.effect&&this.effect._onsample&&t.bindAnimationForCustomEffect(this),i&&(1!=e&&(this.playbackRate=e),null!==o?this.startTime=o:null!==n?this.currentTime=n:null!==this._holdTime&&(this.currentTime=this._holdTime),r&&this.pause()),this._updatePromises()},_updateChildren:function(){if(this.effect&&"idle"!=this.playState){var e=this.effect._timing.delay;this._childAnimations.forEach(function(r){this._arrangeChildren(r,e),this.effect instanceof window.SequenceEffect&&(e+=t.groupChildDuration(r.effect))}.bind(this))}},_setExternalAnimation:function(e){if(this.effect&&this._isGroup)for(var t=0;t<this.effect.children.length;t++)this.effect.children[t]._animation=e,this._childAnimations[t]._setExternalAnimation(e)},_constructChildAnimations:function(){if(this.effect&&this._isGroup){var e=this.effect._timing.delay;this._removeChildAnimations(),this.effect.children.forEach(function(r){var o=window.document.timeline._play(r);this._childAnimations.push(o),o.playbackRate=this.playbackRate,this._paused&&o.pause(),r._animation=this.effect._animation,this._arrangeChildren(o,e),this.effect instanceof window.SequenceEffect&&(e+=t.groupChildDuration(r))}.bind(this))}},_arrangeChildren:function(e,t){null===this.startTime?e.currentTime=this.currentTime-t/this.playbackRate:e.startTime!==this.startTime+t/this.playbackRate&&(e.startTime=this.startTime+t/this.playbackRate)},get timeline(){return this._timeline},get playState(){return this._animation?this._animation.playState:"idle"},get finished(){return window.Promise?(this._finishedPromise||(-1==t.animationsWithPromises.indexOf(this)&&t.animationsWithPromises.push(this),this._finishedPromise=new Promise(function(e,t){this._resolveFinishedPromise=function(){e(this)},this._rejectFinishedPromise=function(){t({type:DOMException.ABORT_ERR,name:"AbortError"})}}.bind(this)),"finished"==this.playState&&this._resolveFinishedPromise()),this._finishedPromise):(console.warn("Animation Promises require JavaScript Promise constructor"),null)},get ready(){return window.Promise?(this._readyPromise||(-1==t.animationsWithPromises.indexOf(this)&&t.animationsWithPromises.push(this),this._readyPromise=new Promise(function(e,t){this._resolveReadyPromise=function(){e(this)},this._rejectReadyPromise=function(){t({type:DOMException.ABORT_ERR,name:"AbortError"})}}.bind(this)),"pending"!==this.playState&&this._resolveReadyPromise()),this._readyPromise):(console.warn("Animation Promises require JavaScript Promise constructor"),null)},get onfinish(){return this._animation.onfinish},set onfinish(e){"function"==typeof e?this._animation.onfinish=function(t){t.target=this,e.call(this,t)}.bind(this):this._animation.onfinish=e},get oncancel(){return this._animation.oncancel},set oncancel(e){"function"==typeof e?this._animation.oncancel=function(t){t.target=this,e.call(this,t)}.bind(this):this._animation.oncancel=e},get currentTime(){this._updatePromises();var e=this._animation.currentTime;return this._updatePromises(),e},set currentTime(e){this._updatePromises(),this._animation.currentTime=isFinite(e)?e:Math.sign(e)*Number.MAX_VALUE,this._register(),this._forEachChild(function(t,r){t.currentTime=e-r}),this._updatePromises()},get startTime(){return this._animation.startTime},set startTime(e){this._updatePromises(),this._animation.startTime=isFinite(e)?e:Math.sign(e)*Number.MAX_VALUE,this._register(),this._forEachChild(function(t,r){t.startTime=e+r}),this._updatePromises()},get playbackRate(){return this._animation.playbackRate},set playbackRate(e){this._updatePromises();var t=this.currentTime;this._animation.playbackRate=e,this._forEachChild(function(t){t.playbackRate=e}),"paused"!=this.playState&&"idle"!=this.playState&&this.play(),null!==t&&(this.currentTime=t),this._updatePromises()},play:function(){this._updatePromises(),this._paused=!1,this._animation.play(),-1==this._timeline._animations.indexOf(this)&&this._timeline._animations.push(this),this._register(),t.awaitStartTime(this),this._forEachChild(function(e){var t=e.currentTime;e.play(),e.currentTime=t}),this._updatePromises()},pause:function(){this._updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._animation.pause(),this._register(),this._forEachChild(function(e){e.pause()}),this._paused=!0,this._updatePromises()},finish:function(){this._updatePromises(),this._animation.finish(),this._register(),this._updatePromises()},cancel:function(){this._updatePromises(),this._animation.cancel(),this._register(),this._removeChildAnimations(),this._updatePromises()},reverse:function(){this._updatePromises();var e=this.currentTime;this._animation.reverse(),this._forEachChild(function(e){e.reverse()}),null!==e&&(this.currentTime=e),this._updatePromises()},addEventListener:function(e,t){var r=t;"function"==typeof t&&(r=function(e){e.target=this,t.call(this,e)}.bind(this),t._wrapper=r),this._animation.addEventListener(e,r)},removeEventListener:function(e,t){this._animation.removeEventListener(e,t&&t._wrapper||t)},_removeChildAnimations:function(){for(;this._childAnimations.length;)this._childAnimations.pop().cancel()},_forEachChild:function(t){var r=0;if(this.effect.children&&this._childAnimations.length<this.effect.children.length&&this._constructChildAnimations(),this._childAnimations.forEach(function(e){t.call(this,e,r),this.effect instanceof window.SequenceEffect&&(r+=e.effect.activeDuration)}.bind(this)),"pending"!=this.playState){var o=this.effect._timing,n=this.currentTime;null!==n&&(n=e.calculateTimeFraction(e.calculateActiveDuration(o),n,o)),(null==n||isNaN(n))&&this._removeChildAnimations()}}},window.Animation=t.Animation}(c,e,f),function(e,t,r){function o(t){this._frames=e.normalizeKeyframes(t)}function n(){for(var e=!1;l.length;){var t=l.shift();t._updateChildren(),e=!0}return e}var i=function(e){if(e._animation=void 0,e instanceof window.SequenceEffect||e instanceof window.GroupEffect)for(var t=0;t<e.children.length;t++)i(e.children[t])};t.removeMulti=function(e){for(var t=[],r=0;r<e.length;r++){var o=e[r];o._parent?(-1==t.indexOf(o._parent)&&t.push(o._parent),o._parent.children.splice(o._parent.children.indexOf(o),1),o._parent=null,i(o)):o._animation&&o._animation.effect==o&&(o._animation.cancel(),o._animation.effect=new KeyframeEffect(null,[]),o._animation._callback&&(o._animation._callback._animation=null),o._animation._rebuildUnderlyingAnimation(),i(o))}for(r=0;r<t.length;r++)t[r]._rebuild()},t.KeyframeEffect=function(t,r,n,i){return this.target=t,this._parent=null,n=e.numericTimingToObject(n),this._timingInput=e.cloneTimingInput(n),this._timing=e.normalizeTimingInput(n),this.timing=e.makeTiming(n,!1,this),this.timing._effect=this,"function"==typeof r?(e.deprecated("Custom KeyframeEffect","2015-06-22","Use KeyframeEffect.onsample instead."),this._normalizedKeyframes=r):this._normalizedKeyframes=new o(r),this._keyframes=r,this.activeDuration=e.calculateActiveDuration(this._timing),this._id=i,this},t.KeyframeEffect.prototype={getFrames:function(){return"function"==typeof this._normalizedKeyframes?this._normalizedKeyframes:this._normalizedKeyframes._frames},set onsample(e){if("function"==typeof this.getFrames())throw new Error("Setting onsample on custom effect KeyframeEffect is not supported.");this._onsample=e,this._animation&&this._animation._rebuildUnderlyingAnimation()},get parent(){return this._parent},clone:function(){if("function"==typeof this.getFrames())throw new Error("Cloning custom effects is not supported.");var t=new KeyframeEffect(this.target,[],e.cloneTimingInput(this._timingInput),this._id);return t._normalizedKeyframes=this._normalizedKeyframes,t._keyframes=this._keyframes,t},remove:function(){t.removeMulti([this])}};var s=Element.prototype.animate;Element.prototype.animate=function(e,r){var o="";return r&&r.id&&(o=r.id),t.timeline._play(new t.KeyframeEffect(this,e,r,o))};var a=document.createElementNS("http://www.w3.org/1999/xhtml","div");t.newUnderlyingAnimationForKeyframeEffect=function(e){if(e){var t=e.target||a,r=e._keyframes;"function"==typeof r&&(r=[]);var o=e._timingInput;o.id=e._id}else var t=a,r=[],o=0;return s.apply(t,[r,o])},t.bindAnimationForKeyframeEffect=function(e){e.effect&&"function"==typeof e.effect._normalizedKeyframes&&t.bindAnimationForCustomEffect(e)};var l=[];t.awaitStartTime=function(e){null===e.startTime&&e._isGroup&&(0==l.length&&requestAnimationFrame(n),l.push(e))};var c=window.getComputedStyle;Object.defineProperty(window,"getComputedStyle",{configurable:!0,enumerable:!0,value:function(){window.document.timeline._updateAnimationsPromises();var e=c.apply(this,arguments);return n()&&(e=c.apply(this,arguments)),window.document.timeline._updateAnimationsPromises(),e}}),window.KeyframeEffect=t.KeyframeEffect,window.Element.prototype.getAnimations=function(){return document.timeline.getAnimations().filter(function(e){return null!==e.effect&&e.effect.target==this}.bind(this))}}(c,e,f),function(e,t,r){function o(e){e._registered||(e._registered=!0,s.push(e),a||(a=!0,requestAnimationFrame(n)))}function n(e){var t=s;s=[],t.sort(function(e,t){return e._sequenceNumber-t._sequenceNumber}),t=t.filter(function(e){e();var t=e._animation?e._animation.playState:"idle";return"running"!=t&&"pending"!=t&&(e._registered=!1),e._registered}),s.push.apply(s,t),s.length?(a=!0,requestAnimationFrame(n)):a=!1}var i=(document.createElementNS("http://www.w3.org/1999/xhtml","div"),0);t.bindAnimationForCustomEffect=function(t){var r,n=t.effect.target,s="function"==typeof t.effect.getFrames();r=s?t.effect.getFrames():t.effect._onsample;var a=t.effect.timing,l=null;a=e.normalizeTimingInput(a);var c=function(){var o=c._animation?c._animation.currentTime:null;null!==o&&(o=e.calculateTimeFraction(e.calculateActiveDuration(a),o,a),isNaN(o)&&(o=null)),o!==l&&(s?r(o,n,t.effect):r(o,t.effect,t.effect._animation)),l=o};c._animation=t,c._registered=!1,c._sequenceNumber=i++,t._callback=c,o(c)};var s=[],a=!1;t.Animation.prototype._register=function(){this._callback&&o(this._callback)}}(c,e,f),function(e,t,r){function o(e){return e._timing.delay+e.activeDuration+e._timing.endDelay}function n(t,r,o){this._id=o,this._parent=null,this.children=t||[],this._reparent(this.children),r=e.numericTimingToObject(r),this._timingInput=e.cloneTimingInput(r),this._timing=e.normalizeTimingInput(r,!0),this.timing=e.makeTiming(r,!0,this),this.timing._effect=this,"auto"===this._timing.duration&&(this._timing.duration=this.activeDuration)}window.SequenceEffect=function(){n.apply(this,arguments)},window.GroupEffect=function(){n.apply(this,arguments)},n.prototype={_isAncestor:function(e){for(var t=this;null!==t;){if(t==e)return!0;t=t._parent}return!1},_rebuild:function(){for(var e=this;e;)"auto"===e.timing.duration&&(e._timing.duration=e.activeDuration),e=e._parent;this._animation&&this._animation._rebuildUnderlyingAnimation()},_reparent:function(e){t.removeMulti(e);for(var r=0;r<e.length;r++)e[r]._parent=this},_putChild:function(e,t){for(var r=t?"Cannot append an ancestor or self":"Cannot prepend an ancestor or self",o=0;o<e.length;o++)if(this._isAncestor(e[o]))throw{type:DOMException.HIERARCHY_REQUEST_ERR,name:"HierarchyRequestError",message:r};for(var o=0;o<e.length;o++)t?this.children.push(e[o]):this.children.unshift(e[o]);this._reparent(e),this._rebuild()},append:function(){this._putChild(arguments,!0)},prepend:function(){this._putChild(arguments,!1)},get parent(){return this._parent},get firstChild(){return this.children.length?this.children[0]:null},get lastChild(){return this.children.length?this.children[this.children.length-1]:null},clone:function(){for(var t=e.cloneTimingInput(this._timingInput),r=[],o=0;o<this.children.length;o++)r.push(this.children[o].clone());return this instanceof GroupEffect?new GroupEffect(r,t):new SequenceEffect(r,t)},remove:function(){t.removeMulti([this])}},window.SequenceEffect.prototype=Object.create(n.prototype),Object.defineProperty(window.SequenceEffect.prototype,"activeDuration",{get:function(){var e=0;return this.children.forEach(function(t){e+=o(t)}),Math.max(e,0)}}),window.GroupEffect.prototype=Object.create(n.prototype),Object.defineProperty(window.GroupEffect.prototype,"activeDuration",{get:function(){var e=0;return this.children.forEach(function(t){e=Math.max(e,o(t))}),e}}),t.newUnderlyingAnimationForGroup=function(r){var o,n=null,i=function(t){var r=o._wrapper;return r&&"pending"!=r.playState&&r.effect?null==t?void r._removeChildAnimations():0==t&&r.playbackRate<0&&(n||(n=e.normalizeTimingInput(r.effect.timing)),t=e.calculateTimeFraction(e.calculateActiveDuration(n),-1,n),isNaN(t)||null==t)?(r._forEachChild(function(e){e.currentTime=-1}),void r._removeChildAnimations()):void 0:void 0},s=new KeyframeEffect(null,[],r._timing,r._id);return s.onsample=i,o=t.timeline._play(s)},t.bindAnimationForGroup=function(e){e._animation._wrapper=e,e._isGroup=!0,t.awaitStartTime(e),e._constructChildAnimations(),e._setExternalAnimation(e)},t.groupChildDuration=o}(c,e,f),b["true"]=a}({},function(){return this}()),Polymer({is:"opaque-animation",behaviors:[Polymer.NeonAnimationBehavior],configure:function(e){var t=e.node;return this._effect=new KeyframeEffect(t,[{opacity:"1"},{opacity:"1"}],this.timingFromConfig(e)),t.style.opacity="0",this._effect},complete:function(e){e.node.style.opacity=""}}),function(){"use strict";var e={pageX:0,pageY:0},t=null,r=[];Polymer.IronDropdownScrollManager={get currentLockingElement(){return this._lockingElements[this._lockingElements.length-1]},elementIsScrollLocked:function(e){var t=this.currentLockingElement;if(void 0===t)return!1;var r;return!!this._hasCachedLockedElement(e)||!this._hasCachedUnlockedElement(e)&&(r=!!t&&t!==e&&!this._composedTreeContains(t,e),r?this._lockedElementCache.push(e):this._unlockedElementCache.push(e),r)},pushScrollLock:function(e){this._lockingElements.indexOf(e)>=0||(0===this._lockingElements.length&&this._lockScrollInteractions(),this._lockingElements.push(e),this._lockedElementCache=[],this._unlockedElementCache=[])},removeScrollLock:function(e){var t=this._lockingElements.indexOf(e);t!==-1&&(this._lockingElements.splice(t,1),this._lockedElementCache=[],this._unlockedElementCache=[],0===this._lockingElements.length&&this._unlockScrollInteractions())},_lockingElements:[],_lockedElementCache:null,_unlockedElementCache:null,_isScrollingKeypress:function(e){return Polymer.IronA11yKeysBehavior.keyboardEventMatchesKeys(e,"pageup pagedown home end up left down right")},_hasCachedLockedElement:function(e){return this._lockedElementCache.indexOf(e)>-1},_hasCachedUnlockedElement:function(e){return this._unlockedElementCache.indexOf(e)>-1},_composedTreeContains:function(e,t){var r,o,n,i;if(e.contains(t))return!0;for(r=Polymer.dom(e).querySelectorAll("content"),n=0;n<r.length;++n)for(o=Polymer.dom(r[n]).getDistributedNodes(),i=0;i<o.length;++i)if(this._composedTreeContains(o[i],t))return!0;return!1},_scrollInteractionHandler:function(t){if(t.cancelable&&this._shouldPreventScrolling(t)&&t.preventDefault(),t.targetTouches){var r=t.targetTouches[0];e.pageX=r.pageX,e.pageY=r.pageY}},_lockScrollInteractions:function(){this._boundScrollHandler=this._boundScrollHandler||this._scrollInteractionHandler.bind(this),document.addEventListener("wheel",this._boundScrollHandler,!0),document.addEventListener("mousewheel",this._boundScrollHandler,!0),document.addEventListener("DOMMouseScroll",this._boundScrollHandler,!0),document.addEventListener("touchstart",this._boundScrollHandler,!0),document.addEventListener("touchmove",this._boundScrollHandler,!0),document.addEventListener("keydown",this._boundScrollHandler,!0)},_unlockScrollInteractions:function(){document.removeEventListener("wheel",this._boundScrollHandler,!0),document.removeEventListener("mousewheel",this._boundScrollHandler,!0),document.removeEventListener("DOMMouseScroll",this._boundScrollHandler,!0),document.removeEventListener("touchstart",this._boundScrollHandler,!0),document.removeEventListener("touchmove",this._boundScrollHandler,!0),document.removeEventListener("keydown",this._boundScrollHandler,!0)},_shouldPreventScrolling:function(e){if("keydown"===e.type)return this._isScrollingKeypress(e);var o=Polymer.dom(e).rootTarget;if("touchmove"!==e.type&&t!==o&&(t=o,r=this._getScrollableNodes(Polymer.dom(e).path)),!r.length)return!0;if("touchstart"===e.type)return!1;var n=this._getScrollInfo(e);return!this._getScrollingNode(r,n.deltaX,n.deltaY)},_getScrollableNodes:function(e){for(var t=[],r=e.indexOf(this.currentLockingElement),o=0;o<=r;o++){var n=e[o];if(11!==n.nodeType){var i=n.style;"scroll"!==i.overflow&&"auto"!==i.overflow&&(i=window.getComputedStyle(n)),"scroll"!==i.overflow&&"auto"!==i.overflow||t.push(n)}}return t},_getScrollingNode:function(e,t,r){if(t||r)for(var o=Math.abs(r)>=Math.abs(t),n=0;n<e.length;n++){var i=e[n],s=!1;if(s=o?r<0?i.scrollTop>0:i.scrollTop<i.scrollHeight-i.clientHeight:t<0?i.scrollLeft>0:i.scrollLeft<i.scrollWidth-i.clientWidth)return i}},_getScrollInfo:function(t){var r={deltaX:t.deltaX,deltaY:t.deltaY};if("deltaX"in t);else if("wheelDeltaX"in t)r.deltaX=-t.wheelDeltaX,r.deltaY=-t.wheelDeltaY;else if("axis"in t)r.deltaX=1===t.axis?t.detail:0,r.deltaY=2===t.axis?t.detail:0;else if(t.targetTouches){var o=t.targetTouches[0];r.deltaX=e.pageX-o.pageX,r.deltaY=e.pageY-o.pageY}return r}}}(),function(){"use strict";Polymer({is:"iron-dropdown",behaviors:[Polymer.IronControlState,Polymer.IronA11yKeysBehavior,Polymer.IronOverlayBehavior,Polymer.NeonAnimationRunnerBehavior],properties:{horizontalAlign:{type:String,value:"left",reflectToAttribute:!0},verticalAlign:{type:String,value:"top",reflectToAttribute:!0},openAnimationConfig:{type:Object},closeAnimationConfig:{type:Object},focusTarget:{type:Object},noAnimations:{type:Boolean,value:!1},allowOutsideScroll:{type:Boolean,value:!1},_boundOnCaptureScroll:{type:Function,value:function(){return this._onCaptureScroll.bind(this)}}},listeners:{"neon-animation-finish":"_onNeonAnimationFinish"},observers:["_updateOverlayPosition(positionTarget, verticalAlign, horizontalAlign, verticalOffset, horizontalOffset)"],get containedElement(){return Polymer.dom(this.$.content).getDistributedNodes()[0]},get _focusTarget(){return this.focusTarget||this.containedElement},ready:function(){this._scrollTop=0,this._scrollLeft=0,this._refitOnScrollRAF=null},detached:function(){this.cancelAnimation(),Polymer.IronDropdownScrollManager.removeScrollLock(this)},_openedChanged:function(){this.opened&&this.disabled?this.cancel():(this.cancelAnimation(),this.sizingTarget=this.containedElement||this.sizingTarget,this._updateAnimationConfig(),this._saveScrollPosition(),this.opened?(document.addEventListener("scroll",this._boundOnCaptureScroll),!this.allowOutsideScroll&&Polymer.IronDropdownScrollManager.pushScrollLock(this)):(document.removeEventListener("scroll",this._boundOnCaptureScroll),Polymer.IronDropdownScrollManager.removeScrollLock(this)),Polymer.IronOverlayBehaviorImpl._openedChanged.apply(this,arguments))},_renderOpened:function(){!this.noAnimations&&this.animationConfig.open?(this.$.contentWrapper.classList.add("animating"),this.playAnimation("open")):Polymer.IronOverlayBehaviorImpl._renderOpened.apply(this,arguments)},_renderClosed:function(){!this.noAnimations&&this.animationConfig.close?(this.$.contentWrapper.classList.add("animating"),this.playAnimation("close")):Polymer.IronOverlayBehaviorImpl._renderClosed.apply(this,arguments)},_onNeonAnimationFinish:function(){this.$.contentWrapper.classList.remove("animating"),this.opened?this._finishRenderOpened():this._finishRenderClosed()},_onCaptureScroll:function(){this.allowOutsideScroll?(this._refitOnScrollRAF&&window.cancelAnimationFrame(this._refitOnScrollRAF),
this._refitOnScrollRAF=window.requestAnimationFrame(this.refit.bind(this))):this._restoreScrollPosition()},_saveScrollPosition:function(){document.scrollingElement?(this._scrollTop=document.scrollingElement.scrollTop,this._scrollLeft=document.scrollingElement.scrollLeft):(this._scrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._scrollLeft=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft))},_restoreScrollPosition:function(){document.scrollingElement?(document.scrollingElement.scrollTop=this._scrollTop,document.scrollingElement.scrollLeft=this._scrollLeft):(document.documentElement.scrollTop=this._scrollTop,document.documentElement.scrollLeft=this._scrollLeft,document.body.scrollTop=this._scrollTop,document.body.scrollLeft=this._scrollLeft)},_updateAnimationConfig:function(){for(var e=(this.openAnimationConfig||[]).concat(this.closeAnimationConfig||[]),t=0;t<e.length;t++)e[t].node=this.containedElement;this.animationConfig={open:this.openAnimationConfig,close:this.closeAnimationConfig}},_updateOverlayPosition:function(){this.isAttached&&this.notifyResize()},_applyFocus:function(){var e=this.focusTarget||this.containedElement;e&&this.opened&&!this.noAutoFocus?e.focus():Polymer.IronOverlayBehaviorImpl._applyFocus.apply(this,arguments)}})}(),Polymer({is:"fade-in-animation",behaviors:[Polymer.NeonAnimationBehavior],configure:function(e){var t=e.node;return this._effect=new KeyframeEffect(t,[{opacity:"0"},{opacity:"1"}],this.timingFromConfig(e)),this._effect}}),Polymer({is:"fade-out-animation",behaviors:[Polymer.NeonAnimationBehavior],configure:function(e){var t=e.node;return this._effect=new KeyframeEffect(t,[{opacity:"1"},{opacity:"0"}],this.timingFromConfig(e)),this._effect}}),Polymer({is:"paper-menu-grow-height-animation",behaviors:[Polymer.NeonAnimationBehavior],configure:function(e){var t=e.node,r=t.getBoundingClientRect(),o=r.height;return this._effect=new KeyframeEffect(t,[{height:o/2+"px"},{height:o+"px"}],this.timingFromConfig(e)),this._effect}}),Polymer({is:"paper-menu-grow-width-animation",behaviors:[Polymer.NeonAnimationBehavior],configure:function(e){var t=e.node,r=t.getBoundingClientRect(),o=r.width;return this._effect=new KeyframeEffect(t,[{width:o/2+"px"},{width:o+"px"}],this.timingFromConfig(e)),this._effect}}),Polymer({is:"paper-menu-shrink-width-animation",behaviors:[Polymer.NeonAnimationBehavior],configure:function(e){var t=e.node,r=t.getBoundingClientRect(),o=r.width;return this._effect=new KeyframeEffect(t,[{width:o+"px"},{width:o-o/20+"px"}],this.timingFromConfig(e)),this._effect}}),Polymer({is:"paper-menu-shrink-height-animation",behaviors:[Polymer.NeonAnimationBehavior],configure:function(e){var t=e.node,r=t.getBoundingClientRect(),o=r.height;r.top;return this.setPrefixedProperty(t,"transformOrigin","0 0"),this._effect=new KeyframeEffect(t,[{height:o+"px",transform:"translateY(0)"},{height:o/2+"px",transform:"translateY(-20px)"}],this.timingFromConfig(e)),this._effect}}),function(){"use strict";var e={ANIMATION_CUBIC_BEZIER:"cubic-bezier(.3,.95,.5,1)",MAX_ANIMATION_TIME_MS:400},t=Polymer({is:"paper-menu-button",behaviors:[Polymer.IronA11yKeysBehavior,Polymer.IronControlState],properties:{opened:{type:Boolean,value:!1,notify:!0,observer:"_openedChanged"},horizontalAlign:{type:String,value:"left",reflectToAttribute:!0},verticalAlign:{type:String,value:"top",reflectToAttribute:!0},dynamicAlign:{type:Boolean},horizontalOffset:{type:Number,value:0,notify:!0},verticalOffset:{type:Number,value:0,notify:!0},noOverlap:{type:Boolean},noAnimations:{type:Boolean,value:!1},ignoreSelect:{type:Boolean,value:!1},closeOnActivate:{type:Boolean,value:!1},openAnimationConfig:{type:Object,value:function(){return[{name:"fade-in-animation",timing:{delay:100,duration:200}},{name:"paper-menu-grow-width-animation",timing:{delay:100,duration:150,easing:e.ANIMATION_CUBIC_BEZIER}},{name:"paper-menu-grow-height-animation",timing:{delay:100,duration:275,easing:e.ANIMATION_CUBIC_BEZIER}}]}},closeAnimationConfig:{type:Object,value:function(){return[{name:"fade-out-animation",timing:{duration:150}},{name:"paper-menu-shrink-width-animation",timing:{delay:100,duration:50,easing:e.ANIMATION_CUBIC_BEZIER}},{name:"paper-menu-shrink-height-animation",timing:{duration:200,easing:"ease-in"}}]}},allowOutsideScroll:{type:Boolean,value:!1},restoreFocusOnClose:{type:Boolean,value:!0},_dropdownContent:{type:Object}},hostAttributes:{role:"group","aria-haspopup":"true"},listeners:{"iron-activate":"_onIronActivate","iron-select":"_onIronSelect"},get contentElement(){return Polymer.dom(this.$.content).getDistributedNodes()[0]},toggle:function(){this.opened?this.close():this.open()},open:function(){this.disabled||this.$.dropdown.open()},close:function(){this.$.dropdown.close()},_onIronSelect:function(e){this.ignoreSelect||this.close()},_onIronActivate:function(e){this.closeOnActivate&&this.close()},_openedChanged:function(e,t){e?(this._dropdownContent=this.contentElement,this.fire("paper-dropdown-open")):null!=t&&this.fire("paper-dropdown-close")},_disabledChanged:function(e){Polymer.IronControlState._disabledChanged.apply(this,arguments),e&&this.opened&&this.close()},__onIronOverlayCanceled:function(e){var t=e.detail,r=(Polymer.dom(t).rootTarget,this.$.trigger),o=Polymer.dom(t).path;o.indexOf(r)>-1&&e.preventDefault()}});Object.keys(e).forEach(function(r){t[r]=e[r]}),Polymer.PaperMenuButton=t}(),Polymer.PaperItemBehaviorImpl={hostAttributes:{role:"option",tabindex:"0"}},Polymer.PaperItemBehavior=[Polymer.IronButtonState,Polymer.IronControlState,Polymer.PaperItemBehaviorImpl],Polymer({is:"paper-item",behaviors:[Polymer.PaperItemBehavior]}),Polymer.IronFormElementBehavior={properties:{name:{type:String},value:{notify:!0,type:String},required:{type:Boolean,value:!1},_parentForm:{type:Object}},attached:function(){this.fire("iron-form-element-register")},detached:function(){this._parentForm&&this._parentForm.fire("iron-form-element-unregister",{target:this})}},function(){"use strict";Polymer.IronA11yAnnouncer=Polymer({is:"iron-a11y-announcer",properties:{mode:{type:String,value:"polite"},_text:{type:String,value:""}},created:function(){Polymer.IronA11yAnnouncer.instance||(Polymer.IronA11yAnnouncer.instance=this),document.body.addEventListener("iron-announce",this._onIronAnnounce.bind(this))},announce:function(e){this._text="",this.async(function(){this._text=e},100)},_onIronAnnounce:function(e){e.detail&&e.detail.text&&this.announce(e.detail.text)}}),Polymer.IronA11yAnnouncer.instance=null,Polymer.IronA11yAnnouncer.requestAvailability=function(){Polymer.IronA11yAnnouncer.instance||(Polymer.IronA11yAnnouncer.instance=document.createElement("iron-a11y-announcer")),document.body.appendChild(Polymer.IronA11yAnnouncer.instance)}}(),Polymer.IronValidatableBehaviorMeta=null,Polymer.IronValidatableBehavior={properties:{validator:{type:String},invalid:{notify:!0,reflectToAttribute:!0,type:Boolean,value:!1},_validatorMeta:{type:Object},validatorType:{type:String,value:"validator"},_validator:{type:Object,computed:"__computeValidator(validator)"}},observers:["_invalidChanged(invalid)"],registered:function(){Polymer.IronValidatableBehaviorMeta=new Polymer.IronMeta({type:"validator"})},_invalidChanged:function(){this.invalid?this.setAttribute("aria-invalid","true"):this.removeAttribute("aria-invalid")},hasValidator:function(){return null!=this._validator},validate:function(e){return this.invalid=!this._getValidity(e),!this.invalid},_getValidity:function(e){return!this.hasValidator()||this._validator.validate(e)},__computeValidator:function(){return Polymer.IronValidatableBehaviorMeta&&Polymer.IronValidatableBehaviorMeta.byKey(this.validator)}},Polymer({is:"iron-input","extends":"input",behaviors:[Polymer.IronValidatableBehavior],properties:{bindValue:{observer:"_bindValueChanged",type:String},preventInvalidInput:{type:Boolean},allowedPattern:{type:String,observer:"_allowedPatternChanged"},_previousValidInput:{type:String,value:""},_patternAlreadyChecked:{type:Boolean,value:!1}},listeners:{input:"_onInput",keypress:"_onKeypress"},registered:function(){this._canDispatchEventOnDisabled()||(this._origDispatchEvent=this.dispatchEvent,this.dispatchEvent=this._dispatchEventFirefoxIE)},created:function(){Polymer.IronA11yAnnouncer.requestAvailability()},_canDispatchEventOnDisabled:function(){var e=document.createElement("input"),t=!1;e.disabled=!0,e.addEventListener("feature-check-dispatch-event",function(){t=!0});try{e.dispatchEvent(new Event("feature-check-dispatch-event"))}catch(r){}return t},_dispatchEventFirefoxIE:function(){var e=this.disabled;this.disabled=!1,this._origDispatchEvent.apply(this,arguments),this.disabled=e},get _patternRegExp(){var e;if(this.allowedPattern)e=new RegExp(this.allowedPattern);else switch(this.type){case"number":e=/[0-9.,e-]/}return e},ready:function(){this.bindValue=this.value},_bindValueChanged:function(){this.value!==this.bindValue&&(this.value=this.bindValue||0===this.bindValue||this.bindValue===!1?this.bindValue:""),this.fire("bind-value-changed",{value:this.bindValue})},_allowedPatternChanged:function(){this.preventInvalidInput=!!this.allowedPattern},_onInput:function(){if(this.preventInvalidInput&&!this._patternAlreadyChecked){var e=this._checkPatternValidity();e||(this._announceInvalidCharacter("Invalid string of characters not entered."),this.value=this._previousValidInput)}this.bindValue=this.value,this._previousValidInput=this.value,this._patternAlreadyChecked=!1},_isPrintable:function(e){var t=8==e.keyCode||9==e.keyCode||13==e.keyCode||27==e.keyCode,r=19==e.keyCode||20==e.keyCode||45==e.keyCode||46==e.keyCode||144==e.keyCode||145==e.keyCode||e.keyCode>32&&e.keyCode<41||e.keyCode>111&&e.keyCode<124;return!(t||0==e.charCode&&r)},_onKeypress:function(e){if(this.preventInvalidInput||"number"===this.type){var t=this._patternRegExp;if(t&&!(e.metaKey||e.ctrlKey||e.altKey)){this._patternAlreadyChecked=!0;var r=String.fromCharCode(e.charCode);this._isPrintable(e)&&!t.test(r)&&(e.preventDefault(),this._announceInvalidCharacter("Invalid character "+r+" not entered."))}}},_checkPatternValidity:function(){var e=this._patternRegExp;if(!e)return!0;for(var t=0;t<this.value.length;t++)if(!e.test(this.value[t]))return!1;return!0},validate:function(){var e=this.checkValidity();return e&&(this.required&&""===this.value?e=!1:this.hasValidator()&&(e=Polymer.IronValidatableBehavior.validate.call(this,this.value))),this.invalid=!e,this.fire("iron-input-validate"),e},_announceInvalidCharacter:function(e){this.fire("iron-announce",{text:e})}}),Polymer.PaperInputHelper={},Polymer.PaperInputHelper.NextLabelID=1,Polymer.PaperInputHelper.NextAddonID=1,Polymer.PaperInputBehaviorImpl={properties:{label:{type:String},value:{notify:!0,type:String},disabled:{type:Boolean,value:!1},invalid:{type:Boolean,value:!1,notify:!0},preventInvalidInput:{type:Boolean},allowedPattern:{type:String},type:{type:String},list:{type:String},pattern:{type:String},required:{type:Boolean,value:!1},errorMessage:{type:String},charCounter:{type:Boolean,value:!1},noLabelFloat:{type:Boolean,value:!1},alwaysFloatLabel:{type:Boolean,value:!1},autoValidate:{type:Boolean,value:!1},validator:{type:String},autocomplete:{type:String,value:"off"},autofocus:{type:Boolean,observer:"_autofocusChanged"},inputmode:{type:String},minlength:{type:Number},maxlength:{type:Number},min:{type:String},max:{type:String},step:{type:String},name:{type:String},placeholder:{type:String,value:""},readonly:{type:Boolean,value:!1},size:{type:Number},autocapitalize:{type:String,value:"none"},autocorrect:{type:String,value:"off"},autosave:{type:String},results:{type:Number},accept:{type:String},multiple:{type:Boolean},_ariaDescribedBy:{type:String,value:""},_ariaLabelledBy:{type:String,value:""}},listeners:{"addon-attached":"_onAddonAttached"},keyBindings:{"shift+tab:keydown":"_onShiftTabDown"},hostAttributes:{tabindex:0},get inputElement(){return this.$.input},get _focusableElement(){return this.inputElement},registered:function(){this._typesThatHaveText=["date","datetime","datetime-local","month","time","week","file"]},attached:function(){this._updateAriaLabelledBy(),this.inputElement&&this._typesThatHaveText.indexOf(this.inputElement.type)!==-1&&(this.alwaysFloatLabel=!0)},_appendStringWithSpace:function(e,t){return e=e?e+" "+t:t},_onAddonAttached:function(e){var t=e.path?e.path[0]:e.target;if(t.id)this._ariaDescribedBy=this._appendStringWithSpace(this._ariaDescribedBy,t.id);else{var r="paper-input-add-on-"+Polymer.PaperInputHelper.NextAddonID++;t.id=r,this._ariaDescribedBy=this._appendStringWithSpace(this._ariaDescribedBy,r)}},validate:function(){return this.inputElement.validate()},_focusBlurHandler:function(e){Polymer.IronControlState._focusBlurHandler.call(this,e),this.focused&&!this._shiftTabPressed&&this._focusableElement.focus()},_onShiftTabDown:function(e){var t=this.getAttribute("tabindex");this._shiftTabPressed=!0,this.setAttribute("tabindex","-1"),this.async(function(){this.setAttribute("tabindex",t),this._shiftTabPressed=!1},1)},_handleAutoValidate:function(){this.autoValidate&&this.validate()},updateValueAndPreserveCaret:function(e){try{var t=this.inputElement.selectionStart;this.value=e,this.inputElement.selectionStart=t,this.inputElement.selectionEnd=t}catch(r){this.value=e}},_computeAlwaysFloatLabel:function(e,t){return t||e},_updateAriaLabelledBy:function(){var e=Polymer.dom(this.root).querySelector("label");if(!e)return void(this._ariaLabelledBy="");var t;e.id?t=e.id:(t="paper-input-label-"+Polymer.PaperInputHelper.NextLabelID++,e.id=t),this._ariaLabelledBy=t},_onChange:function(e){this.shadowRoot&&this.fire(e.type,{sourceEvent:e},{node:this,bubbles:e.bubbles,cancelable:e.cancelable})},_autofocusChanged:function(){if(this.autofocus&&this._focusableElement){var e=document.activeElement,t=e instanceof HTMLElement,r=t&&e!==document.body&&e!==document.documentElement;r||this._focusableElement.focus()}}},Polymer.PaperInputBehavior=[Polymer.IronControlState,Polymer.IronA11yKeysBehavior,Polymer.PaperInputBehaviorImpl],Polymer.PaperInputAddonBehavior={hostAttributes:{"add-on":""},attached:function(){this.fire("addon-attached")},update:function(e){}},Polymer({is:"paper-input-char-counter",behaviors:[Polymer.PaperInputAddonBehavior],properties:{_charCounterStr:{type:String,value:"0"}},update:function(e){if(e.inputElement){e.value=e.value||"";var t=e.value.toString().length.toString();e.inputElement.hasAttribute("maxlength")&&(t+="/"+e.inputElement.getAttribute("maxlength")),this._charCounterStr=t}}}),Polymer({is:"paper-input-container",properties:{noLabelFloat:{type:Boolean,value:!1},alwaysFloatLabel:{type:Boolean,value:!1},attrForValue:{type:String,value:"bind-value"},autoValidate:{type:Boolean,value:!1},invalid:{observer:"_invalidChanged",type:Boolean,value:!1},focused:{readOnly:!0,type:Boolean,value:!1,notify:!0},_addons:{type:Array},_inputHasContent:{type:Boolean,value:!1},_inputSelector:{type:String,value:"input,textarea,.paper-input-input"},_boundOnFocus:{type:Function,value:function(){return this._onFocus.bind(this)}},_boundOnBlur:{type:Function,value:function(){return this._onBlur.bind(this)}},_boundOnInput:{type:Function,value:function(){return this._onInput.bind(this)}},_boundValueChanged:{type:Function,value:function(){return this._onValueChanged.bind(this)}}},listeners:{"addon-attached":"_onAddonAttached","iron-input-validate":"_onIronInputValidate"},get _valueChangedEvent(){return this.attrForValue+"-changed"},get _propertyForValue(){return Polymer.CaseMap.dashToCamelCase(this.attrForValue)},get _inputElement(){return Polymer.dom(this).querySelector(this._inputSelector)},get _inputElementValue(){return this._inputElement[this._propertyForValue]||this._inputElement.value},ready:function(){this._addons||(this._addons=[]),this.addEventListener("focus",this._boundOnFocus,!0),this.addEventListener("blur",this._boundOnBlur,!0)},attached:function(){this.attrForValue?this._inputElement.addEventListener(this._valueChangedEvent,this._boundValueChanged):this.addEventListener("input",this._onInput),""!=this._inputElementValue?this._handleValueAndAutoValidate(this._inputElement):this._handleValue(this._inputElement)},_onAddonAttached:function(e){this._addons||(this._addons=[]);var t=e.target;this._addons.indexOf(t)===-1&&(this._addons.push(t),this.isAttached&&this._handleValue(this._inputElement))},_onFocus:function(){this._setFocused(!0)},_onBlur:function(){this._setFocused(!1),this._handleValueAndAutoValidate(this._inputElement)},_onInput:function(e){this._handleValueAndAutoValidate(e.target)},_onValueChanged:function(e){this._handleValueAndAutoValidate(e.target)},_handleValue:function(e){var t=this._inputElementValue;t||0===t||"number"===e.type&&!e.checkValidity()?this._inputHasContent=!0:this._inputHasContent=!1,this.updateAddons({inputElement:e,value:t,invalid:this.invalid})},_handleValueAndAutoValidate:function(e){if(this.autoValidate){var t;t=e.validate?e.validate(this._inputElementValue):e.checkValidity(),this.invalid=!t}this._handleValue(e)},_onIronInputValidate:function(e){this.invalid=this._inputElement.invalid},_invalidChanged:function(){this._addons&&this.updateAddons({invalid:this.invalid})},updateAddons:function(e){for(var t,r=0;t=this._addons[r];r++)t.update(e)},_computeInputContentClass:function(e,t,r,o,n){var i="input-content";if(e)n&&(i+=" label-is-hidden");else{var s=this.querySelector("label");t||n?(i+=" label-is-floating",this.$.labelAndInputContainer.style.position="static",o?i+=" is-invalid":r&&(i+=" label-is-highlighted")):s&&(this.$.labelAndInputContainer.style.position="relative")}return i},_computeUnderlineClass:function(e,t){var r="underline";return t?r+=" is-invalid":e&&(r+=" is-highlighted"),r},_computeAddOnContentClass:function(e,t){var r="add-on-content";return t?r+=" is-invalid":e&&(r+=" is-highlighted"),r}}),Polymer({is:"paper-input-error",behaviors:[Polymer.PaperInputAddonBehavior],properties:{invalid:{readOnly:!0,reflectToAttribute:!0,type:Boolean}},update:function(e){this._setInvalid(e.invalid)}}),Polymer({is:"paper-input",behaviors:[Polymer.IronFormElementBehavior,Polymer.PaperInputBehavior]}),"undefined"!=typeof module&&(module.exports=MakePromise),window.Promise||(window.Promise=MakePromise(Polymer.Base.async)),Promise.all=Promise.all||function(){var e=Array.prototype.slice.call(1===arguments.length&&Array.isArray(arguments[0])?arguments[0]:arguments);return new Promise(function(t,r){function o(i,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(e){o(i,e)},r)}e[i]=s,0===--n&&t(e)}catch(l){r(l)}}if(0===e.length)return t([]);for(var n=e.length,i=0;i<e.length;i++)o(i,e[i])})},Promise.race=Promise.race||function(e){return new Promise(function(t,r){for(var o=0,n=e.length;o<n;o++)e[o].then(t,r)})},function(){"use strict";var e=/\.splices$/,t=/\.length$/,r=/\.?#?([0-9]+)$/;Polymer.AppStorageBehavior={properties:{data:{type:Object,notify:!0,value:function(){return this.zeroValue}},sequentialTransactions:{type:Boolean,value:!1},log:{type:Boolean,value:!1}},observers:["__dataChanged(data.*)"],created:function(){this.__initialized=!1,this.__syncingToMemory=!1,this.__initializingStoredValue=null,this.__transactionQueueAdvances=Promise.resolve()},ready:function(){this._initializeStoredValue()},get isNew(){return!0},get transactionsComplete(){return this.__transactionQueueAdvances},get zeroValue(){},save:function(){return Promise.resolve()},reset:function(){},destroy:function(){return this.data=this.zeroValue,this.save()},initializeStoredValue:function(){return this.isNew?Promise.resolve():this._getStoredValue("data").then(function(e){return this._log("Got stored value!",e,this.data),null==e?this._setStoredValue("data",this.data||this.zeroValue):void this.syncToMemory(function(){this.set("data",e)})}.bind(this))},getStoredValue:function(e){return Promise.resolve()},setStoredValue:function(e,t){return Promise.resolve(t)},memoryPathToStoragePath:function(e){return e},storagePathToMemoryPath:function(e){return e},syncToMemory:function(e){this.__syncingToMemory||(this._group("Sync to memory."),this.__syncingToMemory=!0,e.call(this),this.__syncingToMemory=!1,this._groupEnd("Sync to memory."))},valueIsEmpty:function(e){return Array.isArray(e)?0===e.length:Object.prototype.isPrototypeOf(e)?0===Object.keys(e).length:null==e},_getStoredValue:function(e){return this.getStoredValue(this.memoryPathToStoragePath(e))},_setStoredValue:function(e,t){return this.setStoredValue(this.memoryPathToStoragePath(e),t)},_enqueueTransaction:function(e){if(this.sequentialTransactions)e=e.bind(this);else{var t=e.call(this);e=function(){return t}}return this.__transactionQueueAdvances=this.__transactionQueueAdvances.then(e)["catch"](function(e){this._error("Error performing queued transaction.",e)}.bind(this))},_log:function(){this.log&&console.log.apply(console,arguments)},_error:function(){this.log&&console.error.apply(console,arguments)},_group:function(){this.log&&console.group.apply(console,arguments)},_groupEnd:function(){this.log&&console.groupEnd.apply(console,arguments)},_initializeStoredValue:function(){if(!this.__initializingStoredValue){this._group("Initializing stored value.");var e=this.__initializingStoredValue=this.initializeStoredValue().then(function(){this.__initialized=!0,this.__initializingStoredValue=null,this._groupEnd("Initializing stored value.")}.bind(this));return this._enqueueTransaction(function(){return e})}},__dataChanged:function(e){if(!this.isNew&&!this.__syncingToMemory&&this.__initialized&&!this.__pathCanBeIgnored(e.path)){var t=this.__normalizeMemoryPath(e.path),r=e.value,o=r&&r.indexSplices;this._enqueueTransaction(function(){return this._log("Setting",t+":",o||r),o&&this.__pathIsSplices(t)&&(t=this.__parentPath(t),r=this.get(t)),this._setStoredValue(t,r)})}},__normalizeMemoryPath:function(e){for(var t=e.split("."),r=[],o=[],n=[],i=0;i<t.length;++i)o.push(t[i]),/^#/.test(t[i])?n.push(this.get(r).indexOf(this.get(o))):n.push(t[i]),r.push(t[i]);return n.join(".")},__parentPath:function(e){var t=e.split(".");return t.slice(0,t.length-1).join(".")},__pathCanBeIgnored:function(e){return t.test(e)&&Array.isArray(this.get(this.__parentPath(e)))},__pathIsSplices:function(t){return e.test(t)&&Array.isArray(this.get(this.__parentPath(t)))},__pathRefersToArray:function(r){return e.test(r)||t.test(r)},__pathTailToIndex:function(e){var t=e.split(".").pop();return window.parseInt(t.replace(r,"$1"),10)}}}(),Polymer({is:"app-localstorage-document",behaviors:[Polymer.AppStorageBehavior],properties:{key:{type:String,notify:!0},sessionOnly:{type:Boolean,value:!1},storage:{type:Object,computed:"__computeStorage(sessionOnly)"}},observers:["__storageSourceChanged(storage, key)"],attached:function(){this.listen(window,"storage","__onStorage"),this.listen(window.top,"app-local-storage-changed","__onAppLocalStorageChanged")},detached:function(){this.unlisten(window,"storage","__onStorage"),this.unlisten(window.top,"app-local-storage-changed","__onAppLocalStorageChanged")},get isNew(){return!this.key},save:function(e){try{this.__setStorageValue(e,this.data)}catch(t){return Promise.reject(t)}return this.key=e,Promise.resolve()},reset:function(){this.key=null,this.data=this.zeroValue},destroy:function(){try{this.storage.removeItem(this.key),this.reset()}catch(e){return Promise.reject(e)}return Promise.resolve()},getStoredValue:function(e){var t;if(null!=this.key)try{t=this.__parseValueFromStorage(),t=null!=t?this.get(e,{data:t}):void 0}catch(r){return Promise.reject(r)}return Promise.resolve(t)},setStoredValue:function(e,t){if(null!=this.key){try{this.__setStorageValue(this.key,this.data)}catch(r){return Promise.reject(r)}this.fire("app-local-storage-changed",this,{node:window.top})}return Promise.resolve(t)},__computeStorage:function(e){return e?window.sessionStorage:window.localStorage},__storageSourceChanged:function(e,t){this._initializeStoredValue()},__onStorage:function(e){e.key===this.key&&e.storageArea===this.storage&&this.syncToMemory(function(){this.set("data",this.__parseValueFromStorage())})},__onAppLocalStorageChanged:function(e){e.detail!==this&&e.detail.key===this.key&&e.detail.storage===this.storage&&this.syncToMemory(function(){this.set("data",e.detail.data)})},__parseValueFromStorage:function(){try{return JSON.parse(this.storage.getItem(this.key))}catch(e){console.error("Failed to parse value from storage for",this.key)}},__setStorageValue:function(e,t){this.storage.setItem(this.key,JSON.stringify(this.data))}}),Polymer({is:"platinum-sw-cache",properties:{cacheConfigFile:String,cacheId:String,defaultCacheStrategy:{type:String,value:"networkFirst"},disabled:{type:Boolean,value:!1},precache:{type:Array,value:function(){return[]}}},_getParameters:function(e){return new Promise(function(t){var r={importscriptLate:new URL("bootstrap/sw-toolbox-setup.js",e).href,defaultCacheStrategy:this.defaultCacheStrategy,precache:this.precache};this.cacheConfigFile?(r.cacheConfigFile=this.cacheConfigFile,window.fetch(this.cacheConfigFile).then(function(e){if(!e.ok)throw Error("unable to load "+this.cacheConfigFile);return e.json()}.bind(this)).then(function(e){this.disabled=e.disabled,this.disabled?r={}:(e.precacheFingerprint?r.precacheFingerprint=e.precacheFingerprint:r.precache=r.precache.concat(e.precache),r.cacheId=e.cacheId||r.cacheId,r.defaultCacheStrategy=e.defaultCacheStrategy||r.defaultCacheStrategy)}.bind(this))["catch"](function(e){console.info("Skipping precaching: "+e.message)}).then(function(){t(r)})):t(r)}.bind(this))}}),Polymer({is:"platinum-sw-fetch",properties:{handler:String,origin:String,path:String},_getParameters:function(e){return new Promise(function(t){var r={importscriptLate:new URL("bootstrap/sw-toolbox-setup.js",e).href};this.path&&this.handler?r.route=[this.path,this.handler,this.origin]:console.warn('The following platinum-sw-fetch element will not have any effect. Both the "path" and "handler" attributes must be set.',this),t(r)}.bind(this))}}),Polymer({is:"platinum-sw-import-script",properties:{href:String},_getParameters:function(){return new Promise(function(e){var t={};this.href?t.importscript=this.href:console.warn('The following platinum-sw-import-script element will not have any effect. The "href" attribute must be set.',this),e(t)}.bind(this))}}),Polymer({is:"platinum-sw-offline-analytics",_getParameters:function(e){return Promise.resolve({importscript:new URL("bootstrap/simple-db.js",e).href,importscriptLate:[new URL("bootstrap/sw-toolbox-setup.js",e).href,new URL("bootstrap/offline-analytics.js",e).href]})}}),Polymer({is:"platinum-sw-register",_version:"1.0",properties:{autoRegister:{type:Boolean,value:!1},baseUri:{type:String,value:document._currentScript?document._currentScript.baseURI:document.currentScript?document.currentScript.baseURI:"./"},clientsClaim:{type:Boolean,value:!1},href:{type:String,value:"sw-import.js"},reloadOnInstall:{type:Boolean,value:!1},scope:{type:String,value:null},skipWaiting:{type:Boolean,value:!1},state:{notify:!0,readOnly:!0,type:String}},register:function(){"serviceWorker"in navigator?this._constructServiceWorkerUrl().then(function(e){this._registerServiceWorker(e)}.bind(this)):(this._setState("unsupported"),this.fire("service-worker-error","Service workers are not available in the current browser."))},_constructServiceWorkerUrl:function(){for(var e=[],t=Polymer.dom(this).children,r=new URL(this.baseUri,window.location.href),o=0;o<t.length;o++)"function"==typeof t[o]._getParameters&&e.push(t[o]._getParameters(r));return Promise.all(e).then(function(e){var t={baseURI:r,version:this._version};return e.forEach(function(e){Object.keys(e).forEach(function(r){Array.isArray(t[r])?t[r]=t[r].concat(e[r]):t[r]=[].concat(e[r])})}),t}.bind(this)).then(function(e){e.importscriptLate&&(e.importscript?e.importscript=e.importscript.concat(e.importscriptLate):e.importscript=e.importscriptLate),e.importscript&&(e.importscript=this._unique(e.importscript)),delete e.importscriptLate,e.clientsClaim=this.clientsClaim,e.skipWaiting=this.skipWaiting;var t=new URL(this.href,window.location);return t.search=this._serializeUrlParams(e),t}.bind(this))},_unique:function(e){return e.filter(function(t,r){return e.indexOf(t)===r})},_serializeUrlParams:function(e){return Object.keys(e).sort().map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")},_registerServiceWorker:function(e){var t=this.scope?{scope:this.scope}:null;navigator.serviceWorker.register(e,t).then(function(e){e.active&&this._setState("installed"),e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){switch(t.state){case"installed":navigator.serviceWorker.controller?(this._setState("updated"),this.fire("service-worker-updated","A new service worker was installed, replacing the old service worker.")):this.reloadOnInstall?window.location.reload():(this._setState("installed"),this.fire("service-worker-installed","A new service worker was installed."));break;case"redundant":this._setState("error"),this.fire("service-worker-error","The installing service worker became redundant.")}}.bind(this)}.bind(this)}.bind(this))["catch"](function(t){if(this._setState("error"),this.fire("service-worker-error",t.toString()),"NetworkError"===t.name){var r=e.origin+e.pathname;console.error("A valid service worker script was not found at "+r+"\nTo learn how to fix this, please see\nhttps://github.com/PolymerElements/platinum-sw#top-level-sw-importjs")}}.bind(this))},attached:function(){this.autoRegister&&this.async(this.register)}}),Polymer({is:"iron-image",properties:{src:{observer:"_srcChanged",type:String,value:""},alt:{type:String,value:null},preventLoad:{type:Boolean,value:!1,observer:"_preventLoadChanged"},sizing:{type:String,value:null,reflectToAttribute:!0},position:{type:String,value:"center"},preload:{type:Boolean,value:!1},placeholder:{type:String,value:null,observer:"_placeholderChanged"},fade:{type:Boolean,value:!1},loaded:{notify:!0,readOnly:!0,type:Boolean,value:!1},loading:{notify:!0,readOnly:!0,type:Boolean,value:!1},error:{notify:!0,readOnly:!0,type:Boolean,value:!1},width:{observer:"_widthChanged",type:Number,value:null},height:{observer:"_heightChanged",type:Number,value:null}},observers:["_transformChanged(sizing, position)"],ready:function(){var e=this.$.img;e.onload=function(){this.$.img.src===this._resolveSrc(this.src)&&(this._setLoading(!1),this._setLoaded(!0),this._setError(!1))}.bind(this),e.onerror=function(){this.$.img.src===this._resolveSrc(this.src)&&(this._reset(),this._setLoading(!1),this._setLoaded(!1),this._setError(!0))}.bind(this),this._resolvedSrc=""},_load:function(e){e?this.$.img.src=e:this.$.img.removeAttribute("src"),this.$.sizedImgDiv.style.backgroundImage=e?'url("'+e+'")':"",this._setLoading(!!e),this._setLoaded(!1),this._setError(!1)},_reset:function(){this.$.img.removeAttribute("src"),this.$.sizedImgDiv.style.backgroundImage="",this._setLoading(!1),this._setLoaded(!1),this._setError(!1)},_computePlaceholderHidden:function(){return!this.preload||!this.fade&&!this.loading&&this.loaded},_computePlaceholderClassName:function(){return this.preload&&this.fade&&!this.loading&&this.loaded?"faded-out":""},_computeImgDivHidden:function(){return!this.sizing},_computeImgDivARIAHidden:function(){return""===this.alt?"true":void 0},_computeImgDivARIALabel:function(){if(null!==this.alt)return this.alt;if(""===this.src)return"";var e=new URL(this._resolveSrc(this.src)).pathname.split("/");return e[e.length-1]},_computeImgHidden:function(){return!!this.sizing},_widthChanged:function(){this.style.width=isNaN(this.width)?this.width:this.width+"px"},_heightChanged:function(){this.style.height=isNaN(this.height)?this.height:this.height+"px"},_preventLoadChanged:function(){this.preventLoad||this.loaded||(this._reset(),this._load(this.src))},_srcChanged:function(e,t){var r=this._resolveSrc(e);r!==this._resolvedSrc&&(this._resolvedSrc=r,this._reset(),this.preventLoad||this._load(e))},_placeholderChanged:function(){
this.$.placeholder.style.backgroundImage=this.placeholder?'url("'+this.placeholder+'")':""},_transformChanged:function(){var e=this.$.sizedImgDiv.style,t=this.$.placeholder.style;e.backgroundSize=t.backgroundSize=this.sizing,e.backgroundPosition=t.backgroundPosition=this.sizing?this.position:"",e.backgroundRepeat=t.backgroundRepeat=this.sizing?"no-repeat":""},_resolveSrc:function(e){return Polymer.ResolveUrl.resolveUrl(e,this.ownerDocument.baseURI)}}),Polymer({is:"paper-card",properties:{heading:{type:String,value:"",observer:"_headingChanged"},image:{type:String,value:""},preloadImage:{type:Boolean,value:!1},fadeImage:{type:Boolean,value:!1},elevation:{type:Number,value:1,reflectToAttribute:!0},animatedShadow:{type:Boolean,value:!1},animated:{type:Boolean,reflectToAttribute:!0,readOnly:!0,computed:"_computeAnimated(animatedShadow)"}},_headingChanged:function(e){this.getAttribute("aria-label");this.setAttribute("aria-label",e)},_computeHeadingClass:function(e){var t="title-text";return e&&(t+=" over-image"),t},_computeAnimated:function(e){return e}}),Polymer.PaperButtonBehaviorImpl={properties:{elevation:{type:Number,reflectToAttribute:!0,readOnly:!0}},observers:["_calculateElevation(focused, disabled, active, pressed, receivedFocusFromKeyboard)","_computeKeyboardClass(receivedFocusFromKeyboard)"],hostAttributes:{role:"button",tabindex:"0",animated:!0},_calculateElevation:function(){var e=1;this.disabled?e=0:this.active||this.pressed?e=4:this.receivedFocusFromKeyboard&&(e=3),this._setElevation(e)},_computeKeyboardClass:function(e){this.toggleClass("keyboard-focus",e)},_spaceKeyDownHandler:function(e){Polymer.IronButtonStateImpl._spaceKeyDownHandler.call(this,e),this.hasRipple()&&this.getRipple().ripples.length<1&&this._ripple.uiDownAction()},_spaceKeyUpHandler:function(e){Polymer.IronButtonStateImpl._spaceKeyUpHandler.call(this,e),this.hasRipple()&&this._ripple.uiUpAction()}},Polymer.PaperButtonBehavior=[Polymer.IronButtonState,Polymer.IronControlState,Polymer.PaperRippleBehavior,Polymer.PaperButtonBehaviorImpl],Polymer({is:"paper-button",behaviors:[Polymer.PaperButtonBehavior],properties:{raised:{type:Boolean,reflectToAttribute:!0,value:!1,observer:"_calculateElevation"}},_calculateElevation:function(){this.raised?Polymer.PaperButtonBehaviorImpl._calculateElevation.apply(this):this._setElevation(0)}}),function(){"use strict";Polymer.IronJsonpLibraryBehavior={properties:{libraryLoaded:{type:Boolean,value:!1,notify:!0,readOnly:!0},libraryErrorMessage:{type:String,value:null,notify:!0,readOnly:!0}},observers:["_libraryUrlChanged(libraryUrl)"],_libraryUrlChanged:function(e){this._isReady&&this.libraryUrl&&this._loadLibrary()},_libraryLoadCallback:function(e,t){e?(console.warn("Library load failed:",e.message),this._setLibraryErrorMessage(e.message)):(this._setLibraryErrorMessage(null),this._setLibraryLoaded(!0),this.notifyEvent&&this.fire(this.notifyEvent,t))},_loadLibrary:function(){e.require(this.libraryUrl,this._libraryLoadCallback.bind(this),this.callbackName)},ready:function(){this._isReady=!0,this.libraryUrl&&this._loadLibrary()}};var e={apiMap:{},require:function(e,r,o){var n=this.nameFromUrl(e);this.apiMap[n]||(this.apiMap[n]=new t(n,e,o)),this.apiMap[n].requestNotify(r)},nameFromUrl:function(e){return e.replace(/[\:\/\%\?\&\.\=\-\,]/g,"_")+"_api"}},t=function(e,t,r){if(this.notifiers=[],!r){if(!(t.indexOf(this.callbackMacro)>=0))return void(this.error=new Error("IronJsonpLibraryBehavior a %%callback%% parameter is required in libraryUrl"));r=e+"_loaded",t=t.replace(this.callbackMacro,r)}this.callbackName=r,window[this.callbackName]=this.success.bind(this),this.addScript(t)};t.prototype={callbackMacro:"%%callback%%",loaded:!1,addScript:function(e){var t=document.createElement("script");t.src=e,t.onerror=this.handleError.bind(this);var r=document.querySelector("script")||document.body;r.parentNode.insertBefore(t,r),this.script=t},removeScript:function(){this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.script=null},handleError:function(e){this.error=new Error("Library failed to load"),this.notifyAll(),this.cleanup()},success:function(){this.loaded=!0,this.result=Array.prototype.slice.call(arguments),this.notifyAll(),this.cleanup()},cleanup:function(){delete window[this.callbackName]},notifyAll:function(){this.notifiers.forEach(function(e){e(this.error,this.result)}.bind(this)),this.notifiers=[]},requestNotify:function(e){this.loaded||this.error?e(this.error,this.result):this.notifiers.push(e)}}}(),Polymer({is:"iron-jsonp-library",behaviors:[Polymer.IronJsonpLibraryBehavior],properties:{libraryUrl:String,callbackName:String,notifyEvent:String}}),Polymer({is:"google-maps-api",behaviors:[Polymer.IronJsonpLibraryBehavior],properties:{mapsUrl:{type:String,value:"https://maps.googleapis.com/maps/api/js?callback=%%callback%%"},apiKey:{type:String,value:""},clientId:{type:String,value:""},version:{type:String,value:"3.exp"},language:{type:String,value:""},signedIn:{type:Boolean,value:!1},notifyEvent:{type:String,value:"api-load"},libraryUrl:{type:String,computed:"_computeUrl(mapsUrl, version, apiKey, clientId, language, signedIn)"}},_computeUrl:function(e,t,r,o,n,i){var s=e+"&v="+t;if(s+="&libraries=drawing,geometry,places,visualization",r&&!o&&(s+="&key="+r),o&&(s+="&client="+o),!r&&!o){var a="No Google Maps API Key or Client ID specified. See https://developers.google.com/maps/documentation/javascript/get-api-key for instructions to get started with a key or client id.";console.warn(a)}return n&&(s+="&language="+n),i&&(s+="&signed_in="+i),s},get api(){return google.maps}}),function(){function e(){this.draggable?this.dragHandler_=google.maps.event.addListener(this.marker,"dragend",t.bind(this)):(google.maps.event.removeListener(this.dragHandler_),this.dragHandler_=null)}function t(e,t,r){this.latitude=e.latLng.lat(),this.longitude=e.latLng.lng()}Polymer({is:"google-map-marker",properties:{marker:{type:Object,notify:!0},map:{type:Object,observer:"_mapChanged"},info:{type:Object,value:null},clickEvents:{type:Boolean,value:!1,observer:"_clickEventsChanged"},dragEvents:{type:Boolean,value:!1,observer:"_dragEventsChanged"},icon:{type:Object,value:null,observer:"_iconChanged"},mouseEvents:{type:Boolean,value:!1,observer:"_mouseEventsChanged"},zIndex:{type:Number,value:0,observer:"_zIndexChanged"},longitude:{type:Number,value:null,notify:!0},latitude:{type:Number,value:null,notify:!0},animation:{type:String,value:null,observer:"_animationChanged"},open:{type:Boolean,value:!1,observer:"_openChanged"}},observers:["_updatePosition(latitude, longitude)"],detached:function(){this.marker&&(google.maps.event.clearInstanceListeners(this.marker),this._listeners={},this.marker.setMap(null)),this._contentObserver&&this._contentObserver.disconnect()},attached:function(){this.marker&&this.marker.setMap(this.map)},_updatePosition:function(){this.marker&&null!=this.latitude&&null!=this.longitude&&this.marker.setPosition(new google.maps.LatLng(parseFloat(this.latitude),parseFloat(this.longitude)))},_clickEventsChanged:function(){this.map&&(this.clickEvents?(this._forwardEvent("click"),this._forwardEvent("dblclick"),this._forwardEvent("rightclick")):(this._clearListener("click"),this._clearListener("dblclick"),this._clearListener("rightclick")))},_dragEventsChanged:function(){this.map&&(this.dragEvents?(this._forwardEvent("drag"),this._forwardEvent("dragend"),this._forwardEvent("dragstart")):(this._clearListener("drag"),this._clearListener("dragend"),this._clearListener("dragstart")))},_mouseEventsChanged:function(){this.map&&(this.mouseEvents?(this._forwardEvent("mousedown"),this._forwardEvent("mousemove"),this._forwardEvent("mouseout"),this._forwardEvent("mouseover"),this._forwardEvent("mouseup")):(this._clearListener("mousedown"),this._clearListener("mousemove"),this._clearListener("mouseout"),this._clearListener("mouseover"),this._clearListener("mouseup")))},_animationChanged:function(){this.marker&&this.marker.setAnimation(google.maps.Animation[this.animation])},_iconChanged:function(){this.marker&&this.marker.setIcon(this.icon)},_zIndexChanged:function(){this.marker&&this.marker.setZIndex(this.zIndex)},_mapChanged:function(){this.marker&&(this.marker.setMap(null),google.maps.event.clearInstanceListeners(this.marker)),this.map&&this.map instanceof google.maps.Map&&this._mapReady()},_contentChanged:function(){this._contentObserver&&this._contentObserver.disconnect(),this._contentObserver=new MutationObserver(this._contentChanged.bind(this)),this._contentObserver.observe(this,{childList:!0,subtree:!0});var e=this.innerHTML.trim();e?(this.info||(this.info=new google.maps.InfoWindow,this.openInfoHandler_=google.maps.event.addListener(this.marker,"click",function(){this.open=!0}.bind(this)),this.closeInfoHandler_=google.maps.event.addListener(this.info,"closeclick",function(){this.open=!1}.bind(this))),this.info.setContent(e)):this.info&&(google.maps.event.removeListener(this.openInfoHandler_),google.maps.event.removeListener(this.closeInfoHandler_),this.info=null)},_openChanged:function(){this.info&&(this.open?(this.info.open(this.map,this.marker),this.fire("google-map-marker-open")):(this.info.close(),this.fire("google-map-marker-close")))},_mapReady:function(){this._listeners={},this.marker=new google.maps.Marker({map:this.map,position:{lat:parseFloat(this.latitude),lng:parseFloat(this.longitude)},title:this.title,animation:google.maps.Animation[this.animation],draggable:this.draggable,visible:!this.hidden,icon:this.icon,zIndex:this.zIndex}),this._contentChanged(),this._clickEventsChanged(),this._dragEventsChanged(),this._mouseEventsChanged(),this._openChanged(),e.bind(this)()},_clearListener:function(e){this._listeners[e]&&(google.maps.event.removeListener(this._listeners[e]),this._listeners[e]=null)},_forwardEvent:function(e){this._listeners[e]=google.maps.event.addListener(this.marker,e,function(t){this.fire("google-map-marker-"+e,t)}.bind(this))},attributeChanged:function(t){if(this.marker)switch(t){case"hidden":this.marker.setVisible(!this.hidden);break;case"draggable":this.marker.setDraggable(this.draggable),e.bind(this)();break;case"title":this.marker.setTitle(this.title)}}})}(),Polymer({is:"google-map",properties:{apiKey:String,clientId:String,latitude:{type:Number,value:37.77493,notify:!0,reflectToAttribute:!0},map:{type:Object,notify:!0,value:null},longitude:{type:Number,value:-122.41942,notify:!0,reflectToAttribute:!0},kml:{type:String,value:null,observer:"_loadKml"},zoom:{type:Number,value:10,observer:"_zoomChanged",notify:!0},noAutoTilt:{type:Boolean,value:!1},mapType:{type:String,value:"roadmap",observer:"_mapTypeChanged",notify:!0},version:{type:String,value:"3.exp"},disableDefaultUi:{type:Boolean,value:!1,observer:"_disableDefaultUiChanged"},fitToMarkers:{type:Boolean,value:!1,observer:"_fitToMarkersChanged"},disableZoom:{type:Boolean,value:!1,observer:"_disableZoomChanged"},styles:{type:Object,value:function(){return{}}},maxZoom:{type:Number,observer:"_maxZoomChanged"},minZoom:{type:Number,observer:"_minZoomChanged"},signedIn:{type:Boolean,value:!1},language:{type:String},clickEvents:{type:Boolean,value:!1,observer:"_clickEventsChanged"},dragEvents:{type:Boolean,value:!1,observer:"_dragEventsChanged"},mouseEvents:{type:Boolean,value:!1,observer:"_mouseEventsChanged"},additionalMapOptions:{type:Object,value:function(){return{}}},markers:{type:Array,value:function(){return[]},readOnly:!0},objects:{type:Array,value:function(){return[]},readOnly:!0},singleInfoWindow:{type:Boolean,value:!1}},behaviors:[Polymer.IronResizableBehavior],listeners:{"iron-resize":"resize"},observers:["_debounceUpdateCenter(latitude, longitude)"],attached:function(){this._initGMap()},detached:function(){this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null),this._objectsMutationObserver&&(this._objectsMutationObserver.disconnect(),this._objectsMutationObserver=null)},_initGMap:function(){this.map||this.$.api.libraryLoaded===!0&&this.isAttached&&(this.map=new google.maps.Map(this.$.map,this._getMapOptions()),this._listeners={},this._updateCenter(),this._loadKml(),this._updateMarkers(),this._updateObjects(),this._addMapListeners(),this.fire("google-map-ready"))},_mapApiLoaded:function(){this._initGMap()},_getMapOptions:function(){var e={zoom:this.zoom,tilt:this.noAutoTilt?0:45,mapTypeId:this.mapType,disableDefaultUI:this.disableDefaultUi,disableDoubleClickZoom:this.disableZoom,scrollwheel:!this.disableZoom,styles:this.styles,maxZoom:Number(this.maxZoom),minZoom:Number(this.minZoom)};null!=this.getAttribute("draggable")&&(e.draggable=this.draggable);for(var t in this.additionalMapOptions)e[t]=this.additionalMapOptions[t];return e},_attachChildrenToMap:function(e){if(this.map)for(var t,r=0;t=e[r];++r)t.map=this.map},_observeMarkers:function(){this._mutationObserver||(this._mutationObserver=new MutationObserver(this._updateMarkers.bind(this)),this._mutationObserver.observe(this.$.selector,{childList:!0}))},_updateMarkers:function(){var e=Array.prototype.slice.call(Polymer.dom(this.$.markers).getDistributedNodes());if(e.length===this.markers.length){var t=e.filter(function(e){return this.markers&&this.markers.indexOf(e)===-1}.bind(this));if(0===t.length)return void(this._mutationObserver||this._observeMarkers())}this._observeMarkers(),this.markers=this._setMarkers(e),this._attachChildrenToMap(this.markers),this.fitToMarkers&&this._fitToMarkersChanged()},_observeObjects:function(){this._objectsMutationObserver||(this._objectsMutationObserver=new MutationObserver(this._updateObjects.bind(this)),this._objectsMutationObserver.observe(this,{childList:!0}))},_updateObjects:function(){var e=Array.prototype.slice.call(Polymer.dom(this.$.objects).getDistributedNodes());if(e.length===this.objects.length){var t=e.filter(function(e){return this.objects.indexOf(e)===-1}.bind(this));if(0===t.length)return void this._observeObjects()}this._observeObjects(),this._setObjects(e),this._attachChildrenToMap(this.objects)},clear:function(){for(var e,t=0;e=this.markers[t];++t)e.marker.setMap(null)},resize:function(){if(this.map){var e=this.latitude,t=this.longitude;google.maps.event.trigger(this.map,"resize"),this.latitude=e,this.longitude=t,this.fitToMarkers&&this._fitToMarkersChanged()}},_loadKml:function(){if(this.map&&this.kml){new google.maps.KmlLayer({url:this.kml,map:this.map})}},_debounceUpdateCenter:function(){this.debounce("updateCenter",this._updateCenter)},_updateCenter:function(){if(this.cancelDebouncer("updateCenter"),this.map&&void 0!==this.latitude&&void 0!==this.longitude){var e=Number(this.latitude);if(isNaN(e))throw new TypeError("latitude must be a number");var t=Number(this.longitude);if(isNaN(t))throw new TypeError("longitude must be a number");var r=new google.maps.LatLng(e,t),o=this.map.getCenter();o?(o=new google.maps.LatLng(o.lat(),o.lng()),o.equals(r)||this.map.panTo(r)):this.map.setCenter(r)}},_zoomChanged:function(){this.map&&this.map.setZoom(Number(this.zoom))},_clickEventsChanged:function(){this.map&&(this.clickEvents?(this._forwardEvent("click"),this._forwardEvent("dblclick"),this._forwardEvent("rightclick")):(this._clearListener("click"),this._clearListener("dblclick"),this._clearListener("rightclick")))},_dragEventsChanged:function(){this.map&&(this.dragEvents?(this._forwardEvent("drag"),this._forwardEvent("dragend"),this._forwardEvent("dragstart")):(this._clearListener("drag"),this._clearListener("dragend"),this._clearListener("dragstart")))},_mouseEventsChanged:function(){this.map&&(this.mouseEvents?(this._forwardEvent("mousemove"),this._forwardEvent("mouseout"),this._forwardEvent("mouseover")):(this._clearListener("mousemove"),this._clearListener("mouseout"),this._clearListener("mouseover")))},_maxZoomChanged:function(){this.map&&this.map.setOptions({maxZoom:Number(this.maxZoom)})},_minZoomChanged:function(){this.map&&this.map.setOptions({minZoom:Number(this.minZoom)})},_mapTypeChanged:function(){this.map&&this.map.setMapTypeId(this.mapType)},_disableDefaultUiChanged:function(){this.map&&this.map.setOptions({disableDefaultUI:this.disableDefaultUi})},_disableZoomChanged:function(){this.map&&this.map.setOptions({disableDoubleClickZoom:this.disableZoom,scrollwheel:!this.disableZoom})},attributeChanged:function(e){if(this.map)switch(e){case"draggable":this.map.setOptions({draggable:this.draggable})}},_fitToMarkersChanged:function(){if(this.map&&this.fitToMarkers&&this.markers.length>0){for(var e,t=new google.maps.LatLngBounds,r=0;e=this.markers[r];++r)t.extend(new google.maps.LatLng(e.latitude,e.longitude));this.markers.length>1&&this.map.fitBounds(t),this.map.setCenter(t.getCenter())}},_addMapListeners:function(){google.maps.event.addListener(this.map,"center_changed",function(){var e=this.map.getCenter();this.latitude=e.lat(),this.longitude=e.lng()}.bind(this)),google.maps.event.addListener(this.map,"zoom_changed",function(){this.zoom=this.map.getZoom()}.bind(this)),google.maps.event.addListener(this.map,"maptypeid_changed",function(){this.mapType=this.map.getMapTypeId()}.bind(this)),this._clickEventsChanged(),this._dragEventsChanged(),this._mouseEventsChanged()},_clearListener:function(e){this._listeners[e]&&(google.maps.event.removeListener(this._listeners[e]),this._listeners[e]=null)},_forwardEvent:function(e){this._listeners[e]=google.maps.event.addListener(this.map,e,function(t){this.fire("google-map-"+e,t)}.bind(this))},_deselectMarker:function(e,t){var r=this.$.selector.indexOf(e.target);this.singleInfoWindow?this.$.selector.selected=null:this.$.selector.selectedValues&&(this.$.selector.selectedValues=this.$.selector.selectedValues.filter(function(e){return e!==r}))}}),Polymer({is:"page-home",properties:{arrive:{type:Array,value:function(){return[0,0]}},depart:{type:Array,value:function(){return[0,0]}}}}),Polymer.PaperDialogBehaviorImpl={hostAttributes:{role:"dialog",tabindex:"-1"},properties:{modal:{type:Boolean,value:!1}},observers:["_modalChanged(modal, _readied)"],listeners:{tap:"_onDialogClick"},ready:function(){this.__prevNoCancelOnOutsideClick=this.noCancelOnOutsideClick,this.__prevNoCancelOnEscKey=this.noCancelOnEscKey,this.__prevWithBackdrop=this.withBackdrop},_modalChanged:function(e,t){t&&(e?(this.__prevNoCancelOnOutsideClick=this.noCancelOnOutsideClick,this.__prevNoCancelOnEscKey=this.noCancelOnEscKey,this.__prevWithBackdrop=this.withBackdrop,this.noCancelOnOutsideClick=!0,this.noCancelOnEscKey=!0,this.withBackdrop=!0):(this.noCancelOnOutsideClick=this.noCancelOnOutsideClick&&this.__prevNoCancelOnOutsideClick,this.noCancelOnEscKey=this.noCancelOnEscKey&&this.__prevNoCancelOnEscKey,this.withBackdrop=this.withBackdrop&&this.__prevWithBackdrop))},_updateClosingReasonConfirmed:function(e){this.closingReason=this.closingReason||{},this.closingReason.confirmed=e},_onDialogClick:function(e){for(var t=Polymer.dom(e).path,r=0;r<t.indexOf(this);r++){var o=t[r];if(o.hasAttribute&&(o.hasAttribute("dialog-dismiss")||o.hasAttribute("dialog-confirm"))){this._updateClosingReasonConfirmed(o.hasAttribute("dialog-confirm")),this.close(),e.stopPropagation();break}}}},Polymer.PaperDialogBehavior=[Polymer.IronOverlayBehavior,Polymer.PaperDialogBehaviorImpl],function(){Polymer({is:"paper-dialog",behaviors:[Polymer.PaperDialogBehavior,Polymer.NeonAnimationRunnerBehavior],listeners:{"neon-animation-finish":"_onNeonAnimationFinish"},_renderOpened:function(){this.cancelAnimation(),this.playAnimation("entry")},_renderClosed:function(){this.cancelAnimation(),this.playAnimation("exit")},_onNeonAnimationFinish:function(){this.opened?this._finishRenderOpened():this._finishRenderClosed()}})}(),function(){Polymer({is:"paper-listbox",behaviors:[Polymer.IronMenuBehavior],hostAttributes:{role:"listbox"}})}(),Polymer({is:"dialog-stations",properties:{title:{value:"Default Title"},stations:{type:Array,value:function(){return[]},notify:!0},selected:{type:Number,value:0,notify:!0,observer:"_selectedChanged"}},_selectedChanged:function(e,t){setTimeout(function(){this.$.dialog.close()}.bind(this),200)}}),Polymer({is:"paper-item-body"}),function(){function e(e,t){if(e!==t){var r=null===e,o=e===E,n=e===e,i=null===t,s=t===E,a=t===t;if(e>t&&!i||!n||r&&!s&&a||o&&a)return 1;if(e<t&&!r||!a||i&&!o&&n||s&&n)return-1}return 0}function t(e,t,r){for(var o=e.length,n=r?o:-1;r?n--:++n<o;)if(t(e[n],n,e))return n;return-1}function r(e,t,r){if(t!==t)return p(e,r);for(var o=r-1,n=e.length;++o<n;)if(e[o]===t)return o;return-1}function o(e){return"function"==typeof e||!1}function n(e){return null==e?"":e+""}function i(e,t){for(var r=-1,o=e.length;++r<o&&t.indexOf(e.charAt(r))>-1;);return r}function s(e,t){for(var r=e.length;r--&&t.indexOf(e.charAt(r))>-1;);return r}function a(t,r){return e(t.criteria,r.criteria)||t.index-r.index}function l(t,r,o){for(var n=-1,i=t.criteria,s=r.criteria,a=i.length,l=o.length;++n<a;){var c=e(i[n],s[n]);if(c){if(n>=l)return c;var u=o[n];return c*("asc"===u||u===!0?1:-1)}}return t.index-r.index}function c(e){return je[e]}function u(e){return Ke[e]}function h(e,t,r){return t?e=Ve[e]:r&&(e=We[e]),"\\"+e}function f(e){return"\\"+We[e]}function p(e,t,r){for(var o=e.length,n=t+(r?0:-1);r?n--:++n<o;){var i=e[n];if(i!==i)return n}return-1}function d(e){return!!e&&"object"==typeof e}function g(e){return e<=160&&e>=9&&e<=13||32==e||160==e||5760==e||6158==e||e>=8192&&(e<=8202||8232==e||8233==e||8239==e||8287==e||12288==e||65279==e)}function _(e,t){for(var r=-1,o=e.length,n=-1,i=[];++r<o;)e[r]===t&&(e[r]=j,i[++n]=r);return i}function m(e,t){for(var r,o=-1,n=e.length,i=-1,s=[];++o<n;){var a=e[o],l=t?t(a,o,e):a;o&&r===l||(r=l,s[++i]=a)}return s}function y(e){for(var t=-1,r=e.length;++t<r&&g(e.charCodeAt(t)););return t}function v(e){for(var t=e.length;t--&&g(e.charCodeAt(t)););return t}function b(e){return He[e]}function S(g){function Q(e){if(d(e)&&!xa(e)&&!(e instanceof je)){if(e instanceof ee)return e;if(ts.call(e,"__chain__")&&ts.call(e,"__wrapped__"))return fo(e)}return new ee(e)}function $(){}function ee(e,t,r){this.__wrapped__=e,this.__actions__=r||[],this.__chain__=!!t}function je(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ws,this.__views__=[]}function Ke(){var e=new je(this.__wrapped__);return e.__actions__=rt(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=rt(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=rt(this.__views__),e}function He(){if(this.__filtered__){var e=new je(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function ze(){var e=this.__wrapped__.value(),t=this.__dir__,r=xa(e),o=t<0,n=r?e.length:0,i=Vr(0,n,this.__views__),s=i.start,a=i.end,l=a-s,c=o?a:s-1,u=this.__iteratees__,h=u.length,f=0,p=Ts(l,this.__takeCount__);if(!r||n<M||n==l&&p==l)return rr(e,this.__actions__);var d=[];e:for(;l--&&f<p;){c+=t;for(var g=-1,_=e[c];++g<h;){var m=u[g],y=m.iteratee,v=m.type,b=y(_);if(v==U)_=b;else if(!b){if(v==F)continue e;break e}}d[f++]=_}return d}function Ve(){this.__data__={}}function We(e){return this.has(e)&&delete this.__data__[e]}function Ge(e){return"__proto__"==e?E:this.__data__[e]}function Qe(e){return"__proto__"!=e&&ts.call(this.__data__,e)}function Ye(e,t){return"__proto__"!=e&&(this.__data__[e]=t),this}function Je(e){var t=e?e.length:0;for(this.data={hash:ms(null),set:new hs};t--;)this.push(e[t])}function Xe(e,t){var r=e.data,o="string"==typeof t||Dn(t)?r.set.has(t):r.hash[t];return o?0:-1}function $e(e){var t=this.data;"string"==typeof e||Dn(e)?t.set.add(e):t.hash[e]=!0}function tt(e,t){for(var r=-1,o=e.length,n=-1,i=t.length,s=ji(o+i);++r<o;)s[r]=e[r];for(;++n<i;)s[r++]=t[n];return s}function rt(e,t){var r=-1,o=e.length;for(t||(t=ji(o));++r<o;)t[r]=e[r];return t}function ot(e,t){for(var r=-1,o=e.length;++r<o&&t(e[r],r,e)!==!1;);return e}function nt(e,t){for(var r=e.length;r--&&t(e[r],r,e)!==!1;);return e}function it(e,t){for(var r=-1,o=e.length;++r<o;)if(!t(e[r],r,e))return!1;return!0}function st(e,t,r,o){for(var n=-1,i=e.length,s=o,a=s;++n<i;){var l=e[n],c=+t(l);r(c,s)&&(s=c,a=l)}return a}function at(e,t){for(var r=-1,o=e.length,n=-1,i=[];++r<o;){var s=e[r];t(s,r,e)&&(i[++n]=s)}return i}function lt(e,t){for(var r=-1,o=e.length,n=ji(o);++r<o;)n[r]=t(e[r],r,e);return n}function ct(e,t){for(var r=-1,o=t.length,n=e.length;++r<o;)e[n+r]=t[r];return e}function ut(e,t,r,o){var n=-1,i=e.length;for(o&&i&&(r=e[++n]);++n<i;)r=t(r,e[n],n,e);return r}function ht(e,t,r,o){var n=e.length;for(o&&n&&(r=e[--n]);n--;)r=t(r,e[n],n,e);return r}function ft(e,t){for(var r=-1,o=e.length;++r<o;)if(t(e[r],r,e))return!0;return!1}function pt(e,t){for(var r=e.length,o=0;r--;)o+=+t(e[r])||0;return o}function dt(e,t){return e===E?t:e}function gt(e,t,r,o){return e!==E&&ts.call(o,r)?e:t}function _t(e,t,r){for(var o=-1,n=qa(t),i=n.length;++o<i;){var s=n[o],a=e[s],l=r(a,t[s],s,e,t);(l===l?l===a:a!==a)&&(a!==E||s in e)||(e[s]=l)}return e}function mt(e,t){return null==t?e:vt(t,qa(t),e)}function yt(e,t){for(var r=-1,o=null==e,n=!o&&Jr(e),i=n?e.length:0,s=t.length,a=ji(s);++r<s;){var l=t[r];n?a[r]=Xr(l,i)?e[l]:E:a[r]=o?E:e[l]}return a}function vt(e,t,r){r||(r={});for(var o=-1,n=t.length;++o<n;){var i=t[o];r[i]=e[i]}return r}function bt(e,t,r){var o=typeof e;return"function"==o?t===E?e:ir(e,t,r):null==e?wi:"object"==o?Ut(e):t===E?Bi(e):qt(e,t)}function St(e,t,r,o,n,i,s){var a;if(r&&(a=n?r(e,o,n):r(e)),a!==E)return a;if(!Dn(e))return e;var l=xa(e);if(l){if(a=Wr(e),!t)return rt(e,a)}else{var c=os.call(e),u=c==G;if(c!=J&&c!=K&&(!u||n))return qe[c]?Qr(e,c,t):n?e:{};if(a=Gr(u?{}:e),!t)return mt(a,e)}i||(i=[]),s||(s=[]);for(var h=i.length;h--;)if(i[h]==e)return s[h];return i.push(e),s.push(a),(l?ot:It)(e,function(o,n){a[n]=St(o,t,r,n,e,i,s)}),a}function Et(e,t,r){if("function"!=typeof e)throw new Ji(q);return fs(function(){e.apply(E,r)},t)}function Tt(e,t){var o=e?e.length:0,n=[];if(!o)return n;var i=-1,s=Kr(),a=s===r,l=a&&t.length>=M?dr(t):null,c=t.length;l&&(s=Xe,a=!1,t=l);e:for(;++i<o;){var u=e[i];if(a&&u===u){for(var h=c;h--;)if(t[h]===u)continue e;n.push(u)}else s(t,u,0)<0&&n.push(u)}return n}function Ct(e,t){var r=!0;return Ls(e,function(e,o,n){return r=!!t(e,o,n)}),r}function Pt(e,t,r,o){var n=o,i=n;return Ls(e,function(e,s,a){var l=+t(e,s,a);(r(l,n)||l===o&&l===i)&&(n=l,i=e)}),i}function Nt(e,t,r,o){var n=e.length;for(r=null==r?0:+r||0,r<0&&(r=-r>n?0:n+r),o=o===E||o>n?n:+o||0,o<0&&(o+=n),n=r>o?0:o>>>0,r>>>=0;r<n;)e[r++]=t;return e}function At(e,t){var r=[];return Ls(e,function(e,o,n){t(e,o,n)&&r.push(e)}),r}function wt(e,t,r,o){var n;return r(e,function(e,r,i){if(t(e,r,i))return n=o?r:e,!1}),n}function xt(e,t,r,o){o||(o=[]);for(var n=-1,i=e.length;++n<i;){var s=e[n];d(s)&&Jr(s)&&(r||xa(s)||Nn(s))?t?xt(s,t,r,o):ct(o,s):r||(o[o.length]=s)}return o}function Rt(e,t){return Fs(e,t,ti)}function It(e,t){return Fs(e,t,qa)}function kt(e,t){return Us(e,t,qa)}function Ot(e,t){for(var r=-1,o=t.length,n=-1,i=[];++r<o;){var s=t[r];Bn(e[s])&&(i[++n]=s)}return i}function Bt(e,t,r){if(null!=e){r!==E&&r in uo(e)&&(t=[r]);for(var o=0,n=t.length;null!=e&&o<n;)e=e[t[o++]];return o&&o==n?e:E}}function Dt(e,t,r,o,n,i){return e===t||(null==e||null==t||!Dn(e)&&!d(t)?e!==e&&t!==t:Lt(e,t,Dt,r,o,n,i))}function Lt(e,t,r,o,n,i,s){var a=xa(e),l=xa(t),c=H,u=H;a||(c=os.call(e),c==K?c=J:c!=J&&(a=zn(e))),l||(u=os.call(t),u==K?u=J:u!=J&&(l=zn(t)));var h=c==J,f=u==J,p=c==u;if(p&&!a&&!h)return Fr(e,t,c);if(!n){var d=h&&ts.call(e,"__wrapped__"),g=f&&ts.call(t,"__wrapped__");if(d||g)return r(d?e.value():e,g?t.value():t,o,n,i,s)}if(!p)return!1;i||(i=[]),s||(s=[]);for(var _=i.length;_--;)if(i[_]==e)return s[_]==t;i.push(e),s.push(t);var m=(a?Mr:Ur)(e,t,r,o,n,i,s);return i.pop(),s.pop(),m}function Mt(e,t,r){var o=t.length,n=o,i=!r;if(null==e)return!n;for(e=uo(e);o--;){var s=t[o];if(i&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<n;){s=t[o];var a=s[0],l=e[a],c=s[1];if(i&&s[2]){if(l===E&&!(a in e))return!1}else{var u=r?r(l,c,a):E;if(!(u===E?Dt(c,l,r,!0):u))return!1}}return!0}function Ft(e,t){var r=-1,o=Jr(e)?ji(e.length):[];return Ls(e,function(e,n,i){o[++r]=t(e,n,i)}),o}function Ut(e){var t=Hr(e);if(1==t.length&&t[0][2]){var r=t[0][0],o=t[0][1];return function(e){return null!=e&&(e[r]===o&&(o!==E||r in uo(e)))}}return function(e){return Mt(e,t)}}function qt(e,t){var r=xa(e),o=Zr(e)&&ro(t),n=e+"";return e=ho(e),function(i){if(null==i)return!1;var s=n;if(i=uo(i),(r||!o)&&!(s in i)){if(i=1==e.length?i:Bt(i,Qt(e,0,-1)),null==i)return!1;s=No(e),i=uo(i)}return i[s]===t?t!==E||s in i:Dt(t,i[s],E,!0)}}function jt(e,t,r,o,n){if(!Dn(e))return e;var i=Jr(t)&&(xa(t)||zn(t)),s=i?E:qa(t);return ot(s||t,function(a,l){if(s&&(l=a,a=t[l]),d(a))o||(o=[]),n||(n=[]),Kt(e,t,l,jt,r,o,n);else{var c=e[l],u=r?r(c,a,l,e,t):E,h=u===E;h&&(u=a),u===E&&(!i||l in e)||!h&&(u===u?u===c:c!==c)||(e[l]=u)}}),e}function Kt(e,t,r,o,n,i,s){for(var a=i.length,l=t[r];a--;)if(i[a]==l)return void(e[r]=s[a]);var c=e[r],u=n?n(c,l,r,e,t):E,h=u===E;h&&(u=l,Jr(l)&&(xa(l)||zn(l))?u=xa(c)?c:Jr(c)?rt(c):[]:jn(l)||Nn(l)?u=Nn(c)?Yn(c):jn(c)?c:{}:h=!1),i.push(l),s.push(u),h?e[r]=o(u,l,n,i,s):(u===u?u!==c:c===c)&&(e[r]=u)}function Ht(e){return function(t){return null==t?E:t[e]}}function zt(e){var t=e+"";return e=ho(e),function(r){return Bt(r,e,t)}}function Vt(e,t){for(var r=e?t.length:0;r--;){var o=t[r];if(o!=n&&Xr(o)){var n=o;ps.call(e,o,1)}}return e}function Wt(e,t){return e+ys(Ns()*(t-e+1))}function Gt(e,t,r,o,n){return n(e,function(e,n,i){r=o?(o=!1,e):t(r,e,n,i)}),r}function Qt(e,t,r){var o=-1,n=e.length;t=null==t?0:+t||0,t<0&&(t=-t>n?0:n+t),r=r===E||r>n?n:+r||0,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var i=ji(n);++o<n;)i[o]=e[o+t];return i}function Yt(e,t){var r;return Ls(e,function(e,o,n){return r=t(e,o,n),!r}),!!r}function Jt(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}function Xt(e,t,r){var o=qr(),n=-1;t=lt(t,function(e){return o(e)});var i=Ft(e,function(e){var r=lt(t,function(t){return t(e)});return{criteria:r,index:++n,value:e}});return Jt(i,function(e,t){return l(e,t,r)})}function $t(e,t){var r=0;return Ls(e,function(e,o,n){r+=+t(e,o,n)||0}),r}function Zt(e,t){var o=-1,n=Kr(),i=e.length,s=n===r,a=s&&i>=M,l=a?dr():null,c=[];l?(n=Xe,s=!1):(a=!1,l=t?[]:c);e:for(;++o<i;){var u=e[o],h=t?t(u,o,e):u;if(s&&u===u){for(var f=l.length;f--;)if(l[f]===h)continue e;t&&l.push(h),c.push(u)}else n(l,h,0)<0&&((t||a)&&l.push(h),c.push(u))}return c}function er(e,t){for(var r=-1,o=t.length,n=ji(o);++r<o;)n[r]=e[t[r]];return n}function tr(e,t,r,o){for(var n=e.length,i=o?n:-1;(o?i--:++i<n)&&t(e[i],i,e););return r?Qt(e,o?0:i,o?i+1:n):Qt(e,o?i+1:0,o?n:i)}function rr(e,t){var r=e;r instanceof je&&(r=r.value());for(var o=-1,n=t.length;++o<n;){var i=t[o];r=i.func.apply(i.thisArg,ct([r],i.args))}return r}function or(e,t,r){var o=0,n=e?e.length:o;if("number"==typeof t&&t===t&&n<=Is){for(;o<n;){var i=o+n>>>1,s=e[i];(r?s<=t:s<t)&&null!==s?o=i+1:n=i}return n}return nr(e,t,wi,r)}function nr(e,t,r,o){t=r(t);for(var n=0,i=e?e.length:0,s=t!==t,a=null===t,l=t===E;n<i;){var c=ys((n+i)/2),u=r(e[c]),h=u!==E,f=u===u;if(s)var p=f||o;else p=a?f&&h&&(o||null!=u):l?f&&(o||h):null!=u&&(o?u<=t:u<t);p?n=c+1:i=c}return Ts(i,Rs)}function ir(e,t,r){if("function"!=typeof e)return wi;if(t===E)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 3:return function(r,o,n){return e.call(t,r,o,n)};case 4:return function(r,o,n,i){return e.call(t,r,o,n,i)};case 5:return function(r,o,n,i,s){return e.call(t,r,o,n,i,s)}}return function(){return e.apply(t,arguments)}}function sr(e){var t=new ss(e.byteLength),r=new ds(t);return r.set(new ds(e)),t}function ar(e,t,r){for(var o=r.length,n=-1,i=Es(e.length-o,0),s=-1,a=t.length,l=ji(a+i);++s<a;)l[s]=t[s];for(;++n<o;)l[r[n]]=e[n];for(;i--;)l[s++]=e[n++];return l}function lr(e,t,r){for(var o=-1,n=r.length,i=-1,s=Es(e.length-n,0),a=-1,l=t.length,c=ji(s+l);++i<s;)c[i]=e[i];for(var u=i;++a<l;)c[u+a]=t[a];for(;++o<n;)c[u+r[o]]=e[i++];return c}function cr(e,t){return function(r,o,n){var i=t?t():{};if(o=qr(o,n,3),xa(r))for(var s=-1,a=r.length;++s<a;){var l=r[s];e(i,l,o(l,s,r),r)}else Ls(r,function(t,r,n){
e(i,t,o(t,r,n),n)});return i}}function ur(e){return yn(function(t,r){var o=-1,n=null==t?0:r.length,i=n>2?r[n-2]:E,s=n>2?r[2]:E,a=n>1?r[n-1]:E;for("function"==typeof i?(i=ir(i,a,5),n-=2):(i="function"==typeof a?a:E,n-=i?1:0),s&&$r(r[0],r[1],s)&&(i=n<3?E:i,n=1);++o<n;){var l=r[o];l&&e(t,l,i)}return t})}function hr(e,t){return function(r,o){var n=r?Ks(r):0;if(!to(n))return e(r,o);for(var i=t?n:-1,s=uo(r);(t?i--:++i<n)&&o(s[i],i,s)!==!1;);return r}}function fr(e){return function(t,r,o){for(var n=uo(t),i=o(t),s=i.length,a=e?s:-1;e?a--:++a<s;){var l=i[a];if(r(n[l],l,n)===!1)break}return t}}function pr(e,t){function r(){var n=this&&this!==Ze&&this instanceof r?o:e;return n.apply(t,arguments)}var o=_r(e);return r}function dr(e){return ms&&hs?new Je(e):null}function gr(e){return function(t){for(var r=-1,o=Pi(hi(t)),n=o.length,i="";++r<n;)i=e(i,o[r],r);return i}}function _r(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Ds(e.prototype),o=e.apply(r,t);return Dn(o)?o:r}}function mr(e){function t(r,o,n){n&&$r(r,o,n)&&(o=E);var i=Lr(r,e,E,E,E,E,E,o);return i.placeholder=t.placeholder,i}return t}function yr(e,t){return yn(function(r){var o=r[0];return null==o?o:(r.push(t),e.apply(E,r))})}function vr(e,t){return function(r,o,n){if(n&&$r(r,o,n)&&(o=E),o=qr(o,n,3),1==o.length){r=xa(r)?r:co(r);var i=st(r,o,e,t);if(!r.length||i!==t)return i}return Pt(r,o,e,t)}}function br(e,r){return function(o,n,i){if(n=qr(n,i,3),xa(o)){var s=t(o,n,r);return s>-1?o[s]:E}return wt(o,n,e)}}function Sr(e){return function(r,o,n){return r&&r.length?(o=qr(o,n,3),t(r,o,e)):-1}}function Er(e){return function(t,r,o){return r=qr(r,o,3),wt(t,r,e,!0)}}function Tr(e){return function(){for(var t,r=arguments.length,o=e?r:-1,n=0,i=ji(r);e?o--:++o<r;){var s=i[n++]=arguments[o];if("function"!=typeof s)throw new Ji(q);!t&&ee.prototype.thru&&"wrapper"==jr(s)&&(t=new ee([],(!0)))}for(o=t?-1:r;++o<r;){s=i[o];var a=jr(s),l="wrapper"==a?js(s):E;t=l&&eo(l[0])&&l[1]==(I|A|x|k)&&!l[4].length&&1==l[9]?t[jr(l[0])].apply(t,l[3]):1==s.length&&eo(s)?t[a]():t.thru(s)}return function(){var e=arguments,o=e[0];if(t&&1==e.length&&xa(o)&&o.length>=M)return t.plant(o).value();for(var n=0,s=r?i[n].apply(this,e):o;++n<r;)s=i[n].call(this,s);return s}}}function Cr(e,t){return function(r,o,n){return"function"==typeof o&&n===E&&xa(r)?e(r,o):t(r,ir(o,n,3))}}function Pr(e){return function(t,r,o){return"function"==typeof r&&o===E||(r=ir(r,o,3)),e(t,r,ti)}}function Nr(e){return function(t,r,o){return"function"==typeof r&&o===E||(r=ir(r,o,3)),e(t,r)}}function Ar(e){return function(t,r,o){var n={};return r=qr(r,o,3),It(t,function(t,o,i){var s=r(t,o,i);o=e?s:o,t=e?t:s,n[o]=t}),n}}function wr(e){return function(t,r,o){return t=n(t),(e?t:"")+kr(t,r,o)+(e?"":t)}}function xr(e){var t=yn(function(r,o){var n=_(o,t.placeholder);return Lr(r,e,E,o,n)});return t}function Rr(e,t){return function(r,o,n,i){var s=arguments.length<3;return"function"==typeof o&&i===E&&xa(r)?e(r,o,n,s):Gt(r,qr(o,i,4),n,s,t)}}function Ir(e,t,r,o,n,i,s,a,l,c){function u(){for(var v=arguments.length,b=v,S=ji(v);b--;)S[b]=arguments[b];if(o&&(S=ar(S,o,n)),i&&(S=lr(S,i,s)),d||m){var T=u.placeholder,N=_(S,T);if(v-=N.length,v<c){var A=a?rt(a):E,w=Es(c-v,0),I=d?N:E,k=d?E:N,O=d?S:E,B=d?E:S;t|=d?x:R,t&=~(d?R:x),g||(t&=~(C|P));var D=[e,t,r,O,I,B,k,A,l,w],L=Ir.apply(E,D);return eo(e)&&Hs(L,D),L.placeholder=T,L}}var M=f?r:this,F=p?M[e]:e;return a&&(S=ao(S,a)),h&&l<S.length&&(S.length=l),this&&this!==Ze&&this instanceof u&&(F=y||_r(e)),F.apply(M,S)}var h=t&I,f=t&C,p=t&P,d=t&A,g=t&N,m=t&w,y=p?E:_r(e);return u}function kr(e,t,r){var o=e.length;if(t=+t,o>=t||!bs(t))return"";var n=t-o;return r=null==r?" ":r+"",mi(r,_s(n/r.length)).slice(0,n)}function Or(e,t,r,o){function n(){for(var t=-1,a=arguments.length,l=-1,c=o.length,u=ji(c+a);++l<c;)u[l]=o[l];for(;a--;)u[l++]=arguments[++t];var h=this&&this!==Ze&&this instanceof n?s:e;return h.apply(i?r:this,u)}var i=t&C,s=_r(e);return n}function Br(e){var t=Vi[e];return function(e,r){return r=r===E?0:+r||0,r?(r=cs(10,r),t(e*r)/r):t(e)}}function Dr(e){return function(t,r,o,n){var i=qr(o);return null==o&&i===bt?or(t,r,e):nr(t,r,i(o,n,1),e)}}function Lr(e,t,r,o,n,i,s,a){var l=t&P;if(!l&&"function"!=typeof e)throw new Ji(q);var c=o?o.length:0;if(c||(t&=~(x|R),o=n=E),c-=n?n.length:0,t&R){var u=o,h=n;o=n=E}var f=l?E:js(e),p=[e,t,r,o,n,u,h,i,s,a];if(f&&(oo(p,f),t=p[1],a=p[9]),p[9]=null==a?l?0:e.length:Es(a-c,0)||0,t==C)var d=pr(p[0],p[2]);else d=t!=x&&t!=(C|x)||p[4].length?Ir.apply(E,p):Or.apply(E,p);var g=f?qs:Hs;return g(d,p)}function Mr(e,t,r,o,n,i,s){var a=-1,l=e.length,c=t.length;if(l!=c&&!(n&&c>l))return!1;for(;++a<l;){var u=e[a],h=t[a],f=o?o(n?h:u,n?u:h,a):E;if(f!==E){if(f)continue;return!1}if(n){if(!ft(t,function(e){return u===e||r(u,e,o,n,i,s)}))return!1}else if(u!==h&&!r(u,h,o,n,i,s))return!1}return!0}function Fr(e,t,r){switch(r){case z:case V:return+e==+t;case W:return e.name==t.name&&e.message==t.message;case Y:return e!=+e?t!=+t:e==+t;case X:case Z:return e==t+""}return!1}function Ur(e,t,r,o,n,i,s){var a=qa(e),l=a.length,c=qa(t),u=c.length;if(l!=u&&!n)return!1;for(var h=l;h--;){var f=a[h];if(!(n?f in t:ts.call(t,f)))return!1}for(var p=n;++h<l;){f=a[h];var d=e[f],g=t[f],_=o?o(n?g:d,n?d:g,f):E;if(!(_===E?r(d,g,o,n,i,s):_))return!1;p||(p="constructor"==f)}if(!p){var m=e.constructor,y=t.constructor;if(m!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof m&&m instanceof m&&"function"==typeof y&&y instanceof y))return!1}return!0}function qr(e,t,r){var o=Q.callback||Ni;return o=o===Ni?bt:o,r?o(e,t,r):o}function jr(e){for(var t=e.name+"",r=Bs[t],o=r?r.length:0;o--;){var n=r[o],i=n.func;if(null==i||i==e)return n.name}return t}function Kr(e,t,o){var n=Q.indexOf||Co;return n=n===Co?r:n,e?n(e,t,o):n}function Hr(e){for(var t=ri(e),r=t.length;r--;)t[r][2]=ro(t[r][1]);return t}function zr(e,t){var r=null==e?E:e[t];return Fn(r)?r:E}function Vr(e,t,r){for(var o=-1,n=r.length;++o<n;){var i=r[o],s=i.size;switch(i.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=Ts(t,e+s);break;case"takeRight":e=Es(e,t-s)}}return{start:e,end:t}}function Wr(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&ts.call(e,"index")&&(r.index=e.index,r.input=e.input),r}function Gr(e){var t=e.constructor;return"function"==typeof t&&t instanceof t||(t=Gi),new t}function Qr(e,t,r){var o=e.constructor;switch(t){case te:return sr(e);case z:case V:return new o((+e));case re:case oe:case ne:case ie:case se:case ae:case le:case ce:case ue:var n=e.buffer;return new o(r?sr(n):n,e.byteOffset,e.length);case Y:case Z:return new o(e);case X:var i=new o(e.source,xe.exec(e));i.lastIndex=e.lastIndex}return i}function Yr(e,t,r){null==e||Zr(t,e)||(t=ho(t),e=1==t.length?e:Bt(e,Qt(t,0,-1)),t=No(t));var o=null==e?e:e[t];return null==o?E:o.apply(e,r)}function Jr(e){return null!=e&&to(Ks(e))}function Xr(e,t){return e="number"==typeof e||ke.test(e)?+e:-1,t=null==t?ks:t,e>-1&&e%1==0&&e<t}function $r(e,t,r){if(!Dn(r))return!1;var o=typeof t;if("number"==o?Jr(r)&&Xr(t,r.length):"string"==o&&t in r){var n=r[t];return e===e?e===n:n!==n}return!1}function Zr(e,t){var r=typeof e;if("string"==r&&Ee.test(e)||"number"==r)return!0;if(xa(e))return!1;var o=!Se.test(e);return o||null!=t&&e in uo(t)}function eo(e){var t=jr(e),r=Q[t];if("function"!=typeof r||!(t in je.prototype))return!1;if(e===r)return!0;var o=js(r);return!!o&&e===o[0]}function to(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=ks}function ro(e){return e===e&&!Dn(e)}function oo(e,t){var r=e[1],o=t[1],n=r|o,i=n<I,s=o==I&&r==A||o==I&&r==k&&e[7].length<=t[8]||o==(I|k)&&r==A;if(!i&&!s)return e;o&C&&(e[2]=t[2],n|=r&C?0:N);var a=t[3];if(a){var l=e[3];e[3]=l?ar(l,a,t[4]):rt(a),e[4]=l?_(e[3],j):rt(t[4])}return a=t[5],a&&(l=e[5],e[5]=l?lr(l,a,t[6]):rt(a),e[6]=l?_(e[5],j):rt(t[6])),a=t[7],a&&(e[7]=rt(a)),o&I&&(e[8]=null==e[8]?t[8]:Ts(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=n,e}function no(e,t){return e===E?t:Ra(e,t,no)}function io(e,t){e=uo(e);for(var r=-1,o=t.length,n={};++r<o;){var i=t[r];i in e&&(n[i]=e[i])}return n}function so(e,t){var r={};return Rt(e,function(e,o,n){t(e,o,n)&&(r[o]=e)}),r}function ao(e,t){for(var r=e.length,o=Ts(t.length,r),n=rt(e);o--;){var i=t[o];e[o]=Xr(i,r)?n[i]:E}return e}function lo(e){for(var t=ti(e),r=t.length,o=r&&e.length,n=!!o&&to(o)&&(xa(e)||Nn(e)),i=-1,s=[];++i<r;){var a=t[i];(n&&Xr(a,o)||ts.call(e,a))&&s.push(a)}return s}function co(e){return null==e?[]:Jr(e)?Dn(e)?e:Gi(e):si(e)}function uo(e){return Dn(e)?e:Gi(e)}function ho(e){if(xa(e))return e;var t=[];return n(e).replace(Te,function(e,r,o,n){t.push(o?n.replace(Ae,"$1"):r||e)}),t}function fo(e){return e instanceof je?e.clone():new ee(e.__wrapped__,e.__chain__,rt(e.__actions__))}function po(e,t,r){t=(r?$r(e,t,r):null==t)?1:Es(ys(t)||1,1);for(var o=0,n=e?e.length:0,i=-1,s=ji(_s(n/t));o<n;)s[++i]=Qt(e,o,o+=t);return s}function go(e){for(var t=-1,r=e?e.length:0,o=-1,n=[];++t<r;){var i=e[t];i&&(n[++o]=i)}return n}function _o(e,t,r){var o=e?e.length:0;return o?((r?$r(e,t,r):null==t)&&(t=1),Qt(e,t<0?0:t)):[]}function mo(e,t,r){var o=e?e.length:0;return o?((r?$r(e,t,r):null==t)&&(t=1),t=o-(+t||0),Qt(e,0,t<0?0:t)):[]}function yo(e,t,r){return e&&e.length?tr(e,qr(t,r,3),!0,!0):[]}function vo(e,t,r){return e&&e.length?tr(e,qr(t,r,3),!0):[]}function bo(e,t,r,o){var n=e?e.length:0;return n?(r&&"number"!=typeof r&&$r(e,t,r)&&(r=0,o=n),Nt(e,t,r,o)):[]}function So(e){return e?e[0]:E}function Eo(e,t,r){var o=e?e.length:0;return r&&$r(e,t,r)&&(t=!1),o?xt(e,t):[]}function To(e){var t=e?e.length:0;return t?xt(e,!0):[]}function Co(e,t,o){var n=e?e.length:0;if(!n)return-1;if("number"==typeof o)o=o<0?Es(n+o,0):o;else if(o){var i=or(e,t);return i<n&&(t===t?t===e[i]:e[i]!==e[i])?i:-1}return r(e,t,o||0)}function Po(e){return mo(e,1)}function No(e){var t=e?e.length:0;return t?e[t-1]:E}function Ao(e,t,r){var o=e?e.length:0;if(!o)return-1;var n=o;if("number"==typeof r)n=(r<0?Es(o+r,0):Ts(r||0,o-1))+1;else if(r){n=or(e,t,!0)-1;var i=e[n];return(t===t?t===i:i!==i)?n:-1}if(t!==t)return p(e,n,!0);for(;n--;)if(e[n]===t)return n;return-1}function wo(){var e=arguments,t=e[0];if(!t||!t.length)return t;for(var r=0,o=Kr(),n=e.length;++r<n;)for(var i=0,s=e[r];(i=o(t,s,i))>-1;)ps.call(t,i,1);return t}function xo(e,t,r){var o=[];if(!e||!e.length)return o;var n=-1,i=[],s=e.length;for(t=qr(t,r,3);++n<s;){var a=e[n];t(a,n,e)&&(o.push(a),i.push(n))}return Vt(e,i),o}function Ro(e){return _o(e,1)}function Io(e,t,r){var o=e?e.length:0;return o?(r&&"number"!=typeof r&&$r(e,t,r)&&(t=0,r=o),Qt(e,t,r)):[]}function ko(e,t,r){var o=e?e.length:0;return o?((r?$r(e,t,r):null==t)&&(t=1),Qt(e,0,t<0?0:t)):[]}function Oo(e,t,r){var o=e?e.length:0;return o?((r?$r(e,t,r):null==t)&&(t=1),t=o-(+t||0),Qt(e,t<0?0:t)):[]}function Bo(e,t,r){return e&&e.length?tr(e,qr(t,r,3),!1,!0):[]}function Do(e,t,r){return e&&e.length?tr(e,qr(t,r,3)):[]}function Lo(e,t,o,n){var i=e?e.length:0;if(!i)return[];null!=t&&"boolean"!=typeof t&&(n=o,o=$r(e,t,n)?E:t,t=!1);var s=qr();return null==o&&s===bt||(o=s(o,n,3)),t&&Kr()===r?m(e,o):Zt(e,o)}function Mo(e){if(!e||!e.length)return[];var t=-1,r=0;e=at(e,function(e){if(Jr(e))return r=Es(e.length,r),!0});for(var o=ji(r);++t<r;)o[t]=lt(e,Ht(t));return o}function Fo(e,t,r){var o=e?e.length:0;if(!o)return[];var n=Mo(e);return null==t?n:(t=ir(t,r,4),lt(n,function(e){return ut(e,t,E,!0)}))}function Uo(){for(var e=-1,t=arguments.length;++e<t;){var r=arguments[e];if(Jr(r))var o=o?ct(Tt(o,r),Tt(r,o)):r}return o?Zt(o):[]}function qo(e,t){var r=-1,o=e?e.length:0,n={};for(!o||t||xa(e[0])||(t=[]);++r<o;){var i=e[r];t?n[i]=t[r]:i&&(n[i[0]]=i[1])}return n}function jo(e){var t=Q(e);return t.__chain__=!0,t}function Ko(e,t,r){return t.call(r,e),e}function Ho(e,t,r){return t.call(r,e)}function zo(){return jo(this)}function Vo(){return new ee(this.value(),this.__chain__)}function Wo(e){for(var t,r=this;r instanceof $;){var o=fo(r);t?n.__wrapped__=o:t=o;var n=o;r=r.__wrapped__}return n.__wrapped__=e,t}function Go(){var e=this.__wrapped__,t=function(e){return e.reverse()};if(e instanceof je){var r=e;return this.__actions__.length&&(r=new je(this)),r=r.reverse(),r.__actions__.push({func:Ho,args:[t],thisArg:E}),new ee(r,this.__chain__)}return this.thru(t)}function Qo(){return this.value()+""}function Yo(){return rr(this.__wrapped__,this.__actions__)}function Jo(e,t,r){var o=xa(e)?it:Ct;return r&&$r(e,t,r)&&(t=E),"function"==typeof t&&r===E||(t=qr(t,r,3)),o(e,t)}function Xo(e,t,r){var o=xa(e)?at:At;return t=qr(t,r,3),o(e,t)}function $o(e,t){return na(e,Ut(t))}function Zo(e,t,r,o){var n=e?Ks(e):0;return to(n)||(e=si(e),n=e.length),r="number"!=typeof r||o&&$r(t,r,o)?0:r<0?Es(n+r,0):r||0,"string"==typeof e||!xa(e)&&Hn(e)?r<=n&&e.indexOf(t,r)>-1:!!n&&Kr(e,t,r)>-1}function en(e,t,r){var o=xa(e)?lt:Ft;return t=qr(t,r,3),o(e,t)}function tn(e,t){return en(e,Bi(t))}function rn(e,t,r){var o=xa(e)?at:At;return t=qr(t,r,3),o(e,function(e,r,o){return!t(e,r,o)})}function on(e,t,r){if(r?$r(e,t,r):null==t){e=co(e);var o=e.length;return o>0?e[Wt(0,o-1)]:E}var n=-1,i=Qn(e),o=i.length,s=o-1;for(t=Ts(t<0?0:+t||0,o);++n<t;){var a=Wt(n,s),l=i[a];i[a]=i[n],i[n]=l}return i.length=t,i}function nn(e){return on(e,ws)}function sn(e){var t=e?Ks(e):0;return to(t)?t:qa(e).length}function an(e,t,r){var o=xa(e)?ft:Yt;return r&&$r(e,t,r)&&(t=E),"function"==typeof t&&r===E||(t=qr(t,r,3)),o(e,t)}function ln(e,t,r){if(null==e)return[];r&&$r(e,t,r)&&(t=E);var o=-1;t=qr(t,r,3);var n=Ft(e,function(e,r,n){return{criteria:t(e,r,n),index:++o,value:e}});return Jt(n,a)}function cn(e,t,r,o){return null==e?[]:(o&&$r(t,r,o)&&(r=E),xa(t)||(t=null==t?[]:[t]),xa(r)||(r=null==r?[]:[r]),Xt(e,t,r))}function un(e,t){return Xo(e,Ut(t))}function hn(e,t){if("function"!=typeof t){if("function"!=typeof e)throw new Ji(q);var r=e;e=t,t=r}return e=bs(e=+e)?e:0,function(){if(--e<1)return t.apply(this,arguments)}}function fn(e,t,r){return r&&$r(e,t,r)&&(t=E),t=e&&null==t?e.length:Es(+t||0,0),Lr(e,I,E,E,E,E,t)}function pn(e,t){var r;if("function"!=typeof t){if("function"!=typeof e)throw new Ji(q);var o=e;e=t,t=o}return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=E),r}}function dn(e,t,r){function o(){p&&as(p),c&&as(c),g=0,c=p=d=E}function n(t,r){r&&as(r),c=p=d=E,t&&(g=ga(),u=e.apply(f,l),p||c||(l=f=E))}function i(){var e=t-(ga()-h);e<=0||e>t?n(d,c):p=fs(i,e)}function s(){n(m,p)}function a(){if(l=arguments,h=ga(),f=this,d=m&&(p||!y),_===!1)var r=y&&!p;else{c||y||(g=h);var o=_-(h-g),n=o<=0||o>_;n?(c&&(c=as(c)),g=h,u=e.apply(f,l)):c||(c=fs(s,o))}return n&&p?p=as(p):p||t===_||(p=fs(i,t)),r&&(n=!0,u=e.apply(f,l)),!n||p||c||(l=f=E),u}var l,c,u,h,f,p,d,g=0,_=!1,m=!0;if("function"!=typeof e)throw new Ji(q);if(t=t<0?0:+t||0,r===!0){var y=!0;m=!1}else Dn(r)&&(y=!!r.leading,_="maxWait"in r&&Es(+r.maxWait||0,t),m="trailing"in r?!!r.trailing:m);return a.cancel=o,a}function gn(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new Ji(q);var r=function(){var o=arguments,n=t?t.apply(this,o):o[0],i=r.cache;if(i.has(n))return i.get(n);var s=e.apply(this,o);return r.cache=i.set(n,s),s};return r.cache=new gn.Cache,r}function _n(e){if("function"!=typeof e)throw new Ji(q);return function(){return!e.apply(this,arguments)}}function mn(e){return pn(2,e)}function yn(e,t){if("function"!=typeof e)throw new Ji(q);return t=Es(t===E?e.length-1:+t||0,0),function(){for(var r=arguments,o=-1,n=Es(r.length-t,0),i=ji(n);++o<n;)i[o]=r[t+o];switch(t){case 0:return e.call(this,i);case 1:return e.call(this,r[0],i);case 2:return e.call(this,r[0],r[1],i)}var s=ji(t+1);for(o=-1;++o<t;)s[o]=r[o];return s[t]=i,e.apply(this,s)}}function vn(e){if("function"!=typeof e)throw new Ji(q);return function(t){return e.apply(this,t)}}function bn(e,t,r){var o=!0,n=!0;if("function"!=typeof e)throw new Ji(q);return r===!1?o=!1:Dn(r)&&(o="leading"in r?!!r.leading:o,n="trailing"in r?!!r.trailing:n),dn(e,t,{leading:o,maxWait:+t,trailing:n})}function Sn(e,t){return t=null==t?wi:t,Lr(t,x,E,[e],[])}function En(e,t,r,o){return t&&"boolean"!=typeof t&&$r(e,t,r)?t=!1:"function"==typeof t&&(o=r,r=t,t=!1),"function"==typeof r?St(e,t,ir(r,o,3)):St(e,t)}function Tn(e,t,r){return"function"==typeof t?St(e,!0,ir(t,r,3)):St(e,!0)}function Cn(e,t){return e>t}function Pn(e,t){return e>=t}function Nn(e){return d(e)&&Jr(e)&&ts.call(e,"callee")&&!us.call(e,"callee")}function An(e){return e===!0||e===!1||d(e)&&os.call(e)==z}function wn(e){return d(e)&&os.call(e)==V}function xn(e){return!!e&&1===e.nodeType&&d(e)&&!jn(e)}function Rn(e){return null==e||(Jr(e)&&(xa(e)||Hn(e)||Nn(e)||d(e)&&Bn(e.splice))?!e.length:!qa(e).length)}function In(e,t,r,o){r="function"==typeof r?ir(r,o,3):E;var n=r?r(e,t):E;return n===E?Dt(e,t,r):!!n}function kn(e){return d(e)&&"string"==typeof e.message&&os.call(e)==W}function On(e){return"number"==typeof e&&bs(e)}function Bn(e){return Dn(e)&&os.call(e)==G}function Dn(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Ln(e,t,r,o){return r="function"==typeof r?ir(r,o,3):E,Mt(e,Hr(t),r)}function Mn(e){return qn(e)&&e!=+e}function Fn(e){return null!=e&&(Bn(e)?is.test(es.call(e)):d(e)&&Ie.test(e))}function Un(e){return null===e}function qn(e){return"number"==typeof e||d(e)&&os.call(e)==Y}function jn(e){var t;if(!d(e)||os.call(e)!=J||Nn(e)||!ts.call(e,"constructor")&&(t=e.constructor,"function"==typeof t&&!(t instanceof t)))return!1;var r;return Rt(e,function(e,t){r=t}),r===E||ts.call(e,r)}function Kn(e){return Dn(e)&&os.call(e)==X}function Hn(e){return"string"==typeof e||d(e)&&os.call(e)==Z}function zn(e){return d(e)&&to(e.length)&&!!Ue[os.call(e)]}function Vn(e){return e===E}function Wn(e,t){return e<t}function Gn(e,t){return e<=t}function Qn(e){var t=e?Ks(e):0;return to(t)?t?rt(e):[]:si(e)}function Yn(e){return vt(e,ti(e))}function Jn(e,t,r){var o=Ds(e);return r&&$r(e,t,r)&&(t=E),t?mt(o,t):o}function Xn(e){return Ot(e,ti(e))}function $n(e,t,r){var o=null==e?E:Bt(e,ho(t),t+"");return o===E?r:o}function Zn(e,t){if(null==e)return!1;var r=ts.call(e,t);if(!r&&!Zr(t)){if(t=ho(t),e=1==t.length?e:Bt(e,Qt(t,0,-1)),null==e)return!1;t=No(t),r=ts.call(e,t)}return r||to(e.length)&&Xr(t,e.length)&&(xa(e)||Nn(e))}function ei(e,t,r){r&&$r(e,t,r)&&(t=E);for(var o=-1,n=qa(e),i=n.length,s={};++o<i;){var a=n[o],l=e[a];t?ts.call(s,l)?s[l].push(a):s[l]=[a]:s[l]=a}return s}function ti(e){if(null==e)return[];Dn(e)||(e=Gi(e));var t=e.length;t=t&&to(t)&&(xa(e)||Nn(e))&&t||0;for(var r=e.constructor,o=-1,n="function"==typeof r&&r.prototype===e,i=ji(t),s=t>0;++o<t;)i[o]=o+"";for(var a in e)s&&Xr(a,t)||"constructor"==a&&(n||!ts.call(e,a))||i.push(a);return i}function ri(e){e=uo(e);for(var t=-1,r=qa(e),o=r.length,n=ji(o);++t<o;){var i=r[t];n[t]=[i,e[i]]}return n}function oi(e,t,r){var o=null==e?E:e[t];return o===E&&(null==e||Zr(t,e)||(t=ho(t),e=1==t.length?e:Bt(e,Qt(t,0,-1)),o=null==e?E:e[No(t)]),o=o===E?r:o),Bn(o)?o.call(e):o}function ni(e,t,r){if(null==e)return e;var o=t+"";t=null!=e[o]||Zr(t,e)?[o]:ho(t);for(var n=-1,i=t.length,s=i-1,a=e;null!=a&&++n<i;){var l=t[n];Dn(a)&&(n==s?a[l]=r:null==a[l]&&(a[l]=Xr(t[n+1])?[]:{})),a=a[l]}return e}function ii(e,t,r,o){var n=xa(e)||zn(e);if(t=qr(t,o,4),null==r)if(n||Dn(e)){var i=e.constructor;r=n?xa(e)?new i:[]:Ds(Bn(i)?i.prototype:E)}else r={};return(n?ot:It)(e,function(e,o,n){return t(r,e,o,n)}),r}function si(e){return er(e,qa(e))}function ai(e){return er(e,ti(e))}function li(e,t,r){return t=+t||0,r===E?(r=t,t=0):r=+r||0,e>=Ts(t,r)&&e<Es(t,r)}function ci(e,t,r){r&&$r(e,t,r)&&(t=r=E);var o=null==e,n=null==t;if(null==r&&(n&&"boolean"==typeof e?(r=e,e=1):"boolean"==typeof t&&(r=t,n=!0)),o&&n&&(t=1,n=!1),e=+e||0,n?(t=e,e=0):t=+t||0,r||e%1||t%1){var i=Ns();return Ts(e+i*(t-e+ls("1e-"+((i+"").length-1))),t)}return Wt(e,t)}function ui(e){return e=n(e),e&&e.charAt(0).toUpperCase()+e.slice(1)}function hi(e){return e=n(e),e&&e.replace(Oe,c).replace(Ne,"")}function fi(e,t,r){e=n(e),t+="";var o=e.length;return r=r===E?o:Ts(r<0?0:+r||0,o),r-=t.length,r>=0&&e.indexOf(t,r)==r}function pi(e){return e=n(e),e&&me.test(e)?e.replace(ge,u):e}function di(e){return e=n(e),e&&Pe.test(e)?e.replace(Ce,h):e||"(?:)"}function gi(e,t,r){e=n(e),t=+t;var o=e.length;if(o>=t||!bs(t))return e;var i=(t-o)/2,s=ys(i),a=_s(i);return r=kr("",a,r),r.slice(0,s)+e+r}function _i(e,t,r){return(r?$r(e,t,r):null==t)?t=0:t&&(t=+t),e=bi(e),Ps(e,t||(Re.test(e)?16:10))}function mi(e,t){var r="";if(e=n(e),t=+t,t<1||!e||!bs(t))return r;do t%2&&(r+=e),t=ys(t/2),e+=e;while(t);return r}function yi(e,t,r){return e=n(e),r=null==r?0:Ts(r<0?0:+r||0,e.length),e.lastIndexOf(t,r)==r}function vi(e,t,r){var o=Q.templateSettings;r&&$r(e,t,r)&&(t=r=E),e=n(e),t=_t(mt({},r||t),o,gt);var i,s,a=_t(mt({},t.imports),o.imports,gt),l=qa(a),c=er(a,l),u=0,h=t.interpolate||Be,p="__p += '",d=Qi((t.escape||Be).source+"|"+h.source+"|"+(h===be?we:Be).source+"|"+(t.evaluate||Be).source+"|$","g"),g="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++Fe+"]")+"\n";e.replace(d,function(t,r,o,n,a,l){return o||(o=n),p+=e.slice(u,l).replace(De,f),r&&(i=!0,p+="' +\n__e("+r+") +\n'"),a&&(s=!0,p+="';\n"+a+";\n__p += '"),o&&(p+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),u=l+t.length,t}),p+="';\n";var _=t.variable;_||(p="with (obj) {\n"+p+"\n}\n"),p=(s?p.replace(he,""):p).replace(fe,"$1").replace(pe,"$1;"),p="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var m=Xa(function(){return zi(l,g+"return "+p).apply(E,c)});if(m.source=p,kn(m))throw m;return m}function bi(e,t,r){var o=e;return(e=n(e))?(r?$r(o,t,r):null==t)?e.slice(y(e),v(e)+1):(t+="",e.slice(i(e,t),s(e,t)+1)):e}function Si(e,t,r){var o=e;return e=n(e),e?(r?$r(o,t,r):null==t)?e.slice(y(e)):e.slice(i(e,t+"")):e}function Ei(e,t,r){var o=e;return e=n(e),e?(r?$r(o,t,r):null==t)?e.slice(0,v(e)+1):e.slice(0,s(e,t+"")+1):e}function Ti(e,t,r){r&&$r(e,t,r)&&(t=E);var o=O,i=B;if(null!=t)if(Dn(t)){var s="separator"in t?t.separator:s;o="length"in t?+t.length||0:o,i="omission"in t?n(t.omission):i}else o=+t||0;if(e=n(e),o>=e.length)return e;var a=o-i.length;if(a<1)return i;var l=e.slice(0,a);if(null==s)return l+i;if(Kn(s)){if(e.slice(a).search(s)){var c,u,h=e.slice(0,a);for(s.global||(s=Qi(s.source,(xe.exec(s)||"")+"g")),s.lastIndex=0;c=s.exec(h);)u=c.index;l=l.slice(0,null==u?a:u)}}else if(e.indexOf(s,a)!=a){var f=l.lastIndexOf(s);f>-1&&(l=l.slice(0,f))}return l+i}function Ci(e){return e=n(e),e&&_e.test(e)?e.replace(de,b):e}function Pi(e,t,r){return r&&$r(e,t,r)&&(t=E),e=n(e),e.match(t||Le)||[]}function Ni(e,t,r){return r&&$r(e,t,r)&&(t=E),d(e)?xi(e):bt(e,t)}function Ai(e){return function(){return e}}function wi(e){return e}function xi(e){return Ut(St(e,!0))}function Ri(e,t){return qt(e,St(t,!0))}function Ii(e,t,r){if(null==r){var o=Dn(t),n=o?qa(t):E,i=n&&n.length?Ot(t,n):E;(i?i.length:o)||(i=!1,r=t,t=e,e=this)}i||(i=Ot(t,qa(t)));var s=!0,a=-1,l=Bn(e),c=i.length;r===!1?s=!1:Dn(r)&&"chain"in r&&(s=r.chain);for(;++a<c;){var u=i[a],h=t[u];e[u]=h,l&&(e.prototype[u]=function(t){return function(){var r=this.__chain__;if(s||r){var o=e(this.__wrapped__),n=o.__actions__=rt(this.__actions__);return n.push({func:t,args:arguments,thisArg:e}),o.__chain__=r,o}return t.apply(e,ct([this.value()],arguments))}}(h))}return e}function ki(){return Ze._=ns,this}function Oi(){}function Bi(e){return Zr(e)?Ht(e):zt(e)}function Di(e){return function(t){return Bt(e,ho(t),t+"")}}function Li(e,t,r){r&&$r(e,t,r)&&(t=r=E),e=+e||0,r=null==r?1:+r||0,null==t?(t=e,e=0):t=+t||0;for(var o=-1,n=Es(_s((t-e)/(r||1)),0),i=ji(n);++o<n;)i[o]=e,e+=r;return i}function Mi(e,t,r){if(e=ys(e),e<1||!bs(e))return[];var o=-1,n=ji(Ts(e,xs));for(t=ir(t,r,1);++o<e;)o<xs?n[o]=t(o):t(o);return n}function Fi(e){var t=++rs;return n(e)+t}function Ui(e,t){return(+e||0)+(+t||0)}function qi(e,t,r){return r&&$r(e,t,r)&&(t=E),t=qr(t,r,3),1==t.length?pt(xa(e)?e:co(e),t):$t(e,t)}g=g?et.defaults(Ze.Object(),g,et.pick(Ze,Me)):Ze;var ji=g.Array,Ki=g.Date,Hi=g.Error,zi=g.Function,Vi=g.Math,Wi=g.Number,Gi=g.Object,Qi=g.RegExp,Yi=g.String,Ji=g.TypeError,Xi=ji.prototype,$i=Gi.prototype,Zi=Yi.prototype,es=zi.prototype.toString,ts=$i.hasOwnProperty,rs=0,os=$i.toString,ns=Ze._,is=Qi("^"+es.call(ts).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ss=g.ArrayBuffer,as=g.clearTimeout,ls=g.parseFloat,cs=Vi.pow,us=$i.propertyIsEnumerable,hs=zr(g,"Set"),fs=g.setTimeout,ps=Xi.splice,ds=g.Uint8Array,gs=zr(g,"WeakMap"),_s=Vi.ceil,ms=zr(Gi,"create"),ys=Vi.floor,vs=zr(ji,"isArray"),bs=g.isFinite,Ss=zr(Gi,"keys"),Es=Vi.max,Ts=Vi.min,Cs=zr(Ki,"now"),Ps=g.parseInt,Ns=Vi.random,As=Wi.NEGATIVE_INFINITY,ws=Wi.POSITIVE_INFINITY,xs=4294967295,Rs=xs-1,Is=xs>>>1,ks=9007199254740991,Os=gs&&new gs,Bs={};Q.support={};Q.templateSettings={escape:ye,evaluate:ve,interpolate:be,variable:"",imports:{_:Q}};var Ds=function(){function e(){}return function(t){if(Dn(t)){e.prototype=t;var r=new e;e.prototype=E}return r||{}}}(),Ls=hr(It),Ms=hr(kt,!0),Fs=fr(),Us=fr(!0),qs=Os?function(e,t){return Os.set(e,t),e}:wi,js=Os?function(e){return Os.get(e)}:Oi,Ks=Ht("length"),Hs=function(){var e=0,t=0;return function(r,o){var n=ga(),i=L-(n-t);if(t=n,i>0){if(++e>=D)return r}else e=0;return qs(r,o)}}(),zs=yn(function(e,t){return d(e)&&Jr(e)?Tt(e,xt(t,!1,!0)):[]}),Vs=Sr(),Ws=Sr(!0),Gs=yn(function(e){for(var t=e.length,o=t,n=ji(h),i=Kr(),s=i===r,a=[];o--;){var l=e[o]=Jr(l=e[o])?l:[];n[o]=s&&l.length>=120?dr(o&&l):null}var c=e[0],u=-1,h=c?c.length:0,f=n[0];e:for(;++u<h;)if(l=c[u],(f?Xe(f,l):i(a,l,0))<0){for(var o=t;--o;){var p=n[o];if((p?Xe(p,l):i(e[o],l,0))<0)continue e}f&&f.push(l),a.push(l)}return a}),Qs=yn(function(t,r){r=xt(r);var o=yt(t,r);return Vt(t,r.sort(e)),o}),Ys=Dr(),Js=Dr(!0),Xs=yn(function(e){return Zt(xt(e,!1,!0))}),$s=yn(function(e,t){return Jr(e)?Tt(e,t):[]}),Zs=yn(Mo),ea=yn(function(e){var t=e.length,r=t>2?e[t-2]:E,o=t>1?e[t-1]:E;return t>2&&"function"==typeof r?t-=2:(r=t>1&&"function"==typeof o?(--t,o):E,o=E),e.length=t,Fo(e,r,o)}),ta=yn(function(e){return e=xt(e),this.thru(function(t){return tt(xa(t)?t:[uo(t)],e)})}),ra=yn(function(e,t){return yt(e,xt(t))}),oa=cr(function(e,t,r){ts.call(e,r)?++e[r]:e[r]=1}),na=br(Ls),ia=br(Ms,!0),sa=Cr(ot,Ls),aa=Cr(nt,Ms),la=cr(function(e,t,r){ts.call(e,r)?e[r].push(t):e[r]=[t]}),ca=cr(function(e,t,r){e[r]=t}),ua=yn(function(e,t,r){var o=-1,n="function"==typeof t,i=Zr(t),s=Jr(e)?ji(e.length):[];return Ls(e,function(e){var a=n?t:i&&null!=e?e[t]:E;s[++o]=a?a.apply(e,r):Yr(e,t,r)}),s}),ha=cr(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]}),fa=Rr(ut,Ls),pa=Rr(ht,Ms),da=yn(function(e,t){if(null==e)return[];var r=t[2];return r&&$r(t[0],t[1],r)&&(t.length=1),Xt(e,xt(t),[])}),ga=Cs||function(){return(new Ki).getTime()},_a=yn(function(e,t,r){var o=C;if(r.length){var n=_(r,_a.placeholder);o|=x}return Lr(e,o,t,r,n)}),ma=yn(function(e,t){t=t.length?xt(t):Xn(e);for(var r=-1,o=t.length;++r<o;){var n=t[r];e[n]=Lr(e[n],C,e)}return e}),ya=yn(function(e,t,r){var o=C|P;if(r.length){var n=_(r,ya.placeholder);o|=x}return Lr(t,o,e,r,n)}),va=mr(A),ba=mr(w),Sa=yn(function(e,t){return Et(e,1,t)}),Ea=yn(function(e,t,r){return Et(e,t,r)}),Ta=Tr(),Ca=Tr(!0),Pa=yn(function(e,t){if(t=xt(t),"function"!=typeof e||!it(t,o))throw new Ji(q);var r=t.length;return yn(function(o){for(var n=Ts(o.length,r);n--;)o[n]=t[n](o[n]);return e.apply(this,o)})}),Na=xr(x),Aa=xr(R),wa=yn(function(e,t){return Lr(e,k,E,E,E,xt(t))}),xa=vs||function(e){return d(e)&&to(e.length)&&os.call(e)==H},Ra=ur(jt),Ia=ur(function(e,t,r){return r?_t(e,t,r):mt(e,t)}),ka=yr(Ia,dt),Oa=yr(Ra,no),Ba=Er(It),Da=Er(kt),La=Pr(Fs),Ma=Pr(Us),Fa=Nr(It),Ua=Nr(kt),qa=Ss?function(e){var t=null==e?E:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&Jr(e)?lo(e):Dn(e)?Ss(e):[]}:lo,ja=Ar(!0),Ka=Ar(),Ha=yn(function(e,t){if(null==e)return{};if("function"!=typeof t[0]){var t=lt(xt(t),Yi);return io(e,Tt(ti(e),t))}var r=ir(t[0],t[1],3);return so(e,function(e,t,o){return!r(e,t,o)})}),za=yn(function(e,t){return null==e?{}:"function"==typeof t[0]?so(e,ir(t[0],t[1],3)):io(e,xt(t))}),Va=gr(function(e,t,r){return t=t.toLowerCase(),e+(r?t.charAt(0).toUpperCase()+t.slice(1):t)}),Wa=gr(function(e,t,r){return e+(r?"-":"")+t.toLowerCase()}),Ga=wr(),Qa=wr(!0),Ya=gr(function(e,t,r){return e+(r?"_":"")+t.toLowerCase()}),Ja=gr(function(e,t,r){return e+(r?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),Xa=yn(function(e,t){try{return e.apply(E,t)}catch(r){return kn(r)?r:new Hi(r)}}),$a=yn(function(e,t){return function(r){return Yr(r,e,t)}}),Za=yn(function(e,t){return function(r){return Yr(e,r,t)}}),el=Br("ceil"),tl=Br("floor"),rl=vr(Cn,As),ol=vr(Wn,ws),nl=Br("round");return Q.prototype=$.prototype,ee.prototype=Ds($.prototype),ee.prototype.constructor=ee,je.prototype=Ds($.prototype),je.prototype.constructor=je,Ve.prototype["delete"]=We,Ve.prototype.get=Ge,Ve.prototype.has=Qe,Ve.prototype.set=Ye,Je.prototype.push=$e,gn.Cache=Ve,Q.after=hn,Q.ary=fn,Q.assign=Ia,Q.at=ra,Q.before=pn,Q.bind=_a,Q.bindAll=ma,Q.bindKey=ya,Q.callback=Ni,Q.chain=jo,Q.chunk=po,Q.compact=go,Q.constant=Ai,Q.countBy=oa,Q.create=Jn,Q.curry=va,Q.curryRight=ba,Q.debounce=dn,Q.defaults=ka,Q.defaultsDeep=Oa,Q.defer=Sa,Q.delay=Ea,Q.difference=zs,Q.drop=_o,Q.dropRight=mo,Q.dropRightWhile=yo,Q.dropWhile=vo,Q.fill=bo,Q.filter=Xo,Q.flatten=Eo,Q.flattenDeep=To,Q.flow=Ta,Q.flowRight=Ca,Q.forEach=sa,Q.forEachRight=aa,Q.forIn=La,Q.forInRight=Ma,Q.forOwn=Fa,Q.forOwnRight=Ua,Q.functions=Xn,Q.groupBy=la,Q.indexBy=ca,Q.initial=Po,Q.intersection=Gs,Q.invert=ei,Q.invoke=ua,Q.keys=qa,Q.keysIn=ti,Q.map=en,Q.mapKeys=ja,Q.mapValues=Ka,Q.matches=xi,Q.matchesProperty=Ri,Q.memoize=gn,Q.merge=Ra,Q.method=$a,Q.methodOf=Za,Q.mixin=Ii,Q.modArgs=Pa,Q.negate=_n,Q.omit=Ha,Q.once=mn,Q.pairs=ri,Q.partial=Na,Q.partialRight=Aa,Q.partition=ha,Q.pick=za,Q.pluck=tn,Q.property=Bi,Q.propertyOf=Di,Q.pull=wo,Q.pullAt=Qs,Q.range=Li,Q.rearg=wa,Q.reject=rn,Q.remove=xo,Q.rest=Ro,Q.restParam=yn,Q.set=ni,Q.shuffle=nn,Q.slice=Io,Q.sortBy=ln,Q.sortByAll=da,Q.sortByOrder=cn,Q.spread=vn,Q.take=ko,Q.takeRight=Oo,Q.takeRightWhile=Bo,Q.takeWhile=Do,Q.tap=Ko,Q.throttle=bn,Q.thru=Ho,Q.times=Mi,Q.toArray=Qn,Q.toPlainObject=Yn,Q.transform=ii,Q.union=Xs,Q.uniq=Lo,Q.unzip=Mo,Q.unzipWith=Fo,Q.values=si,Q.valuesIn=ai,Q.where=un,Q.without=$s,Q.wrap=Sn,Q.xor=Uo,Q.zip=Zs,Q.zipObject=qo,Q.zipWith=ea,Q.backflow=Ca,Q.collect=en,Q.compose=Ca,Q.each=sa,Q.eachRight=aa,Q.extend=Ia,Q.iteratee=Ni,Q.methods=Xn,Q.object=qo,Q.select=Xo,Q.tail=Ro,Q.unique=Lo,Ii(Q,Q),Q.add=Ui,Q.attempt=Xa,Q.camelCase=Va,Q.capitalize=ui,Q.ceil=el,Q.clone=En,Q.cloneDeep=Tn,Q.deburr=hi,Q.endsWith=fi,Q.escape=pi,Q.escapeRegExp=di,Q.every=Jo,Q.find=na,Q.findIndex=Vs,Q.findKey=Ba,Q.findLast=ia,Q.findLastIndex=Ws,Q.findLastKey=Da,Q.findWhere=$o,Q.first=So,Q.floor=tl,Q.get=$n,Q.gt=Cn,Q.gte=Pn,Q.has=Zn,Q.identity=wi,Q.includes=Zo,Q.indexOf=Co,Q.inRange=li,Q.isArguments=Nn,Q.isArray=xa,Q.isBoolean=An,Q.isDate=wn,Q.isElement=xn,Q.isEmpty=Rn,Q.isEqual=In,Q.isError=kn,Q.isFinite=On,Q.isFunction=Bn,Q.isMatch=Ln,Q.isNaN=Mn,Q.isNative=Fn,Q.isNull=Un,Q.isNumber=qn,Q.isObject=Dn,Q.isPlainObject=jn,Q.isRegExp=Kn,Q.isString=Hn,Q.isTypedArray=zn,Q.isUndefined=Vn,Q.kebabCase=Wa,Q.last=No,Q.lastIndexOf=Ao,Q.lt=Wn,Q.lte=Gn,Q.max=rl,Q.min=ol,Q.noConflict=ki,Q.noop=Oi,Q.now=ga,Q.pad=gi,Q.padLeft=Ga,Q.padRight=Qa,Q.parseInt=_i,Q.random=ci,Q.reduce=fa,Q.reduceRight=pa,Q.repeat=mi,Q.result=oi,Q.round=nl,Q.runInContext=S,Q.size=sn,Q.snakeCase=Ya,Q.some=an,Q.sortedIndex=Ys,Q.sortedLastIndex=Js,Q.startCase=Ja,Q.startsWith=yi,Q.sum=qi,Q.template=vi,Q.trim=bi,Q.trimLeft=Si,Q.trimRight=Ei,Q.trunc=Ti,Q.unescape=Ci,Q.uniqueId=Fi,Q.words=Pi,Q.all=Jo,Q.any=an,Q.contains=Zo,Q.eq=In,Q.detect=na,Q.foldl=fa,Q.foldr=pa,Q.head=So,Q.include=Zo,Q.inject=fa,Ii(Q,function(){
var e={};return It(Q,function(t,r){Q.prototype[r]||(e[r]=t)}),e}(),!1),Q.sample=on,Q.prototype.sample=function(e){return this.__chain__||null!=e?this.thru(function(t){return on(t,e)}):on(this.value())},Q.VERSION=T,ot(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){Q[e].placeholder=Q}),ot(["drop","take"],function(e,t){je.prototype[e]=function(r){var o=this.__filtered__;if(o&&!t)return new je(this);r=null==r?1:Es(ys(r)||0,0);var n=this.clone();return o?n.__takeCount__=Ts(n.__takeCount__,r):n.__views__.push({size:r,type:e+(n.__dir__<0?"Right":"")}),n},je.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),ot(["filter","map","takeWhile"],function(e,t){var r=t+1,o=r!=U;je.prototype[e]=function(e,t){var n=this.clone();return n.__iteratees__.push({iteratee:qr(e,t,1),type:r}),n.__filtered__=n.__filtered__||o,n}}),ot(["first","last"],function(e,t){var r="take"+(t?"Right":"");je.prototype[e]=function(){return this[r](1).value()[0]}}),ot(["initial","rest"],function(e,t){var r="drop"+(t?"":"Right");je.prototype[e]=function(){return this.__filtered__?new je(this):this[r](1)}}),ot(["pluck","where"],function(e,t){var r=t?"filter":"map",o=t?Ut:Bi;je.prototype[e]=function(e){return this[r](o(e))}}),je.prototype.compact=function(){return this.filter(wi)},je.prototype.reject=function(e,t){return e=qr(e,t,1),this.filter(function(t){return!e(t)})},je.prototype.slice=function(e,t){e=null==e?0:+e||0;var r=this;return r.__filtered__&&(e>0||t<0)?new je(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==E&&(t=+t||0,r=t<0?r.dropRight(-t):r.take(t-e)),r)},je.prototype.takeRightWhile=function(e,t){return this.reverse().takeWhile(e,t).reverse()},je.prototype.toArray=function(){return this.take(ws)},It(je.prototype,function(e,t){var r=/^(?:filter|map|reject)|While$/.test(t),o=/^(?:first|last)$/.test(t),n=Q[o?"take"+("last"==t?"Right":""):t];n&&(Q.prototype[t]=function(){var t=o?[1]:arguments,i=this.__chain__,s=this.__wrapped__,a=!!this.__actions__.length,l=s instanceof je,c=t[0],u=l||xa(s);u&&r&&"function"==typeof c&&1!=c.length&&(l=u=!1);var h=function(e){return o&&i?n(e,1)[0]:n.apply(E,ct([e],t))},f={func:Ho,args:[h],thisArg:E},p=l&&!a;if(o&&!i)return p?(s=s.clone(),s.__actions__.push(f),e.call(s)):n.call(E,this.value())[0];if(!o&&u){s=p?s:new je(this);var d=e.apply(s,t);return d.__actions__.push(f),new ee(d,i)}return this.thru(h)})}),ot(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(e){var t=(/^(?:replace|split)$/.test(e)?Zi:Xi)[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:join|pop|replace|shift)$/.test(e);Q.prototype[e]=function(){var e=arguments;return o&&!this.__chain__?t.apply(this.value(),e):this[r](function(r){return t.apply(r,e)})}}),It(je.prototype,function(e,t){var r=Q[t];if(r){var o=r.name+"",n=Bs[o]||(Bs[o]=[]);n.push({name:t,func:r})}}),Bs[Ir(E,P).name]=[{name:"wrapper",func:E}],je.prototype.clone=Ke,je.prototype.reverse=He,je.prototype.value=ze,Q.prototype.chain=zo,Q.prototype.commit=Vo,Q.prototype.concat=ta,Q.prototype.plant=Wo,Q.prototype.reverse=Go,Q.prototype.toString=Qo,Q.prototype.run=Q.prototype.toJSON=Q.prototype.valueOf=Q.prototype.value=Yo,Q.prototype.collect=Q.prototype.map,Q.prototype.head=Q.prototype.first,Q.prototype.select=Q.prototype.filter,Q.prototype.tail=Q.prototype.rest,Q}var E,T="3.10.1",C=1,P=2,N=4,A=8,w=16,x=32,R=64,I=128,k=256,O=30,B="...",D=150,L=16,M=200,F=1,U=2,q="Expected a function",j="__lodash_placeholder__",K="[object Arguments]",H="[object Array]",z="[object Boolean]",V="[object Date]",W="[object Error]",G="[object Function]",Q="[object Map]",Y="[object Number]",J="[object Object]",X="[object RegExp]",$="[object Set]",Z="[object String]",ee="[object WeakMap]",te="[object ArrayBuffer]",re="[object Float32Array]",oe="[object Float64Array]",ne="[object Int8Array]",ie="[object Int16Array]",se="[object Int32Array]",ae="[object Uint8Array]",le="[object Uint8ClampedArray]",ce="[object Uint16Array]",ue="[object Uint32Array]",he=/\b__p \+= '';/g,fe=/\b(__p \+=) '' \+/g,pe=/(__e\(.*?\)|\b__t\)) \+\n'';/g,de=/&(?:amp|lt|gt|quot|#39|#96);/g,ge=/[&<>"'`]/g,_e=RegExp(de.source),me=RegExp(ge.source),ye=/<%-([\s\S]+?)%>/g,ve=/<%([\s\S]+?)%>/g,be=/<%=([\s\S]+?)%>/g,Se=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,Ee=/^\w*$/,Te=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,Ce=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,Pe=RegExp(Ce.source),Ne=/[\u0300-\u036f\ufe20-\ufe23]/g,Ae=/\\(\\)?/g,we=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xe=/\w*$/,Re=/^0[xX]/,Ie=/^\[object .+?Constructor\]$/,ke=/^\d+$/,Oe=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Be=/($^)/,De=/['\n\r\u2028\u2029\\]/g,Le=function(){var e="[A-Z\\xc0-\\xd6\\xd8-\\xde]",t="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(e+"+(?="+e+t+")|"+e+"?"+t+"|"+e+"+|[0-9]+","g")}(),Me=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],Fe=-1,Ue={};Ue[re]=Ue[oe]=Ue[ne]=Ue[ie]=Ue[se]=Ue[ae]=Ue[le]=Ue[ce]=Ue[ue]=!0,Ue[K]=Ue[H]=Ue[te]=Ue[z]=Ue[V]=Ue[W]=Ue[G]=Ue[Q]=Ue[Y]=Ue[J]=Ue[X]=Ue[$]=Ue[Z]=Ue[ee]=!1;var qe={};qe[K]=qe[H]=qe[te]=qe[z]=qe[V]=qe[re]=qe[oe]=qe[ne]=qe[ie]=qe[se]=qe[Y]=qe[J]=qe[X]=qe[Z]=qe[ae]=qe[le]=qe[ce]=qe[ue]=!0,qe[W]=qe[G]=qe[Q]=qe[$]=qe[ee]=!1;var je={"Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã":"A","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã":"C","Ã§":"c","Ã":"D","Ã°":"d","Ã":"E","Ã":"E","Ã":"E","Ã":"E","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","Ã":"I","Ã":"I","Ã":"I","Ã":"I","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã":"N","Ã±":"n","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã":"O","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã":"U","Ã":"U","Ã":"U","Ã":"U","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã":"Y","Ã½":"y","Ã¿":"y","Ã":"Ae","Ã¦":"ae","Ã":"Th","Ã¾":"th","Ã":"ss"},Ke={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},He={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},ze={"function":!0,object:!0},Ve={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},We={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=ze[typeof exports]&&exports&&!exports.nodeType&&exports,Qe=ze[typeof module]&&module&&!module.nodeType&&module,Ye=Ge&&Qe&&"object"==typeof global&&global&&global.Object&&global,Je=ze[typeof self]&&self&&self.Object&&self,Xe=ze[typeof window]&&window&&window.Object&&window,$e=Qe&&Qe.exports===Ge&&Ge,Ze=Ye||Xe!==(this&&this.window)&&Xe||Je||this,et=S();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Ze._=et,define(function(){return et})):Ge&&Qe?$e?(Qe.exports=et)._=et:Ge._=et:Ze._=et}.call(this);var Time=window.Time||{};Time=function(){return this._hr=function(e){return e-=12*Math.floor(e/12),0==e?12:e},this._getStandardTime=function(e){e=e.split(":");var t=Number(e[0]),r=Number(e[1]),o=""+this._hr(t);return o+=r<10?":0"+r:":"+r,o+=t<12||t>24||24==t&&r>0?"am":"pm"},this._getTime=function(e){return 0===e.indexOf("25:")?(e=e.split("25:").join("01:"),new Date("2016/01/02 "+e).getTime()):0===e.indexOf("24:")?(e=e.split("24:").join("00:"),new Date("2016/01/02 "+e).getTime()):new Date("2016/01/01 "+e).getTime()},{getStandardTime:this._getStandardTime.bind(this),getTime:this._getTime.bind(this)}}(),Polymer({is:"list-train",properties:{list:{type:Array,value:function(){return[]},notify:!0}},_tripSchedule:function(e){return Time.getStandardTime(e.departure_time)+" - "+Time.getStandardTime(e.arrival_time)},_tripDuration:function(e){var t=Math.abs(Time.getTime(e.arrival_time)-Time.getTime(e.departure_time));return Math.round(t/6e4)}}),self.window||(window=self),function(){"use strict";var $jscomp={scope:{}},goog=goog||{};goog.global=this,goog.isDef=function(e){return void 0!==e},goog.exportPath_=function(e,t,r){var o=e.split("."),n=r||goog.global;o[0]in n||!n.execScript||n.execScript("var "+o[0]);for(var i;o.length&&(i=o.shift());)!o.length&&goog.isDef(t)?n[i]=t:n=n[i]?n[i]:n[i]={}},goog.define=function(e,t){var r=t;goog.exportPath_(e,r)},goog.DEBUG=!0,goog.LOCALE="en",goog.TRUSTED_SITE=!0,goog.STRICT_MODE_COMPATIBLE=!1,goog.DISALLOW_TEST_ONLY_CODE=!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(e){if(goog.isInModuleLoader_())throw Error("goog.provide can not be used within a goog.module.");goog.constructNamespace_(e)},goog.constructNamespace_=function(e,t){goog.exportPath_(e,t)},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(e){if(!goog.isString(e)||!e||-1==e.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+e+" has been loaded incorrectly.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=e},goog.module.get=function(){},goog.module.getInternal_=function(){},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_},goog.module.declareLegacyNamespace=function(){goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.setTestOnly=function(e){if(goog.DISALLOW_TEST_ONLY_CODE)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},goog.forwardDeclare=function(){},goog.getObjectByName=function(e,t){for(var r,o=e.split("."),n=t||goog.global;r=o.shift();){if(!goog.isDefAndNotNull(n[r]))return null;n=n[r]}return n},goog.globalize=function(e,t){var r,o=t||goog.global;for(r in e)o[r]=e[r]},goog.addDependency=function(e,t,r,o){if(goog.DEPENDENCIES_ENABLED){var n,i,s=e.replace(/\\/g,"/"),a=goog.dependencies_;o&&"boolean"!=typeof o||(o=o?{module:"goog"}:{});for(var l=0;n=t[l];l++)a.nameToPath[n]=s,a.loadFlags[s]=o;for(var c=0;i=r[c];c++)s in a.requires||(a.requires[s]={}),a.requires[s][i]=!0}},goog.useStrictRequires=!1,goog.ENABLE_DEBUG_LOADER=!0,goog.logToConsole_=function(e){goog.global.console&&goog.global.console.error(e)},goog.require=function(){},goog.basePath="",goog.nullFunction=function(){},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.getInstance=function(){return e.instance_?e.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!1,goog.TRANSPILE="detect",goog.TRANSPILER="transpile.js",goog.DEPENDENCIES_ENABLED&&(goog.dependencies_={loadFlags:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var e=goog.global.document;return null!=e&&"write"in e},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var e=goog.global.document,t=e.getElementsByTagName("SCRIPT"),r=t.length-1;0<=r;--r){var o=t[r],n=o.src,i=n.lastIndexOf("?"),s=-1==i?n.length:i;if("base.js"==n.substr(s-7,7)){goog.basePath=n.substr(0,s-7);break}}},goog.importScript_=function(e,t){var r=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;r(e,t)&&(goog.dependencies_.written[e]=!0)},goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.importProcessedScript_=function(e,t,r){var o='goog.retrieveAndExec_("'+e+'", '+t+", "+r+");";goog.importScript_("",o)},goog.queuedModules_=[],goog.wrapModule_=function(e,t){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(t+"\n//# sourceURL="+e+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+t+"\n;return exports});\n//# sourceURL="+e+"\n"},goog.loadQueuedModules_=function(){var e=goog.queuedModules_.length;if(0<e){var t=goog.queuedModules_;goog.queuedModules_=[];for(var r=0;r<e;r++){var o=t[r];goog.maybeProcessDeferredPath_(o)}}},goog.maybeProcessDeferredDep_=function(e){if(goog.isDeferredModule_(e)&&goog.allDepsAreAvailable_(e)){var t=goog.getPathFromDeps_(e);goog.maybeProcessDeferredPath_(goog.basePath+t)}},goog.isDeferredModule_=function(e){var t=goog.getPathFromDeps_(e),r=t&&goog.dependencies_.loadFlags[t]||{};if(t&&("goog"==r.module||goog.needsTranspile_(r.lang))){var o=goog.basePath+t;return o in goog.dependencies_.deferred}return!1},goog.allDepsAreAvailable_=function(e){var t=goog.getPathFromDeps_(e);if(t&&t in goog.dependencies_.requires)for(var r in goog.dependencies_.requires[t])if(!goog.isProvided_(r)&&!goog.isDeferredModule_(r))return!1;return!0},goog.maybeProcessDeferredPath_=function(e){if(e in goog.dependencies_.deferred){var t=goog.dependencies_.deferred[e];delete goog.dependencies_.deferred[e],goog.globalEval(t)}},goog.loadModuleFromUrl=function(){},goog.writeScriptSrcNode_=function(e){goog.global.document.write('<script type="text/javascript" src="'+e+'"></script>')},goog.appendScriptSrcNode_=function(e){var t=goog.global.document,r=t.createElement("script");r.type="text/javascript",r.src=e,r.defer=!1,r.async=!1,t.head.appendChild(r)},goog.writeScriptTag_=function(e,t){if(goog.inHtmlDocument_()){var r=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==r.readyState){var o=/\bdeps.js$/.test(e);if(o)return!1;throw Error('Cannot write "'+e+'" after document load')}if(void 0===t)if(goog.IS_OLD_IE_){var n=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ";r.write('<script type="text/javascript" src="'+e+'"'+n+"></script>")}else goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(e):goog.writeScriptSrcNode_(e);else r.write('<script type="text/javascript">'+t+"</script>");return!0}return!1},goog.needsTranspile_=function(lang){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;if(!goog.transpiledLanguages_){goog.transpiledLanguages_={es5:!0,es6:!0,"es6-impl":!0};try{goog.transpiledLanguages_.es5=eval("[1,].length!=1");var es6implTest="let a={};const X=class{constructor(){}x(z){return new Map([...arguments]).get(z[0])==3}};return new X().x([a,3])",es6fullTest="class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}";eval('(()=>{"use strict";'+es6implTest+"})()")&&(goog.transpiledLanguages_["es6-impl"]=!1),eval('(()=>{"use strict";'+es6fullTest+"})()")&&(goog.transpiledLanguages_.es6=!1)}catch(err){}}return!!goog.transpiledLanguages_[lang]},goog.transpiledLanguages_=null,goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(e,t){return"complete"==e.readyState&&goog.lastNonModuleScriptIndex_==t&&goog.loadQueuedModules_(),!0},goog.writeScripts_=function(e){function t(e){if(!(e in n.written||e in n.visited)){if(n.visited[e]=!0,e in n.requires)for(var i in n.requires[e])if(!goog.isProvided_(i)){if(!(i in n.nameToPath))throw Error("Undefined nameToPath for "+i);t(n.nameToPath[i])}e in o||(o[e]=!0,r.push(e))}}var r=[],o={},n=goog.dependencies_;t(e);for(var i=0;i<r.length;i++){var s=r[i];goog.dependencies_.written[s]=!0}var a=goog.moduleLoaderState_;for(goog.moduleLoaderState_=null,i=0;i<r.length;i++){if(!(s=r[i]))throw goog.moduleLoaderState_=a,Error("Undefined script input");var l=n.loadFlags[s]||{},c=goog.needsTranspile_(l.lang);"goog"==l.module||c?goog.importProcessedScript_(goog.basePath+s,"goog"==l.module,c):goog.importScript_(goog.basePath+s)}goog.moduleLoaderState_=a},goog.getPathFromDeps_=function(e){return e in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[e]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js")),goog.loadModule=function(e){var t=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1};var r;if(goog.isFunction(e))r=e.call(void 0,{});else{if(!goog.isString(e))throw Error("Invalid module definition");r=goog.loadModuleFromSource_.call(void 0,e)}var o=goog.moduleLoaderState_.moduleName;if(!goog.isString(o)||!o)throw Error('Invalid module name "'+o+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(o,r):goog.SEAL_MODULE_EXPORTS&&Object.seal&&Object.seal(r),goog.loadedModules_[o]=r}finally{goog.moduleLoaderState_=t}},goog.loadModuleFromSource_=function(JSCompiler_OptimizeArgumentsArray_p0){var exports={};return eval(JSCompiler_OptimizeArgumentsArray_p0),exports},goog.normalizePath_=function(e){for(var t=e.split("/"),r=0;r<t.length;)"."==t[r]?t.splice(r,1):r&&".."==t[r]&&t[r-1]&&".."!=t[r-1]?t.splice(--r,2):r++;return t.join("/")},goog.loadFileSync_=function(e){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(e);try{var t=new goog.global.XMLHttpRequest;return t.open("get",e,!1),t.send(),0==t.status||200==t.status?t.responseText:null}catch(r){return null}},goog.retrieveAndExec_=function(){},goog.transpile_=function(code$$0,path$$0){var jscomp=goog.global.$jscomp;jscomp||(goog.global.$jscomp=jscomp={});var transpile=jscomp.transpile;if(!transpile){var transpilerPath=goog.basePath+goog.TRANSPILER,transpilerCode=goog.loadFileSync_(transpilerPath);transpilerCode&&(eval(transpilerCode+"\n//# sourceURL="+transpilerPath),jscomp=goog.global.$jscomp,transpile=jscomp.transpile)}if(!transpile)var suffix=" requires transpilation but no transpiler was found.",suffix=suffix+' Please add "//javascript/closure:transpiler" as a data dependency to ensure it is included.',transpile=jscomp.transpile=function(e,t){return goog.logToConsole_(t+suffix),e};return transpile(code$$0,path$$0)},goog.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var r=Object.prototype.toString.call(e);if("[object Window]"==r)return"object";if("[object Array]"==r||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==r||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t},goog.isNull=function(e){return null===e},goog.isDefAndNotNull=function(e){return null!=e},goog.isArray=function(e){return"array"==goog.typeOf(e)},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isString=function(e){return"string"==typeof e},goog.isBoolean=function(e){return"boolean"==typeof e},goog.isNumber=function(e){return"number"==typeof e},goog.isFunction=function(e){return"function"==goog.typeOf(e)},goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]},goog.removeUid=function(e){null!==e&&"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(t){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(e.clone)return e.clone();var r,o="array"==t?[]:{};for(r in e)o[r]=goog.cloneObject(e[r]);return o}return e},goog.bindNative_=function(e,t,r){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(e,t,r){if(!e)throw Error();if(2<arguments.length){var o=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,o),e.apply(t,r)}}return function(){return e.apply(t,arguments)}},goog.bind=function(e,t,r){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}},goog.mixin=function(e,t){for(var r in t)e[r]=t[r]},goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date},goog.globalEval=function(e){if(goog.global.execScript)goog.global.execScript(e,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_)if(goog.global.eval("var _evalTest_ = 1;"),"undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(t){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1;if(goog.evalWorksForGlobals_)goog.global.eval(e);else{var r=goog.global.document,o=r.createElement("SCRIPT");o.type="text/javascript",o.defer=!1,o.appendChild(r.createTextNode(e)),r.body.appendChild(o),r.body.removeChild(o)}}},goog.evalWorksForGlobals_=null,goog.getCssName=function(e,t){var r,o=function(e){return goog.cssNameMapping_[e]||e},n=function(e){for(var t=e.split("-"),r=[],n=0;n<t.length;n++)r.push(o(t[n]));return r.join("-")};return r=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?o:n:function(e){return e},t?e+"-"+r(t):r(e)},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},goog.getMsg=function(e,t){return t&&(e=e.replace(/\{\$([^}]+)}/g,function(e,r){return null!=t&&r in t?t[r]:e})),e},goog.getMsgWithFallback=function(e){return e},goog.exportSymbol=function(e,t,r){goog.exportPath_(e,t,r)},goog.exportProperty=function(e,t,r){e[t]=r},goog.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.base=function(e,r,o){for(var n=Array(arguments.length-2),i=2;i<arguments.length;i++)n[i-2]=arguments[i];return t.prototype[r].apply(e,n)}},goog.base=function(e,t,r){var o=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!o)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(o.superClass_){for(var n=Array(arguments.length-1),i=1;i<arguments.length;i++)n[i-1]=arguments[i];return o.superClass_.constructor.apply(e,n)}for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];for(var a=!1,l=e.constructor;l;l=l.superClass_&&l.superClass_.constructor)if(l.prototype[t]===o)a=!0;else if(a)return l.prototype[t].apply(e,s);if(e[t]===o)return e.constructor.prototype[t].apply(e,s);throw Error("goog.base called from a method of one name to a method of a different name")},goog.scope=function(e){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a goog.module.");e.call(goog.global)},goog.defineClass=function(e,t){var r=t.constructor,o=t.statics;r&&r!=Object.prototype.constructor||(r=function(){throw Error("cannot instantiate an interface (no constructor defined).")});var n=goog.defineClass.createSealingConstructor_(r,e);return e&&goog.inherits(n,e),delete t.constructor,delete t.statics,goog.defineClass.applyProperties_(n.prototype,t),null!=o&&(o instanceof Function?o(n):goog.defineClass.applyProperties_(n,o)),n},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(e,t){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return e;var r=!goog.defineClass.isUnsealable_(t),o=function(){var t=e.apply(this,arguments)||this;return t[goog.UID_PROPERTY_]=t[goog.UID_PROPERTY_],this.constructor===o&&r&&Object.seal instanceof Function&&Object.seal(t),t};return o},goog.defineClass.isUnsealable_=function(e){return e&&e.prototype&&e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);for(var o=0;o<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;o++)r=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[o],Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},goog.tagUnsealableClass=function(){},goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable",goog.debug={},goog.debug.Error=function(e){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))},goog.inherits(goog.debug.Error,Error),goog.debug.Error.prototype.name="CustomError",goog.dom={},goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},goog.string={},goog.string.DETECT_DOUBLE_ESCAPING=!1,goog.string.FORCE_NON_DOM_HTML_UNESCAPING=!1,goog.string.Unicode={NBSP:"Â "},goog.string.startsWith=function(e,t){return 0==e.lastIndexOf(t,0)},goog.string.endsWith=function(e,t){var r=e.length-t.length;return 0<=r&&e.indexOf(t,r)==r},goog.string.caseInsensitiveStartsWith=function(e,t){return 0==goog.string.caseInsensitiveCompare(t,e.substr(0,t.length))},goog.string.caseInsensitiveEndsWith=function(e,t){return 0==goog.string.caseInsensitiveCompare(t,e.substr(e.length-t.length,t.length))},goog.string.caseInsensitiveEquals=function(e,t){return e.toLowerCase()==t.toLowerCase()},goog.string.subs=function(e,t){for(var r=e.split("%s"),o="",n=Array.prototype.slice.call(arguments,1);n.length&&1<r.length;)o+=r.shift()+n.shift();return o+r.join("%s")},goog.string.collapseWhitespace=function(e){return e.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},goog.string.isEmptyOrWhitespace=function(e){return/^[\s\xa0]*$/.test(e)},goog.string.isEmptyString=function(e){return 0==e.length},goog.string.isEmpty=goog.string.isEmptyOrWhitespace,goog.string.isEmptyOrWhitespaceSafe=function(e){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(e))},goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe,goog.string.isBreakingWhitespace=function(e){return!/[^\t\n\r ]/.test(e)},goog.string.isAlpha=function(e){return!/[^a-zA-Z]/.test(e)},goog.string.isNumeric=function(e){return!/[^0-9]/.test(e)},goog.string.isAlphaNumeric=function(e){return!/[^a-zA-Z0-9]/.test(e)},goog.string.isSpace=function(e){return" "==e},goog.string.isUnicodeChar=function(e){return 1==e.length&&" "<=e&&"~">=e||"Â"<=e&&"ï¿½">=e},goog.string.stripNewlines=function(e){return e.replace(/(\r\n|\r|\n)+/g," ")},goog.string.canonicalizeNewlines=function(e){return e.replace(/(\r\n|\r|\n)/g,"\n")},goog.string.normalizeWhitespace=function(e){return e.replace(/\xa0|\s/g," ")},goog.string.normalizeSpaces=function(e){return e.replace(/\xa0|[ \t]+/g," ")},goog.string.collapseBreakingSpaces=function(e){return e.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")},goog.string.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},goog.string.trimLeft=function(e){return e.replace(/^[\s\xa0]+/,"")},goog.string.trimRight=function(e){return e.replace(/[\s\xa0]+$/,"")},goog.string.caseInsensitiveCompare=function(e,t){var r=String(e).toLowerCase(),o=String(t).toLowerCase();return r<o?-1:r==o?0:1},goog.string.numberAwareCompare_=function(e,t,r){if(e==t)return 0;if(!e)return-1;if(!t)return 1;for(var o=e.toLowerCase().match(r),n=t.toLowerCase().match(r),i=Math.min(o.length,n.length),s=0;s<i;s++){var a=o[s],l=n[s];if(a!=l){var c=parseInt(a,10);if(!isNaN(c)){var u=parseInt(l,10);if(!isNaN(u)&&c-u)return c-u}return a<l?-1:1}}return o.length!=n.length?o.length-n.length:e<t?-1:1},goog.string.intAwareCompare=function(e,t){return goog.string.numberAwareCompare_(e,t,/\d+|\D+/g)},goog.string.floatAwareCompare=function(e,t){return goog.string.numberAwareCompare_(e,t,/\d+|\.\d+|\D+/g)},goog.string.numerateCompare=goog.string.floatAwareCompare,goog.string.urlEncode=function(e){return encodeURIComponent(String(e))},goog.string.urlDecode=function(e){return decodeURIComponent(e.replace(/\+/g," "))},goog.string.newLineToBr=function(e,t){return e.replace(/(\r\n|\r|\n)/g,t?"<br />":"<br>")},goog.string.htmlEscape=function(e,t){if(t)e=e.replace(goog.string.AMP_RE_,"&amp;").replace(goog.string.LT_RE_,"&lt;").replace(goog.string.GT_RE_,"&gt;").replace(goog.string.QUOT_RE_,"&quot;").replace(goog.string.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.NULL_RE_,"&#0;"),goog.string.DETECT_DOUBLE_ESCAPING&&(e=e.replace(goog.string.E_RE_,"&#101;"));else{if(!goog.string.ALL_RE_.test(e))return e;-1!=e.indexOf("&")&&(e=e.replace(goog.string.AMP_RE_,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(goog.string.LT_RE_,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(goog.string.GT_RE_,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(goog.string.QUOT_RE_,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(goog.string.SINGLE_QUOTE_RE_,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(goog.string.NULL_RE_,"&#0;")),goog.string.DETECT_DOUBLE_ESCAPING&&-1!=e.indexOf("e")&&(e=e.replace(goog.string.E_RE_,"&#101;"))}return e},goog.string.AMP_RE_=/&/g,goog.string.LT_RE_=/</g,goog.string.GT_RE_=/>/g,goog.string.QUOT_RE_=/"/g,goog.string.SINGLE_QUOTE_RE_=/'/g,goog.string.NULL_RE_=/\x00/g,goog.string.E_RE_=/e/g,goog.string.ALL_RE_=goog.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/,goog.string.unescapeEntities=function(e){return goog.string.contains(e,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(e):goog.string.unescapePureXmlEntities_(e):e},goog.string.unescapeEntitiesWithDocument=function(e,t){return goog.string.contains(e,"&")?goog.string.unescapeEntitiesUsingDom_(e,t):e},goog.string.unescapeEntitiesUsingDom_=function(e,t){var r,o={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'};return r=t?t.createElement("div"):goog.global.document.createElement("div"),e.replace(goog.string.HTML_ENTITY_PATTERN_,function(e,t){var n=o[e];if(n)return n;if("#"==t.charAt(0)){var i=Number("0"+t.substr(1));isNaN(i)||(n=String.fromCharCode(i))}return n||(r.innerHTML=e+" ",n=r.firstChild.nodeValue.slice(0,-1)),o[e]=n})},goog.string.unescapePureXmlEntities_=function(e){return e.replace(/&([^;]+);/g,function(e,t){switch(t){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:if("#"==t.charAt(0)){var r=Number("0"+t.substr(1));if(!isNaN(r))return String.fromCharCode(r)}return e}})},goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g,goog.string.whitespaceEscape=function(e,t){return goog.string.newLineToBr(e.replace(/  /g," &#160;"),t)},goog.string.preserveSpaces=function(e){return e.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)},goog.string.stripQuotes=function(e,t){for(var r=t.length,o=0;o<r;o++){var n=1==r?t:t.charAt(o);if(e.charAt(0)==n&&e.charAt(e.length-1)==n)return e.substring(1,e.length-1)}return e},goog.string.truncate=function(e,t,r){return r&&(e=goog.string.unescapeEntities(e)),e.length>t&&(e=e.substring(0,t-3)+"..."),r&&(e=goog.string.htmlEscape(e)),e},goog.string.truncateMiddle=function(e,t,r,o){if(r&&(e=goog.string.unescapeEntities(e)),o&&e.length>t){o>t&&(o=t);var n=e.length-o,i=t-o;e=e.substring(0,i)+"..."+e.substring(n)}else if(e.length>t){var s=Math.floor(t/2),a=e.length-s,s=s+t%2;e=e.substring(0,s)+"..."+e.substring(a)}return r&&(e=goog.string.htmlEscape(e)),e},goog.string.specialEscapeChars_={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\","<":"<"},goog.string.jsEscapeCache_={"'":"\\'"},goog.string.quote=function(e){e=String(e);for(var t=['"'],r=0;r<e.length;r++){
var o=e.charAt(r),n=o.charCodeAt(0);t[r+1]=goog.string.specialEscapeChars_[o]||(31<n&&127>n?o:goog.string.escapeChar(o))}return t.push('"'),t.join("")},goog.string.escapeString=function(e){for(var t=[],r=0;r<e.length;r++)t[r]=goog.string.escapeChar(e.charAt(r));return t.join("")},goog.string.escapeChar=function(e){if(e in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[e];if(e in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[e]=goog.string.specialEscapeChars_[e];var t,r=e.charCodeAt(0);return 31<r&&127>r?t=e:(256>r?(t="\\x",(16>r||256<r)&&(t+="0")):(t="\\u",4096>r&&(t+="0")),t+=r.toString(16).toUpperCase()),goog.string.jsEscapeCache_[e]=t},goog.string.contains=function(e,t){return-1!=e.indexOf(t)},goog.string.caseInsensitiveContains=function(e,t){return goog.string.contains(e.toLowerCase(),t.toLowerCase())},goog.string.countOf=function(e,t){return e&&t?e.split(t).length-1:0},goog.string.removeAt=function(e,t,r){var o=e;return 0<=t&&t<e.length&&0<r&&(o=e.substr(0,t)+e.substr(t+r,e.length-t-r)),o},goog.string.remove=function(e,t){var r=new RegExp(goog.string.regExpEscape(t),"");return e.replace(r,"")},goog.string.removeAll=function(e,t){var r=new RegExp(goog.string.regExpEscape(t),"g");return e.replace(r,"")},goog.string.regExpEscape=function(e){return String(e).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},goog.string.repeat=String.prototype.repeat?function(e,t){return e.repeat(t)}:function(e,t){return Array(t+1).join(e)},goog.string.padNumber=function(e,t,r){var o=goog.isDef(r)?e.toFixed(r):String(e),n=o.indexOf(".");return-1==n&&(n=o.length),goog.string.repeat("0",Math.max(0,t-n))+o},goog.string.makeSafe=function(e){return null==e?"":String(e)},goog.string.buildString=function(e){return Array.prototype.join.call(arguments,"")},goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)},goog.string.compareVersions=function(e,t){for(var r=0,o=goog.string.trim(String(e)).split("."),n=goog.string.trim(String(t)).split("."),i=Math.max(o.length,n.length),s=0;0==r&&s<i;s++){var a=o[s]||"",l=n[s]||"",c=/(\d*)(\D*)/g,u=/(\d*)(\D*)/g;do{var h=c.exec(a)||["","",""],f=u.exec(l)||["","",""];if(0==h[0].length&&0==f[0].length)break;var p=0==h[1].length?0:parseInt(h[1],10),d=0==f[1].length?0:parseInt(f[1],10),r=goog.string.compareElements_(p,d)||goog.string.compareElements_(0==h[2].length,0==f[2].length)||goog.string.compareElements_(h[2],f[2])}while(0==r)}return r},goog.string.compareElements_=function(e,t){return e<t?-1:e>t?1:0},goog.string.hashCode=function(e){for(var t=0,r=0;r<e.length;++r)t=31*t+e.charCodeAt(r)>>>0;return t},goog.string.uniqueStringCounter_=2147483648*Math.random()|0,goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++},goog.string.toNumber=function(e){var t=Number(e);return 0==t&&goog.string.isEmptyOrWhitespace(e)?NaN:t},goog.string.isLowerCamelCase=function(e){return/^[a-z]+([A-Z][a-z]*)*$/.test(e)},goog.string.isUpperCamelCase=function(e){return/^([A-Z][a-z]*)+$/.test(e)},goog.string.toCamelCase=function(e){return String(e).replace(/\-([a-z])/g,function(e,t){return t.toUpperCase()})},goog.string.toSelectorCase=function(e){return String(e).replace(/([A-Z])/g,"-$1").toLowerCase()},goog.string.toTitleCase=function(e,t){var r=goog.isString(t)?goog.string.regExpEscape(t):"\\s",r=r?"|["+r+"]+":"",o=new RegExp("(^"+r+")([a-z])","g");return e.replace(o,function(e,t,r){return t+r.toUpperCase()})},goog.string.capitalize=function(e){return String(e.charAt(0)).toUpperCase()+String(e.substr(1)).toLowerCase()},goog.string.parseInt=function(e){return isFinite(e)&&(e=String(e)),goog.isString(e)?/^\s*-?0x/i.test(e)?parseInt(e,16):parseInt(e,10):NaN},goog.string.splitLimit=function(e,t,r){for(var o=e.split(t),n=[];0<r&&o.length;)n.push(o.shift()),r--;return o.length&&n.push(o.join(t)),n},goog.string.lastComponent=function(e,t){if(!t)return e;"string"==typeof t&&(t=[t]);for(var r=-1,o=0;o<t.length;o++)if(""!=t[o]){var n=e.lastIndexOf(t[o]);n>r&&(r=n)}return-1==r?e:e.slice(r+1)},goog.string.editDistance=function(e,t){var r=[],o=[];if(e==t)return 0;if(!e.length||!t.length)return Math.max(e.length,t.length);for(var n=0;n<t.length+1;n++)r[n]=n;for(n=0;n<e.length;n++){o[0]=n+1;for(var i=0;i<t.length;i++){var s=Number(e[n]!=t[i]);o[i+1]=Math.min(o[i]+1,r[i+1]+1,r[i]+s)}for(i=0;i<r.length;i++)r[i]=o[i]}return o[t.length]},goog.asserts={},goog.asserts.ENABLE_ASSERTS=goog.DEBUG,goog.asserts.AssertionError=function(e,t){t.unshift(e),goog.debug.Error.call(this,goog.string.subs.apply(null,t)),t.shift()},goog.inherits(goog.asserts.AssertionError,goog.debug.Error),goog.asserts.AssertionError.prototype.name="AssertionError",goog.asserts.DEFAULT_ERROR_HANDLER=function(e){throw e},goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER,goog.asserts.doAssertFailure_=function(e,t,r,o){var n="Assertion failed";if(r)var n=n+(": "+r),i=o;else e&&(n+=": "+e,i=t);var s=new goog.asserts.AssertionError(""+n,i||[]);goog.asserts.errorHandler_(s)},goog.asserts.setErrorHandler=function(e){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=e)},goog.asserts.assert=function(e,t,r){return goog.asserts.ENABLE_ASSERTS&&!e&&goog.asserts.doAssertFailure_("",null,t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.fail=function(e,t){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1)))},goog.asserts.assertNumber=function(e,t,r){return goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(e)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertString=function(e,t,r){return goog.asserts.ENABLE_ASSERTS&&!goog.isString(e)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertFunction=function(e,t,r){return goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(e)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertObject=function(e,t,r){return goog.asserts.ENABLE_ASSERTS&&!goog.isObject(e)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertArray=function(e,t,r){return goog.asserts.ENABLE_ASSERTS&&!goog.isArray(e)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertBoolean=function(e,t,r){return goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(e)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertElement=function(e,t,r){return!goog.asserts.ENABLE_ASSERTS||goog.isObject(e)&&e.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(e),e],t,Array.prototype.slice.call(arguments,2)),e},goog.asserts.assertInstanceof=function(e,t,r,o){return!goog.asserts.ENABLE_ASSERTS||e instanceof t||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(t),goog.asserts.getType_(e)],r,Array.prototype.slice.call(arguments,3)),e},goog.asserts.assertObjectPrototypeIsIntact=function(){for(var e in Object.prototype)goog.asserts.fail(e+" should not be enumerable in Object.prototype.")},goog.asserts.getType_=function(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):null===e?"null":typeof e},goog.async={},goog.async.FreeList=function(e,t,r){this.limit_=r,this.create_=e,this.reset_=t,this.occupants_=0,this.head_=null},goog.async.FreeList.prototype.get=function(){var e;return 0<this.occupants_?(this.occupants_--,e=this.head_,this.head_=e.next,e.next=null):e=this.create_(),e},goog.async.FreeList.prototype.put=function(e){this.reset_(e),this.occupants_<this.limit_&&(this.occupants_++,e.next=this.head_,this.head_=e)},goog.debug.entryPointRegistry={},goog.debug.EntryPointMonitor=function(){},goog.debug.entryPointRegistry.refList_=[],goog.debug.entryPointRegistry.monitors_=[],goog.debug.entryPointRegistry.monitorsMayExist_=!1,goog.debug.entryPointRegistry.register=function(e){if(goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=e,goog.debug.entryPointRegistry.monitorsMayExist_)for(var t=goog.debug.entryPointRegistry.monitors_,r=0;r<t.length;r++)e(goog.bind(t[r].wrap,t[r]))},goog.debug.entryPointRegistry.monitorAll=function(e){goog.debug.entryPointRegistry.monitorsMayExist_=!0;for(var t=goog.bind(e.wrap,e),r=0;r<goog.debug.entryPointRegistry.refList_.length;r++)goog.debug.entryPointRegistry.refList_[r](t);goog.debug.entryPointRegistry.monitors_.push(e)},goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(e){var t=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(e==t[t.length-1],"Only the most recent monitor can be unwrapped.");for(var r=goog.bind(e.unwrap,e),o=0;o<goog.debug.entryPointRegistry.refList_.length;o++)goog.debug.entryPointRegistry.refList_[o](r);t.length--},goog.dom.TagName={A:"A",ABBR:"ABBR",ACRONYM:"ACRONYM",ADDRESS:"ADDRESS",APPLET:"APPLET",AREA:"AREA",ARTICLE:"ARTICLE",ASIDE:"ASIDE",AUDIO:"AUDIO",B:"B",BASE:"BASE",BASEFONT:"BASEFONT",BDI:"BDI",BDO:"BDO",BIG:"BIG",BLOCKQUOTE:"BLOCKQUOTE",BODY:"BODY",BR:"BR",BUTTON:"BUTTON",CANVAS:"CANVAS",CAPTION:"CAPTION",CENTER:"CENTER",CITE:"CITE",CODE:"CODE",COL:"COL",COLGROUP:"COLGROUP",COMMAND:"COMMAND",DATA:"DATA",DATALIST:"DATALIST",DD:"DD",DEL:"DEL",DETAILS:"DETAILS",DFN:"DFN",DIALOG:"DIALOG",DIR:"DIR",DIV:"DIV",DL:"DL",DT:"DT",EM:"EM",EMBED:"EMBED",FIELDSET:"FIELDSET",FIGCAPTION:"FIGCAPTION",FIGURE:"FIGURE",FONT:"FONT",FOOTER:"FOOTER",FORM:"FORM",FRAME:"FRAME",FRAMESET:"FRAMESET",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",HEAD:"HEAD",HEADER:"HEADER",HGROUP:"HGROUP",HR:"HR",HTML:"HTML",I:"I",IFRAME:"IFRAME",IMG:"IMG",INPUT:"INPUT",INS:"INS",ISINDEX:"ISINDEX",KBD:"KBD",KEYGEN:"KEYGEN",LABEL:"LABEL",LEGEND:"LEGEND",LI:"LI",LINK:"LINK",MAP:"MAP",MARK:"MARK",MATH:"MATH",MENU:"MENU",META:"META",METER:"METER",NAV:"NAV",NOFRAMES:"NOFRAMES",NOSCRIPT:"NOSCRIPT",OBJECT:"OBJECT",OL:"OL",OPTGROUP:"OPTGROUP",OPTION:"OPTION",OUTPUT:"OUTPUT",P:"P",PARAM:"PARAM",PRE:"PRE",PROGRESS:"PROGRESS",Q:"Q",RP:"RP",RT:"RT",RUBY:"RUBY",S:"S",SAMP:"SAMP",SCRIPT:"SCRIPT",SECTION:"SECTION",SELECT:"SELECT",SMALL:"SMALL",SOURCE:"SOURCE",SPAN:"SPAN",STRIKE:"STRIKE",STRONG:"STRONG",STYLE:"STYLE",SUB:"SUB",SUMMARY:"SUMMARY",SUP:"SUP",SVG:"SVG",TABLE:"TABLE",TBODY:"TBODY",TD:"TD",TEMPLATE:"TEMPLATE",TEXTAREA:"TEXTAREA",TFOOT:"TFOOT",TH:"TH",THEAD:"THEAD",TIME:"TIME",TITLE:"TITLE",TR:"TR",TRACK:"TRACK",TT:"TT",U:"U",UL:"UL",VAR:"VAR",VIDEO:"VIDEO",WBR:"WBR"},goog.functions={},goog.functions.constant=function(e){return function(){return e}},goog.functions.FALSE=goog.functions.constant(!1),goog.functions.TRUE=goog.functions.constant(!0),goog.functions.NULL=goog.functions.constant(null),goog.functions.identity=function(e){return e},goog.functions.error=function(e){return function(){throw Error(e)}},goog.functions.fail=function(e){return function(){throw e}},goog.functions.lock=function(e,t){return t=t||0,function(){return e.apply(this,Array.prototype.slice.call(arguments,0,t))}},goog.functions.nth=function(e){return function(){return arguments[e]}},goog.functions.partialRight=function(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=Array.prototype.slice.call(arguments);return t.push.apply(t,r),e.apply(this,t)}},goog.functions.withReturnValue=function(e,t){return goog.functions.sequence(e,goog.functions.constant(t))},goog.functions.equalTo=function(e,t){return function(r){return t?e==r:e===r}},goog.functions.compose=function(e,t){var r=arguments,o=r.length;return function(){var e;o&&(e=r[o-1].apply(this,arguments));for(var t=o-2;0<=t;t--)e=r[t].call(this,e);return e}},goog.functions.sequence=function(e){var t=arguments,r=t.length;return function(){for(var e,o=0;o<r;o++)e=t[o].apply(this,arguments);return e}},goog.functions.and=function(e){var t=arguments,r=t.length;return function(){for(var e=0;e<r;e++)if(!t[e].apply(this,arguments))return!1;return!0}},goog.functions.or=function(e){var t=arguments,r=t.length;return function(){for(var e=0;e<r;e++)if(t[e].apply(this,arguments))return!0;return!1}},goog.functions.not=function(e){return function(){return!e.apply(this,arguments)}},goog.functions.create=function(e,t){var r=function(){};r.prototype=e.prototype;var o=new r;return e.apply(o,Array.prototype.slice.call(arguments,1)),o},goog.functions.CACHE_RETURN_VALUE=!0,goog.functions.cacheReturnValue=function(e){var t,r=!1;return function(){return goog.functions.CACHE_RETURN_VALUE?(r||(t=e(),r=!0),t):e()}},goog.functions.once=function(e){var t=e;return function(){if(t){var e=t;t=null,e()}}},goog.functions.debounce=function(e,t,r){r&&(e=goog.bind(e,r));var o=null;return function(r){goog.global.clearTimeout(o);var n=arguments;o=goog.global.setTimeout(function(){e.apply(null,n)},t)}},goog.functions.throttle=function(e,t,r){r&&(e=goog.bind(e,r));var o=null,n=!1,i=[],s=function(){o=null,n&&(n=!1,a())},a=function(){o=goog.global.setTimeout(s,t),e.apply(null,i)};return function(e){i=arguments,o?n=!0:a()}},goog.array={},goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE,goog.array.ASSUME_NATIVE_FUNCTIONS=!1,goog.array.peek=function(e){return e[e.length-1]},goog.array.last=goog.array.peek,goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.indexOf)?function(e,t,r){return goog.asserts.assert(null!=e.length),Array.prototype.indexOf.call(e,t,r)}:function(e,t,r){var o=null==r?0:0>r?Math.max(0,e.length+r):r;if(goog.isString(e))return goog.isString(t)&&1==t.length?e.indexOf(t,o):-1;for(var n=o;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.lastIndexOf)?function(e,t,r){goog.asserts.assert(null!=e.length);var o=null==r?e.length-1:r;return Array.prototype.lastIndexOf.call(e,t,o)}:function(e,t,r){var o=null==r?e.length-1:r;if(0>o&&(o=Math.max(0,e.length+o)),goog.isString(e))return goog.isString(t)&&1==t.length?e.lastIndexOf(t,o):-1;for(var n=o;0<=n;n--)if(n in e&&e[n]===t)return n;return-1},goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.forEach)?function(e,t,r){goog.asserts.assert(null!=e.length),Array.prototype.forEach.call(e,t,r)}:function(e,t,r){for(var o=e.length,n=goog.isString(e)?e.split(""):e,i=0;i<o;i++)i in n&&t.call(r,n[i],i,e)},goog.array.forEachRight=function(e,t,r){for(var o=e.length,n=goog.isString(e)?e.split(""):e,i=o-1;0<=i;--i)i in n&&t.call(r,n[i],i,e)},goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.filter)?function(e,t,r){return goog.asserts.assert(null!=e.length),Array.prototype.filter.call(e,t,r)}:function(e,t,r){for(var o=e.length,n=[],i=0,s=goog.isString(e)?e.split(""):e,a=0;a<o;a++)if(a in s){var l=s[a];t.call(r,l,a,e)&&(n[i++]=l)}return n},goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.map)?function(e,t,r){return goog.asserts.assert(null!=e.length),Array.prototype.map.call(e,t,r)}:function(e,t,r){for(var o=e.length,n=Array(o),i=goog.isString(e)?e.split(""):e,s=0;s<o;s++)s in i&&(n[s]=t.call(r,i[s],s,e));return n},goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduce)?function(e,t,r,o){return goog.asserts.assert(null!=e.length),o&&(t=goog.bind(t,o)),Array.prototype.reduce.call(e,t,r)}:function(e,t,r,o){var n=r;return goog.array.forEach(e,function(r,i){n=t.call(o,n,r,i,e)}),n},goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduceRight)?function(e,t,r,o){return goog.asserts.assert(null!=e.length),goog.asserts.assert(null!=t),o&&(t=goog.bind(t,o)),Array.prototype.reduceRight.call(e,t,r)}:function(e,t,r,o){var n=r;return goog.array.forEachRight(e,function(r,i){n=t.call(o,n,r,i,e)}),n},goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.some)?function(e,t,r){return goog.asserts.assert(null!=e.length),Array.prototype.some.call(e,t,r)}:function(e,t,r){for(var o=e.length,n=goog.isString(e)?e.split(""):e,i=0;i<o;i++)if(i in n&&t.call(r,n[i],i,e))return!0;return!1},goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.every)?function(e,t,r){return goog.asserts.assert(null!=e.length),Array.prototype.every.call(e,t,r)}:function(e,t,r){for(var o=e.length,n=goog.isString(e)?e.split(""):e,i=0;i<o;i++)if(i in n&&!t.call(r,n[i],i,e))return!1;return!0},goog.array.count=function(e,t,r){var o=0;return goog.array.forEach(e,function(e,n,i){t.call(r,e,n,i)&&++o},r),o},goog.array.find=function(e,t,r){var o=goog.array.findIndex(e,t,r);return 0>o?null:goog.isString(e)?e.charAt(o):e[o]},goog.array.findIndex=function(e,t,r){for(var o=e.length,n=goog.isString(e)?e.split(""):e,i=0;i<o;i++)if(i in n&&t.call(r,n[i],i,e))return i;return-1},goog.array.findRight=function(e,t,r){var o=goog.array.findIndexRight(e,t,r);return 0>o?null:goog.isString(e)?e.charAt(o):e[o]},goog.array.findIndexRight=function(e,t,r){for(var o=e.length,n=goog.isString(e)?e.split(""):e,i=o-1;0<=i;i--)if(i in n&&t.call(r,n[i],i,e))return i;return-1},goog.array.contains=function(e,t){return 0<=goog.array.indexOf(e,t)},goog.array.isEmpty=function(e){return 0==e.length},goog.array.clear=function(e){if(!goog.isArray(e))for(var t=e.length-1;0<=t;t--)delete e[t];e.length=0},goog.array.insert=function(e,t){goog.array.contains(e,t)||e.push(t)},goog.array.insertAt=function(e,t,r){goog.array.splice(e,r,0,t)},goog.array.insertArrayAt=function(e,t,r){goog.partial(goog.array.splice,e,r,0).apply(null,t)},goog.array.insertBefore=function(e,t,r){var o;2==arguments.length||0>(o=goog.array.indexOf(e,r))?e.push(t):goog.array.insertAt(e,t,o)},goog.array.remove=function(e,t){var r,o=goog.array.indexOf(e,t);return(r=0<=o)&&goog.array.removeAt(e,o),r},goog.array.removeLast=function(e,t){var r=goog.array.lastIndexOf(e,t);return 0<=r&&(goog.array.removeAt(e,r),!0)},goog.array.removeAt=function(e,t){return goog.asserts.assert(null!=e.length),1==Array.prototype.splice.call(e,t,1).length},goog.array.removeIf=function(e,t,r){var o=goog.array.findIndex(e,t,r);return 0<=o&&(goog.array.removeAt(e,o),!0)},goog.array.removeAllIf=function(e,t,r){var o=0;return goog.array.forEachRight(e,function(n,i){t.call(r,n,i,e)&&goog.array.removeAt(e,i)&&o++}),o},goog.array.concat=function(e){return Array.prototype.concat.apply(Array.prototype,arguments)},goog.array.join=function(e){return Array.prototype.concat.apply(Array.prototype,arguments)},goog.array.toArray=function(e){var t=e.length;if(0<t){for(var r=Array(t),o=0;o<t;o++)r[o]=e[o];return r}return[]},goog.array.clone=goog.array.toArray,goog.array.extend=function(e,t){for(var r=1;r<arguments.length;r++){var o=arguments[r];if(goog.isArrayLike(o)){var n=e.length||0,i=o.length||0;e.length=n+i;for(var s=0;s<i;s++)e[n+s]=o[s]}else e.push(o)}},goog.array.splice=function(e,t,r,o){return goog.asserts.assert(null!=e.length),Array.prototype.splice.apply(e,goog.array.slice(arguments,1))},goog.array.slice=function(e,t,r){return goog.asserts.assert(null!=e.length),2>=arguments.length?Array.prototype.slice.call(e,t):Array.prototype.slice.call(e,t,r)},goog.array.removeDuplicates=function(e,t,r){for(var o=t||e,n=function(e){return goog.isObject(e)?"o"+goog.getUid(e):(typeof e).charAt(0)+e},i=r||n,s={},a=0,l=0;l<e.length;){var c=e[l++],u=i(c);Object.prototype.hasOwnProperty.call(s,u)||(s[u]=!0,o[a++]=c)}o.length=a},goog.array.binarySearch=function(e,t,r){return goog.array.binarySearch_(e,r||goog.array.defaultCompare,!1,t)},goog.array.binarySelect=function(e,t,r){return goog.array.binarySearch_(e,t,!0,void 0,r)},goog.array.binarySearch_=function(e,t,r,o,n){for(var i,s=0,a=e.length;s<a;){var l,c=s+a>>1;l=r?t.call(n,e[c],c,e):t(o,e[c]),0<l?s=c+1:(a=c,i=!l)}return i?s:~s},goog.array.sort=function(e,t){e.sort(t||goog.array.defaultCompare)},goog.array.stableSort=function(e,t){function r(e,t){return i(e.value,t.value)||e.index-t.index}for(var o=Array(e.length),n=0;n<e.length;n++)o[n]={index:n,value:e[n]};var i=t||goog.array.defaultCompare;for(goog.array.sort(o,r),n=0;n<e.length;n++)e[n]=o[n].value},goog.array.sortByKey=function(e,t,r){var o=r||goog.array.defaultCompare;goog.array.sort(e,function(e,r){return o(t(e),t(r))})},goog.array.sortObjectsByKey=function(e,t,r){goog.array.sortByKey(e,function(e){return e[t]},r)},goog.array.isSorted=function(e,t,r){for(var o=t||goog.array.defaultCompare,n=1;n<e.length;n++){var i=o(e[n-1],e[n]);if(0<i||0==i&&r)return!1}return!0},goog.array.equals=function(e,t,r){if(!goog.isArrayLike(e)||!goog.isArrayLike(t)||e.length!=t.length)return!1;for(var o=e.length,n=r||goog.array.defaultCompareEquality,i=0;i<o;i++)if(!n(e[i],t[i]))return!1;return!0},goog.array.compare3=function(e,t,r){for(var o=r||goog.array.defaultCompare,n=Math.min(e.length,t.length),i=0;i<n;i++){var s=o(e[i],t[i]);if(0!=s)return s}return goog.array.defaultCompare(e.length,t.length)},goog.array.defaultCompare=function(e,t){return e>t?1:e<t?-1:0},goog.array.inverseDefaultCompare=function(e,t){return-goog.array.defaultCompare(e,t)},goog.array.defaultCompareEquality=function(e,t){return e===t},goog.array.binaryInsert=function(e,t,r){var o=goog.array.binarySearch(e,t,r);return 0>o&&(goog.array.insertAt(e,t,-(o+1)),!0)},goog.array.binaryRemove=function(e,t,r){var o=goog.array.binarySearch(e,t,r);return 0<=o&&goog.array.removeAt(e,o)},goog.array.bucket=function(e,t,r){for(var o={},n=0;n<e.length;n++){var i=e[n],s=t.call(r,i,n,e);if(goog.isDef(s)){var a=o[s]||(o[s]=[]);a.push(i)}}return o},goog.array.toObject=function(e,t,r){var o={};return goog.array.forEach(e,function(n,i){o[t.call(r,n,i,e)]=n}),o},goog.array.range=function(e,t,r){var o=[],n=0,i=e,s=r||1;if(void 0!==t&&(n=e,i=t),0>s*(i-n))return[];if(0<s)for(var a=n;a<i;a+=s)o.push(a);else for(a=n;a>i;a+=s)o.push(a);return o},goog.array.repeat=function(e,t){for(var r=[],o=0;o<t;o++)r[o]=e;return r},goog.array.flatten=function(e){for(var t=[],r=0;r<arguments.length;r++){var o=arguments[r];if(goog.isArray(o))for(var n=0;n<o.length;n+=8192)for(var i=goog.array.slice(o,n,n+8192),s=goog.array.flatten.apply(null,i),a=0;a<s.length;a++)t.push(s[a]);else t.push(o)}return t},goog.array.rotate=function(e,t){return goog.asserts.assert(null!=e.length),e.length&&(t%=e.length,0<t?Array.prototype.unshift.apply(e,e.splice(-t,t)):0>t&&Array.prototype.push.apply(e,e.splice(0,-t))),e},goog.array.moveItem=function(e,t,r){goog.asserts.assert(0<=t&&t<e.length),goog.asserts.assert(0<=r&&r<e.length);var o=Array.prototype.splice.call(e,t,1);Array.prototype.splice.call(e,r,0,o[0])},goog.array.zip=function(e){if(!arguments.length)return[];for(var t=[],r=arguments[0].length,o=1;o<arguments.length;o++)arguments[o].length<r&&(r=arguments[o].length);for(o=0;o<r;o++){for(var n=[],i=0;i<arguments.length;i++)n.push(arguments[i][o]);t.push(n)}return t},goog.array.shuffle=function(e,t){for(var r=t||Math.random,o=e.length-1;0<o;o--){var n=Math.floor(r()*(o+1)),i=e[o];e[o]=e[n],e[n]=i}},goog.array.copyByIndex=function(e,t){var r=[];return goog.array.forEach(t,function(t){r.push(e[t])}),r},goog.array.concatMap=function(e,t,r){return goog.array.concat.apply([],goog.array.map(e,t,r))},goog.object={},goog.object.is=function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t},goog.object.forEach=function(e,t,r){for(var o in e)t.call(r,e[o],o,e)},goog.object.filter=function(e,t,r){var o,n={};for(o in e)t.call(r,e[o],o,e)&&(n[o]=e[o]);return n},goog.object.map=function(e,t,r){var o,n={};for(o in e)n[o]=t.call(r,e[o],o,e);return n},goog.object.some=function(e,t,r){for(var o in e)if(t.call(r,e[o],o,e))return!0;return!1},goog.object.every=function(e,t,r){for(var o in e)if(!t.call(r,e[o],o,e))return!1;return!0},goog.object.getCount=function(e){var t,r=0;for(t in e)r++;return r},goog.object.getAnyKey=function(e){for(var t in e)return t},goog.object.getAnyValue=function(e){for(var t in e)return e[t]},goog.object.contains=function(e,t){return goog.object.containsValue(e,t)},goog.object.getValues=function(e){var t,r=[],o=0;for(t in e)r[o++]=e[t];return r},goog.object.getKeys=function(e){var t,r=[],o=0;for(t in e)r[o++]=t;return r},goog.object.getValueByKeys=function(e,t){for(var r=goog.isArrayLike(t),o=r?t:arguments,n=r?0:1;n<o.length&&(e=e[o[n]],goog.isDef(e));n++);return e},goog.object.containsKey=function(e,t){return null!==e&&t in e},goog.object.containsValue=function(e,t){for(var r in e)if(e[r]==t)return!0;return!1},goog.object.findKey=function(e,t,r){for(var o in e)if(t.call(r,e[o],o,e))return o},goog.object.findValue=function(e,t,r){var o=goog.object.findKey(e,t,r);return o&&e[o]},goog.object.isEmpty=function(e){for(var t in e)return!1;return!0},goog.object.clear=function(e){for(var t in e)delete e[t]},goog.object.remove=function(e,t){var r;return(r=t in e)&&delete e[t],r},goog.object.add=function(e,t,r){if(null!==e&&t in e)throw Error('The object already contains the key "'+t+'"');goog.object.set(e,t,r)},goog.object.get=function(e,t,r){return null!==e&&t in e?e[t]:r},goog.object.set=function(e,t,r){e[t]=r},goog.object.setIfUndefined=function(e,t,r){return t in e?e[t]:e[t]=r},goog.object.setWithReturnValueIfNotSet=function(e,t,r){if(t in e)return e[t];var o=r();return e[t]=o},goog.object.equals=function(e,t){for(var r in e)if(!(r in t)||e[r]!==t[r])return!1;for(r in t)if(!(r in e))return!1;return!0},goog.object.clone=function(e){var t,r={};for(t in e)r[t]=e[t];return r},goog.object.unsafeClone=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(goog.isFunction(e.clone))return e.clone();var r,o="array"==t?[]:{};for(r in e)o[r]=goog.object.unsafeClone(e[r]);return o}return e},goog.object.transpose=function(e){var t,r={};for(t in e)r[e[t]]=t;return r},goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.object.extend=function(e,t){for(var r,o,n=1;n<arguments.length;n++){o=arguments[n];for(r in o)e[r]=o[r];for(var i=0;i<goog.object.PROTOTYPE_FIELDS_.length;i++)r=goog.object.PROTOTYPE_FIELDS_[i],Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}},goog.object.create=function(e){var t=arguments.length;if(1==t&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(t%2)throw Error("Uneven number of arguments");for(var r={},o=0;o<t;o+=2)r[arguments[o]]=arguments[o+1];return r},goog.object.createSet=function(e){var t=arguments.length;if(1==t&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var r={},o=0;o<t;o++)r[arguments[o]]=!0;return r},goog.object.createImmutableView=function(e){var t=e;return Object.isFrozen&&!Object.isFrozen(e)&&(t=Object.create(e),Object.freeze(t)),t},goog.object.isImmutableView=function(e){return!!Object.isFrozen&&Object.isFrozen(e)},goog.labs={},goog.labs.userAgent={},goog.labs.userAgent.util={},goog.labs.userAgent.util.getNativeUserAgentString_=function(){var e=goog.labs.userAgent.util.getNavigator_();if(e){var t=e.userAgent;if(t)return t}return""},goog.labs.userAgent.util.getNavigator_=function(){return goog.global.navigator},goog.labs.userAgent.util.userAgent_=goog.labs.userAgent.util.getNativeUserAgentString_(),goog.labs.userAgent.util.setUserAgent=function(e){goog.labs.userAgent.util.userAgent_=e||goog.labs.userAgent.util.getNativeUserAgentString_()},goog.labs.userAgent.util.getUserAgent=function(){return goog.labs.userAgent.util.userAgent_},goog.labs.userAgent.util.matchUserAgent=function(e){var t=goog.labs.userAgent.util.getUserAgent();return goog.string.contains(t,e)},goog.labs.userAgent.util.matchUserAgentIgnoreCase=function(e){var t=goog.labs.userAgent.util.getUserAgent();return goog.string.caseInsensitiveContains(t,e)},goog.labs.userAgent.util.extractVersionTuples=function(e){for(var t,r=/(\w[\w ]+)\/([^\s]+)\s*(?:\((.*?)\))?/g,o=[];t=r.exec(e);)o.push([t[1],t[2],t[3]||void 0]);return o},goog.labs.userAgent.browser={},goog.labs.userAgent.browser.matchOpera_=function(){return goog.labs.userAgent.util.matchUserAgent("Opera")},goog.labs.userAgent.browser.matchIE_=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")},goog.labs.userAgent.browser.matchEdge_=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")},goog.labs.userAgent.browser.matchFirefox_=function(){return goog.labs.userAgent.util.matchUserAgent("Firefox")},goog.labs.userAgent.browser.matchSafari_=function(){return goog.labs.userAgent.util.matchUserAgent("Safari")&&!(goog.labs.userAgent.browser.matchChrome_()||goog.labs.userAgent.browser.matchCoast_()||goog.labs.userAgent.browser.matchOpera_()||goog.labs.userAgent.browser.matchEdge_()||goog.labs.userAgent.browser.isSilk()||goog.labs.userAgent.util.matchUserAgent("Android"))},goog.labs.userAgent.browser.matchCoast_=function(){return goog.labs.userAgent.util.matchUserAgent("Coast")},goog.labs.userAgent.browser.matchIosWebview_=function(){return(goog.labs.userAgent.util.matchUserAgent("iPad")||goog.labs.userAgent.util.matchUserAgent("iPhone"))&&!goog.labs.userAgent.browser.matchSafari_()&&!goog.labs.userAgent.browser.matchChrome_()&&!goog.labs.userAgent.browser.matchCoast_()&&goog.labs.userAgent.util.matchUserAgent("AppleWebKit")},goog.labs.userAgent.browser.matchChrome_=function(){return(goog.labs.userAgent.util.matchUserAgent("Chrome")||goog.labs.userAgent.util.matchUserAgent("CriOS"))&&!goog.labs.userAgent.browser.matchEdge_()},goog.labs.userAgent.browser.matchAndroidBrowser_=function(){return goog.labs.userAgent.util.matchUserAgent("Android")&&!(goog.labs.userAgent.browser.isChrome()||goog.labs.userAgent.browser.isFirefox()||goog.labs.userAgent.browser.isOpera()||goog.labs.userAgent.browser.isSilk())},goog.labs.userAgent.browser.isOpera=goog.labs.userAgent.browser.matchOpera_,goog.labs.userAgent.browser.isIE=goog.labs.userAgent.browser.matchIE_,goog.labs.userAgent.browser.isEdge=goog.labs.userAgent.browser.matchEdge_,goog.labs.userAgent.browser.isFirefox=goog.labs.userAgent.browser.matchFirefox_,goog.labs.userAgent.browser.isSafari=goog.labs.userAgent.browser.matchSafari_,goog.labs.userAgent.browser.isCoast=goog.labs.userAgent.browser.matchCoast_,goog.labs.userAgent.browser.isIosWebview=goog.labs.userAgent.browser.matchIosWebview_,goog.labs.userAgent.browser.isChrome=goog.labs.userAgent.browser.matchChrome_,goog.labs.userAgent.browser.isAndroidBrowser=goog.labs.userAgent.browser.matchAndroidBrowser_,goog.labs.userAgent.browser.isSilk=function(){return goog.labs.userAgent.util.matchUserAgent("Silk")},goog.labs.userAgent.browser.getVersion=function(){function e(e){var t=goog.array.find(e,n);return o[t]||""}var t=goog.labs.userAgent.util.getUserAgent();if(goog.labs.userAgent.browser.isIE())return goog.labs.userAgent.browser.getIEVersion_(t);var r=goog.labs.userAgent.util.extractVersionTuples(t),o={};goog.array.forEach(r,function(e){var t=e[0],r=e[1];o[t]=r});var n=goog.partial(goog.object.containsKey,o);if(goog.labs.userAgent.browser.isOpera())return e(["Version","Opera"]);if(goog.labs.userAgent.browser.isEdge())return e(["Edge"]);if(goog.labs.userAgent.browser.isChrome())return e(["Chrome","CriOS"]);var i=r[2];return i&&i[1]||""},goog.labs.userAgent.browser.isVersionOrHigher=function(e){return 0<=goog.string.compareVersions(goog.labs.userAgent.browser.getVersion(),e)},goog.labs.userAgent.browser.getIEVersion_=function(e){var t=/rv: *([\d\.]*)/.exec(e);if(t&&t[1])return t[1];var r="",o=/MSIE +([\d\.]+)/.exec(e);
if(o&&o[1]){var n=/Trident\/(\d.\d)/.exec(e);if("7.0"==o[1])if(n&&n[1])switch(n[1]){case"4.0":r="8.0";break;case"5.0":r="9.0";break;case"6.0":r="10.0";break;case"7.0":r="11.0"}else r="7.0";else r=o[1]}return r},goog.labs.userAgent.engine={},goog.labs.userAgent.engine.isPresto=function(){return goog.labs.userAgent.util.matchUserAgent("Presto")},goog.labs.userAgent.engine.isTrident=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")},goog.labs.userAgent.engine.isEdge=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")},goog.labs.userAgent.engine.isWebKit=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("WebKit")&&!goog.labs.userAgent.engine.isEdge()},goog.labs.userAgent.engine.isGecko=function(){return goog.labs.userAgent.util.matchUserAgent("Gecko")&&!goog.labs.userAgent.engine.isWebKit()&&!goog.labs.userAgent.engine.isTrident()&&!goog.labs.userAgent.engine.isEdge()},goog.labs.userAgent.engine.getVersion=function(){var e=goog.labs.userAgent.util.getUserAgent();if(e){var t=goog.labs.userAgent.util.extractVersionTuples(e),r=goog.labs.userAgent.engine.getEngineTuple_(t);if(r)return"Gecko"==r[0]?goog.labs.userAgent.engine.getVersionForKey_(t,"Firefox"):r[1];var o,n=t[0];if(n&&(o=n[2])){var i=/Trident\/([^\s;]+)/.exec(o);if(i)return i[1]}}return""},goog.labs.userAgent.engine.getEngineTuple_=function(e){if(!goog.labs.userAgent.engine.isEdge())return e[1];for(var t=0;t<e.length;t++){var r=e[t];if("Edge"==r[0])return r}},goog.labs.userAgent.engine.isVersionOrHigher=function(e){return 0<=goog.string.compareVersions(goog.labs.userAgent.engine.getVersion(),e)},goog.labs.userAgent.engine.getVersionForKey_=function(e,t){var r=goog.array.find(e,function(e){return t==e[0]});return r&&r[1]||""},goog.async.throwException=function(e){goog.global.setTimeout(function(){throw e},0)},goog.async.nextTick=function(e,t,r){var o=e;t&&(o=goog.bind(e,t)),o=goog.async.nextTick.wrapCallback_(o),goog.isFunction(goog.global.setImmediate)&&(r||goog.async.nextTick.useSetImmediate_())?goog.global.setImmediate(o):(goog.async.nextTick.setImmediate_||(goog.async.nextTick.setImmediate_=goog.async.nextTick.getSetImmediateEmulator_()),goog.async.nextTick.setImmediate_(o))},goog.async.nextTick.useSetImmediate_=function(){return!(goog.global.Window&&goog.global.Window.prototype&&!goog.labs.userAgent.browser.isEdge()&&goog.global.Window.prototype.setImmediate==goog.global.setImmediate)},goog.async.nextTick.getSetImmediateEmulator_=function(){var e=goog.global.MessageChannel;if("undefined"==typeof e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!goog.labs.userAgent.engine.isPresto()&&(e=function(){var e=document.createElement(goog.dom.TagName.IFRAME);e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow,r=t.document;r.open(),r.write(""),r.close();var o="callImmediate"+Math.random(),n="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host,i=goog.bind(function(e){"*"!=n&&e.origin!=n||e.data!=o||this.port1.onmessage()},this);t.addEventListener("message",i,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(o,n)}}}),"undefined"!=typeof e&&!goog.labs.userAgent.browser.isIE()){var t=new e,r={},o=r;return t.port1.onmessage=function(){if(goog.isDef(r.next)){r=r.next;var e=r.cb;r.cb=null,e()}},function(e){o.next={cb:e},o=o.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement(goog.dom.TagName.SCRIPT)?function(e){var t=document.createElement(goog.dom.TagName.SCRIPT);t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){goog.global.setTimeout(e,0)}},goog.async.nextTick.wrapCallback_=goog.functions.identity,goog.debug.entryPointRegistry.register(function(e){goog.async.nextTick.wrapCallback_=e}),goog.async.WorkQueue=function(){this.workTail_=this.workHead_=null},goog.async.WorkQueue.DEFAULT_MAX_UNUSED=100,goog.async.WorkQueue.freelist_=new goog.async.FreeList(function(){return new goog.async.WorkItem},function(e){e.reset()},goog.async.WorkQueue.DEFAULT_MAX_UNUSED),goog.async.WorkQueue.prototype.add=function(e,t){var r=this.getUnusedItem_();r.set(e,t),this.workTail_?this.workTail_.next=r:(goog.asserts.assert(!this.workHead_),this.workHead_=r),this.workTail_=r},goog.async.WorkQueue.prototype.remove=function(){var e=null;return this.workHead_&&(e=this.workHead_,this.workHead_=this.workHead_.next,this.workHead_||(this.workTail_=null),e.next=null),e},goog.async.WorkQueue.prototype.returnUnused=function(e){goog.async.WorkQueue.freelist_.put(e)},goog.async.WorkQueue.prototype.getUnusedItem_=function(){return goog.async.WorkQueue.freelist_.get()},goog.async.WorkItem=function(){this.next=this.scope=this.fn=null},goog.async.WorkItem.prototype.set=function(e,t){this.fn=e,this.scope=t,this.next=null},goog.async.WorkItem.prototype.reset=function(){this.next=this.scope=this.fn=null},goog.async.run=function(e,t){goog.async.run.schedule_||goog.async.run.initializeRunner_(),goog.async.run.workQueueScheduled_||(goog.async.run.schedule_(),goog.async.run.workQueueScheduled_=!0),goog.async.run.workQueue_.add(e,t)},goog.async.run.initializeRunner_=function(){if(goog.global.Promise&&goog.global.Promise.resolve){var e=goog.global.Promise.resolve(void 0);goog.async.run.schedule_=function(){e.then(goog.async.run.processWorkQueue)}}else goog.async.run.schedule_=function(){goog.async.nextTick(goog.async.run.processWorkQueue)}},goog.async.run.forceNextTick=function(e){goog.async.run.schedule_=function(){goog.async.nextTick(goog.async.run.processWorkQueue),e&&e(goog.async.run.processWorkQueue)}},goog.async.run.workQueueScheduled_=!1,goog.async.run.workQueue_=new goog.async.WorkQueue,goog.DEBUG&&(goog.async.run.resetQueue=function(){goog.async.run.workQueueScheduled_=!1,goog.async.run.workQueue_=new goog.async.WorkQueue}),goog.async.run.processWorkQueue=function(){for(var e;e=goog.async.run.workQueue_.remove();){try{e.fn.call(e.scope)}catch(t){goog.async.throwException(t)}goog.async.run.workQueue_.returnUnused(e)}goog.async.run.workQueueScheduled_=!1},goog.promise={},goog.promise.Resolver=function(){},goog.Thenable=function(){},goog.Thenable.prototype.then=function(){},goog.Thenable.IMPLEMENTED_BY_PROP="$goog_Thenable",goog.Thenable.addImplementation=function(e){goog.exportProperty(e.prototype,"then",e.prototype.then),e.prototype[goog.Thenable.IMPLEMENTED_BY_PROP]=!0},goog.Thenable.isImplementedBy=function(e){if(!e)return!1;try{return!!e[goog.Thenable.IMPLEMENTED_BY_PROP]}catch(t){return!1}},goog.Promise=function(e,t){if(this.state_=goog.Promise.State_.PENDING,this.result_=void 0,this.callbackEntriesTail_=this.callbackEntries_=this.parent_=null,this.executing_=!1,0<goog.Promise.UNHANDLED_REJECTION_DELAY?this.unhandledRejectionId_=0:0==goog.Promise.UNHANDLED_REJECTION_DELAY&&(this.hadUnhandledRejection_=!1),goog.Promise.LONG_STACK_TRACES&&(this.stack_=[],this.addStackTrace_(Error("created")),this.currentStep_=0),e!=goog.nullFunction)try{var r=this;e.call(t,function(e){r.resolve_(goog.Promise.State_.FULFILLED,e)},function(e){if(goog.DEBUG&&!(e instanceof goog.Promise.CancellationError))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(t){}r.resolve_(goog.Promise.State_.REJECTED,e)})}catch(o){this.resolve_(goog.Promise.State_.REJECTED,o)}},goog.Promise.LONG_STACK_TRACES=!1,goog.Promise.UNHANDLED_REJECTION_DELAY=0,goog.Promise.State_={PENDING:0,BLOCKED:1,FULFILLED:2,REJECTED:3},goog.Promise.CallbackEntry_=function(){this.next=this.context=this.onRejected=this.onFulfilled=this.child=null,this.always=!1},goog.Promise.CallbackEntry_.prototype.reset=function(){this.context=this.onRejected=this.onFulfilled=this.child=null,this.always=!1},goog.Promise.DEFAULT_MAX_UNUSED=100,goog.Promise.freelist_=new goog.async.FreeList(function(){return new goog.Promise.CallbackEntry_},function(e){e.reset()},goog.Promise.DEFAULT_MAX_UNUSED),goog.Promise.getCallbackEntry_=function(e,t,r){var o=goog.Promise.freelist_.get();return o.onFulfilled=e,o.onRejected=t,o.context=r,o},goog.Promise.returnEntry_=function(e){goog.Promise.freelist_.put(e)},goog.Promise.resolve=function(e){if(e instanceof goog.Promise)return e;var t=new goog.Promise(goog.nullFunction);return t.resolve_(goog.Promise.State_.FULFILLED,e),t},goog.Promise.reject=function(e){return new goog.Promise(function(t,r){r(e)})},goog.Promise.resolveThen_=function(e,t,r){var o=goog.Promise.maybeThen_(e,t,r,null);o||goog.async.run(goog.partial(t,e))},goog.Promise.race=function(e){return new goog.Promise(function(t,r){e.length||t(void 0);for(var o,n=0;n<e.length;n++)o=e[n],goog.Promise.resolveThen_(o,t,r)})},goog.Promise.all=function(e){return new goog.Promise(function(t,r){var o=e.length,n=[];if(o)for(var i,s=function(e,r){o--,n[e]=r,0==o&&t(n)},a=function(e){r(e)},l=0;l<e.length;l++)i=e[l],goog.Promise.resolveThen_(i,goog.partial(s,l),a);else t(n)})},goog.Promise.allSettled=function(e){return new goog.Promise(function(t){var r=e.length,o=[];if(r)for(var n,i=function(e,n,i){r--,o[e]=n?{fulfilled:!0,value:i}:{fulfilled:!1,reason:i},0==r&&t(o)},s=0;s<e.length;s++)n=e[s],goog.Promise.resolveThen_(n,goog.partial(i,s,!0),goog.partial(i,s,!1));else t(o)})},goog.Promise.firstFulfilled=function(e){return new goog.Promise(function(t,r){var o=e.length,n=[];if(o)for(var i,s=function(e){t(e)},a=function(e,t){o--,n[e]=t,0==o&&r(n)},l=0;l<e.length;l++)i=e[l],goog.Promise.resolveThen_(i,s,goog.partial(a,l));else t(void 0)})},goog.Promise.withResolver=function(){var e,t,r=new goog.Promise(function(r,o){e=r,t=o});return new goog.Promise.Resolver_(r,e,t)},goog.Promise.prototype.then=function(e,t,r){return null!=e&&goog.asserts.assertFunction(e,"opt_onFulfilled should be a function."),null!=t&&goog.asserts.assertFunction(t,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("then")),this.addChildPromise_(goog.isFunction(e)?e:null,goog.isFunction(t)?t:null,r)},goog.Thenable.addImplementation(goog.Promise),goog.Promise.prototype.thenVoid=function(e,t,r){null!=e&&goog.asserts.assertFunction(e,"opt_onFulfilled should be a function."),null!=t&&goog.asserts.assertFunction(t,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("then")),this.addCallbackEntry_(goog.Promise.getCallbackEntry_(e||goog.nullFunction,t||null,r))},goog.Promise.prototype.thenCatch=function(e,t){return goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("thenCatch")),this.addChildPromise_(null,e,t)},goog.Promise.prototype.addCallbackEntry_=function(e){this.hasEntry_()||this.state_!=goog.Promise.State_.FULFILLED&&this.state_!=goog.Promise.State_.REJECTED||this.scheduleCallbacks_(),this.queueEntry_(e)},goog.Promise.prototype.addChildPromise_=function(e,t,r){var o=goog.Promise.getCallbackEntry_(null,null,null);return o.child=new goog.Promise(function(n,i){o.onFulfilled=e?function(t){try{var o=e.call(r,t);n(o)}catch(s){i(s)}}:n,o.onRejected=t?function(e){try{var o=t.call(r,e);!goog.isDef(o)&&e instanceof goog.Promise.CancellationError?i(e):n(o)}catch(s){i(s)}}:i}),o.child.parent_=this,this.addCallbackEntry_(o),o.child},goog.Promise.prototype.unblockAndFulfill_=function(e){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED),this.state_=goog.Promise.State_.PENDING,this.resolve_(goog.Promise.State_.FULFILLED,e)},goog.Promise.prototype.unblockAndReject_=function(e){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED),this.state_=goog.Promise.State_.PENDING,this.resolve_(goog.Promise.State_.REJECTED,e)},goog.Promise.prototype.resolve_=function(e,t){if(this.state_==goog.Promise.State_.PENDING){this===t&&(e=goog.Promise.State_.REJECTED,t=new TypeError("Promise cannot resolve to itself")),this.state_=goog.Promise.State_.BLOCKED;var r=goog.Promise.maybeThen_(t,this.unblockAndFulfill_,this.unblockAndReject_,this);r||(this.result_=t,this.state_=e,this.parent_=null,this.scheduleCallbacks_(),e!=goog.Promise.State_.REJECTED||t instanceof goog.Promise.CancellationError||goog.Promise.addUnhandledRejection_(this,t))}},goog.Promise.maybeThen_=function(e,t,r,o){if(e instanceof goog.Promise)return e.thenVoid(t,r,o),!0;if(goog.Thenable.isImplementedBy(e))return e.then(t,r,o),!0;if(goog.isObject(e))try{var n=e.then;if(goog.isFunction(n))return goog.Promise.tryThen_(e,n,t,r,o),!0}catch(i){return r.call(o,i),!0}return!1},goog.Promise.tryThen_=function(e,t,r,o,n){var i=!1,s=function(e){i||(i=!0,r.call(n,e))},a=function(e){i||(i=!0,o.call(n,e))};try{t.call(e,s,a)}catch(l){a(l)}},goog.Promise.prototype.scheduleCallbacks_=function(){this.executing_||(this.executing_=!0,goog.async.run(this.executeCallbacks_,this))},goog.Promise.prototype.hasEntry_=function(){return!!this.callbackEntries_},goog.Promise.prototype.queueEntry_=function(e){goog.asserts.assert(null!=e.onFulfilled),this.callbackEntriesTail_?this.callbackEntriesTail_.next=e:this.callbackEntries_=e,this.callbackEntriesTail_=e},goog.Promise.prototype.popEntry_=function(){var e=null;return this.callbackEntries_&&(e=this.callbackEntries_,this.callbackEntries_=e.next,e.next=null),this.callbackEntries_||(this.callbackEntriesTail_=null),null!=e&&goog.asserts.assert(null!=e.onFulfilled),e},goog.Promise.prototype.executeCallbacks_=function(){for(var e;e=this.popEntry_();)goog.Promise.LONG_STACK_TRACES&&this.currentStep_++,this.executeCallback_(e,this.state_,this.result_);this.executing_=!1},goog.Promise.prototype.executeCallback_=function(e,t,r){if(t==goog.Promise.State_.REJECTED&&e.onRejected&&!e.always&&this.removeUnhandledRejection_(),e.child)e.child.parent_=null,goog.Promise.invokeCallback_(e,t,r);else try{e.always?e.onFulfilled.call(e.context):goog.Promise.invokeCallback_(e,t,r)}catch(o){goog.Promise.handleRejection_.call(null,o)}goog.Promise.returnEntry_(e)},goog.Promise.invokeCallback_=function(e,t,r){t==goog.Promise.State_.FULFILLED?e.onFulfilled.call(e.context,r):e.onRejected&&e.onRejected.call(e.context,r)},goog.Promise.prototype.addStackTrace_=function(e){if(goog.Promise.LONG_STACK_TRACES&&goog.isString(e.stack)){var t=e.stack.split("\n",4)[3],r=e.message,r=r+Array(11-r.length).join(" ");this.stack_.push(r+t)}},goog.Promise.prototype.appendLongStack_=function(e){if(goog.Promise.LONG_STACK_TRACES&&e&&goog.isString(e.stack)&&this.stack_.length){for(var t=["Promise trace:"],r=this;r;r=r.parent_){for(var o=this.currentStep_;0<=o;o--)t.push(r.stack_[o]);t.push("Value: ["+(r.state_==goog.Promise.State_.REJECTED?"REJECTED":"FULFILLED")+"] <"+String(r.result_)+">")}e.stack+="\n\n"+t.join("\n")}},goog.Promise.prototype.removeUnhandledRejection_=function(){if(0<goog.Promise.UNHANDLED_REJECTION_DELAY)for(var e=this;e&&e.unhandledRejectionId_;e=e.parent_)goog.global.clearTimeout(e.unhandledRejectionId_),e.unhandledRejectionId_=0;else if(0==goog.Promise.UNHANDLED_REJECTION_DELAY)for(e=this;e&&e.hadUnhandledRejection_;e=e.parent_)e.hadUnhandledRejection_=!1},goog.Promise.addUnhandledRejection_=function(e,t){0<goog.Promise.UNHANDLED_REJECTION_DELAY?e.unhandledRejectionId_=goog.global.setTimeout(function(){e.appendLongStack_(t),goog.Promise.handleRejection_.call(null,t)},goog.Promise.UNHANDLED_REJECTION_DELAY):0==goog.Promise.UNHANDLED_REJECTION_DELAY&&(e.hadUnhandledRejection_=!0,goog.async.run(function(){e.hadUnhandledRejection_&&(e.appendLongStack_(t),goog.Promise.handleRejection_.call(null,t))}))},goog.Promise.handleRejection_=goog.async.throwException,goog.Promise.setUnhandledRejectionHandler=function(e){goog.Promise.handleRejection_=e},goog.Promise.CancellationError=function(e){goog.debug.Error.call(this,e)},goog.inherits(goog.Promise.CancellationError,goog.debug.Error),goog.Promise.CancellationError.prototype.name="cancel",goog.Promise.Resolver_=function(e,t,r){this.promise=e,this.resolve=t,this.reject=r},goog.math={},goog.math.randomInt=function(e){return Math.floor(Math.random()*e)},goog.math.uniformRandom=function(e,t){return e+Math.random()*(t-e)},goog.math.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},goog.math.modulo=function(e,t){var r=e%t;return 0>r*t?r+t:r},goog.math.lerp=function(e,t,r){return e+r*(t-e)},goog.math.nearlyEquals=function(e,t,r){return Math.abs(e-t)<=(r||1e-6)},goog.math.standardAngle=function(e){return goog.math.modulo(e,360)},goog.math.standardAngleInRadians=function(e){return goog.math.modulo(e,2*Math.PI)},goog.math.toRadians=function(e){return e*Math.PI/180},goog.math.toDegrees=function(e){return 180*e/Math.PI},goog.math.angleDx=function(e,t){return t*Math.cos(goog.math.toRadians(e))},goog.math.angleDy=function(e,t){return t*Math.sin(goog.math.toRadians(e))},goog.math.angle=function(e,t,r,o){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(o-t,r-e)))},goog.math.angleDifference=function(e,t){var r=goog.math.standardAngle(t)-goog.math.standardAngle(e);return 180<r?r-=360:-180>=r&&(r=360+r),r},goog.math.sign=Math.sign||function(e){return 0<e?1:0>e?-1:e},goog.math.longestCommonSubsequence=function(e,t,r,o){for(var n=r||function(e,t){return e==t},i=o||function(t){return e[t]},s=e.length,a=t.length,l=[],c=0;c<s+1;c++)l[c]=[],l[c][0]=0;for(var u=0;u<a+1;u++)l[0][u]=0;for(c=1;c<=s;c++)for(u=1;u<=a;u++)n(e[c-1],t[u-1])?l[c][u]=l[c-1][u-1]+1:l[c][u]=Math.max(l[c-1][u],l[c][u-1]);for(var h=[],c=s,u=a;0<c&&0<u;)n(e[c-1],t[u-1])?(h.unshift(i(c-1,u-1)),c--,u--):l[c-1][u]>l[c][u-1]?c--:u--;return h},goog.math.sum=function(e){return goog.array.reduce(arguments,function(e,t){return e+t},0)},goog.math.average=function(e){return goog.math.sum.apply(null,arguments)/arguments.length},goog.math.sampleVariance=function(e){var t=arguments.length;if(2>t)return 0;var r=goog.math.average.apply(null,arguments),o=goog.math.sum.apply(null,goog.array.map(arguments,function(e){return Math.pow(e-r,2)}))/(t-1);return o},goog.math.standardDeviation=function(e){return Math.sqrt(goog.math.sampleVariance.apply(null,arguments))},goog.math.isInt=function(e){return isFinite(e)&&0==e%1},goog.math.isFiniteNumber=function(e){return isFinite(e)&&!isNaN(e)},goog.math.isNegativeZero=function(e){return 0==e&&0>1/e},goog.math.log10Floor=function(e){if(0<e){var t=Math.round(Math.log(e)*Math.LOG10E);return t-(parseFloat("1e"+t)>e?1:0)}return 0==e?-(1/0):NaN},goog.math.safeFloor=function(e,t){return goog.asserts.assert(!goog.isDef(t)||0<t),Math.floor(e+(t||2e-15))},goog.math.safeCeil=function(e,t){return goog.asserts.assert(!goog.isDef(t)||0<t),Math.ceil(e-(t||2e-15))},goog.iter={},goog.iter.StopIteration="StopIteration"in goog.global?goog.global.StopIteration:{message:"StopIteration",stack:""},goog.iter.Iterator=function(){},goog.iter.Iterator.prototype.next=function(){throw goog.iter.StopIteration},goog.iter.Iterator.prototype.__iterator__=function(){return this},goog.iter.toIterator=function(e){if(e instanceof goog.iter.Iterator)return e;if("function"==typeof e.__iterator__)return e.__iterator__(!1);if(goog.isArrayLike(e)){var t=0,r=new goog.iter.Iterator;return r.next=function(){for(;;){if(t>=e.length)throw goog.iter.StopIteration;if(t in e)return e[t++];t++}},r}throw Error("Not implemented")},goog.iter.forEach=function(e,t,r){if(goog.isArrayLike(e))try{goog.array.forEach(e,t,r)}catch(o){if(o!==goog.iter.StopIteration)throw o}else{e=goog.iter.toIterator(e);try{for(;;)t.call(r,e.next(),void 0,e)}catch(o){if(o!==goog.iter.StopIteration)throw o}}},goog.iter.filter=function(e,t,r){var o=goog.iter.toIterator(e),n=new goog.iter.Iterator;return n.next=function(){for(;;){var e=o.next();if(t.call(r,e,void 0,o))return e}},n},goog.iter.filterFalse=function(e,t,r){return goog.iter.filter(e,goog.functions.not(t),r)},goog.iter.range=function(e,t,r){var o=0,n=e,i=r||1;if(1<arguments.length&&(o=e,n=t),0==i)throw Error("Range step argument must not be zero");var s=new goog.iter.Iterator;return s.next=function(){if(0<i&&o>=n||0>i&&o<=n)throw goog.iter.StopIteration;var e=o;return o+=i,e},s},goog.iter.join=function(e,t){return goog.iter.toArray(e).join(t)},goog.iter.map=function(e,t,r){var o=goog.iter.toIterator(e),n=new goog.iter.Iterator;return n.next=function(){var e=o.next();return t.call(r,e,void 0,o)},n},goog.iter.reduce=function(e,t,r,o){var n=r;return goog.iter.forEach(e,function(e){n=t.call(o,n,e)}),n},goog.iter.some=function(e,t,r){e=goog.iter.toIterator(e);try{for(;;)if(t.call(r,e.next(),void 0,e))return!0}catch(o){if(o!==goog.iter.StopIteration)throw o}return!1},goog.iter.every=function(e,t,r){e=goog.iter.toIterator(e);try{for(;;)if(!t.call(r,e.next(),void 0,e))return!1}catch(o){if(o!==goog.iter.StopIteration)throw o}return!0},goog.iter.chain=function(e){return goog.iter.chainFromIterable(arguments)},goog.iter.chainFromIterable=function(e){var t=goog.iter.toIterator(e),r=new goog.iter.Iterator,o=null;return r.next=function(){for(;;){if(null==o){var e=t.next();o=goog.iter.toIterator(e)}try{return o.next()}catch(r){if(r!==goog.iter.StopIteration)throw r;o=null}}},r},goog.iter.dropWhile=function(e,t,r){var o=goog.iter.toIterator(e),n=new goog.iter.Iterator,i=!0;return n.next=function(){for(;;){var e=o.next();if(!i||!t.call(r,e,void 0,o))return i=!1,e}},n},goog.iter.takeWhile=function(e,t,r){var o=goog.iter.toIterator(e),n=new goog.iter.Iterator;return n.next=function(){var e=o.next();if(t.call(r,e,void 0,o))return e;throw goog.iter.StopIteration},n},goog.iter.toArray=function(e){if(goog.isArrayLike(e))return goog.array.toArray(e);e=goog.iter.toIterator(e);var t=[];return goog.iter.forEach(e,function(e){t.push(e)}),t},goog.iter.equals=function(e,t,r){var o={},n=goog.iter.zipLongest(o,e,t),i=r||goog.array.defaultCompareEquality;return goog.iter.every(n,function(e){return i(e[0],e[1])})},goog.iter.nextOrValue=function(e,t){try{return goog.iter.toIterator(e).next()}catch(r){if(r!=goog.iter.StopIteration)throw r;return t}},goog.iter.product=function(e){var t=goog.array.some(arguments,function(e){return!e.length});if(t||!arguments.length)return new goog.iter.Iterator;var r=new goog.iter.Iterator,o=arguments,n=goog.array.repeat(0,o.length);return r.next=function(){if(n){for(var e=goog.array.map(n,function(e,t){return o[t][e]}),t=n.length-1;0<=t;t--){if(goog.asserts.assert(n),n[t]<o[t].length-1){n[t]++;break}if(0==t){n=null;break}n[t]=0}return e}throw goog.iter.StopIteration},r},goog.iter.cycle=function(e){var t=goog.iter.toIterator(e),r=[],o=0,n=new goog.iter.Iterator,i=!1;return n.next=function(){var e=null;if(!i)try{return e=t.next(),r.push(e),e}catch(n){if(n!=goog.iter.StopIteration||goog.array.isEmpty(r))throw n;i=!0}return e=r[o],o=(o+1)%r.length,e},n},goog.iter.count=function(e,t){var r=e||0,o=goog.isDef(t)?t:1,n=new goog.iter.Iterator;return n.next=function(){var e=r;return r+=o,e},n},goog.iter.repeat=function(e){var t=new goog.iter.Iterator;return t.next=goog.functions.constant(e),t},goog.iter.accumulate=function(e){var t=goog.iter.toIterator(e),r=0,o=new goog.iter.Iterator;return o.next=function(){return r+=t.next()},o},goog.iter.zip=function(e){var t=arguments,r=new goog.iter.Iterator;if(0<t.length){var o=goog.array.map(t,goog.iter.toIterator);r.next=function(){var e=goog.array.map(o,function(e){return e.next()});return e}}return r},goog.iter.zipLongest=function(e,t){var r=goog.array.slice(arguments,1),o=new goog.iter.Iterator;if(0<r.length){var n=goog.array.map(r,goog.iter.toIterator);o.next=function(){var t=!1,r=goog.array.map(n,function(r){var o;try{o=r.next(),t=!0}catch(n){if(n!==goog.iter.StopIteration)throw n;o=e}return o});if(!t)throw goog.iter.StopIteration;return r}}return o},goog.iter.compress=function(e,t){var r=goog.iter.toIterator(t);return goog.iter.filter(e,function(){return!!r.next()})},goog.iter.GroupByIterator_=function(e,t){this.iterator=goog.iter.toIterator(e),this.keyFunc=t||goog.functions.identity},goog.inherits(goog.iter.GroupByIterator_,goog.iter.Iterator),goog.iter.GroupByIterator_.prototype.next=function(){for(;this.currentKey==this.targetKey;)this.currentValue=this.iterator.next(),this.currentKey=this.keyFunc(this.currentValue);return this.targetKey=this.currentKey,[this.currentKey,this.groupItems_(this.targetKey)]},goog.iter.GroupByIterator_.prototype.groupItems_=function(e){for(var t=[];this.currentKey==e;){t.push(this.currentValue);try{this.currentValue=this.iterator.next()}catch(r){if(r!==goog.iter.StopIteration)throw r;break}this.currentKey=this.keyFunc(this.currentValue)}return t},goog.iter.groupBy=function(e,t){return new goog.iter.GroupByIterator_(e,t)},goog.iter.starMap=function(e,t,r){var o=goog.iter.toIterator(e),n=new goog.iter.Iterator;return n.next=function(){var e=goog.iter.toArray(o.next());return t.apply(r,goog.array.concat(e,void 0,o))},n},goog.iter.tee=function(e,t){var r=goog.iter.toIterator(e),o=goog.isNumber(t)?t:2,n=goog.array.map(goog.array.range(o),function(){return[]}),i=function(){var e=r.next();goog.array.forEach(n,function(t){t.push(e)})},s=function(e){var t=new goog.iter.Iterator;return t.next=function(){return goog.array.isEmpty(e)&&i(),goog.asserts.assert(!goog.array.isEmpty(e)),e.shift()},t};return goog.array.map(n,s)},goog.iter.enumerate=function(e,t){return goog.iter.zip(goog.iter.count(t),e)},goog.iter.limit=function(e,t){goog.asserts.assert(goog.math.isInt(t)&&0<=t);var r=goog.iter.toIterator(e),o=new goog.iter.Iterator,n=t;return o.next=function(){if(0<n--)return r.next();throw goog.iter.StopIteration},o},goog.iter.consume=function(e,t){goog.asserts.assert(goog.math.isInt(t)&&0<=t);for(var r=goog.iter.toIterator(e);0<t--;)goog.iter.nextOrValue(r,null);return r},goog.iter.slice=function(e,t,r){goog.asserts.assert(goog.math.isInt(t)&&0<=t);var o=goog.iter.consume(e,t);return goog.isNumber(r)&&(goog.asserts.assert(goog.math.isInt(r)&&r>=t),o=goog.iter.limit(o,r-t)),o},goog.iter.hasDuplicates_=function(e){var t=[];return goog.array.removeDuplicates(e,t),e.length!=t.length},goog.iter.permutations=function(e,t){var r=goog.iter.toArray(e),o=goog.isNumber(t)?t:r.length,n=goog.array.repeat(r,o),i=goog.iter.product.apply(void 0,n);return goog.iter.filter(i,function(e){return!goog.iter.hasDuplicates_(e)})},goog.iter.combinations=function(e,t){function r(e){return o[e]}var o=goog.iter.toArray(e),n=goog.iter.range(o.length),i=goog.iter.permutations(n,t),s=goog.iter.filter(i,function(e){return goog.array.isSorted(e)}),a=new goog.iter.Iterator;return a.next=function(){return goog.array.map(s.next(),r)},a},goog.iter.combinationsWithReplacement=function(e,t){function r(e){return o[e]}var o=goog.iter.toArray(e),n=goog.array.range(o.length),i=goog.array.repeat(n,t),s=goog.iter.product.apply(void 0,i),a=goog.iter.filter(s,function(e){return goog.array.isSorted(e)}),l=new goog.iter.Iterator;return l.next=function(){return goog.array.map(a.next(),r)},l},goog.structs={},goog.structs.Map=function(e,t){this.map_={},this.keys_=[],this.version_=this.count_=0;var r=arguments.length;if(1<r){if(r%2)throw Error("Uneven number of arguments");for(var o=0;o<r;o+=2)this.set(arguments[o],arguments[o+1])}else e&&this.addAll(e)},goog.structs.Map.prototype.getCount=function(){return this.count_},goog.structs.Map.prototype.getValues=function(){this.cleanupKeysArray_();for(var e=[],t=0;t<this.keys_.length;t++){var r=this.keys_[t];e.push(this.map_[r])}return e},goog.structs.Map.prototype.getKeys=function(){return this.cleanupKeysArray_(),this.keys_.concat()},goog.structs.Map.prototype.containsKey=function(e){return goog.structs.Map.hasKey_(this.map_,e)},goog.structs.Map.prototype.containsValue=function(e){for(var t=0;t<this.keys_.length;t++){var r=this.keys_[t];if(goog.structs.Map.hasKey_(this.map_,r)&&this.map_[r]==e)return!0}return!1},goog.structs.Map.prototype.equals=function(e,t){if(this===e)return!0;if(this.count_!=e.getCount())return!1;var r=t||goog.structs.Map.defaultEquals;this.cleanupKeysArray_();for(var o,n=0;o=this.keys_[n];n++)if(!r(this.get(o),e.get(o)))return!1;return!0},goog.structs.Map.defaultEquals=function(e,t){return e===t},goog.structs.Map.prototype.isEmpty=function(){return 0==this.count_},goog.structs.Map.prototype.clear=function(){this.map_={},this.version_=this.count_=this.keys_.length=0},goog.structs.Map.prototype.remove=function(e){return!!goog.structs.Map.hasKey_(this.map_,e)&&(delete this.map_[e],this.count_--,this.version_++,this.keys_.length>2*this.count_&&this.cleanupKeysArray_(),!0)},goog.structs.Map.prototype.cleanupKeysArray_=function(){if(this.count_!=this.keys_.length){for(var e=0,t=0;e<this.keys_.length;){var r=this.keys_[e];goog.structs.Map.hasKey_(this.map_,r)&&(this.keys_[t++]=r),e++}this.keys_.length=t}if(this.count_!=this.keys_.length){for(var o={},t=e=0;e<this.keys_.length;)r=this.keys_[e],goog.structs.Map.hasKey_(o,r)||(this.keys_[t++]=r,o[r]=1),e++;this.keys_.length=t}},goog.structs.Map.prototype.get=function(e,t){return goog.structs.Map.hasKey_(this.map_,e)?this.map_[e]:t},goog.structs.Map.prototype.set=function(e,t){goog.structs.Map.hasKey_(this.map_,e)||(this.count_++,this.keys_.push(e),this.version_++),this.map_[e]=t},goog.structs.Map.prototype.addAll=function(e){var t,r;e instanceof goog.structs.Map?(t=e.getKeys(),r=e.getValues()):(t=goog.object.getKeys(e),r=goog.object.getValues(e));for(var o=0;o<t.length;o++)this.set(t[o],r[o])},goog.structs.Map.prototype.forEach=function(e,t){for(var r=this.getKeys(),o=0;o<r.length;o++){var n=r[o],i=this.get(n);e.call(t,i,n,this)}},goog.structs.Map.prototype.clone=function(){return new goog.structs.Map(this)},goog.structs.Map.prototype.transpose=function(){for(var e=new goog.structs.Map,t=0;t<this.keys_.length;t++){var r=this.keys_[t],o=this.map_[r];e.set(o,r)}return e},goog.structs.Map.prototype.toObject=function(){this.cleanupKeysArray_();for(var e={},t=0;t<this.keys_.length;t++){var r=this.keys_[t];e[r]=this.map_[r]}return e},goog.structs.Map.prototype.__iterator__=function(e){this.cleanupKeysArray_();var t=0,r=this.version_,o=this,n=new goog.iter.Iterator;return n.next=function(){if(r!=o.version_)throw Error("The map has changed since the iterator was created");if(t>=o.keys_.length)throw goog.iter.StopIteration;var n=o.keys_[t++];return e?n:o.map_[n]},n},goog.structs.Map.hasKey_=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},goog.labs.userAgent.platform={},goog.labs.userAgent.platform.isAndroid=function(){return goog.labs.userAgent.util.matchUserAgent("Android")},goog.labs.userAgent.platform.isIpod=function(){return goog.labs.userAgent.util.matchUserAgent("iPod")},goog.labs.userAgent.platform.isIphone=function(){return goog.labs.userAgent.util.matchUserAgent("iPhone")&&!goog.labs.userAgent.util.matchUserAgent("iPod")&&!goog.labs.userAgent.util.matchUserAgent("iPad")},goog.labs.userAgent.platform.isIpad=function(){return goog.labs.userAgent.util.matchUserAgent("iPad")},goog.labs.userAgent.platform.isIos=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpad()||goog.labs.userAgent.platform.isIpod()},goog.labs.userAgent.platform.isMacintosh=function(){return goog.labs.userAgent.util.matchUserAgent("Macintosh")},goog.labs.userAgent.platform.isLinux=function(){return goog.labs.userAgent.util.matchUserAgent("Linux")},goog.labs.userAgent.platform.isWindows=function(){return goog.labs.userAgent.util.matchUserAgent("Windows")},goog.labs.userAgent.platform.isChromeOS=function(){return goog.labs.userAgent.util.matchUserAgent("CrOS")},goog.labs.userAgent.platform.getVersion=function(){var e,t=goog.labs.userAgent.util.getUserAgent(),r="";if(goog.labs.userAgent.platform.isWindows()){e=/Windows (?:NT|Phone) ([0-9.]+)/;var o=e.exec(t),r=o?o[1]:"0.0"}else goog.labs.userAgent.platform.isIos()?(e=/(?:iPhone|iPod|iPad|CPU)\s+OS\s+(\S+)/,r=(o=e.exec(t))&&o[1].replace(/_/g,".")):goog.labs.userAgent.platform.isMacintosh()?(e=/Mac OS X ([0-9_.]+)/,r=(o=e.exec(t))?o[1].replace(/_/g,"."):"10"):goog.labs.userAgent.platform.isAndroid()?(e=/Android\s+([^\);]+)(\)|;)/,r=(o=e.exec(t))&&o[1]):goog.labs.userAgent.platform.isChromeOS()&&(e=/(?:CrOS\s+(?:i686|x86_64)\s+([0-9.]+))/,
r=(o=e.exec(t))&&o[1]);return r||""},goog.labs.userAgent.platform.isVersionOrHigher=function(e){return 0<=goog.string.compareVersions(goog.labs.userAgent.platform.getVersion(),e)},goog.userAgent={},goog.userAgent.ASSUME_IE=!1,goog.userAgent.ASSUME_EDGE=!1,goog.userAgent.ASSUME_GECKO=!1,goog.userAgent.ASSUME_WEBKIT=!1,goog.userAgent.ASSUME_MOBILE_WEBKIT=!1,goog.userAgent.ASSUME_OPERA=!1,goog.userAgent.ASSUME_ANY_VERSION=!1,goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA,goog.userAgent.getUserAgentString=function(){return goog.labs.userAgent.util.getUserAgent()},goog.userAgent.getNavigator=function(){return goog.global.navigator||null},goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.labs.userAgent.browser.isOpera(),goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.labs.userAgent.browser.isIE(),goog.userAgent.EDGE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_EDGE:goog.labs.userAgent.engine.isEdge(),goog.userAgent.EDGE_OR_IE=goog.userAgent.EDGE||goog.userAgent.IE,goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.labs.userAgent.engine.isGecko(),goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.labs.userAgent.engine.isWebKit(),goog.userAgent.isMobile_=function(){return goog.userAgent.WEBKIT&&goog.labs.userAgent.util.matchUserAgent("Mobile")},goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.isMobile_(),goog.userAgent.SAFARI=goog.userAgent.WEBKIT,goog.userAgent.determinePlatform_=function(){var e=goog.userAgent.getNavigator();return e&&e.platform||""},goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_(),goog.userAgent.ASSUME_MAC=!1,goog.userAgent.ASSUME_WINDOWS=!1,goog.userAgent.ASSUME_LINUX=!1,goog.userAgent.ASSUME_X11=!1,goog.userAgent.ASSUME_ANDROID=!1,goog.userAgent.ASSUME_IPHONE=!1,goog.userAgent.ASSUME_IPAD=!1,goog.userAgent.ASSUME_IPOD=!1,goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD,goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.labs.userAgent.platform.isMacintosh(),goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.labs.userAgent.platform.isWindows(),goog.userAgent.isLegacyLinux_=function(){return goog.labs.userAgent.platform.isLinux()||goog.labs.userAgent.platform.isChromeOS()},goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.isLegacyLinux_(),goog.userAgent.isX11_=function(){var e=goog.userAgent.getNavigator();return!!e&&goog.string.contains(e.appVersion||"","X11")},goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.isX11_(),goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.labs.userAgent.platform.isAndroid(),goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.labs.userAgent.platform.isIphone(),goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad(),goog.userAgent.IPOD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIpod(),goog.userAgent.determineVersion_=function(){var e="",t=goog.userAgent.getVersionRegexResult_();if(t&&(e=t?t[1]:""),goog.userAgent.IE){var r=goog.userAgent.getDocumentMode_();if(null!=r&&r>parseFloat(e))return String(r)}return e},goog.userAgent.getVersionRegexResult_=function(){var e=goog.userAgent.getUserAgentString();return goog.userAgent.GECKO?/rv\:([^\);]+)(\)|;)/.exec(e):goog.userAgent.EDGE?/Edge\/([\d\.]+)/.exec(e):goog.userAgent.IE?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):goog.userAgent.WEBKIT?/WebKit\/(\S+)/.exec(e):goog.userAgent.OPERA?/(?:Version)[ \/]?(\S+)/.exec(e):void 0},goog.userAgent.getDocumentMode_=function(){var e=goog.global.document;return e?e.documentMode:void 0},goog.userAgent.VERSION=goog.userAgent.determineVersion_(),goog.userAgent.compare=function(e,t){return goog.string.compareVersions(e,t)},goog.userAgent.isVersionOrHigherCache_={},goog.userAgent.isVersionOrHigher=function(e){return goog.userAgent.ASSUME_ANY_VERSION||goog.userAgent.isVersionOrHigherCache_[e]||(goog.userAgent.isVersionOrHigherCache_[e]=0<=goog.string.compareVersions(goog.userAgent.VERSION,e))},goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher,goog.userAgent.isDocumentModeOrHigher=function(e){return Number(goog.userAgent.DOCUMENT_MODE)>=e},goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher;var JSCompiler_inline_result$$0,doc$$inline_2=goog.global.document,mode$$inline_3=goog.userAgent.getDocumentMode_();JSCompiler_inline_result$$0=doc$$inline_2&&goog.userAgent.IE?mode$$inline_3||("CSS1Compat"==doc$$inline_2.compatMode?parseInt(goog.userAgent.VERSION,10):5):void 0,goog.userAgent.DOCUMENT_MODE=JSCompiler_inline_result$$0,goog.userAgent.product={},goog.userAgent.product.ASSUME_FIREFOX=!1,goog.userAgent.product.ASSUME_IPHONE=!1,goog.userAgent.product.ASSUME_IPAD=!1,goog.userAgent.product.ASSUME_ANDROID=!1,goog.userAgent.product.ASSUME_CHROME=!1,goog.userAgent.product.ASSUME_SAFARI=!1,goog.userAgent.product.PRODUCT_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_OPERA||goog.userAgent.product.ASSUME_FIREFOX||goog.userAgent.product.ASSUME_IPHONE||goog.userAgent.product.ASSUME_IPAD||goog.userAgent.product.ASSUME_ANDROID||goog.userAgent.product.ASSUME_CHROME||goog.userAgent.product.ASSUME_SAFARI,goog.userAgent.product.OPERA=goog.userAgent.OPERA,goog.userAgent.product.IE=goog.userAgent.IE,goog.userAgent.product.EDGE=goog.userAgent.EDGE,goog.userAgent.product.FIREFOX=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_FIREFOX:goog.labs.userAgent.browser.isFirefox(),goog.userAgent.product.isIphoneOrIpod_=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpod()},goog.userAgent.product.IPHONE=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPHONE:goog.userAgent.product.isIphoneOrIpod_(),goog.userAgent.product.IPAD=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad(),goog.userAgent.product.ANDROID=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_ANDROID:goog.labs.userAgent.browser.isAndroidBrowser(),goog.userAgent.product.CHROME=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_CHROME:goog.labs.userAgent.browser.isChrome(),goog.userAgent.product.isSafariDesktop_=function(){return goog.labs.userAgent.browser.isSafari()&&!goog.labs.userAgent.platform.isIos()},goog.userAgent.product.SAFARI=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_SAFARI:goog.userAgent.product.isSafariDesktop_();var lf={Capability:function(){this.safariWebView_=goog.userAgent.product.SAFARI||goog.userAgent.product.IPAD||goog.userAgent.product.IPHONE,this.indexedDb=!(this.safariWebView_||goog.userAgent.product.IE&&!goog.userAgent.isVersionOrHigher(10)),!goog.userAgent.product.IE||goog.userAgent.isVersionOrHigher(11),this.webSql=goog.userAgent.product.CHROME||goog.userAgent.product.SAFARI,this.nativeMap=goog.isDef(window.Map)&&goog.isDef(window.Map.prototype.values)&&goog.isDef(window.Map.prototype.forEach)&&!this.safariWebView_,this.nativeSet=goog.isDef(window.Set)&&goog.isDef(window.Set.prototype.values)&&goog.isDef(window.Set.prototype.forEach)&&!this.safariWebView_}};lf.Capability.get=function(){return goog.isDef(lf.Capability.instance_)||(lf.Capability.instance_=new lf.Capability),lf.Capability.instance_},lf.Flags={},lf.Flags.MEMORY_ONLY=!1,lf.Flags.NATIVE_ES6=!1,lf.structs={},lf.structs.map={},$jscomp.scope.detectUseNative=function(){return lf.Flags.NATIVE_ES6||lf.Capability.get().nativeMap},lf.structs.MapPolyFill_=function(){this.map_=new goog.structs.Map,Object.defineProperty(this,"size",{get:function(){return this.map_.getCount()}})},lf.structs.MapPolyFill_.prototype.clear=function(){this.map_.clear()},goog.exportProperty(lf.structs.MapPolyFill_.prototype,"clear",lf.structs.MapPolyFill_.prototype.clear),lf.structs.MapPolyFill_.prototype["delete"]=function(e){return this.map_.remove(e)},goog.exportProperty(lf.structs.MapPolyFill_.prototype,"delete",lf.structs.MapPolyFill_.prototype["delete"]),lf.structs.MapPolyFill_.prototype.forEach=function(e,t){return this.map_.forEach(e,t)},goog.exportProperty(lf.structs.MapPolyFill_.prototype,"forEach",lf.structs.MapPolyFill_.prototype.forEach),lf.structs.MapPolyFill_.prototype.get=function(e){return this.map_.get(e)},goog.exportProperty(lf.structs.MapPolyFill_.prototype,"get",lf.structs.MapPolyFill_.prototype.get),lf.structs.MapPolyFill_.prototype.has=function(e){return this.map_.containsKey(e)},goog.exportProperty(lf.structs.MapPolyFill_.prototype,"has",lf.structs.MapPolyFill_.prototype.has),lf.structs.MapPolyFill_.prototype.set=function(e,t){return this.map_.set(e,t)},goog.exportProperty(lf.structs.MapPolyFill_.prototype,"set",lf.structs.MapPolyFill_.prototype.set),$jscomp.scope.USE_NATIVE=(0,$jscomp.scope.detectUseNative)(),lf.structs.map.create=function(){return $jscomp.scope.USE_NATIVE?new window.Map:new lf.structs.MapPolyFill_},lf.structs.map.keys=function(e){if(e instanceof lf.structs.MapPolyFill_)return e.map_.getKeys();var t=0,r=Array(e.size);return e.forEach(function(e,o){r[t++]=o}),r},lf.structs.map.values=function(e){if(e instanceof lf.structs.MapPolyFill_)return e.map_.getValues();var t=0,r=Array(e.size);return e.forEach(function(e){r[t++]=e}),r},lf.Row=function(e,t){this.id_=e,this.payload_=t||this.defaultPayload()},lf.Row.nextId_=0,lf.Row.DUMMY_ID=-1,lf.Row.getNextId=function(){return lf.Row.nextId_++},lf.Row.setNextId=function(e){lf.Row.nextId_=e},lf.Row.prototype.id=function(){return this.id_},lf.Row.prototype.assignRowId=function(e){this.id_=e},lf.Row.prototype.defaultPayload=function(){return{}},lf.Row.prototype.toDbPayload=function(){return this.payload_},lf.Row.prototype.serialize=function(){return{id:this.id_,value:this.toDbPayload()}},lf.Row.prototype.keyOfIndex=function(e){return"#"==e.substr(-1)?this.id_:null},lf.Row.deserialize=function(e){return new lf.Row(e.id,e.value)},lf.Row.create=function(e){return new lf.Row(lf.Row.getNextId(),e||{})},lf.Row.binToHex=function(e){if(!goog.isDefAndNotNull(e))return null;for(var t=new Uint8Array(e),r="",o=0;o<t.length;++o)var n=t[o].toString(16),r=r+(2>n.length?"0"+n:n);return r},lf.Row.hexToBin=function(e){if(!goog.isDefAndNotNull(e)||""==e)return null;0!=e.length%2&&(e="0"+e);for(var t=new ArrayBuffer(e.length/2),r=new Uint8Array(t),o=0,n=0;o<e.length;o+=2)r[n++]=parseInt(e.substr(o,2),16);return t},lf.TransactionType={},goog.exportSymbol("lf.TransactionType",lf.TransactionType),lf.TransactionType.READ_ONLY=0,goog.exportProperty(lf.TransactionType,"READ_ONLY",lf.TransactionType.READ_ONLY),lf.TransactionType.READ_WRITE=1,goog.exportProperty(lf.TransactionType,"READ_WRITE",lf.TransactionType.READ_WRITE),lf.Transaction=function(){},lf.TransactionStats=function(e,t,r,o,n){this.success_=e,this.insertedRowCount_=t,this.updatedRowCount_=r,this.deletedRowCount_=o,this.changedTableCount_=n},goog.exportSymbol("lf.TransactionStats",lf.TransactionStats),lf.TransactionStats.prototype.success=function(){return this.success_},goog.exportProperty(lf.TransactionStats.prototype,"success",lf.TransactionStats.prototype.success),lf.TransactionStats.prototype.insertedRowCount=function(){return this.insertedRowCount_},goog.exportProperty(lf.TransactionStats.prototype,"insertedRowCount",lf.TransactionStats.prototype.insertedRowCount),lf.TransactionStats.prototype.updatedRowCount=function(){return this.updatedRowCount_},goog.exportProperty(lf.TransactionStats.prototype,"updatedRowCount",lf.TransactionStats.prototype.updatedRowCount),lf.TransactionStats.prototype.deletedRowCount=function(){return this.deletedRowCount_},goog.exportProperty(lf.TransactionStats.prototype,"deletedRowCount",lf.TransactionStats.prototype.deletedRowCount),lf.TransactionStats.prototype.changedTableCount=function(){return this.changedTableCount_},goog.exportProperty(lf.TransactionStats.prototype,"changedTableCount",lf.TransactionStats.prototype.changedTableCount),lf.TransactionStats.getDefault=function(){return new lf.TransactionStats((!1),0,0,0,0)},lf.backstore={},lf.backstore.TableType={DATA:0,INDEX:1},lf.backstore.Tx=function(){},lf.backstore.BaseTx=function(e,t){this.txType=e,this.journal_=t||null,this.resolver=goog.Promise.withResolver(),this.success_=!1,this.stats_=null},lf.backstore.BaseTx.prototype.commit=function(){var e=this.txType==lf.TransactionType.READ_ONLY?this.commitInternal():this.commitReadWrite_();return e.then(function(e){return this.success_=!0,e}.bind(this))},lf.backstore.BaseTx.prototype.commitReadWrite_=function(){try{this.journal_.checkDeferredConstraints()}catch(e){return goog.Promise.reject(e)}return this.mergeIntoBackstore_().then(function(e){return this.journal_.commit(),e}.bind(this))},lf.backstore.BaseTx.prototype.mergeIntoBackstore_=function(){return this.mergeTableChanges_(),this.mergeIndexChanges_(),this.commitInternal()},lf.backstore.BaseTx.prototype.mergeTableChanges_=function(){var e=this.journal_.tableDiffs_;e.forEach(function(e,t){var r=this.journal_.getScope().get(t),o=this.getTable(r.getName(),r.deserializeRow.bind(r),lf.backstore.TableType.DATA),n=lf.structs.map.values(e.deleted_).map(function(e){return e.id()});0<n.length&&o.remove(n).thenCatch(this.handleError_,this);var i=lf.structs.map.values(e.modified_).map(function(e){return e[1]}).concat(lf.structs.map.values(e.added_));o.put(i).thenCatch(this.handleError_,this)},this)},lf.backstore.BaseTx.prototype.mergeIndexChanges_=function(){var e=this.journal_.getIndexDiff();e.forEach(function(e){var t=this.getTable(e.getName(),lf.Row.deserialize,lf.backstore.TableType.INDEX);t.remove([]),t.put(e.serialize())},this)},lf.backstore.BaseTx.prototype.handleError_=function(e){this.resolver.reject(e)},lf.backstore.BaseTx.prototype.stats=function(){if(goog.isNull(this.stats_))if(this.success_)if(this.txType==lf.TransactionType.READ_ONLY)this.stats_=new lf.TransactionStats((!0),0,0,0,0);else{var e=this.journal_.tableDiffs_,t=0,r=0,o=0,n=0;e.forEach(function(e){n++,t+=e.added_.size,o+=e.modified_.size,r+=e.deleted_.size}),this.stats_=new lf.TransactionStats((!0),t,o,r,n)}else this.stats_=lf.TransactionStats.getDefault();return this.stats_},lf.service={},lf.service.ServiceId=function(e){this.serviceId_=e},lf.service.ServiceId.prototype.toString=function(){return this.serviceId_},lf.service.BACK_STORE=new lf.service.ServiceId("backstore"),lf.service.CACHE=new lf.service.ServiceId("cache"),lf.service.INDEX_STORE=new lf.service.ServiceId("indexstore"),lf.service.QUERY_ENGINE=new lf.service.ServiceId("engine"),lf.service.RUNNER=new lf.service.ServiceId("runner"),lf.service.OBSERVER_REGISTRY=new lf.service.ServiceId("observerregistry"),lf.service.SCHEMA=new lf.service.ServiceId("schema"),lf.Table=function(){},goog.structs.Collection=function(){},goog.structs.getCount=function(e){return e.getCount&&"function"==typeof e.getCount?e.getCount():goog.isArrayLike(e)||goog.isString(e)?e.length:goog.object.getCount(e)},goog.structs.getValues=function(e){if(e.getValues&&"function"==typeof e.getValues)return e.getValues();if(goog.isString(e))return e.split("");if(goog.isArrayLike(e)){for(var t=[],r=e.length,o=0;o<r;o++)t.push(e[o]);return t}return goog.object.getValues(e)},goog.structs.getKeys=function(e){if(e.getKeys&&"function"==typeof e.getKeys)return e.getKeys();if(!e.getValues||"function"!=typeof e.getValues){if(goog.isArrayLike(e)||goog.isString(e)){for(var t=[],r=e.length,o=0;o<r;o++)t.push(o);return t}return goog.object.getKeys(e)}},goog.structs.contains=function(e,t){return e.contains&&"function"==typeof e.contains?e.contains(t):e.containsValue&&"function"==typeof e.containsValue?e.containsValue(t):goog.isArrayLike(e)||goog.isString(e)?goog.array.contains(e,t):goog.object.containsValue(e,t)},goog.structs.isEmpty=function(e){return e.isEmpty&&"function"==typeof e.isEmpty?e.isEmpty():goog.isArrayLike(e)||goog.isString(e)?goog.array.isEmpty(e):goog.object.isEmpty(e)},goog.structs.clear=function(e){e.clear&&"function"==typeof e.clear?e.clear():goog.isArrayLike(e)?goog.array.clear(e):goog.object.clear(e)},goog.structs.forEach=function(e,t,r){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,r);else if(goog.isArrayLike(e)||goog.isString(e))goog.array.forEach(e,t,r);else for(var o=goog.structs.getKeys(e),n=goog.structs.getValues(e),i=n.length,s=0;s<i;s++)t.call(r,n[s],o&&o[s],e)},goog.structs.filter=function(e,t,r){if("function"==typeof e.filter)return e.filter(t,r);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.filter(e,t,r);var o,n=goog.structs.getKeys(e),i=goog.structs.getValues(e),s=i.length;if(n){o={};for(var a=0;a<s;a++)t.call(r,i[a],n[a],e)&&(o[n[a]]=i[a])}else for(o=[],a=0;a<s;a++)t.call(r,i[a],void 0,e)&&o.push(i[a]);return o},goog.structs.map=function(e,t,r){if("function"==typeof e.map)return e.map(t,r);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.map(e,t,r);var o,n=goog.structs.getKeys(e),i=goog.structs.getValues(e),s=i.length;if(n){o={};for(var a=0;a<s;a++)o[n[a]]=t.call(r,i[a],n[a],e)}else for(o=[],a=0;a<s;a++)o[a]=t.call(r,i[a],void 0,e);return o},goog.structs.some=function(e,t,r){if("function"==typeof e.some)return e.some(t,r);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.some(e,t,r);for(var o=goog.structs.getKeys(e),n=goog.structs.getValues(e),i=n.length,s=0;s<i;s++)if(t.call(r,n[s],o&&o[s],e))return!0;return!1},goog.structs.every=function(e,t,r){if("function"==typeof e.every)return e.every(t,r);if(goog.isArrayLike(e)||goog.isString(e))return goog.array.every(e,t,r);for(var o=goog.structs.getKeys(e),n=goog.structs.getValues(e),i=n.length,s=0;s<i;s++)if(!t.call(r,n[s],o&&o[s],e))return!1;return!0},goog.structs.Set=function(e){this.map_=new goog.structs.Map,e&&this.addAll(e)},goog.structs.Set.getKey_=function(e){var t=typeof e;return"object"==t&&e||"function"==t?"o"+goog.getUid(e):t.substr(0,1)+e},goog.structs.Set.prototype.getCount=function(){return this.map_.getCount()},goog.structs.Set.prototype.add=function(e){this.map_.set(goog.structs.Set.getKey_(e),e)},goog.structs.Set.prototype.addAll=function(e){for(var t=goog.structs.getValues(e),r=t.length,o=0;o<r;o++)this.add(t[o])},goog.structs.Set.prototype.removeAll=function(e){for(var t=goog.structs.getValues(e),r=t.length,o=0;o<r;o++)this.remove(t[o])},goog.structs.Set.prototype.remove=function(e){return this.map_.remove(goog.structs.Set.getKey_(e))},goog.structs.Set.prototype.clear=function(){this.map_.clear()},goog.structs.Set.prototype.isEmpty=function(){return this.map_.isEmpty()},goog.structs.Set.prototype.contains=function(e){return this.map_.containsKey(goog.structs.Set.getKey_(e))},goog.structs.Set.prototype.difference=function(e){var t=this.clone();return t.removeAll(e),t},goog.structs.Set.prototype.getValues=function(){return this.map_.getValues()},goog.structs.Set.prototype.clone=function(){return new goog.structs.Set(this)},goog.structs.Set.prototype.equals=function(e){return this.getCount()==goog.structs.getCount(e)&&this.isSubsetOf(e)},goog.structs.Set.prototype.isSubsetOf=function(e){var t=goog.structs.getCount(e);return!(this.getCount()>t)&&(!(e instanceof goog.structs.Set)&&5<t&&(e=new goog.structs.Set(e)),goog.structs.every(this,function(t){return goog.structs.contains(e,t)}))},goog.structs.Set.prototype.__iterator__=function(){return this.map_.__iterator__(!1)},lf.structs.set={},$jscomp.scope.detectUseNative$jscomp$1=function(){return lf.Flags.NATIVE_ES6||lf.Capability.get().nativeSet},lf.structs.SetPolyFill_=function(e){this.set_=new goog.structs.Set(e),Object.defineProperty(this,"size",{get:function(){return this.set_.getCount()}})},lf.structs.SetPolyFill_.prototype.add=function(e){this.set_.add(e)},goog.exportProperty(lf.structs.SetPolyFill_.prototype,"add",lf.structs.SetPolyFill_.prototype.add),lf.structs.SetPolyFill_.prototype.clear=function(){this.set_.clear()},goog.exportProperty(lf.structs.SetPolyFill_.prototype,"clear",lf.structs.SetPolyFill_.prototype.clear),lf.structs.SetPolyFill_.prototype["delete"]=function(e){return this.set_.remove(e)},goog.exportProperty(lf.structs.SetPolyFill_.prototype,"delete",lf.structs.SetPolyFill_.prototype["delete"]),lf.structs.SetPolyFill_.prototype.forEach=function(e,t){this.set_.getValues().forEach(e,t)},lf.structs.SetPolyFill_.prototype.has=function(e){return this.set_.contains(e)},goog.exportProperty(lf.structs.SetPolyFill_.prototype,"has",lf.structs.SetPolyFill_.prototype.has),$jscomp.scope.USE_NATIVE$jscomp$1=(0,$jscomp.scope.detectUseNative$jscomp$1)(),lf.structs.set.create=function(e){return $jscomp.scope.USE_NATIVE$jscomp$1?goog.isDef(e)?new window.Set(e):new window.Set:new lf.structs.SetPolyFill_(e)},lf.structs.set.values=function(e){if(e instanceof lf.structs.SetPolyFill_)return e.set_.getValues();var t=0,r=Array(e.size);return e.forEach(function(e){r[t++]=e}),r},lf.structs.set.diff=function(e,t){if(e instanceof lf.structs.SetPolyFill_){var r=new lf.structs.SetPolyFill_;r.set_=e.set_.difference(t.set_)}else r=lf.structs.set.create(),lf.structs.set.values(e).forEach(function(e){t.has(e)||r.add(e)});return r},lf.structs.set.isSubset=function(e,t){if(t.size>e.size)return!1;var r=!0;return t.forEach(function(t){r=r&&e.has(t)}),r},lf.structs.set.equals=function(e,t){return e.size==t.size&&lf.structs.set.isSubset(e,t)},lf.backstore.Page=function(e,t){this.id_=e,this.payload_=t||{}},lf.backstore.Page.BUNDLE_EXPONENT=9,lf.backstore.Page.toPageIds=function(e){var t=lf.structs.set.create();return e.forEach(function(e){t.add(lf.backstore.Page.toPageId(e))}),lf.structs.set.values(t)},lf.backstore.Page.toPageId=function(e){return e>>lf.backstore.Page.BUNDLE_EXPONENT},lf.backstore.Page.getPageRange=function(e){return[e<<lf.backstore.Page.BUNDLE_EXPONENT,(e+1<<lf.backstore.Page.BUNDLE_EXPONENT)-1]},lf.backstore.Page.prototype.getId=function(){return this.id_},lf.backstore.Page.prototype.setRows=function(e){e.forEach(function(e){this.payload_[e.id()]=e.serialize()},this)},lf.backstore.Page.prototype.removeRows=function(e){e.forEach(function(e){delete this.payload_[e]},this)},lf.backstore.Page.prototype.serialize=function(){return{id:this.id_,value:JSON.stringify(this.payload_)}},lf.backstore.Page.deserialize=function(e){return new lf.backstore.Page(e.id,JSON.parse(e.value))},lf.backstore.BundledObjectStore=function(e,t,r){this.store_=e,this.deserializeFn_=t,this.retrievePageFn_=r},lf.backstore.BundledObjectStore.prototype.get=function(e){if(0==e.length)return this.getAll_();var t=this.deserializeFn_;return this.getPagesByRowIds_(e).then(function(r){return e.map(function(e){var o=r.get(lf.backstore.Page.toPageId(e));return goog.asserts.assert(o,"Containing page is empty"),t(o.payload_[e])})})},lf.backstore.BundledObjectStore.prototype.getPagesByRowIds_=function(e){var t=lf.structs.map.create(),r=goog.Promise.withResolver(),o=lf.backstore.Page.toPageIds(e),n=o.map(function(e){return new goog.Promise(function(r,o){var n;try{n=this.store_.get(e)}catch(i){return void o(i)}n.onerror=o,n.onsuccess=function(e){var o=lf.backstore.Page.deserialize(e.target.result);t.set(o.getId(),o),r()}},this)},this);return goog.Promise.all(n).then(function(){r.resolve(t)}),r.promise},lf.backstore.BundledObjectStore.prototype.getAll_=function(){return new goog.Promise(function(e,t){var r,o=[];try{r=this.store_.openCursor()}catch(n){return void t(n)}r.onerror=t,r.onsuccess=function(){var t=r.result;if(t){var n,i=lf.backstore.Page.deserialize(t.value),s=i.payload_;for(n in s)o.push(this.deserializeFn_(s[n]));t["continue"]()}else e(o)}.bind(this)},this)},lf.backstore.BundledObjectStore.prototype.performWriteOp_=function(e){return new goog.Promise(function(t,r){var o;try{o=e()}catch(n){return void r(n)}o.onsuccess=t,o.onerror=r},this)},lf.backstore.BundledObjectStore.prototype.put=function(e){if(0==e.length)return goog.Promise.resolve();var t=lf.structs.map.create();e.forEach(function(e){var r=lf.backstore.Page.toPageId(e.id()),o=t.get(r)||null;goog.isNull(o)&&(o=this.retrievePageFn_(this.store_.name,r)),o.setRows([e]),t.set(r,o)},this);var r=lf.structs.map.values(t).map(function(e){return this.performWriteOp_(function(){return this.store_.put(e.serialize())}.bind(this))},this);return goog.Promise.all(r)},lf.backstore.BundledObjectStore.prototype.remove=function(e){if(0==e.length)return this.performWriteOp_(function(){return this.store_.clear()}.bind(this));var t=lf.structs.map.create();e.forEach(function(e){var r=lf.backstore.Page.toPageId(e),o=t.get(r)||null;goog.isNull(o)&&(o=this.retrievePageFn_(this.store_.name,r)),o.removeRows([e]),t.set(r,o)},this);var r=lf.structs.map.values(t).map(function(e){return this.performWriteOp_(function(){return 0==Object.keys(e.payload_).length?this.store_["delete"](e.getId()):this.store_.put(e.serialize())}.bind(this))},this);return goog.Promise.all(r)},lf.backstore.BundledObjectStore.getDataTablePage_=function(e,t,r){var o=e.getService(lf.service.CACHE),n=lf.backstore.Page.getPageRange(r),i=o.getRange(t,n[0],n[1]),s=new lf.backstore.Page(r);return s.setRows(i),s},lf.backstore.BundledObjectStore.getIndexTablePage_=function(e,t){return new lf.backstore.Page(t)},lf.backstore.BundledObjectStore.forTableType=function(e,t,r,o){var n=o==lf.backstore.TableType.DATA?goog.partial(lf.backstore.BundledObjectStore.getDataTablePage_,e):lf.backstore.BundledObjectStore.getIndexTablePage_;return new lf.backstore.BundledObjectStore(t,r,n)},lf.index={},lf.index.Favor={RHS:-1,TIE:0,LHS:1},lf.index.Comparator=function(){},lf.index.Index=function(){},lf.cache={},lf.cache.InMemoryUpdater=function(e){this.cache_=e.getService(lf.service.CACHE),this.indexStore_=e.getService(lf.service.INDEX_STORE),this.schema_=e.getService(lf.service.SCHEMA)},lf.cache.InMemoryUpdater.prototype.update=function(e){e.forEach(function(e){this.updateIndicesForDiff_(e),this.updateCacheForDiff_(e)},this)},lf.cache.InMemoryUpdater.prototype.updateCacheForDiff_=function(e){var t=e.getName();e.deleted_.forEach(function(e,r){this.cache_.remove(t,r)},this),e.added_.forEach(function(e){this.cache_.set(t,e)},this),e.modified_.forEach(function(e){this.cache_.set(t,e[1])},this)},lf.cache.InMemoryUpdater.prototype.updateIndicesForDiff_=function(e){var t=this.schema_.table(e.getName()),r=e.getAsModifications();r.forEach(function(e){this.updateTableIndicesForRow(t,e)},this)},lf.cache.InMemoryUpdater.prototype.updateTableIndicesForRow=function(e,t){var r=this.indexStore_.getTableIndices(e.getName()),o=0;r.forEach(function(e){try{this.updateTableIndexForRow_(e,t),o++}catch(n){throw r.slice(0,o).forEach(function(e){this.updateTableIndexForRow_(e,[t[1],t[0]])},this),n}},this)},lf.cache.InMemoryUpdater.prototype.updateTableIndexForRow_=function(e,t){var r=goog.isNull(t[1])?void 0:t[1].keyOfIndex(e.getName()),o=goog.isNull(t[0])?void 0:t[0].keyOfIndex(e.getName());if(!goog.isDef(o)&&goog.isDef(r))e.add(r,t[1].id());else if(goog.isDef(o)&&goog.isDef(r)){if(goog.isNull(r)||goog.isNull(o)){if(r==o)return}else if(e.comparator().compare(o,r)==lf.index.Favor.TIE)return;e.add(r,t[1].id()),e.remove(o,t[0].id())}else goog.isDef(o)&&!goog.isDef(r)&&e.remove(o,t[0].id())},lf.type={},lf.ConstraintAction={},goog.exportSymbol("lf.ConstraintAction",lf.ConstraintAction),lf.ConstraintAction.RESTRICT=0,goog.exportProperty(lf.ConstraintAction,"RESTRICT",lf.ConstraintAction.RESTRICT),lf.ConstraintAction.CASCADE=1,goog.exportProperty(lf.ConstraintAction,"CASCADE",lf.ConstraintAction.CASCADE),lf.ConstraintTiming={},goog.exportSymbol("lf.ConstraintTiming",lf.ConstraintTiming),lf.ConstraintTiming.IMMEDIATE=0,goog.exportProperty(lf.ConstraintTiming,"IMMEDIATE",lf.ConstraintTiming.IMMEDIATE),lf.ConstraintTiming.DEFERRABLE=1,goog.exportProperty(lf.ConstraintTiming,"DEFERRABLE",lf.ConstraintTiming.DEFERRABLE),lf.Order={},goog.exportSymbol("lf.Order",lf.Order),lf.Order.DESC=0,goog.exportProperty(lf.Order,"DESC",lf.Order.DESC),lf.Order.ASC=1,goog.exportProperty(lf.Order,"ASC",lf.Order.ASC),lf.Type={},goog.exportSymbol("lf.Type",lf.Type),lf.Type.ARRAY_BUFFER=0,goog.exportProperty(lf.Type,"ARRAY_BUFFER",lf.Type.ARRAY_BUFFER),lf.Type.BOOLEAN=1,goog.exportProperty(lf.Type,"BOOLEAN",lf.Type.BOOLEAN),lf.Type.DATE_TIME=2,goog.exportProperty(lf.Type,"DATE_TIME",lf.Type.DATE_TIME),lf.Type.INTEGER=3,goog.exportProperty(lf.Type,"INTEGER",lf.Type.INTEGER),lf.Type.NUMBER=4,goog.exportProperty(lf.Type,"NUMBER",lf.Type.NUMBER),lf.Type.STRING=5,goog.exportProperty(lf.Type,"STRING",lf.Type.STRING),lf.Type.OBJECT=6,goog.exportProperty(lf.Type,"OBJECT",lf.Type.OBJECT),lf.type.DEFAULT_VALUES={0:null,1:!1,2:Object.freeze(new Date(0)),3:0,4:0,5:"",6:null},goog.exportSymbol("lf.type.DEFAULT_VALUES",lf.type.DEFAULT_VALUES),lf.Exception=function(e,t){if(this.code=e,this.message="http://google.github.io/lovefield/error_lookup/src/error_lookup.html?c="+e,1<arguments.length)for(var r=1;r<=Math.min(4,arguments.length-1);++r)this.message+="&p"+(r-1)+"="+encodeURIComponent(String(arguments[r]).slice(0,64))},goog.inherits(lf.Exception,Error),lf.structs.MapSet=function(){this.map_=lf.structs.map.create(),this.size=0},lf.structs.MapSet.prototype.has=function(e){return this.map_.has(e)},lf.structs.MapSet.prototype.set=function(e,t){var r=this.map_.get(e)||null;return goog.isNull(r)&&(r=lf.structs.set.create(),this.map_.set(e,r)),r.has(t)||(r.add(t),this.size++),this},lf.structs.MapSet.prototype.setMany=function(e,t){var r=this.map_.get(e)||null;return goog.isNull(r)&&(r=lf.structs.set.create(),this.map_.set(e,r)),t.forEach(function(e){r.has(e)||(r.add(e),this.size++)},this),this},lf.structs.MapSet.prototype.merge=function(e){return e.keys().forEach(function(t){var r=e.get(t);this.setMany(t,r)},this),this},lf.structs.MapSet.prototype["delete"]=function(e,t){var r=this.map_.get(e)||null;if(goog.isNull(r))return!1;var o=r["delete"](t);return o&&(--this.size,0==r.size&&this.map_["delete"](e)),o},lf.structs.MapSet.prototype.get=function(e){var t=this.map_.get(e)||null;return goog.isNull(t)?null:lf.structs.set.values(t)},lf.structs.MapSet.prototype.clear=function(){this.map_.clear(),this.size=0},lf.structs.MapSet.prototype.keys=function(){return lf.structs.map.keys(this.map_)},lf.structs.MapSet.prototype.values=function(){var e=[];return this.map_.forEach(function(t){e.push.apply(e,lf.structs.set.values(t))}),e},lf.cache.ConstraintChecker=function(e){this.indexStore_=e.getService(lf.service.INDEX_STORE),this.schema_=e.getService(lf.service.SCHEMA),this.cache_=e.getService(lf.service.CACHE),this.foreignKeysParentIndices_=null},lf.cache.ConstraintChecker.prototype.findExistingRowIdInPkIndex=function(e,t){var r=e.constraint_.primaryKey_;return goog.isNull(r)?null:this.findExistingRowIdInIndex_(r,t)},lf.cache.ConstraintChecker.prototype.findExistingRowIdInIndex_=function(e,t){var r=e.getNormalizedName(),o=t.keyOfIndex(r),n=this.indexStore_.get(r),i=n.get(o);return 0==i.length?null:i[0]},lf.cache.ConstraintChecker.prototype.checkNotNullable=function(e,t){var r=e.constraint_.notNullable_;t.forEach(function(e){r.forEach(function(t){if(!goog.isDefAndNotNull(e.payload_[t.getName()]))throw new lf.Exception(202,t.getNormalizedName())},this)},this)},lf.cache.ConstraintChecker.prototype.checkReferredKeys_=function(e,t,r){var o=e.constraint_.foreignKeys_;o.forEach(function(e){e.timing==r&&this.checkReferredKey_(e,t)},this)},lf.cache.ConstraintChecker.prototype.checkReferredKey_=function(e,t){var r=this.getParentIndex_(e);t.forEach(function(t){var o=lf.cache.ConstraintChecker.didColumnValueChange_(t[0],t[1],e.name);if(o){var n=t[1],i=n.keyOfIndex(e.name);
if(!goog.isNull(i)&&!r.containsKey(i))throw new lf.Exception(203,e.name)}},this)},lf.cache.ConstraintChecker.prototype.findParentIndex_=function(e){var t=this.schema_.table(e.parentTable),r=t[e.parentColumn],o=r.getIndex();return this.indexStore_.get(o.getNormalizedName())},lf.cache.ConstraintChecker.prototype.getParentIndex_=function(e){goog.isNull(this.foreignKeysParentIndices_)&&(this.foreignKeysParentIndices_=lf.structs.map.create());var t=this.foreignKeysParentIndices_.get(e.name)||null;return goog.isNull(t)&&(t=this.findParentIndex_(e),this.foreignKeysParentIndices_.set(e.name,t)),t},lf.cache.ConstraintChecker.didColumnValueChange_=function(e,t,r){var o=goog.isNull(e)?!goog.isNull(t):goog.isNull(t);return o||e.keyOfIndex(r)!=t.keyOfIndex(r)},lf.cache.ConstraintChecker.prototype.checkReferringKeys_=function(e,t,r,o){var n=this.schema_.info().getReferencingForeignKeys(e.getName(),o);goog.isNull(n)||(n=n.filter(function(e){return e.timing==r}),0!=n.length&&this.loopThroughReferringRows_(n,t,function(e,t,r){if(t.containsKey(r))throw new lf.Exception(203,e.name)}))},lf.cache.ConstraintChecker.prototype.findReferringRowIds_=function(e,t){var r=this.schema_.info().getReferencingForeignKeys(e.getName(),lf.ConstraintAction.CASCADE);if(goog.isNull(r))return null;var o=new lf.structs.MapSet;return this.loopThroughReferringRows_(r,t,function(e,t,r){var n=t.get(r);0<n.length&&o.setMany(e.childTable,n)}),o},lf.cache.ConstraintChecker.prototype.detectCascadeUpdates=function(e,t,r){var o=new lf.structs.MapSet;return this.loopThroughReferringRows_(r,t,function(e,t,r,n){var i=t.get(r);i.forEach(function(t){o.set(t,{fkSpec:e,originalUpdatedRow:n[1]})})}),o},lf.cache.ConstraintChecker.prototype.loopThroughReferringRows_=function(e,t,r){e.forEach(function(e){var o=this.indexStore_.get(e.name),n=this.getParentIndex_(e);t.forEach(function(t){var i=lf.cache.ConstraintChecker.didColumnValueChange_(t[0],t[1],n.getName());if(i){var s=t[0],a=s.keyOfIndex(n.getName());r(e,o,a,t)}},this)},this)},lf.cache.ConstraintChecker.prototype.checkForeignKeysForInsert=function(e,t,r){if(0!=t.length){var o=t.map(function(e){return[null,e]});this.checkReferredKeys_(e,o,r)}},lf.cache.ConstraintChecker.prototype.checkForeignKeysForUpdate=function(e,t,r){0!=t.length&&(this.checkReferredKeys_(e,t,r),this.checkReferringKeys_(e,t,r,lf.ConstraintAction.RESTRICT))},lf.cache.ConstraintChecker.prototype.checkForeignKeysForDelete=function(e,t,r){if(0!=t.length){var o=t.map(function(e){return[e,null]});this.checkReferringKeys_(e,o,r,lf.ConstraintAction.RESTRICT)}},lf.cache.ConstraintChecker.prototype.detectCascadeDeletion=function(e,t){var r={tableOrder:[],rowIdsPerTable:new lf.structs.MapSet},o=new lf.structs.MapSet;o.setMany(e.getName(),t.map(function(e){return e.id()}));do{var n=new lf.structs.MapSet;o.keys().forEach(function(e){var t=this.schema_.table(e),i=o.get(e),s=i.map(function(e){var t=this.cache_.get(e);return[t,null]},this),a=this.findReferringRowIds_(t,s);goog.isNull(a)||(r.tableOrder.unshift.apply(r.tableOrder,a.keys()),n.merge(a))},this),o=n,r.rowIdsPerTable.merge(o)}while(0<o.size);return r},lf.cache.TableDiff=function(e){this.added_=lf.structs.map.create(),this.modified_=lf.structs.map.create(),this.deleted_=lf.structs.map.create(),this.name_=e},lf.cache.TableDiff.prototype.getName=function(){return this.name_},lf.cache.TableDiff.prototype.add=function(e){if(this.deleted_.has(e.id())){var t=[this.deleted_.get(e.id()),e];this.modified_.set(e.id(),t),this.deleted_["delete"](e.id())}else this.added_.set(e.id(),e)},lf.cache.TableDiff.prototype.modify=function(e){var t=e[0],r=e[1];goog.asserts.assert(t.id()==r.id(),"Row ID mismatch between old/new values.");var o=t.id();if(this.added_.has(o))this.added_.set(o,r);else if(this.modified_.has(o)){var n=[this.modified_.get(e[0].id())[0],r];this.modified_.set(o,n)}else this.modified_.set(o,e)},lf.cache.TableDiff.prototype["delete"]=function(e){if(this.added_.has(e.id()))this.added_["delete"](e.id());else if(this.modified_.has(e.id())){var t=this.modified_.get(e.id())[0];this.modified_["delete"](e.id()),this.deleted_.set(e.id(),t)}else this.deleted_.set(e.id(),e)},lf.cache.TableDiff.prototype.merge=function(e){e.added_.forEach(function(e){this.add(e)},this),e.modified_.forEach(function(e){this.modify(e)},this),e.deleted_.forEach(function(e){this["delete"](e)},this)},lf.cache.TableDiff.prototype.getAsModifications=function(){var e=[];return this.added_.forEach(function(t){e.push([null,t])}),this.modified_.forEach(function(t){e.push(t)}),this.deleted_.forEach(function(t){e.push([t,null])}),e},lf.cache.TableDiff.prototype.toString=function(){return"["+lf.structs.map.keys(this.added_).toString()+"], ["+lf.structs.map.keys(this.modified_).toString()+"], ["+lf.structs.map.keys(this.deleted_).toString()+"]"},lf.cache.TableDiff.prototype.getReverse=function(){var e=new lf.cache.TableDiff(this.name_);return this.added_.forEach(function(t){e["delete"](t)}),this.deleted_.forEach(function(t){e.add(t)}),this.modified_.forEach(function(t){e.modify([t[1],t[0]])}),e},lf.cache.TableDiff.prototype.isEmpty=function(){return 0==this.added_.size&&0==this.deleted_.size&&0==this.modified_.size},lf.cache.Journal=function(e,t){this.scope_=lf.structs.map.create(),t.forEach(function(e){this.scope_.set(e.getName(),e)},this),this.schema_=e.getService(lf.service.SCHEMA),this.cache_=e.getService(lf.service.CACHE),this.indexStore_=e.getService(lf.service.INDEX_STORE),this.constraintChecker_=new lf.cache.ConstraintChecker(e),this.inMemoryUpdater_=new lf.cache.InMemoryUpdater(e),this.pendingRollback_=this.terminated_=!1,this.tableDiffs_=lf.structs.map.create()},lf.cache.Journal.prototype.getIndexDiff=function(){var e=lf.structs.map.keys(this.tableDiffs_).map(function(e){return this.scope_.get(e)},this),t=[];return e.forEach(function(e){if(e.persistentIndex()){var r=e.getIndices();r.forEach(function(e){t.push(this.indexStore_.get(e.getNormalizedName()))},this),t.push(this.indexStore_.get(e.getName()+".#"))}},this),t},lf.cache.Journal.prototype.getScope=function(){return this.scope_},lf.cache.Journal.prototype.insert=function(e,t){this.assertJournalWritable_(),this.checkScope_(e),this.constraintChecker_.checkNotNullable(e,t),this.constraintChecker_.checkForeignKeysForInsert(e,t,lf.ConstraintTiming.IMMEDIATE);for(var r=0;r<t.length;r++)this.modifyRow_(e,[null,t[r]])},lf.cache.Journal.prototype.modifyRow_=function(e,t){var r=e.getName(),o=this.tableDiffs_.get(r)||new lf.cache.TableDiff(r);this.tableDiffs_.set(r,o);try{this.inMemoryUpdater_.updateTableIndicesForRow(e,t)}catch(n){throw this.pendingRollback_=!0,n}var i=t[0],s=t[1];goog.isNull(i)&&!goog.isNull(s)?(this.cache_.set(r,s),o.add(s)):goog.isNull(i)||goog.isNull(s)?!goog.isNull(i)&&goog.isNull(s)&&(this.cache_.remove(r,i.id()),o["delete"](i)):(this.cache_.set(r,s),o.modify(t))},lf.cache.Journal.prototype.update=function(e,t){this.assertJournalWritable_(),this.checkScope_(e),this.constraintChecker_.checkNotNullable(e,t);var r=t.map(function(e){var t=this.cache_.get(e.id());return[t,e]},this);this.updateByCascade_(e,r),this.constraintChecker_.checkForeignKeysForUpdate(e,r,lf.ConstraintTiming.IMMEDIATE),r.forEach(function(t){this.modifyRow_(e,t)},this)},lf.cache.Journal.prototype.insertOrReplace=function(e,t){this.assertJournalWritable_(),this.checkScope_(e),this.constraintChecker_.checkNotNullable(e,t);for(var r=0;r<t.length;r++){var o=t[r],n=null,i=this.constraintChecker_.findExistingRowIdInPkIndex(e,o);if(goog.isDefAndNotNull(i)){n=this.cache_.get(i),o.assignRowId(i);var s=[n,o];this.constraintChecker_.checkForeignKeysForUpdate(e,[s],lf.ConstraintTiming.IMMEDIATE)}else this.constraintChecker_.checkForeignKeysForInsert(e,[o],lf.ConstraintTiming.IMMEDIATE);this.modifyRow_(e,[n,o])}},lf.cache.Journal.prototype.remove=function(e,t){this.assertJournalWritable_(),this.checkScope_(e),this.removeByCascade_(e,t),this.constraintChecker_.checkForeignKeysForDelete(e,t,lf.ConstraintTiming.IMMEDIATE);for(var r=0;r<t.length;r++)this.modifyRow_(e,[t[r],null])},lf.cache.Journal.prototype.updateByCascade_=function(e,t){var r=this.schema_.info().getReferencingForeignKeys(e.getName(),lf.ConstraintAction.CASCADE);if(!goog.isNull(r)){var o=this.constraintChecker_.detectCascadeUpdates(e,t,r);o.keys().forEach(function(e){var t=o.get(e);t.forEach(function(t){var r=this.schema_.table(t.fkSpec.childTable),o=this.cache_.get(e),n=r.deserializeRow(o.serialize());n.payload_[t.fkSpec.childColumn]=t.originalUpdatedRow.payload_[t.fkSpec.parentColumn],this.modifyRow_(r,[o,n])},this)},this)}},lf.cache.Journal.prototype.removeByCascade_=function(e,t){var r=this.schema_.info().getReferencingForeignKeys(e.getName(),lf.ConstraintAction.CASCADE);if(!goog.isNull(r)){var o=this.constraintChecker_.detectCascadeDeletion(e,t),n=o.rowIdsPerTable;o.tableOrder.forEach(function(e){var t=this.schema_.table(e),r=n.get(e).map(function(e){return this.cache_.get(e)},this);this.constraintChecker_.checkForeignKeysForDelete(t,r,lf.ConstraintTiming.IMMEDIATE),r.forEach(function(e){this.modifyRow_(t,[e,null])},this)},this)}},lf.cache.Journal.prototype.checkDeferredConstraints=function(){this.tableDiffs_.forEach(function(e){var t=this.scope_.get(e.getName());this.constraintChecker_.checkForeignKeysForInsert(t,lf.structs.map.values(e.added_),lf.ConstraintTiming.DEFERRABLE),this.constraintChecker_.checkForeignKeysForDelete(t,lf.structs.map.values(e.deleted_),lf.ConstraintTiming.DEFERRABLE),this.constraintChecker_.checkForeignKeysForUpdate(t,lf.structs.map.values(e.modified_),lf.ConstraintTiming.DEFERRABLE)},this)},lf.cache.Journal.prototype.commit=function(){this.assertJournalWritable_(),this.terminated_=!0},lf.cache.Journal.prototype.assertJournalWritable_=function(){goog.asserts.assert(!this.pendingRollback_,"Attemptted to use journal that needs to be rolled back."),goog.asserts.assert(!this.terminated_,"Attemptted to commit a terminated journal.")},lf.cache.Journal.prototype.rollback=function(){goog.asserts.assert(!this.terminated_,"Attempted to rollback a terminated journal.");var e=lf.structs.map.values(this.tableDiffs_).map(function(e){return e.getReverse()});this.inMemoryUpdater_.update(e),this.terminated_=!0,this.pendingRollback_=!1},lf.cache.Journal.prototype.checkScope_=function(e){if(!this.scope_.has(e.getName()))throw new lf.Exception(106,e.getName())},lf.index.SingleKeyRange=function(e,t,r,o){this.from=e,this.to=t,this.excludeLower=!lf.index.SingleKeyRange.isUnbound(this.from)&&r,this.excludeUpper=!lf.index.SingleKeyRange.isUnbound(this.to)&&o},lf.index.UnboundKey=function(){},lf.index.SingleKeyRange.UNBOUND_VALUE=new lf.index.UnboundKey,lf.index.SingleKeyRange.isUnbound=function(e){return e==lf.index.SingleKeyRange.UNBOUND_VALUE},lf.index.SingleKeyRange.prototype.toString=function(){return(this.excludeLower?"(":"[")+(lf.index.SingleKeyRange.isUnbound(this.from)?"unbound":this.from)+", "+(lf.index.SingleKeyRange.isUnbound(this.to)?"unbound":this.to)+(this.excludeUpper?")":"]")},lf.index.SingleKeyRange.prototype.complement=function(){if(this.isAll())return[];var e=null,t=null;return lf.index.SingleKeyRange.isUnbound(this.from)||(e=new lf.index.SingleKeyRange(lf.index.SingleKeyRange.UNBOUND_VALUE,this.from,(!1),(!this.excludeLower))),lf.index.SingleKeyRange.isUnbound(this.to)||(t=new lf.index.SingleKeyRange(this.to,lf.index.SingleKeyRange.UNBOUND_VALUE,(!this.excludeUpper),(!1))),[e,t].filter(function(e){return!goog.isNull(e)})},lf.index.SingleKeyRange.prototype.reverse=function(){return new lf.index.SingleKeyRange(this.to,this.from,this.excludeUpper,this.excludeLower)},lf.index.SingleKeyRange.prototype.overlaps=function(e){var t=lf.index.SingleKeyRange.compareKey_(this.from,e.from,!0,this.excludeLower,e.excludeLower);if(t==lf.index.Favor.TIE)return!0;var r=t==lf.index.Favor.RHS?this:e,o=t==lf.index.Favor.LHS?this:e;return lf.index.SingleKeyRange.isUnbound(r.to)||r.to>o.from||r.to==o.from&&!r.excludeUpper&&!o.excludeLower},lf.index.SingleKeyRange.upperBound=function(e,t){return new lf.index.SingleKeyRange(lf.index.SingleKeyRange.UNBOUND_VALUE,e,(!1),t||!1)},lf.index.SingleKeyRange.lowerBound=function(e,t){return new lf.index.SingleKeyRange(e,lf.index.SingleKeyRange.UNBOUND_VALUE,t||!1,(!1))},lf.index.SingleKeyRange.only=function(e){return new lf.index.SingleKeyRange(e,e,(!1),(!1))},lf.index.SingleKeyRange.all=function(){return new lf.index.SingleKeyRange(lf.index.SingleKeyRange.UNBOUND_VALUE,lf.index.SingleKeyRange.UNBOUND_VALUE,(!1),(!1))},lf.index.SingleKeyRange.prototype.isAll=function(){return lf.index.SingleKeyRange.isUnbound(this.from)&&lf.index.SingleKeyRange.isUnbound(this.to)},lf.index.SingleKeyRange.prototype.isOnly=function(){return this.from==this.to&&!lf.index.SingleKeyRange.isUnbound(this.from)&&!this.excludeLower&&!this.excludeUpper},lf.index.SingleKeyRange.prototype.contains=function(e){var t=lf.index.SingleKeyRange.isUnbound(this.from)||e>this.from||e==this.from&&!this.excludeLower,r=lf.index.SingleKeyRange.isUnbound(this.to)||e<this.to||e==this.to&&!this.excludeUpper;return t&&r},lf.index.SingleKeyRange.prototype.equals=function(e){return this.from==e.from&&this.excludeLower==e.excludeLower&&this.to==e.to&&this.excludeUpper==e.excludeUpper},lf.index.SingleKeyRange.xor=function(e,t){return e?!t:t},lf.index.SingleKeyRange.compareKey_=function(e,t,r,o,n){var i=lf.index.Favor,s=o||!1,a=n||!1,l=function(e){return r?e:e==i.LHS?i.RHS:i.LHS},c=function(){return lf.index.SingleKeyRange.xor(s,a)?l(s?i.LHS:i.RHS):i.TIE};return lf.index.SingleKeyRange.isUnbound(e)?lf.index.SingleKeyRange.isUnbound(t)?c():l(i.RHS):lf.index.SingleKeyRange.isUnbound(t)?l(i.LHS):e<t?i.RHS:e==t?c():i.LHS},lf.index.SingleKeyRange.compare=function(e,t){var r=lf.index.SingleKeyRange.compareKey_(e.from,t.from,!0,e.excludeLower,t.excludeLower);return r==lf.index.Favor.TIE&&(r=lf.index.SingleKeyRange.compareKey_(e.to,t.to,!1,e.excludeUpper,t.excludeUpper)),r},lf.index.SingleKeyRange.getBoundingRange=function(e,t){var r=lf.index.SingleKeyRange.all();if(!lf.index.SingleKeyRange.isUnbound(e.from)&&!lf.index.SingleKeyRange.isUnbound(t.from)){var o=lf.index.SingleKeyRange.compareKey_(e.from,t.from,!0);o!=lf.index.Favor.LHS?(r.from=e.from,r.excludeLower=o!=lf.index.Favor.TIE?e.excludeLower:e.excludeLower&&t.excludeLower):(r.from=t.from,r.excludeLower=t.excludeLower)}return lf.index.SingleKeyRange.isUnbound(e.to)||lf.index.SingleKeyRange.isUnbound(t.to)||(o=lf.index.SingleKeyRange.compareKey_(e.to,t.to,!1),o!=lf.index.Favor.RHS?(r.to=e.to,r.excludeUpper=o!=lf.index.Favor.TIE?e.excludeUpper:e.excludeUpper&&t.excludeUpper):(r.to=t.to,r.excludeUpper=t.excludeUpper)),r},lf.index.SingleKeyRange.and=function(e,t){if(!e.overlaps(t))return null;var r=lf.index.SingleKeyRange.all(),o=lf.index.SingleKeyRange.compareKey_(e.from,t.from,!0),n=o==lf.index.Favor.TIE?e.excludeLower?e:t:o!=lf.index.Favor.RHS?e:t;r.from=n.from,r.excludeLower=n.excludeLower;var i;return lf.index.SingleKeyRange.isUnbound(e.to)||lf.index.SingleKeyRange.isUnbound(t.to)?i=lf.index.SingleKeyRange.isUnbound(e.to)?t:e:(o=lf.index.SingleKeyRange.compareKey_(e.to,t.to,!1),i=o==lf.index.Favor.TIE?e.excludeUpper?e:t:o==lf.index.Favor.RHS?e:t),r.to=i.to,r.excludeUpper=i.excludeUpper,r},lf.index.SingleKeyRange.complement=function(e){if(0==e.length)return[];e.sort(lf.index.SingleKeyRange.compare);for(var t=Array(e.length+1),r=0;r<t.length;r++)t[r]=0==r?lf.index.SingleKeyRange.upperBound(e[r].from,!0):r==t.length-1?lf.index.SingleKeyRange.lowerBound(e[r-1].to,!0):new lf.index.SingleKeyRange(e[r-1].to,e[r].from,(!0),(!0));return t},lf.index.SingleKeyRangeSet=function(e){this.ranges_=[],goog.isDef(e)&&this.add(e)},lf.index.SingleKeyRangeSet.prototype.toString=function(){return this.ranges_.map(function(e){return e.toString()}).join(",")},lf.index.SingleKeyRangeSet.prototype.containsKey=function(e){return this.ranges_.some(function(t){return t.contains(e)})},lf.index.SingleKeyRangeSet.prototype.getValues=function(){return this.ranges_},lf.index.SingleKeyRangeSet.prototype.add=function(e){if(0!=e.length){var t=this.ranges_.concat(e);if(1==t.length)this.ranges_=t;else{t.sort(lf.index.SingleKeyRange.compare);for(var r=[],o=t[0],n=1;n<t.length;++n)o.overlaps(t[n])?o=lf.index.SingleKeyRange.getBoundingRange(o,t[n]):(r.push(o),o=t[n]);r.push(o),this.ranges_=r}}},lf.index.SingleKeyRangeSet.prototype.equals=function(e){return this.ranges_.length==e.ranges_.length&&(0==this.ranges_.length||this.ranges_.every(function(t,r){return t.equals(e.ranges_[r])}))},lf.index.SingleKeyRangeSet.prototype.getBoundingRange=function(){if(1>=this.ranges_.length)return 0==this.ranges_.length?null:this.ranges_[0];var e=this.ranges_.length-1;return lf.index.SingleKeyRange.getBoundingRange(this.ranges_[0],this.ranges_[e])},lf.index.SingleKeyRangeSet.intersect=function(e,t){var r=e.getValues().map(function(e){return t.getValues().map(function(t){return lf.index.SingleKeyRange.and(e,t)})}),o=[];return r.forEach(function(e){o=o.concat(e)}),new lf.index.SingleKeyRangeSet(o.filter(function(e){return!goog.isNull(e)}))},lf.proc={},lf.proc.Relation=function(e,t){this.entries=e,this.tables_=lf.structs.set.create(t),this.aggregationResults_=null},lf.proc.Relation.prototype.isCompatible=function(e){return lf.structs.set.equals(this.tables_,e.tables_)},lf.proc.Relation.assertCompatible_=function(e,t){goog.asserts.assert(e.isCompatible(t),"Intersection/union operations only apply to compatible relations.")},lf.proc.Relation.prototype.getTables=function(){return lf.structs.set.values(this.tables_)},lf.proc.Relation.prototype.isPrefixApplied=function(){return 1<this.tables_.size},lf.proc.Relation.prototype.getPayloads=function(){return this.entries.map(function(e){return e.row.payload_})},lf.proc.Relation.prototype.getRowIds=function(){return this.entries.map(function(e){return e.row.id()})},lf.proc.Relation.prototype.setAggregationResult=function(e,t){goog.isNull(this.aggregationResults_)&&(this.aggregationResults_=lf.structs.map.create()),this.aggregationResults_.set(e.getNormalizedName(),t)},lf.proc.Relation.prototype.getAggregationResult=function(e){goog.asserts.assert(!goog.isNull(this.aggregationResults_),"getAggregationResult called before any results have been calculated.");var t=this.aggregationResults_.get(e.getNormalizedName());return goog.asserts.assert(goog.isDef(t),"Could not find result for "+e.getNormalizedName()),t},lf.proc.Relation.prototype.hasAggregationResult=function(e){return!goog.isNull(this.aggregationResults_)&&this.aggregationResults_.has(e.getNormalizedName())},lf.proc.Relation.emptyRelation_=null,lf.proc.Relation.createEmpty=function(){return goog.isNull(lf.proc.Relation.emptyRelation_)&&(lf.proc.Relation.emptyRelation_=new lf.proc.Relation([],[])),lf.proc.Relation.emptyRelation_},lf.proc.Relation.intersect=function(e){if(0==e.length)return lf.proc.Relation.createEmpty();for(var t=e.reduce(function(t,r){return lf.proc.Relation.assertCompatible_(e[0],r),t+r.entries.length},0),r=Array(t),o=0,n=e.map(function(e){var t=lf.structs.map.create();return e.entries.forEach(function(e){r[o++]=e,t.set(e.id,e)}),t}),i=lf.structs.map.create(),s=0;s<r.length;s++){var a=n.every(function(e){return e.has(r[s].id)});a&&i.set(r[s].id,r[s])}return new lf.proc.Relation(lf.structs.map.values(i),lf.structs.set.values(e[0].tables_))},lf.proc.Relation.union=function(e){if(0==e.length)return lf.proc.Relation.createEmpty();var t=lf.structs.map.create();return e.forEach(function(r){lf.proc.Relation.assertCompatible_(e[0],r),r.entries.forEach(function(e){t.set(e.id,e)})}),new lf.proc.Relation(lf.structs.map.values(t),lf.structs.set.values(e[0].tables_))},lf.proc.Relation.fromRows=function(e,t){var r=1<t.length,o=e.map(function(e){return new lf.proc.RelationEntry(e,r)});return new lf.proc.Relation(o,t)},lf.proc.RelationEntry=function(e,t){this.row=e,this.id=lf.proc.RelationEntry.getNextId_(),this.isPrefixApplied_=t},lf.proc.RelationEntry.id_=0,lf.proc.RelationEntry.getNextId_=function(){return lf.proc.RelationEntry.id_++},lf.proc.RelationEntry.prototype.getField=function(e){var t=e.alias_;return!goog.isNull(t)&&this.row.payload_.hasOwnProperty(t)?this.row.payload_[t]:this.isPrefixApplied_?this.row.payload_[e.getTable().getEffectiveName()][e.getName()]:this.row.payload_[e.getName()]},lf.proc.RelationEntry.prototype.setField=function(e,t){var r=e.alias_;if(goog.isDefAndNotNull(r))this.row.payload_[r]=t;else if(this.isPrefixApplied_){var o=e.getTable().getEffectiveName(),n=this.row.payload_[o];goog.isDefAndNotNull(n)||(n={},this.row.payload_[o]=n),n[e.getName()]=t}else this.row.payload_[e.getName()]=t},lf.proc.RelationEntry.combineEntries=function(e,t,r,o){var n={},i=function(e,t){if(e.isPrefixApplied_){var r,o=e.row.payload_;for(r in o)n[r]=o[r]}else goog.asserts.assert(!n.hasOwnProperty(t[0]),"Attempted to join table with itself, without using table alias, or same alias "+t[0]+"is reused for multiple tables."),n[t[0]]=e.row.payload_};i(e,t),i(r,o);var s=new lf.Row(lf.Row.DUMMY_ID,n);return new lf.proc.RelationEntry(s,(!0))},lf.bind=function(e){return new lf.Binder(e)},goog.exportSymbol("lf.bind",lf.bind),lf.Binder=function(e){this.index_=e},goog.exportSymbol("lf.Binder",lf.Binder),lf.Binder.prototype.getIndex=function(){return this.index_},lf.eval={},lf.eval.Type={BETWEEN:"between",EQ:"eq",GTE:"gte",GT:"gt",IN:"in",LTE:"lte",LT:"lt",MATCH:"match",NEQ:"neq"},lf.eval.Registry=function(){this.keyOfIndexConversionMap_=lf.eval.buildKeyOfIndexConversionMap_();var e=lf.eval.buildNumberEvaluatorMap_();this.evalMaps_=lf.structs.map.create(),this.evalMaps_.set(lf.Type.BOOLEAN,lf.eval.buildBooleanEvaluatorMap_()),this.evalMaps_.set(lf.Type.DATE_TIME,lf.eval.buildDateEvaluatorMap_()),this.evalMaps_.set(lf.Type.NUMBER,e),this.evalMaps_.set(lf.Type.INTEGER,e),this.evalMaps_.set(lf.Type.STRING,lf.eval.buildStringEvaluatorMap_()),this.evalMaps_.set(lf.Type.OBJECT,lf.eval.buildObjectEvaluatorMap_())},lf.eval.Registry.get=function(){return goog.isDefAndNotNull(lf.eval.Registry.instance_)||(lf.eval.Registry.instance_=new lf.eval.Registry),lf.eval.Registry.instance_},lf.eval.Registry.prototype.getEvaluator=function(e,t){var r=this.evalMaps_.get(e)||null;if(goog.isNull(r))throw new lf.Exception(550);var o=r.get(t)||null;if(goog.isNull(o))throw new lf.Exception(550);return o},lf.eval.Registry.prototype.getKeyOfIndexEvaluator=function(e){var t=this.keyOfIndexConversionMap_.get(e)||null;return goog.asserts.assert(!goog.isNull(t),"Could not find keyOfIndex evaluation function for "+e),t},lf.eval.buildKeyOfIndexConversionMap_=function(){var e=lf.structs.map.create();e.set(lf.Type.BOOLEAN,function(e){return goog.isNull(e)?null:e?1:0}),e.set(lf.Type.DATE_TIME,function(e){return goog.isNull(e)?null:e.getTime()});var t=function(e){return e};return e.set(lf.Type.INTEGER,t),e.set(lf.Type.NUMBER,t),e.set(lf.Type.STRING,t),e},lf.eval.buildBooleanEvaluatorMap_=function(){var e=lf.structs.map.create();return e.set(lf.eval.Type.EQ,function(e,t){return e==t}),e.set(lf.eval.Type.NEQ,function(e,t){return e!=t}),e},lf.eval.buildCommonEvaluatorMap_=function(){var e=lf.eval.buildBooleanEvaluatorMap_();return e.set(lf.eval.Type.BETWEEN,function(e,t){return!(goog.isNull(e)||goog.isNull(t[0])||goog.isNull(t[1]))&&(e>=t[0]&&e<=t[1])}),e.set(lf.eval.Type.GTE,function(e,t){return!goog.isNull(e)&&!goog.isNull(t)&&e>=t}),e.set(lf.eval.Type.GT,function(e,t){return!goog.isNull(e)&&!goog.isNull(t)&&e>t}),e.set(lf.eval.Type.IN,function(e,t){return-1!=t.indexOf(e)}),e.set(lf.eval.Type.LTE,function(e,t){return!goog.isNull(e)&&!goog.isNull(t)&&e<=t}),e.set(lf.eval.Type.LT,function(e,t){return!goog.isNull(e)&&!goog.isNull(t)&&e<t}),e},lf.eval.buildNumberEvaluatorMap_=function(){return lf.eval.buildCommonEvaluatorMap_()},lf.eval.buildStringEvaluatorMap_=function(){var e=lf.eval.buildCommonEvaluatorMap_();return e.set(lf.eval.Type.MATCH,function(e,t){if(goog.isNull(e)||goog.isNull(t))return!1;var r=new RegExp(t);return r.test(e)}),e},lf.eval.buildObjectEvaluatorMap_=function(){var e=lf.structs.map.create(),t=function(e){if(!goog.isNull(e))throw new lf.Exception(550)};return e.set(lf.eval.Type.EQ,function(e,r){return t(r),goog.isNull(e)}),e.set(lf.eval.Type.NEQ,function(e,r){return t(r),!goog.isNull(e)}),e},lf.eval.buildDateEvaluatorMap_=function(){var e=lf.structs.map.create();return e.set(lf.eval.Type.BETWEEN,function(e,t){return!(goog.isNull(e)||goog.isNull(t[0])||goog.isNull(t[1]))&&(e.getTime()>=t[0].getTime()&&e.getTime()<=t[1].getTime())}),e.set(lf.eval.Type.EQ,function(e,t){var r=goog.isNull(e)?-1:e.getTime(),o=goog.isNull(t)?-1:t.getTime();return r==o}),e.set(lf.eval.Type.GTE,function(e,t){return!goog.isNull(e)&&!goog.isNull(t)&&e.getTime()>=t.getTime()}),e.set(lf.eval.Type.GT,function(e,t){return!goog.isNull(e)&&!goog.isNull(t)&&e.getTime()>t.getTime()}),e.set(lf.eval.Type.IN,function(e,t){return t.some(function(t){return t.getTime()==e.getTime()})}),e.set(lf.eval.Type.LTE,function(e,t){return!goog.isNull(e)&&!goog.isNull(t)&&e.getTime()<=t.getTime()}),e.set(lf.eval.Type.LT,function(e,t){return!goog.isNull(e)&&!goog.isNull(t)&&e.getTime()<t.getTime()}),e.set(lf.eval.Type.NEQ,function(e,t){var r=goog.isNull(e)?-1:e.getTime(),o=goog.isNull(t)?-1:t.getTime();return r!=o}),e},lf.structs.TreeNode=function(){this.children_=this.parent_=null},lf.structs.TreeNode.EMPTY_ARRAY_=[],lf.structs.TreeNode.prototype.getParent=function(){return this.parent_},lf.structs.TreeNode.prototype.setParent=function(e){this.parent_=e},lf.structs.TreeNode.prototype.getRoot=function(){for(var e=this;!goog.isNull(e.getParent());)e=e.getParent();return e},lf.structs.TreeNode.prototype.getDepth=function(){for(var e=0,t=this;!goog.isNull(t.getParent());)e++,t=t.getParent();return e},lf.structs.TreeNode.prototype.isLeaf=function(){return goog.isNull(this.children_)},lf.structs.TreeNode.prototype.getChildren=function(){return this.children_||lf.structs.TreeNode.EMPTY_ARRAY_},lf.structs.TreeNode.prototype.getChildAt=function(e){return this.getChildren()[e]||null},lf.structs.TreeNode.prototype.getChildCount=function(){return this.getChildren().length},lf.structs.TreeNode.prototype.addChildAt=function(e,t){goog.asserts.assert(goog.isNull(e.getParent())),e.setParent(this),goog.isNull(this.children_)?(goog.asserts.assert(0==t),this.children_=[e]):(goog.asserts.assert(0<=t&&t<=this.children_.length),this.children_.splice(t,0,e))},lf.structs.TreeNode.prototype.addChild=function(e){goog.asserts.assert(goog.isNull(e.getParent())),e.setParent(this),goog.isNull(this.children_)?this.children_=[e]:this.children_.push(e)},lf.structs.TreeNode.prototype.removeChildAt=function(e){var t=this.children_&&this.children_[e];return t?(t.setParent(null),this.children_.splice(e,1),0==this.children_.length&&(this.children_=null),t):null},lf.structs.TreeNode.prototype.removeChild=function(e){return this.removeChildAt(this.getChildren().indexOf(e))},lf.structs.TreeNode.prototype.replaceChildAt=function(e,t){goog.asserts.assert(goog.isNull(e.getParent()),"New child must not have parent node");var r=this.getChildAt(t);return goog.asserts.assert(r,"Invalid child index"),r.setParent(null),e.setParent(this),this.children_[t]=e,r},lf.structs.TreeNode.prototype.traverse=function(e,t){!1!==e.call(t,this)&&this.getChildren().forEach(function(r){r.traverse(e,t)})},lf.Predicate=function(){},lf.PredicateProvider=function(){},lf.pred={},lf.pred.PredicateNode=function(){lf.structs.TreeNode.call(this),this.id_=lf.pred.PredicateNode.nextId_++},goog.inherits(lf.pred.PredicateNode,lf.structs.TreeNode),lf.pred.PredicateNode.nextId_=0,lf.pred.PredicateNode.prototype.getId=function(){return this.id_},lf.pred.PredicateNode.prototype.setId=function(e){this.id_=e},lf.pred.ValuePredicate=function(e,t,r){lf.pred.PredicateNode.call(this),this.column=e,this.value=t,this.evaluatorType=r,this.evaluatorFn_=lf.eval.Registry.get().getEvaluator(this.column.getType(),this.evaluatorType),this.isComplement_=!1,this.binder_=t},goog.inherits(lf.pred.ValuePredicate,lf.pred.PredicateNode),lf.pred.ValuePredicate.prototype.copy=function(){var e=new lf.pred.ValuePredicate(this.column,this.value,this.evaluatorType);return e.setBinder(this.binder_),e.setComplement(this.isComplement_),e.setId(this.getId()),e},lf.pred.ValuePredicate.prototype.getColumns=function(e){return goog.isDefAndNotNull(e)?(e.push(this.column),e):[this.column]},lf.pred.ValuePredicate.prototype.getTables=function(e){var t=goog.isDefAndNotNull(e)?e:lf.structs.set.create();return t.add(this.column.getTable()),t},lf.pred.ValuePredicate.prototype.setComplement=function(e){this.isComplement_=e},lf.pred.ValuePredicate.prototype.setBinder=function(e){this.binder_=e},lf.pred.ValuePredicate.prototype.checkBinding_=function(){var e=!1;if(this.value instanceof lf.Binder||(e=!goog.isArray(this.value)||!this.value.some(function(e){return e instanceof lf.Binder})),!e)throw new lf.Exception(501)},lf.pred.ValuePredicate.prototype.eval=function(e){if(this.checkBinding_(),this.evaluatorType==lf.eval.Type.IN)return this.evalAsIn_(e);var t=e.entries.filter(function(e){return this.evaluatorFn_(e.getField(this.column),this.value)!=this.isComplement_},this);return new lf.proc.Relation(t,e.getTables())},lf.pred.ValuePredicate.prototype.bind=function(e){var t=function(t){if(e.length<=t)throw new lf.Exception(510)};if(this.binder_ instanceof lf.Binder){var r=this.binder_.getIndex();t(r),this.value=e[r]}else goog.isArray(this.binder_)&&(this.value=this.binder_.map(function(r){return r instanceof lf.Binder?(t(r.getIndex()),e[r.getIndex()]):r}))},lf.pred.ValuePredicate.prototype.evalAsIn_=function(e){goog.asserts.assert(this.evaluatorType==lf.eval.Type.IN,"ValuePredicate#evalAsIn_() called for wrong predicate type.");var t=lf.structs.set.create(this.value),r=function(e){return!goog.isNull(e)&&t.has(e)!=this.isComplement_}.bind(this),o=e.entries.filter(function(e){return r(e.getField(this.column))},this);return new lf.proc.Relation(o,e.getTables())},lf.pred.ValuePredicate.prototype.toString=function(){return"value_pred("+this.column.getNormalizedName()+" "+this.evaluatorType+(this.isComplement_?"(complement)":"")+" "+this.value+")"},lf.pred.ValuePredicate.prototype.isKeyRangeCompatible=function(){return this.checkBinding_(),!goog.isNull(this.value)&&(this.evaluatorType==lf.eval.Type.BETWEEN||this.evaluatorType==lf.eval.Type.IN||this.evaluatorType==lf.eval.Type.EQ||this.evaluatorType==lf.eval.Type.GT||this.evaluatorType==lf.eval.Type.GTE||this.evaluatorType==lf.eval.Type.LT||this.evaluatorType==lf.eval.Type.LTE)},lf.pred.ValuePredicate.prototype.toKeyRange=function(){goog.asserts.assert(this.isKeyRangeCompatible(),"Could not convert predicate to key range.");var e=null;if(this.evaluatorType==lf.eval.Type.BETWEEN)e=new lf.index.SingleKeyRange(this.getValueAsKey_(this.value[0]),this.getValueAsKey_(this.value[1]),(!1),(!1));else{if(this.evaluatorType==lf.eval.Type.IN){var t=this.value.map(function(e){return lf.index.SingleKeyRange.only(e)});return new lf.index.SingleKeyRangeSet(this.isComplement_?lf.index.SingleKeyRange.complement(t):t)}var r=this.getValueAsKey_(this.value),e=this.evaluatorType==lf.eval.Type.EQ?lf.index.SingleKeyRange.only(r):this.evaluatorType==lf.eval.Type.GTE?lf.index.SingleKeyRange.lowerBound(r):this.evaluatorType==lf.eval.Type.GT?lf.index.SingleKeyRange.lowerBound(r,!0):this.evaluatorType==lf.eval.Type.LTE?lf.index.SingleKeyRange.upperBound(r):lf.index.SingleKeyRange.upperBound(r,!0)}return new lf.index.SingleKeyRangeSet(this.isComplement_?e.complement():[e])},lf.pred.ValuePredicate.prototype.getValueAsKey_=function(e){return this.column.getType()==lf.Type.DATE_TIME?e.getTime():e},lf.query={},lf.query.Context=function(e){this.schema=e,this.clonedFrom=this.predicateMap_=null},lf.query.Context.prototype.getPredicate=function(e){goog.isNull(this.predicateMap_)&&goog.isDefAndNotNull(this.where)&&(this.predicateMap_=lf.query.Context.buildPredicateMap_(this.where));var t=this.predicateMap_.get(e)||null;return goog.asserts.assert(!goog.isNull(t)),t},lf.query.Context.buildPredicateMap_=function(e){var t=lf.structs.map.create();return e.traverse(function(e){
t.set(e.getId(),e)}),t},lf.query.Context.prototype.cloneBase=function(e){e.where&&(this.where=e.where.copy()),this.clonedFrom=e},lf.query.Context.prototype.bind=function(){return goog.asserts.assert(!goog.isDefAndNotNull(this.clonedFrom)),this},lf.query.Context.prototype.bindValuesInSearchCondition=function(e){var t=this.where;goog.isDefAndNotNull(t)&&t.traverse(function(t){t instanceof lf.pred.ValuePredicate&&t.bind(e)})},lf.query.SelectContext=function(e){lf.query.Context.call(this,e)},goog.inherits(lf.query.SelectContext,lf.query.Context),lf.query.SelectContext.orderByToString=function(e){var t="";return e.forEach(function(r,o){t+=r.column.getNormalizedName()+" ",t+=r.order==lf.Order.ASC?"ASC":"DESC",o<e.length-1&&(t+=", ")}),t},lf.query.SelectContext.prototype.getScope=function(){return lf.structs.set.create(this.from)},lf.query.SelectContext.prototype.clone=function(){var e=new lf.query.SelectContext(this.schema);return e.cloneBase(this),this.columns&&(e.columns=this.columns.slice()),this.from&&(e.from=this.from.slice()),e.limit=this.limit,e.skip=this.skip,this.orderBy&&(e.orderBy=this.orderBy.slice()),this.groupBy&&(e.groupBy=this.groupBy.slice()),this.limitBinder&&(e.limitBinder=this.limitBinder),this.skipBinder&&(e.skipBinder=this.skipBinder),e.outerJoinPredicates=this.outerJoinPredicates,e},lf.query.SelectContext.prototype.bind=function(e){return lf.query.SelectContext.superClass_.bind.call(this,e),goog.isDefAndNotNull(this.limitBinder)&&(this.limit=e[this.limitBinder.getIndex()]),goog.isDefAndNotNull(this.skipBinder)&&(this.skip=e[this.skipBinder.getIndex()]),this.bindValuesInSearchCondition(e),this},lf.proc.PhysicalQueryPlan=function(e,t){this.rootNode_=e,this.scope_=t},lf.proc.PhysicalQueryPlan.prototype.getRoot=function(){return this.rootNode_},lf.proc.PhysicalQueryPlan.prototype.getScope=function(){return this.scope_},lf.proc.PhysicalQueryPlan.getCombinedScope=function(e){var t=lf.structs.set.create();return e.forEach(function(e){e.getScope().forEach(t.add.bind(t))}),t},lf.proc.Task=function(){},lf.proc.TaskPriority={EXPORT_TASK:0,IMPORT_TASK:0,OBSERVER_QUERY_TASK:0,EXTERNAL_CHANGE_TASK:1,USER_QUERY_TASK:2,TRANSACTION_TASK:2},lf.proc.QueryTask=function(e,t){this.global=e,this.backStore_=e.getService(lf.service.BACK_STORE),this.queries=t.map(function(e){return e.context}),this.plans_=t.map(function(e){return e.plan}),this.combinedScope_=lf.proc.PhysicalQueryPlan.getCombinedScope(this.plans_),this.txType_=this.detectType_(),this.resolver_=goog.Promise.withResolver()},lf.proc.QueryTask.prototype.detectType_=function(){var e=this.queries.some(function(e){return!(e instanceof lf.query.SelectContext)})?lf.TransactionType.READ_WRITE:lf.TransactionType.READ_ONLY;return e},lf.proc.QueryTask.prototype.exec=function(){var e=this.txType_==lf.TransactionType.READ_ONLY?void 0:new lf.cache.Journal(this.global,this.combinedScope_),t=[],r=this.plans_.slice(),o=this.queries,n=function(){var i=r.shift();if(i){var s=o[t.length];return i.getRoot().exec(e,s).then(function(e){return t.push(e[0]),n()})}return goog.Promise.resolve()};return n().then(function(){return this.tx_=this.backStore_.createTx(this.txType_,lf.structs.set.values(this.combinedScope_),e),this.tx_.commit()}.bind(this)).then(function(){return this.onSuccess(t),t}.bind(this),function(t){throw goog.isDefAndNotNull(e)&&e.rollback(),t})},lf.proc.QueryTask.prototype.getType=function(){return this.txType_},lf.proc.QueryTask.prototype.getScope=function(){return this.combinedScope_},lf.proc.QueryTask.prototype.getId=function(){return goog.getUid(this)},lf.proc.QueryTask.prototype.onSuccess=function(){},lf.proc.QueryTask.prototype.stats=function(){var e=null;return goog.isDefAndNotNull(this.tx_)&&(e=this.tx_.stats()),goog.isNull(e)?lf.TransactionStats.getDefault():e},lf.proc.ObserverQueryTask=function(e,t){lf.proc.QueryTask.call(this,e,t),this.observerRegistry_=e.getService(lf.service.OBSERVER_REGISTRY)},goog.inherits(lf.proc.ObserverQueryTask,lf.proc.QueryTask),lf.proc.ObserverQueryTask.prototype.getPriority=function(){return lf.proc.TaskPriority.OBSERVER_QUERY_TASK},lf.proc.ObserverQueryTask.prototype.onSuccess=function(e){var t=this.queries;t.forEach(function(t,r){this.observerRegistry_.updateResultsForQuery(t,e[r])},this)},lf.proc.ExternalChangeTask=function(e,t){this.global_=e,this.observerRegistry_=e.getService(lf.service.OBSERVER_REGISTRY),this.runner_=e.getService(lf.service.RUNNER),this.inMemoryUpdater_=new lf.cache.InMemoryUpdater(e),this.tableDiffs_=t;var r=e.getService(lf.service.SCHEMA),o=this.tableDiffs_.map(function(e){return r.table(e.getName())});this.scope_=lf.structs.set.create(o),this.resolver_=goog.Promise.withResolver()},lf.proc.ExternalChangeTask.prototype.exec=function(){return this.inMemoryUpdater_.update(this.tableDiffs_),this.scheduleObserverTask_(),goog.Promise.resolve()},lf.proc.ExternalChangeTask.prototype.getType=function(){return lf.TransactionType.READ_WRITE},lf.proc.ExternalChangeTask.prototype.getScope=function(){return this.scope_},lf.proc.ExternalChangeTask.prototype.getId=function(){return goog.getUid(this)},lf.proc.ExternalChangeTask.prototype.getPriority=function(){return lf.proc.TaskPriority.EXTERNAL_CHANGE_TASK},lf.proc.ExternalChangeTask.prototype.scheduleObserverTask_=function(){var e=this.observerRegistry_.getTaskItemsForTables(this.scope_);if(0!=e.length){var t=new lf.proc.ObserverQueryTask(this.global_,e);this.runner_.scheduleTask(t)}},lf.backstore.ExternalChangeObserver=function(e){this.global_=e,this.backStore_=e.getService(lf.service.BACK_STORE),this.runner_=e.getService(lf.service.RUNNER)},lf.backstore.ExternalChangeObserver.prototype.startObserving=function(){this.backStore_.subscribe(this.onChange_.bind(this))},lf.backstore.ExternalChangeObserver.prototype.onChange_=function(e){var t=new lf.proc.ExternalChangeTask(this.global_,e);this.runner_.scheduleTask(t)},lf.BackStore=function(){},lf.raw={},lf.raw.BackStore=function(){},lf.backstore.FirebaseRawBackStore=function(e,t){this.version_=e,this.db_=t,this.tableIds_=lf.structs.map.create()},goog.exportSymbol("lf.backstore.FirebaseRawBackStore",lf.backstore.FirebaseRawBackStore),lf.backstore.FirebaseRawBackStore.prototype.getRawDBInstance=function(){return this.db_},lf.backstore.FirebaseRawBackStore.prototype.getRawTransaction=function(){throw new lf.Exception(351)},lf.backstore.FirebaseRawBackStore.getValue=function(e,t){var r=goog.Promise.withResolver(),o=e;return t.length&&(o=e.child(t)),o.once("value",function(e){r.resolve(e.val())},function(e){r.reject(e)}),r.promise},lf.backstore.FirebaseRawBackStore.setValue=function(e,t,r){var o=r||!1,n=goog.Promise.withResolver(),i=function(e){e?n.reject(e):n.resolve()};return o?e.set(t,i):e.update(t,i),n.promise},lf.backstore.FirebaseRawBackStore.prototype.init=function(e){return lf.backstore.FirebaseRawBackStore.getValue(this.db_,"@rev/R").then(function(e){return this.revision_=e,lf.backstore.FirebaseRawBackStore.getValue(this.db_,"@table")}.bind(this)).then(function(t){var r,o=0;for(r in t)this.tableIds_.set(r,t[r]),t[r]>o&&(o=t[r]);e.tables().forEach(function(e){this.tableIds_.has(e.getName())||(t[e.getName()]=++o)},this);var n=this.db_.child("@table");return lf.backstore.FirebaseRawBackStore.setValue(n,t)}.bind(this))},lf.backstore.FirebaseRawBackStore.prototype.transform_=function(e,t){var r=this.tableIds_.get(e);if(!goog.isDefAndNotNull(r))return goog.Promise.resolve();var o=function(){var e={},o=goog.Promise.withResolver();return this.db_.orderByChild("T").equalTo(r).once("value",function(r){r.forEach(function(r){var o=t(r.val());e[parseInt(r.key(),10)]=o}),o.resolve(e)}),o.promise}.bind(this);return o().then(function(e){return e["@rev"]={R:++this.revision_},lf.backstore.FirebaseRawBackStore.setValue(this.db_,e)}.bind(this))},lf.backstore.FirebaseRawBackStore.prototype.dropTable=function(e){return this.transform_(e,function(){return null}).then(function(){return this.tableIds_["delete"](e),lf.backstore.FirebaseRawBackStore.setValue(this.db_.child("@table/"+e),null,!0)}.bind(this))},goog.exportProperty(lf.backstore.FirebaseRawBackStore.prototype,"dropTable",lf.backstore.FirebaseRawBackStore.prototype.dropTable),lf.backstore.FirebaseRawBackStore.prototype.addTableColumn=function(e,t,r){return this.transform_(e,function(e){var o=e.P;return o[t]=r,{R:this.revision_+1,T:e.T,P:o}}.bind(this))},goog.exportProperty(lf.backstore.FirebaseRawBackStore.prototype,"addTableColumn",lf.backstore.FirebaseRawBackStore.prototype.addTableColumn),lf.backstore.FirebaseRawBackStore.prototype.dropTableColumn=function(e,t){return this.transform_(e,function(e){var r=e.P;return delete r[t],{R:this.revision_+1,T:e.T,P:r}}.bind(this))},goog.exportProperty(lf.backstore.FirebaseRawBackStore.prototype,"dropTableColumn",lf.backstore.FirebaseRawBackStore.prototype.dropTableColumn),lf.backstore.FirebaseRawBackStore.prototype.renameTableColumn=function(e,t,r){return this.transform_(e,function(e){var o=e.P;return o[r]=o[t],delete o[t],{R:this.revision_+1,T:e.T,P:o}}.bind(this))},goog.exportProperty(lf.backstore.FirebaseRawBackStore.prototype,"renameTableColumn",lf.backstore.FirebaseRawBackStore.prototype.renameTableColumn),lf.backstore.FirebaseRawBackStore.prototype.createRow=function(){throw new lf.Exception(351)},goog.exportProperty(lf.backstore.FirebaseRawBackStore.prototype,"createRow",lf.backstore.FirebaseRawBackStore.prototype.createRow),lf.backstore.FirebaseRawBackStore.prototype.getVersion=function(){return this.version_},goog.exportProperty(lf.backstore.FirebaseRawBackStore.prototype,"getVersion",lf.backstore.FirebaseRawBackStore.prototype.getVersion),lf.backstore.FirebaseRawBackStore.prototype.dumpTable_=function(e){var t=goog.Promise.withResolver(),r=this.tableIds_.get(e);return this.db_.orderByChild("T").equalTo(r).once("value",function(e){var r=[];e.forEach(function(e){r.push(e.val().P)}),t.resolve(r)}),t.promise},lf.backstore.FirebaseRawBackStore.prototype.dump=function(){var e={},t=lf.structs.map.keys(this.tableIds_).map(function(t){return this.dumpTable_(t).then(function(r){e[t]=r})}.bind(this));return goog.Promise.all(t).then(function(){return e})},goog.exportProperty(lf.backstore.FirebaseRawBackStore.prototype,"dump",lf.backstore.FirebaseRawBackStore.prototype.dump),lf.backstore.FirebaseTx=function(e,t,r){lf.backstore.BaseTx.call(this,t,r),this.db_=e},goog.inherits(lf.backstore.FirebaseTx,lf.backstore.BaseTx),lf.backstore.FirebaseTx.prototype.getTable=function(e){return this.db_.getTableInternal(e)},lf.backstore.FirebaseTx.prototype.commitInternal=function(){if(this.txType==lf.TransactionType.READ_ONLY)return this.resolver.resolve(),this.resolver.promise;var e=this.journal_.tableDiffs_,t=e.size;if(0==t)this.resolver.resolve();else{var r=this.db_.revision_+1;this.db_.setRevision(r);var o={"@rev":{R:r}};e.forEach(function(e,t){var n=this.db_.getTableId(t);e.added_.forEach(function(e,t){o[t]={R:r,T:n,P:e.payload_}}),e.modified_.forEach(function(e,t){o[t]={R:r,T:n,P:e[1].payload_}}),e.deleted_.forEach(function(e,t){o[t]=null})},this),this.db_.db_.update(o,function(t){if(goog.isNull(t))this.resolver.resolve();else{this.db_.setRevision(r-1);var o=lf.structs.map.values(e).map(function(e){return this.db_.reloadTable(e.getName())},this);goog.Promise.all(o).then(this.resolver.reject.bind(this.resolver),this.resolver.reject.bind(this.resolver))}}.bind(this))}return this.resolver.promise},lf.backstore.MemoryTable=function(){this.data_=lf.structs.map.create()},lf.backstore.MemoryTable.prototype.getSync=function(e){if(0==e.length)return lf.structs.map.values(this.data_);var t=[];return e.forEach(function(e){var r=this.data_.get(e)||null;goog.isNull(r)||t.push(r)},this),t},lf.backstore.MemoryTable.prototype.getData=function(){return this.data_},lf.backstore.MemoryTable.prototype.get=function(e){return goog.Promise.resolve(this.getSync(e))},lf.backstore.MemoryTable.prototype.putSync=function(e){e.forEach(function(e){this.data_.set(e.id(),e)},this)},lf.backstore.MemoryTable.prototype.put=function(e){return this.putSync(e),goog.Promise.resolve()},lf.backstore.MemoryTable.prototype.removeSync=function(e){0==e.length||e.length==this.data_.size?this.data_.clear():e.forEach(function(e){this.data_["delete"](e)},this)},lf.backstore.MemoryTable.prototype.remove=function(e){return this.removeSync(e),goog.Promise.resolve()},lf.backstore.MemoryTable.prototype.getMaxRowId=function(){return 0==this.data_.size?0:lf.structs.map.keys(this.data_).reduce(function(e,t){return e>t?e:t},0)},lf.backstore.Firebase=function(e,t){this.schema_=e,this.app_=t,this.removedRows_=lf.structs.map.create(),this.revision_=-1,this.tables_=lf.structs.map.create(),this.tableIds_=lf.structs.map.create(),this.changeHandler_=null},lf.backstore.Firebase.prototype.setRevision=function(e){this.revision_=e},lf.backstore.Firebase.prototype.init=function(e){this.db_=this.app_.child(this.schema_.name());var t=lf.backstore.FirebaseRawBackStore.getValue,r=e||function(){return goog.Promise.resolve()};return t(this.db_,"@db/version").then(function(e){return goog.isNull(e)?lf.backstore.FirebaseRawBackStore.setValue(this.db_,this.createNewDb_(),!0).then(function(){var e=new lf.backstore.FirebaseRawBackStore(0,this.db_);return r(e)}.bind(this)).then(function(){return this.init()}.bind(this)):e==this.schema_.version()?t(this.db_,"@rev/R").then(function(e){return this.revision_=e,t(this.db_,"@table")}.bind(this)).then(function(e){for(var t in e)this.tableIds_.set(t,e[t]);var r=this.schema_.tables().map(function(e){return this.reloadTable(e.getName())},this);return goog.Promise.all(r)}.bind(this)).then(function(){return this.initRowId_(),this.listen_(),goog.Promise.resolve()}.bind(this)):this.onUpgrade_(e,r).then(function(){return this.init()}.bind(this))}.bind(this))},lf.backstore.Firebase.prototype.onUpgrade_=function(e,t){var r=new lf.backstore.FirebaseRawBackStore(e,this.db_);return r.init(this.schema_).then(function(){return this.updateIndexTables_()}.bind(this)).then(function(){return t(r)}).then(function(){var e=this.db_.child("@db");return lf.backstore.FirebaseRawBackStore.setValue(e,{version:this.schema_.version()},!0)}.bind(this))},lf.backstore.Firebase.prototype.updateIndexTables_=function(){return goog.Promise.resolve()},lf.backstore.Firebase.prototype.listen_=function(){this.db_.off(),this.db_.on("child_removed",this.onRemoved_.bind(this)),this.change_&&(this.change_.off(),this.removedRows_.clear()),this.change_=this.db_.orderByChild("R").startAt(this.revision_+1),this.change_.on("value",this.onChange_.bind(this))},lf.backstore.Firebase.prototype.initRowId_=function(){var e=lf.structs.map.values(this.tables_).map(function(e){return e.getMaxRowId()}).reduce(function(e,t){return e>t?e:t},0);lf.Row.setNextId(e+1)},lf.backstore.Firebase.prototype.onRemoved_=function(e){var t=e.val(),r=this.removedRows_.get(t.T)||null;goog.isNull(r)&&(r=lf.structs.set.create(),this.removedRows_.set(t.T,r)),r.add(parseInt(e.key(),10))},lf.backstore.Firebase.prototype.onChange_=function(e){var t=e.child("@rev/R").val();if(goog.isDefAndNotNull(t)&&t!=this.revision_){this.revision_=t;var r=this.generateDiff_(e);r.forEach(function(e){var t=this.tables_.get(e.getName()),r=lf.structs.map.keys(e.deleted_);0<r.length&&t.removeSync(r);var o=lf.structs.map.values(e.added_);e.modified_.forEach(function(e){o.push(e[1])}),t.putSync(o)},this),0<r.length&&this.notify(r),this.listen_()}},lf.backstore.Firebase.prototype.generateDiff_=function(e){var t=lf.structs.set.create(),r=lf.structs.map.create();return this.tableIds_.forEach(function(e,o){var n=this.tables_.get(o),i=new lf.cache.TableDiff(o);if(this.removedRows_.has(e)){var s=lf.structs.set.values(this.removedRows_.get(e));s.forEach(function(e){t.add(e)}),n.getSync(s).forEach(function(e){i["delete"](e)})}r.set(e,i)}.bind(this)),e.forEach(function(e){if("@rev"!=e.key()){var o=parseInt(e.key(),10);if(!t.has(o)){var n=e.val(),i=r.get(n.T),s=this.tables_.get(i.getName()),a=this.schema_.table(i.getName()),l=a.deserializeRow({id:o,value:n.P});s.getData().has(o)?i.modify([s.getSync([o])[0],l]):i.add(l)}}}.bind(this)),lf.structs.map.values(r).filter(function(e){return!e.isEmpty()})},lf.backstore.Firebase.prototype.reloadTable=function(e){var t=goog.Promise.withResolver(),r=this.getTableId(e),o=this.schema_.table(e);return this.db_.orderByChild("T").equalTo(r).once("value",function(r){var n=new lf.backstore.MemoryTable,i=[];r.forEach(function(e){i.push(o.deserializeRow({id:parseInt(e.key(),10),value:e.val().P}))}),n.putSync(i),this.tables_.set(e,n),t.resolve()}.bind(this)),t.promise},lf.backstore.Firebase.prototype.getTableId=function(e){return this.tableIds_.get(e)},lf.backstore.Firebase.prototype.createNewDb_=function(){var e={};return e["@db"]={version:this.schema_.version()},e["@rev"]={R:1},this.revision_=1,e["@table"]={},this.schema_.tables().forEach(function(t,r){var o=t.getName();e["@table"][o]=r,this.tables_.set(o,new lf.backstore.MemoryTable),this.tableIds_.set(o,r)},this),e},lf.backstore.Firebase.prototype.createTx=function(e,t,r){return new lf.backstore.FirebaseTx(this,e,r)},lf.backstore.Firebase.prototype.getTableInternal=function(e){var t=this.tables_.get(e)||null;if(!goog.isNull(t))return t;throw new lf.Exception(101,e)},lf.backstore.Firebase.prototype.close=function(){},lf.backstore.Firebase.prototype.subscribe=function(e){this.changeHandler_=e},lf.backstore.Firebase.prototype.notify=function(e){goog.isDefAndNotNull(this.changeHandler_)&&this.changeHandler_(e)},lf.backstore.IndexedDBRawBackStore=function(e,t,r,o){this.db_=t,this.tx_=r,this.version_=e,this.bundleMode_=o},goog.exportSymbol("lf.backstore.IndexedDBRawBackStore",lf.backstore.IndexedDBRawBackStore),lf.backstore.IndexedDBRawBackStore.prototype.getRawDBInstance=function(){return this.db_},goog.exportProperty(lf.backstore.IndexedDBRawBackStore.prototype,"getRawDBInstance",lf.backstore.IndexedDBRawBackStore.prototype.getRawDBInstance),lf.backstore.IndexedDBRawBackStore.prototype.getRawTransaction=function(){return this.tx_},goog.exportProperty(lf.backstore.IndexedDBRawBackStore.prototype,"getRawTransaction",lf.backstore.IndexedDBRawBackStore.prototype.getRawTransaction),lf.backstore.IndexedDBRawBackStore.prototype.dropTable=function(e){return new goog.Promise(function(t,r){try{this.db_.deleteObjectStore(e)}catch(o){return void r(o)}t()},this)},goog.exportProperty(lf.backstore.IndexedDBRawBackStore.prototype,"dropTable",lf.backstore.IndexedDBRawBackStore.prototype.dropTable),lf.backstore.IndexedDBRawBackStore.prototype.openCursorForWrite_=function(e,t,r){return new goog.Promise(function(o,n){var i;try{var s=this.tx_.objectStore(e);i=s.openCursor()}catch(a){return void n(a)}i.onsuccess=function(){var e=i.result;e?(t(e),e["continue"]()):(r(s),o())},i.onerror=n},this)},lf.backstore.IndexedDBRawBackStore.convert=function(e){var t;return t=e instanceof ArrayBuffer?lf.Row.binToHex(e):e instanceof Date?e.getTime():e},lf.backstore.IndexedDBRawBackStore.prototype.transformRows_=function(e,t){var r=function(e){var r=lf.Row.deserialize(e.value);t(r),e.update(r.serialize())},o=function(e){var r,o=lf.backstore.Page.deserialize(e.value),n=o.payload_;for(r in n){var i=lf.Row.deserialize(n[r]);t(i),n[r]=i.serialize()}e.update(o.serialize())},n=function(){};return this.openCursorForWrite_(e,this.bundleMode_?o:r,n)},lf.backstore.IndexedDBRawBackStore.prototype.addTableColumn=function(e,t,r){var o=lf.backstore.IndexedDBRawBackStore.convert(r);return this.transformRows_(e,function(e){e.payload_[t]=o})},goog.exportProperty(lf.backstore.IndexedDBRawBackStore.prototype,"addTableColumn",lf.backstore.IndexedDBRawBackStore.prototype.addTableColumn),lf.backstore.IndexedDBRawBackStore.prototype.dropTableColumn=function(e,t){return this.transformRows_(e,function(e){delete e.payload_[t]})},goog.exportProperty(lf.backstore.IndexedDBRawBackStore.prototype,"dropTableColumn",lf.backstore.IndexedDBRawBackStore.prototype.dropTableColumn),lf.backstore.IndexedDBRawBackStore.prototype.renameTableColumn=function(e,t,r){return this.transformRows_(e,function(e){e.payload_[r]=e.payload_[t],delete e.payload_[t]})},goog.exportProperty(lf.backstore.IndexedDBRawBackStore.prototype,"renameTableColumn",lf.backstore.IndexedDBRawBackStore.prototype.renameTableColumn),lf.backstore.IndexedDBRawBackStore.prototype.getTableRows_=function(e){var t=[];return new goog.Promise(function(r,o){var n;try{n=this.tx_.objectStore(e).openCursor()}catch(i){return void o(i)}n.onsuccess=function(){var e=n.result;if(e){if(this.bundleMode_){var o,i=lf.backstore.Page.deserialize(e.value),s=i.payload_;for(o in s)t.push(s[o])}else t.push(e.value);e["continue"]()}else r(t)}.bind(this),n.onerror=o},this)},lf.backstore.IndexedDBRawBackStore.prototype.createRow=function(e){var t,r={};for(t in e)r[t]=lf.backstore.IndexedDBRawBackStore.convert(e[t]);return lf.Row.create(r)},goog.exportProperty(lf.backstore.IndexedDBRawBackStore.prototype,"createRow",lf.backstore.IndexedDBRawBackStore.prototype.createRow),lf.backstore.IndexedDBRawBackStore.prototype.getVersion=function(){return this.version_},goog.exportProperty(lf.backstore.IndexedDBRawBackStore.prototype,"getVersion",lf.backstore.IndexedDBRawBackStore.prototype.getVersion),lf.backstore.IndexedDBRawBackStore.prototype.dump=function(){for(var e=this.db_.objectStoreNames,t=[],r=0;r<e.length;++r){var o=e.item(r);t.push(this.dumpTable_(o))}return goog.Promise.all(t).then(function(t){var r={};return t.forEach(function(t,o){r[e.item(o)]=t}),r})},goog.exportProperty(lf.backstore.IndexedDBRawBackStore.prototype,"dump",lf.backstore.IndexedDBRawBackStore.prototype.dump),lf.backstore.IndexedDBRawBackStore.prototype.dumpTable_=function(e){return this.getTableRows_(e).then(function(e){return e.map(function(e){return e.value})})},lf.backstore.ObjectStore=function(e,t){this.store_=e,this.deserializeFn_=t},lf.backstore.ObjectStore.prototype.get=function(e){if(0==e.length)return goog.isDefAndNotNull(this.store_.getAll)?this.getAllBulk_():this.getAllWithCursor_();var t=e.map(function(e){return new goog.Promise(function(t,r){var o;try{o=this.store_.get(e)}catch(n){return void r(n)}o.onerror=r,o.onsuccess=function(e){t(this.deserializeFn_(e.target.result))}.bind(this)},this)},this);return goog.Promise.all(t)},lf.backstore.ObjectStore.prototype.getAllWithCursor_=function(){return new goog.Promise(function(e,t){var r,o=[];try{r=this.store_.openCursor()}catch(n){return void t(n)}r.onerror=t,r.onsuccess=function(){var t=r.result;t?(o.push(this.deserializeFn_(t.value)),t["continue"]()):e(o)}.bind(this)},this)},lf.backstore.ObjectStore.prototype.getAllBulk_=function(){return new goog.Promise(function(e,t){var r;try{r=this.store_.getAll()}catch(o){return void t(o)}r.onerror=t,r.onsuccess=function(){var t=r.result.map(function(e){return this.deserializeFn_(e)},this);e(t)}.bind(this)},this)},lf.backstore.ObjectStore.prototype.performWriteOp_=function(e){return new goog.Promise(function(t,r){var o;try{o=e()}catch(n){return void r(n)}o.onsuccess=t,o.onerror=r},this)},lf.backstore.ObjectStore.prototype.put=function(e){if(0==e.length)return goog.Promise.resolve();var t=e.map(function(e){return this.performWriteOp_(function(){return this.store_.put(e.serialize())}.bind(this))},this);return goog.Promise.all(t)},lf.backstore.ObjectStore.prototype.remove=function(e){return new goog.Promise(function(t,r){var o=this.store_.count();o.onsuccess=function(o){if(0==e.length||o.target.result==e.length)return this.performWriteOp_(function(){return this.store_.clear()}.bind(this)).then(t,r);var n=e.map(function(e){return this.performWriteOp_(function(){return this.store_["delete"](e)}.bind(this))},this);goog.Promise.all(n).then(t,r)}.bind(this),o.onerror=r},this)},lf.backstore.IndexedDBTx=function(e,t,r,o,n){lf.backstore.BaseTx.call(this,r,n),this.global_=e,this.tx_=t,this.bundleMode_=o,this.tx_.oncomplete=this.resolver.resolve.bind(this.resolver),this.tx_.onabort=this.resolver.reject.bind(this.resolver)},goog.inherits(lf.backstore.IndexedDBTx,lf.backstore.BaseTx),lf.backstore.IndexedDBTx.prototype.getTable=function(e,t,r){if(this.bundleMode_){var o=goog.isDefAndNotNull(r)?r:lf.backstore.TableType.DATA;return lf.backstore.BundledObjectStore.forTableType(this.global_,this.tx_.objectStore(e),t,o)}return new lf.backstore.ObjectStore(this.tx_.objectStore(e),t)},lf.backstore.IndexedDBTx.prototype.commitInternal=function(){return this.resolver.promise},lf.backstore.IndexedDB=function(e,t){this.global_=e,this.schema_=t,this.bundledMode_=t.pragma_.enableBundledMode||!1},lf.backstore.IndexedDB.prototype.init=function(e){var t=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(!goog.isDefAndNotNull(t))throw new lf.Exception(352);var r=e||function(){return goog.Promise.resolve()};return new goog.Promise(function(e,o){var n;try{n=t.open(this.schema_.name(),this.schema_.version())}catch(i){return void o(i)}n.onerror=function(e){var t=e.target.error;o(new lf.Exception(361,t.name,t.message))},n.onupgradeneeded=function(e){this.onUpgradeNeeded_(r,e).then(function(){},o)}.bind(this),n.onsuccess=function(t){this.db_=t.target.result,this.scanRowId_().then(function(t){lf.Row.setNextId(t+1),e(this.db_)}.bind(this))}.bind(this)},this)},lf.backstore.IndexedDB.prototype.onUpgradeNeeded_=function(e,t){var r=t.target.result,o=t.target.transaction,n=new lf.backstore.IndexedDBRawBackStore(t.oldVersion,r,o,this.bundledMode_);return this.removeIndexTables_(r,o),this.createTables_(r),e(n)},lf.backstore.IndexedDB.prototype.removeIndexTables_=function(e){for(var t=[],r=0;r<e.objectStoreNames.length;++r){var o=e.objectStoreNames.item(r);-1!=o.indexOf(".")&&t.push(o)}t.forEach(function(t){try{e.deleteObjectStore(t)}catch(r){}})},lf.backstore.IndexedDB.prototype.createTables_=function(e){this.schema_.tables().forEach(goog.partial(this.createObjectStoresForTable_,e),this)},lf.backstore.IndexedDB.prototype.createObjectStoresForTable_=function(e,t){if(e.objectStoreNames.contains(t.getName())||e.createObjectStore(t.getName(),{keyPath:"id"}),t.persistentIndex()){var r=t.getIndices();r.forEach(function(t){this.createIndexTable_(e,t.getNormalizedName())},this),this.createIndexTable_(e,t.getRowIdIndexName())}},lf.backstore.IndexedDB.prototype.createIndexTable_=function(e,t){e.objectStoreNames.contains(t)||e.createObjectStore(t,{keyPath:"id"})},lf.backstore.IndexedDB.prototype.createTx=function(e,t,r){var o=this.db_.transaction(lf.backstore.IndexedDB.getIndexedDBScope_(t),e==lf.TransactionType.READ_ONLY?"readonly":"readwrite");return new lf.backstore.IndexedDBTx(this.global_,o,e,this.bundledMode_,r)},lf.backstore.IndexedDB.getIndexedDBScope_=function(e){var t=lf.structs.set.create();return e.forEach(function(e){if(t.add(e.getName()),e.persistentIndex()){var r=e.getIndices();r.forEach(function(e){t.add(e.getNormalizedName())}),t.add(e.getRowIdIndexName())}}),lf.structs.set.values(t)},lf.backstore.IndexedDB.prototype.scanRowId_=function(e){var t=this.schema_.tables().map(function(e){return e.getName()}),r=this.db_,o=0,n=function(e){if(this.bundledMode_){var t=lf.backstore.Page.deserialize(e.value);return Object.keys(t.payload_).reduce(function(e,t){return Math.max(e,t)},0)}return e.key}.bind(this),i=function(t){return new goog.Promise(function(i,s){var a;try{var l=e||r.transaction([t]);a=l.objectStore(t).openCursor(null,"prev")}catch(c){return void s(c)}a.onsuccess=function(e){var t=e.target.result;t&&(o=Math.max(o,n(t))),i(o)},a.onerror=function(){i(o)}})},s=function(){if(0==t.length)return goog.Promise.resolve();var e=t.shift();return i(e).then(s)};return new goog.Promise(function(e){s().then(function(){e(o)})})},lf.backstore.IndexedDB.prototype.close=function(){this.db_.close()},lf.backstore.IndexedDB.prototype.getTableInternal=function(){throw new lf.Exception(511)},lf.backstore.IndexedDB.prototype.subscribe=function(){},lf.backstore.IndexedDB.prototype.notify=function(){},lf.backstore.LocalStorageTable=function(e){this.key_=e,this.data_={};var t=window.localStorage.getItem(e);goog.isDefAndNotNull(t)&&(this.data_=JSON.parse(t))},lf.backstore.LocalStorageTable.prototype.get=function(e){var t;return 0==e.length?t=Object.keys(this.data_).map(function(e){var t=parseInt(e,10);return new lf.Row(t,this.data_[e])},this):(t=[],e.forEach(function(e){this.data_.hasOwnProperty(e.toString())&&t.push(new lf.Row(e,this.data_[e.toString()]))},this)),goog.Promise.resolve(t)},lf.backstore.LocalStorageTable.prototype.put=function(e){return e.forEach(function(e){this.data_[e.id().toString()]=e.payload_},this),goog.Promise.resolve()},lf.backstore.LocalStorageTable.prototype.remove=function(e){return 0==e.length||e.length==Object.keys(this.data_).length?this.data_={}:e.forEach(function(e){delete this.data_[e]},this),goog.Promise.resolve()},lf.backstore.LocalStorageTable.prototype.commit=function(){window.localStorage.setItem(this.key_,JSON.stringify(this.data_))},lf.backstore.LocalStorageTable.prototype.diff=function(e){var t=Object.keys(this.data_),r=Object.keys(e),o=new lf.cache.TableDiff(this.key_);return r.forEach(function(t){var r=parseInt(t,10);this.data_.hasOwnProperty(t)?JSON.stringify(this.data_[t])!=JSON.stringify(e[t])&&o.modify([new lf.Row(r,this.data_[t]),new lf.Row(r,e[t])]):o.add(new lf.Row(r,e[t]))},this),t.filter(function(t){return!e.hasOwnProperty(t)},this).forEach(function(e){o["delete"](new lf.Row(parseInt(e,10),this.data_[e]))},this),o},lf.backstore.LocalStorageTx=function(e,t,r){lf.backstore.BaseTx.call(this,t,r),this.store_=e,t==lf.TransactionType.READ_ONLY&&this.resolver.resolve()},goog.inherits(lf.backstore.LocalStorageTx,lf.backstore.BaseTx),lf.backstore.LocalStorageTx.prototype.getTable=function(e){return this.store_.getTableInternal(e)},lf.backstore.LocalStorageTx.prototype.commitInternal=function(){return this.store_.commit(),this.resolver.resolve(),this.resolver.promise},lf.backstore.LocalStorage=function(e){this.schema_=e,this.tables_=lf.structs.map.create(),this.listener_=this.changeHandler_=null},lf.backstore.LocalStorage.prototype.initSync=function(){if(!window.localStorage)throw new lf.Exception(359);var e=this.schema_.name()+".version#",t=window.localStorage.getItem(e);if(goog.isDefAndNotNull(t)){if(t!=this.schema_.version().toString())throw new lf.Exception(360);this.loadTables_()}else this.loadTables_(),window.localStorage.setItem(e,this.schema_.version().toString()),this.commit()},lf.backstore.LocalStorage.prototype.init=function(){return new goog.Promise(function(e){this.initSync(),e()}.bind(this))},lf.backstore.LocalStorage.prototype.loadTables_=function(){var e=this.schema_.name()+".";this.schema_.tables().forEach(function(t){var r=t.getName();if(this.tables_.set(r,new lf.backstore.LocalStorageTable(e+r)),t.persistentIndex()){var o=t.getIndices();o.forEach(function(t){var r=t.getNormalizedName();this.tables_.set(r,new lf.backstore.LocalStorageTable(e+r))},this)}},this)},lf.backstore.LocalStorage.prototype.getTableInternal=function(e){if(!this.tables_.has(e))throw new lf.Exception(101,e);return this.tables_.get(e)},lf.backstore.LocalStorage.prototype.createTx=function(e,t,r){return new lf.backstore.LocalStorageTx(this,e,r)},lf.backstore.LocalStorage.prototype.close=function(){},lf.backstore.LocalStorage.prototype.subscribe=function(e){this.changeHandler_=e,goog.isDefAndNotNull(this.listener_)||(this.listener_=this.onStorageEvent_.bind(this),window.addEventListener("storage",this.listener_,!1))},lf.backstore.LocalStorage.prototype.commit=function(){this.tables_.forEach(function(e){e.commit()})},lf.backstore.LocalStorage.prototype.notify=function(e){goog.isDefAndNotNull(this.changeHandler_)&&this.changeHandler_(e)},lf.backstore.LocalStorage.prototype.onStorageEvent_=function(e){var t=e;if(t.storageArea==window.localStorage&&0==t.key.indexOf(this.schema_.name()+".")){var r=window.localStorage.getItem(t.key),o={};if(!goog.isNull(r))try{o=JSON.parse(r)}catch(n){return}var i=t.key.slice(this.schema_.name().length+1),s=this.tables_.get(i);s&&this.changeHandler_([s.diff(o)])}},lf.backstore.MemoryTx=function(e,t,r){lf.backstore.BaseTx.call(this,t,r),this.store_=e,
t==lf.TransactionType.READ_ONLY&&this.resolver.resolve()},goog.inherits(lf.backstore.MemoryTx,lf.backstore.BaseTx),lf.backstore.MemoryTx.prototype.getTable=function(e){return this.store_.getTableInternal(e)},lf.backstore.MemoryTx.prototype.commitInternal=function(){return this.resolver.resolve(),this.resolver.promise},lf.backstore.Memory=function(e){this.schema_=e,this.tables_=lf.structs.map.create()},lf.backstore.Memory.prototype.init=function(){return this.schema_.tables().forEach(this.initTable_,this),goog.Promise.resolve()},lf.backstore.Memory.prototype.getTableInternal=function(e){var t=this.tables_.get(e)||null;if(goog.isNull(t))throw new lf.Exception(101,e);return t},lf.backstore.Memory.prototype.createTx=function(e,t,r){return new lf.backstore.MemoryTx(this,e,r)},lf.backstore.Memory.prototype.createTable_=function(e){if(!this.tables_.has(e)){var t=new lf.backstore.MemoryTable;return this.tables_.set(e,t),t}return null},lf.backstore.Memory.prototype.initTable_=function(e){if(this.createTable_(e.getName()),e.persistentIndex()){var t=e.getIndices();t.forEach(function(e){this.createTable_(e.getNormalizedName())},this),this.createTable_(e.getRowIdIndexName())}},lf.backstore.Memory.prototype.close=function(){},lf.backstore.Memory.prototype.subscribe=function(){},lf.backstore.Memory.prototype.notify=function(){},lf.backstore.ObservableStore=function(e){lf.backstore.Memory.call(this,e),this.observer_=null},goog.inherits(lf.backstore.ObservableStore,lf.backstore.Memory),lf.backstore.ObservableStore.prototype.subscribe=function(e){goog.isNull(this.observer_)&&(this.observer_=e)},lf.backstore.ObservableStore.prototype.notify=function(e){goog.isNull(this.observer_)||this.observer_(e)},lf.backstore.WebSqlTable=function(e,t,r){this.tx_=e,this.name_='"'+t+'"',this.deserializeFn_=r},lf.backstore.WebSqlTable.prototype.get=function(e){var t=0==e.length?"":"WHERE id IN ("+e.join(",")+")",r="SELECT id, value FROM "+this.name_+" "+t,o=this.deserializeFn_,n=function(e){for(var t=e.rows.length,r=Array(t),n=0;n<t;++n)r[n]=o({id:e.rows.item(n).id,value:JSON.parse(e.rows.item(n).value)});return r};return this.tx_.queue(r,[],n)},lf.backstore.WebSqlTable.prototype.put=function(e){if(0==e.length)return goog.Promise.resolve();var t="INSERT OR REPLACE INTO "+this.name_+"(id, value) VALUES (?, ?)";return e.forEach(function(e){this.tx_.queue(t,[e.id(),JSON.stringify(e.payload_)])},this),goog.Promise.resolve()},lf.backstore.WebSqlTable.prototype.remove=function(e){var t=0==e.length?"":"WHERE id IN ("+e.join(",")+")",r="DELETE FROM "+this.name_+" "+t;return this.tx_.queue(r,[]),goog.Promise.resolve()},lf.backstore.WebSqlTx=function(e,t,r){lf.backstore.BaseTx.call(this,t,r),this.db_=e,this.tables_=lf.structs.map.create(),this.commands_=[]},goog.inherits(lf.backstore.WebSqlTx,lf.backstore.BaseTx),lf.backstore.WebSqlTx.INDEX_MARK="__d__",lf.backstore.WebSqlTx.escapeTableName=function(e){return e.replace(".",lf.backstore.WebSqlTx.INDEX_MARK).replace("#","__s__")},lf.backstore.WebSqlTx.prototype.getTable=function(e,t){var r=this.tables_.get(e)||null;return goog.isNull(r)&&(r=new lf.backstore.WebSqlTable(this,lf.backstore.WebSqlTx.escapeTableName(e),t),this.tables_.set(e,r)),r},lf.backstore.WebSqlTx.prototype.queue=function(e,t,r){var o=goog.Promise.withResolver();return this.commands_.push({statement:e,params:t,transform:r,resolver:o}),o.promise},lf.backstore.WebSqlTx.prototype.commitInternal=function(){var e=null,t=this.resolver.reject.bind(this.resolver),r=function(e,t){this.resolver.reject(t)}.bind(this),o=[],n=function(t,i){if(!goog.isNull(e)){var s=i;goog.isDefAndNotNull(e.transform)&&goog.isDefAndNotNull(i)&&(s=e.transform(i)),o.push(s),e.resolver.resolve(s)}if(0<this.commands_.length){var a=this.commands_.shift();e=a,t.executeSql(a.statement,a.params,n,r)}else this.resolver.resolve(o)}.bind(this);return this.txType==lf.TransactionType.READ_ONLY?this.db_.readTransaction(n,t):this.db_.transaction(n,t),this.resolver.promise},lf.backstore.WebSqlRawBackStore=function(e,t,r){this.db_=r,this.global_=e,this.version_=t},goog.exportSymbol("lf.backstore.WebSqlRawBackStore",lf.backstore.WebSqlRawBackStore),lf.backstore.WebSqlRawBackStore.prototype.getRawDBInstance=function(){return this.db_},goog.exportProperty(lf.backstore.WebSqlRawBackStore.prototype,"getRawDBInstance",lf.backstore.WebSqlRawBackStore.prototype.getRawDBInstance),lf.backstore.WebSqlRawBackStore.prototype.getRawTransaction=function(){throw new lf.Exception(356)},goog.exportProperty(lf.backstore.WebSqlRawBackStore.prototype,"getRawTransaction",lf.backstore.WebSqlRawBackStore.prototype.getRawTransaction),lf.backstore.WebSqlRawBackStore.prototype.createTx_=function(){return new lf.backstore.WebSqlTx(this.db_,lf.TransactionType.READ_WRITE,new lf.cache.Journal(this.global_,lf.structs.set.create()))},lf.backstore.WebSqlRawBackStore.prototype.dropTable=function(e){var t=this.createTx_();return t.queue("DROP TABLE "+e,[]),t.commit()},goog.exportProperty(lf.backstore.WebSqlRawBackStore.prototype,"dropTable",lf.backstore.WebSqlRawBackStore.prototype.dropTable),lf.backstore.WebSqlRawBackStore.prototype.dumpTable_=function(e){var t=this.createTx_();return t.queue("SELECT id, value FROM "+e,[]),t.commit().then(function(e){for(var t=e[0].rows.length,r=Array(t),o=0;o<t;++o)r[o]={id:e[0].rows.item(o).id,value:JSON.parse(e[0].rows.item(o).value)};return goog.Promise.resolve(r)})},lf.backstore.WebSqlRawBackStore.prototype.transformColumn_=function(e,t){var r=this.createTx_(),o="UPDATE "+e+" SET value=? WHERE id=?";return this.dumpTable_(e).then(function(e){return e.forEach(function(e){var n=t(e);r.queue(o,[JSON.stringify(n.value),n.id])}),r.commit()})},lf.backstore.WebSqlRawBackStore.prototype.addTableColumn=function(e,t,r){var o=lf.backstore.IndexedDBRawBackStore.convert(r);return this.transformColumn_(e,function(e){return e.value[t]=o,e})},goog.exportProperty(lf.backstore.WebSqlRawBackStore.prototype,"addTableColumn",lf.backstore.WebSqlRawBackStore.prototype.addTableColumn),lf.backstore.WebSqlRawBackStore.prototype.dropTableColumn=function(e,t){return this.transformColumn_(e,function(e){return delete e.value[t],e})},goog.exportProperty(lf.backstore.WebSqlRawBackStore.prototype,"dropTableColumn",lf.backstore.WebSqlRawBackStore.prototype.dropTableColumn),lf.backstore.WebSqlRawBackStore.prototype.renameTableColumn=function(e,t,r){return this.transformColumn_(e,function(e){return e.value[r]=e.value[t],delete e.value[t],e})},goog.exportProperty(lf.backstore.WebSqlRawBackStore.prototype,"renameTableColumn",lf.backstore.WebSqlRawBackStore.prototype.renameTableColumn),lf.backstore.WebSqlRawBackStore.prototype.createRow=function(e){var t,r={};for(t in e)r[t]=lf.backstore.IndexedDBRawBackStore.convert(e[t]);return lf.Row.create(r)},goog.exportProperty(lf.backstore.WebSqlRawBackStore.prototype,"createRow",lf.backstore.WebSqlRawBackStore.prototype.createRow),lf.backstore.WebSqlRawBackStore.prototype.getVersion=function(){return this.version_},goog.exportProperty(lf.backstore.WebSqlRawBackStore.prototype,"getVersion",lf.backstore.WebSqlRawBackStore.prototype.getVersion),lf.backstore.WebSqlRawBackStore.queueListTables=function(e){e.queue('SELECT tbl_name FROM sqlite_master WHERE type="table"',[],function(e){for(var t=Array(e.rows.length),r=0;r<t.length;++r)t[r]=e.rows.item(r).tbl_name;return t})},lf.backstore.WebSqlRawBackStore.prototype.dump=function(){var e=goog.Promise.withResolver(),t=this.createTx_();lf.backstore.WebSqlRawBackStore.queueListTables(t);var r={};return t.commit().then(function(t){var o=t[0].filter(function(e){return"__lf_ver"!=e&&"__WebKitDatabaseInfoTable__"!=e}),n=o.map(function(e){return this.dumpTable_(e).then(function(t){r[e]=t})},this);goog.Promise.all(n).then(function(){e.resolve(r)})}.bind(this)),e.promise},goog.exportProperty(lf.backstore.WebSqlRawBackStore.prototype,"dump",lf.backstore.WebSqlRawBackStore.prototype.dump),lf.backstore.WebSql=function(e,t,r){this.global_=e,this.schema_=t,this.size_=r||1},lf.backstore.WebSql.prototype.getEmptyJournal_=function(){return new lf.cache.Journal(this.global_,lf.structs.set.create())},lf.backstore.WebSql.prototype.init=function(e){if(!goog.isDefAndNotNull(window.openDatabase))throw new lf.Exception(353);var t=e||function(){return goog.Promise.resolve()};return new goog.Promise(function(e,r){var o=window.openDatabase(this.schema_.name(),"",this.schema_.name(),this.size_);if(!goog.isDefAndNotNull(o))throw new lf.Exception(354);this.db_=o,this.checkVersion_(t).then(function(){this.scanRowId_().then(e,r)}.bind(this),function(e){if(e instanceof lf.Exception)throw e;throw new lf.Exception(354,e.message)})},this)},lf.backstore.WebSql.prototype.checkVersion_=function(e){var t=goog.Promise.withResolver(),r=new lf.backstore.WebSqlTx(this.db_,lf.TransactionType.READ_WRITE,this.getEmptyJournal_());return r.queue("CREATE TABLE IF NOT EXISTS __lf_ver(id INTEGER PRIMARY KEY, v INTEGER)",[]),r.queue("SELECT v FROM __lf_ver WHERE id = 0",[]),r.commit().then(function(r){var o=0;r[1].rows.length&&(o=r[1].rows.item(0).v),o<this.schema_.version()?this.onUpgrade_(e,o).then(t.resolve.bind(t)):o>this.schema_.version()?t.reject(new lf.Exception(108)):t.resolve()}.bind(this),t.reject.bind(t)),t.promise},lf.backstore.WebSql.prototype.createTx=function(e,t,r){if(goog.isDefAndNotNull(this.db_))return new lf.backstore.WebSqlTx(this.db_,e,r);throw new lf.Exception(2)},lf.backstore.WebSql.prototype.close=function(){},lf.backstore.WebSql.prototype.getTableInternal=function(){throw new lf.Exception(512)},lf.backstore.WebSql.prototype.notSupported_=function(){throw new lf.Exception(355)},lf.backstore.WebSql.prototype.subscribe=function(){this.notSupported_()},lf.backstore.WebSql.prototype.notify=function(){this.notSupported_()},lf.backstore.WebSql.prototype.onUpgrade_=function(e,t){return this.preUpgrade_().then(function(){var r=new lf.backstore.WebSqlRawBackStore(this.global_,t,this.db_);return e(r)}.bind(this))},lf.backstore.WebSql.escape_=function(e){return'"'+e+'"'},lf.backstore.WebSql.prototype.preUpgrade_=function(){var e=this.schema_.tables(),t=new lf.backstore.WebSqlTx(this.db_,lf.TransactionType.READ_WRITE,this.getEmptyJournal_()),r=new lf.backstore.WebSqlTx(this.db_,lf.TransactionType.READ_WRITE,this.getEmptyJournal_());return t.queue("INSERT OR REPLACE INTO __lf_ver VALUES (0, ?)",[this.schema_.version()]),lf.backstore.WebSqlRawBackStore.queueListTables(t),t.commit().then(function(t){var o=t[1];o.filter(function(e){return-1!=e.indexOf(lf.backstore.WebSqlTx.INDEX_MARK)}).forEach(function(e){r.queue("DROP TABLE "+lf.backstore.WebSql.escape_(e),[])});var n=[],i=[],s=[];return e.map(function(e){if(-1==o.indexOf(e.getName())&&n.push(e.getName()),e.persistentIndex){e.getIndices().forEach(function(e){var t=lf.backstore.WebSqlTx.escapeTableName(e.getNormalizedName());n.push(t),i.push(t)});var t=lf.backstore.WebSqlTx.escapeTableName(e.getRowIdIndexName());n.push(t),s.push(t)}}),n.forEach(function(e){r.queue("CREATE TABLE "+lf.backstore.WebSql.escape_(e)+"(id INTEGER PRIMARY KEY, value TEXT)",[])}),r.commit()})},lf.backstore.WebSql.prototype.scanRowId_=function(){var e=0,t=goog.Promise.withResolver(),r=function(t){var r=new lf.backstore.WebSqlTx(this.db_,lf.TransactionType.READ_ONLY);return r.queue("SELECT MAX(id) FROM "+lf.backstore.WebSql.escape_(t),[]),r.commit().then(function(t){var r=t[0].rows.item(0)["MAX(id)"];e=Math.max(r,e)})}.bind(this),o=this.schema_.tables().map(function(e){return r(e.getName())});return goog.Promise.all(o).then(function(){lf.Row.setNextId(e+1),t.resolve()},function(e){t.reject(e)}),t.promise},lf.cache.Cache=function(){},lf.cache.DefaultCache=function(e){this.map_=lf.structs.map.create(),this.tableRows_=lf.structs.map.create(),e.tables().forEach(function(e){this.tableRows_.set(e.getName(),lf.structs.set.create())},this)},lf.cache.DefaultCache.prototype.set=function(e,t){this.map_.set(t.id(),t),this.tableRows_.get(e).add(t.id())},lf.cache.DefaultCache.prototype.setMany=function(e,t){var r=this.tableRows_.get(e);t.forEach(function(e){this.map_.set(e.id(),e),r.add(e.id())},this)},lf.cache.DefaultCache.prototype.get=function(e){return this.map_.get(e)||null},lf.cache.DefaultCache.prototype.getMany=function(e){return e.map(function(e){return this.get(e)},this)},lf.cache.DefaultCache.prototype.getRange=function(e,t,r){var o=[],n=Math.min(t,r),i=Math.max(t,r),s=this.tableRows_.get(e);if(s.size<i-n)s.forEach(function(e){if(e>=n&&e<=i){var t=this.map_.get(e);goog.asserts.assert(goog.isDefAndNotNull(t),"Inconsistent cache"),o.push(t)}},this);else for(var a=n;a<=i;++a)if(s.has(a)){var l=this.map_.get(a);goog.asserts.assert(goog.isDefAndNotNull(l),"Inconsistent cache"),o.push(l)}return o},lf.cache.DefaultCache.prototype.remove=function(e,t){this.map_["delete"](t),this.tableRows_.get(e)["delete"](t)},lf.cache.DefaultCache.prototype.getCount=function(e){return goog.isDefAndNotNull(e)?this.tableRows_.get(e).size:this.map_.size},lf.cache.DefaultCache.prototype.clear=function(){this.map_.clear(),this.tableRows_.clear()},lf.structs.array={},lf.structs.array.binarySearch_=function(e,t,r){for(var o=0,n=e.length,i=r||lf.structs.array.defaultComparator_;o<n;){var s=o+n>>1;0>i(e[s],t)?o=s+1:n=s}return o==n&&e[o]==t?o:~o},lf.structs.array.defaultComparator_=function(e,t){return e-t},lf.structs.array.binaryInsert=function(e,t,r){var o=lf.structs.array.binarySearch_(e,t,r);return 0>o&&(e.splice(-(o+1),0,t),!0)},lf.structs.array.binaryRemove=function(e,t,r){var o=lf.structs.array.binarySearch_(e,t,r);return!(0>o)&&(e.splice(o,1),!0)},lf.index.hashCode=function(e){for(var t=0,r=0;r<e.length;++r)t=(t<<5)-t+e.charCodeAt(r),t&=t;return t},lf.index.hashArray=function(e){var t=e.map(function(e){return goog.isDefAndNotNull(e)?lf.index.hashCode(e.toString()).toString(32):""});return t.join("_")},lf.index.slice=function(e,t,r,o){var n=t?e.reverse():e;if(!goog.isDefAndNotNull(r)&&!goog.isDefAndNotNull(o))return n;var i=Math.min(goog.isDef(r)?r:n.length,n.length);if(0==i)return[];var s=Math.min(o||0,n.length);return n.slice(s,s+i)},lf.index.Stats=function(){this.totalRows=0,this.maxKeyEncountered=null},lf.index.Stats.prototype.add=function(e,t){this.totalRows+=t,goog.isNull(this.maxKeyEncountered)?this.maxKeyEncountered=e:this.maxKeyEncountered=e>this.maxKeyEncountered?e:this.maxKeyEncountered},lf.index.Stats.prototype.remove=function(e,t){this.totalRows-=t},lf.index.Stats.prototype.clear=function(){this.totalRows=0},lf.index.Stats.prototype.updateFromList=function(e){this.clear(),e.forEach(function(e){this.totalRows+=e.totalRows},this)},lf.index.BTree=function(e,t,r,o){this.name_=e,this.comparator_=t,this.uniqueKeyOnly_=r,this.stats_=new lf.index.Stats,o?this.root_=lf.index.BTreeNode_.fromData(this,o):this.clear()},lf.index.BTree.EMPTY=[],lf.index.BTree.prototype.getName=function(){return this.name_},lf.index.BTree.prototype.toString=function(){return this.root_.toString()},lf.index.BTree.prototype.add=function(e,t){this.root_=this.root_.insert(e,t)},lf.index.BTree.prototype.set=function(e,t){this.root_=this.root_.insert(e,t,!0)},lf.index.BTree.prototype.remove=function(e,t){this.root_=this.root_.remove(e,t)},lf.index.BTree.prototype.get=function(e){return this.root_.get(e)},lf.index.BTree.prototype.cost=function(e){if(!goog.isDefAndNotNull(e))return this.stats().totalRows;if(e instanceof lf.index.SingleKeyRange){if(e.isAll())return this.stats().totalRows;if(e.isOnly())return this.get(e.from).length}return this.getRange([e]).length},lf.index.BTree.prototype.stats=function(){return this.stats_},lf.index.BTree.prototype.getAll_=function(e,t,r,o){var n=t?this.stats_.totalRows-e-o:o,i=Array(e),s={offset:n,count:e,startIndex:0};return this.root_.fill(s,i),t?i.reverse():i},lf.index.BTree.prototype.getRange=function(e,t,r,o){var n=this.root_.getLeftMostNode().keys_[0];if(!goog.isDef(n)||0==r)return lf.index.BTree.EMPTY;var i=t||!1,s=goog.isDefAndNotNull(r)?Math.min(r,this.stats_.totalRows):this.stats_.totalRows,a=o||0,l=Math.min(Math.max(this.stats_.totalRows-a,0),s);if(0==l)return lf.index.BTree.EMPTY;if(!goog.isDef(e)||1==e.length&&e[0]instanceof lf.index.SingleKeyRange&&e[0].isAll())return this.getAll_(l,i,s,a);var c=this.comparator_.sortKeyRanges(e),u=Array(i?this.stats_.totalRows:l),h={count:0,limit:u.length,reverse:i,skip:a},f=1<this.comparator().keyDimensions();return c.forEach(function(e){for(var t=this.comparator_.rangeToKeys(e),r=this.comparator_.isLeftOpen(e)?n:t[0],o=this.root_.getContainingLeaf(r),i=0;goog.isDefAndNotNull(o)&&h.count<h.limit;)f?o.getRangeWithFilter(e,h,u):o.getRange(e,h,u),0!=h.skip||o.isFirstKeyInRange(e)?i=0:i++,o=2==i?null:o.next()},this),u.length>h.count&&u.splice(h.count,u.length-h.count),i?lf.index.slice(u,i,s,a):u},lf.index.BTree.prototype.clear=function(){this.root_=lf.index.BTreeNode_.create(this),this.stats_.clear()},lf.index.BTree.prototype.containsKey=function(e){return this.root_.containsKey(e)},lf.index.BTree.prototype.min=function(){return this.minMax_(this.comparator_.min.bind(this.comparator_))},lf.index.BTree.prototype.max=function(){return this.minMax_(this.comparator_.max.bind(this.comparator_))},lf.index.BTree.prototype.checkNullKey_=function(e,t){if(!this.comparator_.comparable(e.keys_[t])){if(!(1<e.keys_[t].length))return null;if(goog.isNull(e.keys_[t][0]))return null}return[e.keys_[t],this.uniqueKeyOnly_?[e.values_[t]]:e.values_[t]]},lf.index.BTree.prototype.findLeftMost_=function(){var e=this.root_.getLeftMostNode(),t=0;do if(t>=e.keys_.length)e=e.next_,t=0;else{var r=this.checkNullKey_(e,t);if(!goog.isNull(r))return r;t++}while(!goog.isNull(e));return null},lf.index.BTree.prototype.findRightMost_=function(){var e=this.root_.getRightMostNode(),t=e.keys_.length-1;do if(0>t)e=e.prev_,t=0;else{var r=this.checkNullKey_(e,t);if(!goog.isNull(r))return r;t--}while(!goog.isNull(e));return null},lf.index.BTree.prototype.minMax_=function(e){var t=this.findLeftMost_(),r=this.findRightMost_();return goog.isNull(t)||goog.isNull(r)?null:e(t[0],r[0])==lf.index.Favor.LHS?t:r},lf.index.BTree.prototype.isUniqueKey=function(){return this.uniqueKeyOnly_},lf.index.BTree.prototype.comparator=function(){return this.comparator_},lf.index.BTree.prototype.eq=function(e,t){return!!goog.isDefAndNotNull(e)&&this.comparator_.compare(e,t)==lf.index.Favor.TIE},lf.index.BTree.prototype.serialize=function(){var e=this.root_.getLeftMostNode();return lf.index.BTreeNode_.serialize(e)},lf.index.BTree.deserialize=function(e,t,r,o){var n=new lf.index.BTree(t,e,r),i=lf.index.BTreeNode_.deserialize(o,n);return n.root_=i,n},lf.index.BTreeNode_=function(e,t){this.id_=e,this.tree_=t,this.height_=0,this.next_=this.prev_=this.parent_=null,this.keys_=[],this.values_=[],this.children_=[],this.getContainingLeaf=1==t.comparator().keyDimensions()?this.getContainingLeaf_:this.getContainingLeafMultiKey_},lf.index.BTreeNode_.MAX_COUNT_=512,lf.index.BTreeNode_.MAX_KEY_LEN_=lf.index.BTreeNode_.MAX_COUNT_-1,lf.index.BTreeNode_.MIN_KEY_LEN_=lf.index.BTreeNode_.MAX_COUNT_>>1,lf.index.BTreeNode_.create=function(e){var t=new lf.index.BTreeNode_(lf.Row.getNextId(),e);return t},lf.index.BTreeNode_.prototype.isLeaf_=function(){return 0==this.height_},lf.index.BTreeNode_.prototype.isRoot_=function(){return goog.isNull(this.parent_)},lf.index.BTreeNode_.prototype.next=function(){return this.next_},lf.index.BTreeNode_.dumpLevel_=function(e){var t=e.id_+"["+e.keys_.join("|")+"]",r=e.children_.map(function(e){return e.id_}),o=r.join("|"),n=e.values_.join("/"),i=function(e){return goog.isDefAndNotNull(e)?e.id_.toString():"_"},s=i(e.prev_)+"{",s=e.isLeaf_()?s+n:s+o,s=s+"}"+i(e.parent_);if(e.next_)var a=lf.index.BTreeNode_.dumpLevel_(e.next_),t=t+"  "+a[0],s=s+"  "+a[1];return[t,s]},lf.index.BTreeNode_.prototype.toString=function(){var e="",t=lf.index.BTreeNode_.dumpLevel_(this),e=e+(t[0]+"\n"+t[1]+"\n");return this.children_.length&&(e+=this.children_[0].toString()),e},lf.index.BTreeNode_.prototype.getLeftMostNode=function(){return this.isLeaf_()?this:this.children_[0].getLeftMostNode()},lf.index.BTreeNode_.prototype.getRightMostNode=function(){return this.isLeaf_()?this:this.children_[this.children_.length-1].getRightMostNode()},lf.index.BTreeNode_.associate_=function(e,t){t&&(t.prev_=e),e&&(e.next_=t)},lf.index.BTreeNode_.calcNodeLen_=function(e){var t=lf.index.BTreeNode_.MAX_KEY_LEN_,r=lf.index.BTreeNode_.MIN_KEY_LEN_+1;return e>=t+r?t:e>=r&&e<=t?e:r},lf.index.BTreeNode_.createLeaves_=function(e,t){for(var r=t.length,o=0,n=lf.index.BTreeNode_.create(e),i=n;0<r;){var s=lf.index.BTreeNode_.calcNodeLen_(r),a=t.slice(o,o+s);if(n.keys_=a.map(function(e){return e.key}),n.values_=a.map(function(e){return e.value}),o+=s,r-=s,0<r){var l=lf.index.BTreeNode_.create(n.tree_);lf.index.BTreeNode_.associate_(n,l),n=l}}return i},lf.index.BTreeNode_.createParent_=function(e){var t=e[0],r=lf.index.BTreeNode_.create(t.tree_);r.height_=t.height_+1,r.children_=e;for(var o=0;o<e.length;++o)e[o].parent_=r,0<o&&r.keys_.push(e[o].keys_[0]);return r},lf.index.BTreeNode_.createInternals_=function(e){var t=e,r=[];do r.push(t),t=t.next_;while(t);var o;if(r.length<=lf.index.BTreeNode_.MAX_KEY_LEN_+1)o=lf.index.BTreeNode_.createParent_(r);else{var n=r.length,i=0;for(o=lf.index.BTreeNode_.create(e.tree_),o.height_=e.height_+2;0<n;){var s=lf.index.BTreeNode_.calcNodeLen_(n),a=r.slice(i,i+s),l=lf.index.BTreeNode_.createParent_(a);l.parent_=o,o.children_.length&&(o.keys_.push(a[0].keys_[0]),lf.index.BTreeNode_.associate_(o.children_[o.children_.length-1],l)),o.children_.push(l),i+=s,n-=s}}return o},lf.index.BTreeNode_.fromData=function(e,t){var r=lf.index.BTreeNode_.MAX_KEY_LEN_,r=r*r*r;if(t.length>=r)throw new lf.Exception(6,r);var o=lf.index.BTreeNode_.createLeaves_(e,t);return o=lf.index.BTreeNode_.createInternals_(o)},lf.index.BTreeNode_.prototype.get=function(e){var t=this.searchKey_(e);if(this.isLeaf_()){var r=lf.index.BTree.EMPTY;return this.tree_.eq(this.keys_[t],e)&&(r=r.concat(this.values_[t])),r}return t=this.tree_.eq(this.keys_[t],e)?t+1:t,this.children_[t].get(e)},lf.index.BTreeNode_.prototype.containsKey=function(e){var t=this.searchKey_(e);return!!this.tree_.eq(this.keys_[t],e)||!this.isLeaf_()&&this.children_[t].containsKey(e)},lf.index.BTreeNode_.prototype.remove=function(e,t){if(this.delete_(e,-1,t),this.isRoot_()){var r=this;return 1==this.children_.length&&(r=this.children_[0],r.parent_=null),r}return this},lf.index.BTreeNode_.leftMostKey_=function(e){return e.isLeaf_()?e.keys_[0]:lf.index.BTreeNode_.leftMostKey_(e.children_[0])},lf.index.BTreeNode_.prototype.fix_=function(){this.keys_=[];for(var e=1;e<this.children_.length;++e)this.keys_.push(lf.index.BTreeNode_.leftMostKey_(this.children_[e]))},lf.index.BTreeNode_.prototype.delete_=function(e,t,r){var o=this.searchKey_(e),n=this.isLeaf_();if(n){if(!this.tree_.eq(this.keys_[o],e))return!1}else{var i=this.tree_.eq(this.keys_[o],e)?o+1:o;if(!this.children_[i].delete_(e,i,r))return!1;this.fix_()}if(this.keys_.length>o&&this.tree_.eq(this.keys_[o],e)){if(goog.isDef(r)&&!this.tree_.isUniqueKey()&&n&&(lf.structs.array.binaryRemove(this.values_[o],r)&&this.tree_.stats().remove(e,1),this.values_[o].length))return!1;if(this.keys_.splice(o,1),n){var s=this.tree_.isUniqueKey()?1:this.values_[o].length;this.values_.splice(o,1),this.tree_.stats().remove(e,s)}}return this.keys_.length<lf.index.BTreeNode_.MIN_KEY_LEN_&&!this.isRoot_()&&(this.steal_()||this.merge_(t)),!0},lf.index.BTreeNode_.prototype.steal_=function(){var e,t,r,o;if(this.next_&&this.next_.keys_.length>lf.index.BTreeNode_.MIN_KEY_LEN_)e=this.next_,r=t=0,o=this.keys_.length+1;else{if(!(this.prev_&&this.prev_.keys_.length>lf.index.BTreeNode_.MIN_KEY_LEN_))return!1;e=this.prev_,t=this.prev_.keys_.length-1,r=this.isLeaf_()?t:t+1,o=0}this.keys_.splice(o,0,e.keys_[t]),e.keys_.splice(t,1);var n,i=this.isLeaf_()?this.values_:this.children_;return this.isLeaf_()?n=e.values_:(n=e.children_,n[r].parent_=this),i.splice(o,0,n[r]),n.splice(r,1),e.isLeaf_()||(e.fix_(),this.fix_()),!0},lf.index.BTreeNode_.prototype.merge_=function(e){var t,r,o;this.next_&&this.next_.keys_.length<lf.index.BTreeNode_.MAX_KEY_LEN_?(t=this.next_,o=r=0):this.prev_&&(t=this.prev_,r=t.keys_.length,o=t.isLeaf_()?t.values_.length:t.children_.length);var n=[r,0].concat(this.keys_);Array.prototype.splice.apply(t.keys_,n);var i=null;this.isLeaf_()?i=this.values_:(i=this.children_,i.forEach(function(e){e.parent_=t})),n=[o,0].concat(i),Array.prototype.splice.apply(t.isLeaf_()?t.values_:t.children_,n),lf.index.BTreeNode_.associate_(this.prev_,this.next_),t.isLeaf_()||t.fix_(),-1!=e&&(this.parent_.keys_.splice(e,1),this.parent_.children_.splice(e,1))},lf.index.BTreeNode_.prototype.insert=function(e,t,r){var o=this.searchKey_(e);if(this.isLeaf_()){if(this.tree_.eq(this.keys_[o],e)){if(r)this.tree_.stats().remove(e,this.tree_.isUniqueKey()?1:this.values_[o].length),this.values_[o]=this.tree_.isUniqueKey()?t:[t];else{if(this.tree_.isUniqueKey())throw new lf.Exception(201,this.tree_.getName(),JSON.stringify(e));if(!lf.structs.array.binaryInsert(this.values_[o],t))throw new lf.Exception(109)}return this.tree_.stats().add(e,1),this}return this.keys_.splice(o,0,e),this.values_.splice(o,0,this.tree_.isUniqueKey()?t:[t]),this.tree_.stats().add(e,1),this.keys_.length==lf.index.BTreeNode_.MAX_COUNT_?this.splitLeaf_():this}var o=this.tree_.eq(this.keys_[o],e)?o+1:o,n=this.children_[o].insert(e,t,r);return n.isLeaf_()||1!=n.keys_.length||(this.keys_.splice(o,0,n.keys_[0]),n.children_[1].parent_=this,n.children_[0].parent_=this,this.children_.splice(o,1,n.children_[1]),this.children_.splice(o,0,n.children_[0])),this.keys_.length==lf.index.BTreeNode_.MAX_COUNT_?this.splitInternal_():this},lf.index.BTreeNode_.prototype.splitLeaf_=function(){var e=lf.index.BTreeNode_.MIN_KEY_LEN_,t=lf.index.BTreeNode_.create(this.tree_),r=lf.index.BTreeNode_.create(this.tree_);return r.height_=1,r.keys_=[this.keys_[e]],r.children_=[this,t],r.parent_=this.parent_,this.parent_=r,t.keys_=this.keys_.splice(e),t.values_=this.values_.splice(e),t.parent_=r,lf.index.BTreeNode_.associate_(t,this.next_),lf.index.BTreeNode_.associate_(this,t),r},lf.index.BTreeNode_.prototype.splitInternal_=function(){var e=lf.index.BTreeNode_.MIN_KEY_LEN_,t=lf.index.BTreeNode_.create(this.tree_),r=lf.index.BTreeNode_.create(this.tree_);return t.parent_=this.parent_,t.height_=this.height_+1,t.keys_=[this.keys_[e]],t.children_=[this,r],this.keys_.splice(e,1),r.parent_=t,r.height_=this.height_,r.keys_=this.keys_.splice(e),r.children_=this.children_.splice(e+1),r.children_.forEach(function(e){e.parent_=r}),this.parent_=t,lf.index.BTreeNode_.associate_(r,this.next_),lf.index.BTreeNode_.associate_(this,r),t},lf.index.BTreeNode_.prototype.searchKey_=function(e){for(var t=0,r=this.keys_.length,o=this.tree_.comparator();t<r;){var n=t+r>>1;o.compare(this.keys_[n],e)==lf.index.Favor.RHS?t=n+1:r=n}return t},lf.index.BTreeNode_.prototype.getContainingLeaf_=function(e){if(!this.isLeaf_()){var t=this.searchKey_(e);return this.tree_.eq(this.keys_[t],e)&&t++,this.children_[t].getContainingLeaf_(e)}return this},lf.index.BTreeNode_.prototype.getContainingLeafMultiKey_=function(e){if(!this.isLeaf_()){var t=this.searchKey_(e);if(this.tree_.eq(this.keys_[t],e)){var r=e.some(function(e){return e==lf.index.SingleKeyRange.UNBOUND_VALUE});r||t++}return this.children_[t].getContainingLeafMultiKey_(e)}return this},lf.index.BTreeNode_.prototype.getRange=function(e,t,r){var o=this.tree_.comparator(),n=0,i=this.keys_.length-1,s=function(e){return e[0]?e[1]?lf.index.Favor.TIE:lf.index.Favor.LHS:lf.index.Favor.RHS},a=this.keys_,l=s(o.compareRange(a[n],e)),c=s(o.compareRange(a[i],e));if(l!=lf.index.Favor.LHS&&(l!=lf.index.Favor.RHS||c!=lf.index.Favor.RHS)){var u=function(e,t){var r=e+t>>1;return r==e?r+1:r},h=function(t,r,n){if(t>=r)return n==lf.index.Favor.TIE?r:-1;var i=s(o.compareRange(a[t],e));if(i==lf.index.Favor.TIE)return t;if(i==lf.index.Favor.LHS)return-1;var l=u(t,r);if(l==r)return n==lf.index.Favor.TIE?r:-1;var c=s(o.compareRange(a[l],e));return c==lf.index.Favor.TIE?h(t,l,c):c==lf.index.Favor.RHS?h(l+1,r,n):h(t+1,l,c)},f=function(t,r){if(t>=r)return t;var n=s(o.compareRange(a[r],e));if(n==lf.index.Favor.TIE)return r;if(n==lf.index.Favor.RHS)return t;var i=u(t,r);if(i==r)return t;var l=s(o.compareRange(a[i],e));return l==lf.index.Favor.TIE?f(i,r):l==lf.index.Favor.LHS?f(t,i-1):-1};l!=lf.index.Favor.TIE&&(n=h(n+1,i,c)),-1!=n&&(i=f(n,i),-1!=i&&i>=n&&this.appendResults_(t,r,n,i+1))}},lf.index.BTreeNode_.prototype.appendResultsAt_=function(e,t,r){if(this.tree_.isUniqueKey())!e.reverse&&e.skip?e.skip--:t[e.count++]=this.values_[r];else for(var o=0;o<this.values_[r].length&&e.count<t.length;++o)!e.reverse&&e.skip?e.skip--:t[e.count++]=this.values_[r][o]},lf.index.BTreeNode_.prototype.appendResults_=function(e,t,r,o){for(var n=r;n<o&&(e.reverse||!(e.count>=e.limit));++n)this.appendResultsAt_(e,t,n)},lf.index.BTreeNode_.prototype.getRangeWithFilter=function(e,t,r){for(var o=this.tree_.comparator(),n=-1,i=0;i<this.keys_.length;++i)if(o.isInRange(this.keys_[i],e)){n=i;break}if(-1!=n)for(i=n;i<this.keys_.length&&t.count<t.limit;++i)o.isInRange(this.keys_[i],e)&&this.appendResultsAt_(t,r,i)},lf.index.BTreeNode_.prototype.fill=function(e,t){if(this.isLeaf_())for(var r=0;r<this.values_.length&&0<e.count;++r)if(0<e.offset){if(e.offset-=this.tree_.isUniqueKey()?1:this.values_[r].length,0>e.offset)for(var o=this.values_[r].length+e.offset;o<this.values_[r].length&&0<e.count;++o)t[e.startIndex++]=this.values_[r][o],e.count--}else if(this.tree_.isUniqueKey())t[e.startIndex++]=this.values_[r],e.count--;else for(o=0;o<this.values_[r].length&&0<e.count;++o)t[e.startIndex++]=this.values_[r][o],e.count--;else for(r=0;r<this.children_.length&&0<e.count;++r)this.children_[r].fill(e,t)},lf.index.BTreeNode_.serialize=function(e){for(var t=[],r=e;r;){var o=[r.keys_,r.values_];t.push(new lf.Row(r.id_,o)),r=r.next_}return t},lf.index.BTreeNode_.deserialize=function(e,t){for(var r=t.stats(),o=e.map(function(e){var o=new lf.index.BTreeNode_(e.id(),t);return o.keys_=e.payload_[0],o.values_=e.payload_[1],o.keys_.forEach(function(e,n){r.add(e,t.isUniqueKey()?1:o.values_[n].length)}),o}),n=0;n<o.length-1;++n)lf.index.BTreeNode_.associate_(o[n],o[n+1]);return 1<o.length?lf.index.BTreeNode_.createInternals_(o[0]):o[0]},lf.index.BTreeNode_.prototype.isFirstKeyInRange=function(e){return this.tree_.comparator().isFirstKeyInRange(this.keys_[0],e)},lf.index.SimpleComparator=function(e){this.compareFn=e==lf.Order.DESC?lf.index.SimpleComparator.compareDescending:lf.index.SimpleComparator.compareAscending,this.normalizeKeyRange_=e==lf.Order.DESC?function(e){return goog.isDefAndNotNull(e)?e.reverse():null}:function(e){return e||null},this.orderRange_=e==lf.Order.DESC?lf.index.SimpleComparator.orderRangeDescending:lf.index.SimpleComparator.orderRangeAscending},lf.index.SimpleComparator.compareAscending=function(e,t){return e>t?lf.index.Favor.LHS:e<t?lf.index.Favor.RHS:lf.index.Favor.TIE},lf.index.SimpleComparator.compareDescending=function(e,t){return lf.index.SimpleComparator.compareAscending(t,e)},lf.index.SimpleComparator.orderRangeAscending=function(e,t){return lf.index.SingleKeyRange.compare(e,t)},lf.index.SimpleComparator.orderRangeDescending=function(e,t){return lf.index.SingleKeyRange.compare(t,e)},lf.index.SimpleComparator.prototype.compareRange=function(e,t){var r=this.normalizeKeyRange_(t),o=[lf.index.SingleKeyRange.isUnbound(r.from),lf.index.SingleKeyRange.isUnbound(r.to)];if(!o[0]){var n=this.compareFn(e,r.from);o[0]=r.excludeLower?n==lf.index.Favor.LHS:n!=lf.index.Favor.RHS}return o[1]||(n=this.compareFn(e,r.to),o[1]=r.excludeUpper?n==lf.index.Favor.RHS:n!=lf.index.Favor.LHS),o},lf.index.SimpleComparator.prototype.compare=function(e,t){return this.compareFn(e,t)},lf.index.SimpleComparator.prototype.min=function(e,t){return e<t?lf.index.Favor.LHS:e==t?lf.index.Favor.TIE:lf.index.Favor.RHS},lf.index.SimpleComparator.prototype.max=function(e,t){return e>t?lf.index.Favor.LHS:e==t?lf.index.Favor.TIE:lf.index.Favor.RHS},lf.index.SimpleComparator.prototype.isInRange=function(e,t){
var r=this.compareRange(e,t);return r[0]&&r[1]},lf.index.SimpleComparator.prototype.isFirstKeyInRange=function(e,t){return this.isInRange(e,t)},lf.index.SimpleComparator.prototype.orderKeyRange=function(e,t){return this.orderRange_(e,t)},lf.index.SimpleComparator.prototype.sortKeyRanges=function(e){return e.filter(function(e){return!goog.isNull(e)}).sort(function(e,t){return this.orderRange_(e,t)}.bind(this))},lf.index.SimpleComparator.prototype.isLeftOpen=function(e){return lf.index.SingleKeyRange.isUnbound(this.normalizeKeyRange_(e).from)},lf.index.SimpleComparator.prototype.rangeToKeys=function(e){var t=this.normalizeKeyRange_(e);return[t.from,t.to]},lf.index.SimpleComparator.prototype.comparable=function(e){return!goog.isNull(e)},lf.index.SimpleComparator.prototype.keyDimensions=function(){return 1},lf.index.SimpleComparator.prototype.toString=function(){return this.compare==lf.index.SimpleComparator.compareDescending?"SimpleComparator_DESC":"SimpleComparator_ASC"},lf.index.SimpleComparatorWithNull=function(e){lf.index.SimpleComparator.call(this,e),this.compareFn=e==lf.Order.DESC?lf.index.SimpleComparatorWithNull.compareDescending:lf.index.SimpleComparatorWithNull.compareAscending},goog.inherits(lf.index.SimpleComparatorWithNull,lf.index.SimpleComparator),lf.index.SimpleComparatorWithNull.compareAscending=function(e,t){return goog.isNull(e)?goog.isNull(t)?lf.index.Favor.TIE:lf.index.Favor.RHS:goog.isNull(t)?lf.index.Favor.LHS:lf.index.SimpleComparator.compareAscending(e,t)},lf.index.SimpleComparatorWithNull.compareDescending=function(e,t){return lf.index.SimpleComparatorWithNull.compareAscending(t,e)},lf.index.SimpleComparatorWithNull.prototype.isInRange=function(e,t){return goog.isNull(e)?t.isAll():lf.index.SimpleComparatorWithNull.superClass_.isInRange.call(this,e,t)},lf.index.SimpleComparatorWithNull.prototype.minMax_=function(e,t){return goog.isNull(e)?goog.isNull(t)?lf.index.Favor.TIE:lf.index.Favor.RHS:goog.isNull(t)?lf.index.Favor.LHS:null},lf.index.SimpleComparatorWithNull.prototype.min=function(e,t){var r=this.minMax_(e,t);return goog.isNull(r)&&(r=lf.index.SimpleComparatorWithNull.superClass_.min.call(this,e,t)),r},lf.index.SimpleComparatorWithNull.prototype.max=function(e,t){var r=this.minMax_(e,t);return goog.isNull(r)&&(r=lf.index.SimpleComparatorWithNull.superClass_.max.call(this,e,t)),r},lf.index.MultiKeyComparator=function(e){this.comparators=e.map(function(e){return new lf.index.SimpleComparator(e)})},lf.index.MultiKeyComparator.createOrders=function(e,t){for(var r=Array(e),o=0;o<e;++o)r[o]=t;return r},lf.index.MultiKeyComparator.prototype.forEach_=function(e,t,r){for(var o=lf.index.Favor.TIE,n=0;n<this.comparators.length&&o==lf.index.Favor.TIE;++n)o=r(this.comparators[n],e[n],t[n]);return o},lf.index.MultiKeyComparator.prototype.compare=function(e,t){return this.forEach_(e,t,function(e,t,r){return t==lf.index.SingleKeyRange.UNBOUND_VALUE||r==lf.index.SingleKeyRange.UNBOUND_VALUE?lf.index.Favor.TIE:e.compare(t,r)})},lf.index.MultiKeyComparator.prototype.min=function(e,t){return this.forEach_(e,t,function(e,t,r){return e.min(t,r)})},lf.index.MultiKeyComparator.prototype.max=function(e,t){return this.forEach_(e,t,function(e,t,r){return e.max(t,r)})},lf.index.MultiKeyComparator.prototype.compareRange=function(e,t){for(var r=[!0,!0],o=0;o<this.comparators.length&&(r[0]||r[1]);++o){var n=this.comparators[o].compareRange(e[o],t[o]);r[0]=r[0]&&n[0],r[1]=r[1]&&n[1]}return r},lf.index.MultiKeyComparator.prototype.isInRange=function(e,t){for(var r=!0,o=0;o<this.comparators.length&&r;++o)r=this.comparators[o].isInRange(e[o],t[o]);return r},lf.index.MultiKeyComparator.prototype.isFirstKeyInRange=function(e,t){return this.comparators[0].isInRange(e[0],t[0])},lf.index.MultiKeyComparator.prototype.sortKeyRanges=function(e){for(var t=e.filter(function(e){return e.every(goog.isDefAndNotNull)}),r=Array(this.comparators.length),o=0;o<r.length;o++)r[o]=t.map(function(e){return e[o]});r.forEach(function(e,t){e.sort(function(e,r){return this.comparators[t].orderKeyRange(e,r)}.bind(this))},this);for(var n=Array(t.length),o=0;o<n.length;o++)n[o]=r.map(function(e){return e[o]});return n.sort(function(e,t){for(var r=lf.index.Favor.TIE,o=0;o<this.comparators.length&&r==lf.index.Favor.TIE;++o)r=this.comparators[o].orderKeyRange(e[o],t[o]);return r}.bind(this))},lf.index.MultiKeyComparator.prototype.isLeftOpen=function(e){return this.comparators[0].isLeftOpen(e[0])},lf.index.MultiKeyComparator.prototype.rangeToKeys=function(e){var t=e.map(function(e,t){return this.comparators[t].rangeToKeys(e)[0]},this),r=e.map(function(e,t){return this.comparators[t].rangeToKeys(e)[1]},this);return[t,r]},lf.index.MultiKeyComparator.prototype.comparable=function(e){return e.every(function(e,t){return this.comparators[t].comparable(e)},this)},lf.index.MultiKeyComparator.prototype.keyDimensions=function(){return this.comparators.length},lf.index.MultiKeyComparatorWithNull=function(e){lf.index.MultiKeyComparator.call(this,e),this.comparators=e.map(function(e){return new lf.index.SimpleComparatorWithNull(e)})},goog.inherits(lf.index.MultiKeyComparatorWithNull,lf.index.MultiKeyComparator),lf.index.ComparatorFactory={},lf.index.ComparatorFactory.create=function(e){if(1==e.columns.length)return new lf.index.SimpleComparator(e.columns[0].order);var t=e.columns.map(function(e){return e.order}),r=e.columns.some(function(e){return e.schema.isNullable()});return r?new lf.index.MultiKeyComparatorWithNull(t):new lf.index.MultiKeyComparator(t)},lf.index.NullableIndex=function(e){this.index_=e,this.nulls_=lf.structs.set.create(),this.statsNull_=new lf.index.Stats,this.stats_=new lf.index.Stats},lf.index.NullableIndex.prototype.getName=function(){return this.index_.getName()},lf.index.NullableIndex.prototype.add=function(e,t){goog.isNull(e)?(this.nulls_.add(t),this.statsNull_.add(e,1)):this.index_.add(e,t)},lf.index.NullableIndex.prototype.set=function(e,t){goog.isNull(e)?(this.nulls_.clear(),this.statsNull_.clear(),this.add(e,t)):this.index_.set(e,t)},lf.index.NullableIndex.prototype.remove=function(e,t){goog.isNull(e)?t?(this.nulls_["delete"](t),this.statsNull_.remove(e,1)):(this.nulls_.clear(),this.statsNull_.clear()):this.index_.remove(e,t)},lf.index.NullableIndex.prototype.get=function(e){return goog.isNull(e)?lf.structs.set.values(this.nulls_):this.index_.get(e)},lf.index.NullableIndex.prototype.cost=function(e){return this.index_.cost(e)},lf.index.NullableIndex.prototype.stats=function(){return this.stats_.updateFromList([this.index_.stats(),this.statsNull_]),this.stats_},lf.index.NullableIndex.prototype.getRange=function(e,t,r,o){var n=this.index_.getRange(e,t,r,o);return goog.isDefAndNotNull(e)?n:n.concat(lf.structs.set.values(this.nulls_))},lf.index.NullableIndex.prototype.clear=function(){this.nulls_.clear(),this.index_.clear()},lf.index.NullableIndex.prototype.containsKey=function(e){return goog.isNull(e)?0!=this.nulls_.size:this.index_.containsKey(e)},lf.index.NullableIndex.prototype.min=function(){return this.index_.min()},lf.index.NullableIndex.prototype.max=function(){return this.index_.max()},lf.index.NullableIndex.NULL_ROW_ID_=-2,lf.index.NullableIndex.prototype.serialize=function(){var e=[new lf.Row(lf.index.NullableIndex.NULL_ROW_ID_,lf.structs.set.values(this.nulls_))];return e.concat(this.index_.serialize())},lf.index.NullableIndex.prototype.comparator=function(){return this.index_.comparator()},lf.index.NullableIndex.deserialize=function(e,t){for(var r=-1,o=0;o<t.length;++o)if(t[o].id()==lf.index.NullableIndex.NULL_ROW_ID_){r=o;break}if(-1==r)throw new lf.Exception(102);var n=t[r].payload_,i=t.slice(0);i.splice(r,1);var s=e(i),a=new lf.index.NullableIndex(s);return n.forEach(function(e){a.nulls_.add(e)}),a},lf.index.NullableIndex.prototype.isUniqueKey=function(){return this.index_.isUniqueKey()},lf.index.RowId=function(e){this.name_=e,this.rows_=lf.structs.set.create(),this.comparator_=new lf.index.SimpleComparator(lf.Order.ASC)},lf.index.RowId.ROW_ID=0,lf.index.RowId.prototype.getName=function(){return this.name_},lf.index.RowId.prototype.add=function(e){if("number"!=typeof e)throw new lf.Exception(103);this.rows_.add(e)},lf.index.RowId.prototype.set=function(e,t){this.add(e,t)},lf.index.RowId.prototype.remove=function(e){this.rows_["delete"](e)},lf.index.RowId.prototype.get=function(e){return this.containsKey(e)?[e]:[]},lf.index.RowId.prototype.min=function(){return this.minMax_(this.comparator_.min.bind(this.comparator_))},lf.index.RowId.prototype.max=function(){return this.minMax_(this.comparator_.max.bind(this.comparator_))},lf.index.RowId.prototype.minMax_=function(e){if(0==this.rows_.size)return null;var t=lf.structs.set.values(this.rows_).reduce(function(t,r){return goog.isNull(t)||e(r,t)==lf.index.Favor.LHS?r:t},null);return[t,[t]]},lf.index.RowId.prototype.cost=function(){return this.rows_.size},lf.index.RowId.prototype.getRange=function(e,t,r,o){var n=e||[lf.index.SingleKeyRange.all()],i=lf.structs.set.values(this.rows_).filter(function(e){return n.some(function(t){return this.comparator_.isInRange(e,t)},this)},this);return lf.index.slice(i,t,r,o)},lf.index.RowId.prototype.clear=function(){this.rows_.clear()},lf.index.RowId.prototype.containsKey=function(e){return this.rows_.has(e)},lf.index.RowId.prototype.serialize=function(){return[new lf.Row(lf.index.RowId.ROW_ID,lf.structs.set.values(this.rows_))]},lf.index.RowId.prototype.comparator=function(){return this.comparator_},lf.index.RowId.deserialize=function(e,t){var r=new lf.index.RowId(e),o=t[0].payload_;return o.forEach(function(e){r.add(e,e)}),r},lf.index.RowId.prototype.isUniqueKey=function(){return!0},lf.index.RowId.prototype.stats=function(){var e=new lf.index.Stats;return e.totalRows=this.rows_.size,e},lf.cache.Prefetcher=function(e){this.backStore_=e.getService(lf.service.BACK_STORE),this.indexStore_=e.getService(lf.service.INDEX_STORE),this.cache_=e.getService(lf.service.CACHE)},lf.cache.Prefetcher.prototype.init=function(e){var t=e.tables(),r=function(){if(0==t.length)return goog.Promise.resolve();var e=t.shift(),o=e.persistentIndex()?this.fetchTableWithPersistentIndices_(e):this.fetchTable_(e);return o.then(r)}.bind(this);return r()},lf.cache.Prefetcher.prototype.fetchTable_=function(e){var t=this.backStore_.createTx(lf.TransactionType.READ_ONLY,[e]),r=t.getTable(e.getName(),e.deserializeRow.bind(e),lf.backstore.TableType.DATA),o=r.get([]).then(function(t){this.cache_.setMany(e.getName(),t),this.reconstructNonPersistentIndices_(e,t)}.bind(this));return t.commit(),o},lf.cache.Prefetcher.prototype.reconstructNonPersistentIndices_=function(e,t){var r=this.indexStore_.getTableIndices(e.getName());t.forEach(function(e){r.forEach(function(t){var r=e.keyOfIndex(t.getName());t.add(r,e.id())})})},lf.cache.Prefetcher.prototype.fetchTableWithPersistentIndices_=function(e){var t=this.backStore_.createTx(lf.TransactionType.READ_ONLY,[e]),r=t.getTable(e.getName(),e.deserializeRow,lf.backstore.TableType.DATA),o=r.get([]).then(function(t){this.cache_.setMany(e.getName(),t)}.bind(this)),n=e.getIndices().map(function(e){return this.reconstructPersistentIndex_(e,t)},this).concat(this.reconstructPersistentRowIdIndex_(e,t));return t.commit(),goog.Promise.all(n.concat(o))},lf.cache.Prefetcher.prototype.reconstructPersistentIndex_=function(e,t){var r=t.getTable(e.getNormalizedName(),lf.Row.deserialize,lf.backstore.TableType.INDEX),o=lf.index.ComparatorFactory.create(e);return r.get([]).then(function(t){if(0<t.length)if(e.hasNullableColumn()){var r=lf.index.BTree.deserialize.bind(void 0,o,e.getNormalizedName(),e.isUnique),n=lf.index.NullableIndex.deserialize(r,t);this.indexStore_.set(e.tableName,n)}else{var i=lf.index.BTree.deserialize(o,e.getNormalizedName(),e.isUnique,t);this.indexStore_.set(e.tableName,i)}}.bind(this))},lf.cache.Prefetcher.prototype.reconstructPersistentRowIdIndex_=function(e,t){var r=t.getTable(e.getRowIdIndexName(),lf.Row.deserialize,lf.backstore.TableType.INDEX);return r.get([]).then(function(t){if(0<t.length){var r=lf.index.RowId.deserialize(e.getRowIdIndexName(),t);this.indexStore_.set(e.getName(),r)}}.bind(this))},lf.index.IndexStore=function(){},lf.index.MemoryIndexStore=function(){this.store_=lf.structs.map.create(),this.tableIndices_=lf.structs.map.create()},lf.index.MemoryIndexStore.prototype.init=function(e){var t=e.tables();return t.forEach(function(e){var t=[];this.tableIndices_.set(e.getName(),t);var r=e.getRowIdIndexName(),o=this.get(r);if(goog.isNull(o)){var n=new lf.index.RowId(r);t.push(n),this.store_.set(r,n)}e.getIndices().forEach(function(e){var r=lf.index.MemoryIndexStore.createIndex_(e);t.push(r),this.store_.set(e.getNormalizedName(),r)},this)},this),goog.Promise.resolve()},lf.index.MemoryIndexStore.createIndex_=function(e){var t=lf.index.ComparatorFactory.create(e),r=new lf.index.BTree(e.getNormalizedName(),t,e.isUnique);return e.hasNullableColumn()&&1==e.columns.length?new lf.index.NullableIndex(r):r},lf.index.MemoryIndexStore.prototype.get=function(e){return this.store_.get(e)||null},lf.index.MemoryIndexStore.prototype.set=function(e,t){var r=this.tableIndices_.get(e)||null;goog.isNull(r)&&(r=[],this.tableIndices_.set(e,r));for(var o=null,n=0;n<r.length;n++)if(r[n].getName()==t.getName()){o=n;break}!goog.isNull(o)&&0<r.length?r.splice(o,1,t):r.push(t),this.store_.set(t.getName(),t)},lf.index.MemoryIndexStore.prototype.getTableIndices=function(e){return this.tableIndices_.get(e)||[]},lf.tree={},lf.tree.map=function(e,t){var r=[],o=null,n=null;return e.traverse(function(e){var i=t(e);null==e.getParent()?n=i:o.addChild(i);var s=e.getParent(),a=o;if(!goog.isNull(s)){var l=s.getChildCount()==a.getChildCount();if(l){var c=r.indexOf(a);-1!=c&&r.splice(c,1)}}1<e.getChildCount()&&r.push(i),o=e.isLeaf()?r[r.length-1]:i}),n},lf.tree.getLeafNodes=function(e){return lf.tree.find(e,function(e){return e.isLeaf()})},lf.tree.removeNode=function(e){var t=e.getParent(),r=0;goog.isNull(t)||(r=t.getChildren().indexOf(e),t.removeChild(e));var o=e.getChildren().slice();return o.forEach(function(o,n){e.removeChild(o),goog.isNull(t)||t.addChildAt(o,r+n)}),{parent:t,children:o}},lf.tree.insertNodeAt=function(e,t){var r=e.getChildren().slice();r.forEach(function(r){e.removeChild(r),t.addChild(r)}),e.addChild(t)},lf.tree.swapNodeWithChild=function(e){goog.asserts.assert(1==e.getChildCount());var t=e.getChildAt(0);return goog.asserts.assert(1==t.getChildCount()),lf.tree.removeNode(e),lf.tree.insertNodeAt(t,e),t},lf.tree.pushNodeBelowChild=function(e,t,r){goog.asserts.assert(1==e.getChildCount());var o=e.getChildAt(0);goog.asserts.assert(1<o.getChildCount());var n=o.getChildren().slice(),i=n.some(function(e){return t(e)});return i?(lf.tree.removeNode(e),n.forEach(function(n,i){if(t(n)){var s=r(e);o.removeChildAt(i),s.addChild(n),o.addChildAt(s,i)}}),o):e},lf.tree.replaceChainWithChain=function(e,t,r,o){var n=e.getParent();if(!goog.isNull(n)){var i=n.getChildren().indexOf(e);n.removeChildAt(i),n.addChildAt(r,i)}return t.getChildren().slice().forEach(function(e){t.removeChild(e),o.addChild(e)}),r},lf.tree.replaceNodeWithChain=function(e,t,r){return lf.tree.replaceChainWithChain(e,e,t,r)},lf.tree.replaceChainWithNode=function(e,t,r){return lf.tree.replaceChainWithChain(e,t,r,r)},lf.tree.find=function(e,t,r){var o=[],n=function(e){t(e)&&o.push(e),goog.isDefAndNotNull(r)&&r(e)||e.getChildren().forEach(n)};return n(e),o},lf.tree.toString=function(e,t){var r=t||function(e){return e.toString()+"\n"},o="";return e.traverse(function(e){for(var t=0;t<e.getDepth();t++)o+="-";o+=r(e)}),o},lf.pred.Operator={AND:"and",OR:"or"},lf.pred.CombinedPredicate=function(e){lf.pred.PredicateNode.call(this),this.operator=e,this.isComplement_=!1},goog.inherits(lf.pred.CombinedPredicate,lf.pred.PredicateNode),lf.pred.CombinedPredicate.prototype.copy=function(){var e=lf.tree.map(this,function(e){if(e instanceof lf.pred.CombinedPredicate){var t=new lf.pred.CombinedPredicate(e.operator);return t.isComplement_=e.isComplement_,t.setId(e.getId()),t}return e.copy()});return e},lf.pred.CombinedPredicate.prototype.getColumns=function(e){var t=e||[];this.traverse(function(e){e!=this&&e.getColumns(t)}.bind(this));var r=lf.structs.set.create(t);return lf.structs.set.values(r)},lf.pred.CombinedPredicate.prototype.getTables=function(e){var t=goog.isDefAndNotNull(e)?e:lf.structs.set.create();return this.traverse(function(e){e!=this&&e.getTables(t)}.bind(this)),t},lf.pred.CombinedPredicate.prototype.setComplement=function(e){this.isComplement_!=e&&(this.isComplement_=e,this.operator=this.operator==lf.pred.Operator.AND?lf.pred.Operator.OR:lf.pred.Operator.AND,this.getChildren().forEach(function(t){return t.setComplement(e)}))},lf.pred.CombinedPredicate.prototype.eval=function(e){var t=this.getChildren().map(function(t){return t.eval(e)});return this.combineResults_(t)},lf.pred.CombinedPredicate.prototype.combineResults_=function(e){return this.operator==lf.pred.Operator.AND?lf.proc.Relation.intersect(e):lf.proc.Relation.union(e)},lf.pred.CombinedPredicate.prototype.toString=function(){return"combined_pred_"+this.operator.toString()},lf.pred.CombinedPredicate.prototype.toKeyRange=function(){if(goog.asserts.assert(this.isKeyRangeCompatible(),"Could not convert combined predicate to key range."),this.operator==lf.pred.Operator.OR){var e=new lf.index.SingleKeyRangeSet;return this.getChildren().forEach(function(t){var r=t.toKeyRange().getValues();e.add(r)}),e}return goog.asserts.fail("toKeyRange() called for an AND predicate."),new lf.index.SingleKeyRangeSet},lf.pred.CombinedPredicate.prototype.isKeyRangeCompatible=function(){return this.operator==lf.pred.Operator.OR&&this.isKeyRangeCompatibleOr_()},lf.pred.CombinedPredicate.prototype.isKeyRangeCompatibleOr_=function(){var e=null;return this.getChildren().every(function(t){var r=t instanceof lf.pred.ValuePredicate&&t.isKeyRangeCompatible();return!!r&&(goog.isNull(e)&&(e=t.column),e.getNormalizedName()==t.column.getNormalizedName())})},lf.pred.JoinPredicate=function(e,t,r){lf.pred.PredicateNode.call(this),this.leftColumn=e,this.rightColumn=t,this.evaluatorType=r,this.nullPayload_=null;var o=lf.eval.Registry.get();this.evaluatorFn_=o.getEvaluator(this.leftColumn.getType(),this.evaluatorType),this.keyOfIndexFn_=o.getKeyOfIndexEvaluator(this.leftColumn.getType())},goog.inherits(lf.pred.JoinPredicate,lf.pred.PredicateNode),lf.pred.JoinPredicate.BLOCK_SIZE_EXPONENT_=8,lf.pred.JoinPredicate.prototype.copy=function(){var e=new lf.pred.JoinPredicate(this.leftColumn,this.rightColumn,this.evaluatorType);return e.setId(this.getId()),e},lf.pred.JoinPredicate.prototype.getColumns=function(e){return goog.isDefAndNotNull(e)?(e.push(this.leftColumn),e.push(this.rightColumn),e):[this.leftColumn,this.rightColumn]},lf.pred.JoinPredicate.prototype.getTables=function(e){var t=goog.isDefAndNotNull(e)?e:lf.structs.set.create();return t.add(this.leftColumn.getTable()),t.add(this.rightColumn.getTable()),t},lf.pred.JoinPredicate.prototype.reverse=function(){var e=this.evaluatorType;switch(this.evaluatorType){case lf.eval.Type.GT:e=lf.eval.Type.LT;break;case lf.eval.Type.LT:e=lf.eval.Type.GT;break;case lf.eval.Type.GTE:e=lf.eval.Type.LTE;break;case lf.eval.Type.LTE:e=lf.eval.Type.GTE}var t=new lf.pred.JoinPredicate(this.rightColumn,this.leftColumn,e);return t},lf.pred.JoinPredicate.prototype.reverseSelf_=function(){var e=this.leftColumn;this.leftColumn=this.rightColumn,this.rightColumn=e;var t;switch(this.evaluatorType){case lf.eval.Type.GT:t=lf.eval.Type.LT;break;case lf.eval.Type.LT:t=lf.eval.Type.GT;break;case lf.eval.Type.GTE:t=lf.eval.Type.LTE;break;case lf.eval.Type.LTE:t=lf.eval.Type.GTE;break;default:return}this.evaluatorType=t,this.evaluatorFn_=lf.eval.Registry.get().getEvaluator(this.leftColumn.getType(),this.evaluatorType)},lf.pred.JoinPredicate.prototype.eval=function(e){var t=e.entries.filter(function(e){var t=e.getField(this.leftColumn),r=e.getField(this.rightColumn);return this.evaluatorFn_(t,r)},this);return new lf.proc.Relation(t,e.getTables())},lf.pred.JoinPredicate.prototype.toString=function(){return"join_pred("+this.leftColumn.getNormalizedName()+" "+this.evaluatorType+" "+this.rightColumn.getNormalizedName()+")"},lf.pred.JoinPredicate.prototype.appliesToLeft_=function(e){return-1!=e.getTables().indexOf(this.leftColumn.getTable().getEffectiveName())},lf.pred.JoinPredicate.prototype.appliesToRight_=function(e){return-1!=e.getTables().indexOf(this.rightColumn.getTable().getEffectiveName())},lf.pred.JoinPredicate.prototype.detectLeftRight_=function(e,t){var r,o;return this.appliesToLeft_(e)?(this.assertRelationsApply_(e,t),r=e,o=t):(this.assertRelationsApply_(t,e),r=t,o=e),r.entries.length>o.entries.length?(this.reverseSelf_(),this.assertRelationsApply_(o,r),[o,r]):[r,o]},lf.pred.JoinPredicate.prototype.assertRelationsApply_=function(e,t){goog.asserts.assert(this.appliesToLeft_(e),"Mismatch between join predicate left operand and right relation."),goog.asserts.assert(this.appliesToRight_(t),"Mismatch between join predicate right operand and right relation.")},lf.pred.JoinPredicate.prototype.createNullPayload_=function(e){var t={};return e.getColumns().forEach(function(e){t[e.getName()]=null}),t},lf.pred.JoinPredicate.prototype.createCombinedEntryForUnmatched_=function(e,t){goog.isNull(this.nullPayload_)&&(this.nullPayload_=this.createNullPayload_(this.rightColumn.getTable()));var r=new lf.proc.RelationEntry(new lf.Row(lf.Row.DUMMY_ID,this.nullPayload_),(!1)),o=lf.proc.RelationEntry.combineEntries(e,t,r,[this.rightColumn.getTable().getEffectiveName()]);return o},lf.pred.JoinPredicate.prototype.evalRelationsNestedLoopJoin=function(e,t,r){var o=[e,t];r||(o=this.detectLeftRight_(e,t)),e=o[0],t=o[1];for(var n=[],i=e.getTables(),s=t.getTables(),a=e.entries.length,l=t.entries.length,c=lf.pred.JoinPredicate.BLOCK_SIZE_EXPONENT_,u=l+(1<<c)-1>>c,h=0;h<u;){for(var f=0;f<a;f++){var p=!1,d=e.entries[f].getField(this.leftColumn);if(!goog.isNull(d))for(var g=Math.min(h+1<<c,l),_=h<<c;_<g;_++){var m=this.evaluatorFn_(d,t.entries[_].getField(this.rightColumn));if(m){var p=!0,y=lf.proc.RelationEntry.combineEntries(e.entries[f],i,t.entries[_],s);n.push(y)}}r&&!p&&n.push(this.createCombinedEntryForUnmatched_(e.entries[f],i))}h++}var v=e.getTables().concat(t.getTables());return new lf.proc.Relation(n,v)},lf.pred.JoinPredicate.prototype.evalRelationsHashJoin=function(e,t,r){var o=[e,t];r||(o=this.detectLeftRight_(e,t)),e=o[0],t=o[1];var n=e,i=t,s=this.leftColumn,a=this.rightColumn;r&&(n=t,i=e,s=this.rightColumn,a=this.leftColumn);var l=new lf.structs.MapSet,c=[];n.entries.forEach(function(e){var t=String(e.getField(s));l.set(t,e)});var u=n.getTables(),h=i.getTables();i.entries.forEach(function(e){var t=e.getField(a),o=String(t);!goog.isNull(t)&&l.has(o)?l.get(o).forEach(function(t){var r=lf.proc.RelationEntry.combineEntries(e,h,t,u);c.push(r)}):r&&c.push(this.createCombinedEntryForUnmatched_(e,h))}.bind(this));var f=e.getTables().concat(t.getTables());return new lf.proc.Relation(c,f)},lf.pred.JoinPredicate.prototype.evalRelationsIndexNestedLoopJoin=function(e,t,r,o){goog.asserts.assert(this.evaluatorType==lf.eval.Type.EQ,"For now, index nested loop join can only be leveraged for EQ.");var n=r.indexedColumn.getTable(),i=e,s=t;-1!=e.getTables().indexOf(n.getEffectiveName())&&(i=t,s=e);var a=[],l=s.getTables(),c=i.getTables(),u=function(e,t){var r=new lf.proc.RelationEntry(t,1<l.length),o=lf.proc.RelationEntry.combineEntries(e,c,r,l);a.push(o)};i.entries.forEach(function(e){var t=this.keyOfIndexFn_(e.getField(r.nonIndexedColumn)),n=r.index.get(t);if(0!=n.length)if(r.index.isUniqueKey())u(e,o.get(n[0]));else{var i=o.getMany(n);i.forEach(u.bind(null,e))}},this);var h=i.getTables().concat(s.getTables());return new lf.proc.Relation(a,h)},lf.pred.createPredicate=function(e,t,r){return goog.isNull(t)?new lf.pred.ValuePredicate(e,t,r):goog.isDef(t.getNormalizedName)?new lf.pred.JoinPredicate(e,t,r):new lf.pred.ValuePredicate(e,t,r)},lf.schema={},lf.schema.Column=function(){},lf.schema.Database=function(){},lf.schema.DataStoreType={},goog.exportSymbol("lf.schema.DataStoreType",lf.schema.DataStoreType),lf.schema.DataStoreType.INDEXED_DB=0,goog.exportProperty(lf.schema.DataStoreType,"INDEXED_DB",lf.schema.DataStoreType.INDEXED_DB),lf.schema.DataStoreType.MEMORY=1,goog.exportProperty(lf.schema.DataStoreType,"MEMORY",lf.schema.DataStoreType.MEMORY),lf.schema.DataStoreType.LOCAL_STORAGE=2,goog.exportProperty(lf.schema.DataStoreType,"LOCAL_STORAGE",lf.schema.DataStoreType.LOCAL_STORAGE),lf.schema.DataStoreType.FIREBASE=3,goog.exportProperty(lf.schema.DataStoreType,"FIREBASE",lf.schema.DataStoreType.FIREBASE),lf.schema.DataStoreType.WEB_SQL=4,goog.exportProperty(lf.schema.DataStoreType,"WEB_SQL",lf.schema.DataStoreType.WEB_SQL),lf.schema.DataStoreType.OBSERVABLE_STORE=5,goog.exportProperty(lf.schema.DataStoreType,"OBSERVABLE_STORE",lf.schema.DataStoreType.OBSERVABLE_STORE),lf.schema.Index=function(e,t,r,o){this.tableName=e,this.name=t,this.isUnique=r,this.columns=o},lf.schema.Index.prototype.getNormalizedName=function(){return this.tableName+"."+this.name},lf.schema.Index.prototype.hasNullableColumn=function(){return this.columns.some(function(e){return e.schema.isNullable()})},lf.schema.Table=function(e,t,r,o){this.name_=e,this.indices_=r,this.columns_=t,this.persistentIndex_=o,this.alias_=null},goog.exportSymbol("lf.schema.Table",lf.schema.Table),lf.schema.Table.prototype.getName=function(){return this.name_},goog.exportProperty(lf.schema.Table.prototype,"getName",lf.schema.Table.prototype.getName),lf.schema.Table.prototype.getEffectiveName=function(){return this.alias_||this.name_},lf.schema.Table.prototype.as=function(e){var t=new this.constructor(this.name_);return t.alias_=e,t.referencingForeignKeys_=this.referencingForeignKeys_,t},goog.exportProperty(lf.schema.Table.prototype,"as",lf.schema.Table.prototype.as),goog.exportProperty(lf.schema.Table.prototype,"createRow",lf.schema.Table.prototype.createRow),goog.exportProperty(lf.schema.Table.prototype,"deserializeRow",lf.schema.Table.prototype.deserializeRow),lf.schema.Table.prototype.getIndices=function(){return this.indices_},goog.exportProperty(lf.schema.Table.prototype,"getIndices",lf.schema.Table.prototype.getIndices),lf.schema.Table.prototype.getColumns=function(){return this.columns_},goog.exportProperty(lf.schema.Table.prototype,"getColumns",lf.schema.Table.prototype.getColumns),goog.exportProperty(lf.schema.Table.prototype,"getConstraint",lf.schema.Table.prototype.getConstraint),lf.schema.Table.prototype.persistentIndex=function(){return this.persistentIndex_},goog.exportProperty(lf.schema.Table.prototype,"persistentIndex",lf.schema.Table.prototype.persistentIndex),lf.schema.Table.ROW_ID_INDEX_PATTERN="#",lf.schema.Table.prototype.getRowIdIndexName=function(){return this.name_+"."+lf.schema.Table.ROW_ID_INDEX_PATTERN},lf.fn={},lf.fn.AggregatedColumn=function(e,t){this.child=e,this.aggregatorType=t,this.alias_=null},lf.fn.AggregatedColumn.prototype.getName=function(){return this.aggregatorType+"("+this.child.getName()+")"},lf.fn.AggregatedColumn.prototype.getNormalizedName=function(){return this.aggregatorType+"("+this.child.getNormalizedName()+")"},lf.fn.AggregatedColumn.prototype.getTable=function(){return this.child.getTable()},lf.fn.AggregatedColumn.prototype.toString=function(){return this.getNormalizedName()},lf.fn.AggregatedColumn.prototype.getType=function(){return this.child.getType()},lf.fn.AggregatedColumn.prototype.getIndices=function(){return[]},lf.fn.AggregatedColumn.prototype.getIndex=function(){return null},lf.fn.AggregatedColumn.prototype.isNullable=function(){return!1},lf.fn.AggregatedColumn.prototype.as=function(e){return this.alias_=e,this},goog.exportProperty(lf.fn.AggregatedColumn.prototype,"as",lf.fn.AggregatedColumn.prototype.as),lf.fn.AggregatedColumn.prototype.getColumnChain=function(){for(var e=[this],t=this;t instanceof lf.fn.AggregatedColumn;)e.push(t.child),t=t.child;return e},lf.fn.StarColumn=function(e){this.alias_=e||null,this.table_=new lf.schema.Table("#UnknownTable",[],[],(!1))},lf.fn.StarColumn.prototype.getName=function(){return"*"},lf.fn.StarColumn.prototype.getNormalizedName=function(){return this.getName()},lf.fn.StarColumn.prototype.toString=function(){return this.getNormalizedName()},lf.fn.StarColumn.prototype.getTable=function(){return this.table_},lf.fn.StarColumn.prototype.getType=function(){return lf.Type.NUMBER},lf.fn.StarColumn.prototype.getIndices=function(){return[]},lf.fn.StarColumn.prototype.getIndex=function(){return null},lf.fn.StarColumn.prototype.isNullable=function(){return!1},lf.fn.Type={AVG:"AVG",COUNT:"COUNT",DISTINCT:"DISTINCT",GEOMEAN:"GEOMEAN",MAX:"MAX",MIN:"MIN",STDDEV:"STDDEV",SUM:"SUM"},lf.fn.avg=function(e){return new lf.fn.AggregatedColumn(e,lf.fn.Type.AVG)},goog.exportSymbol("lf.fn.avg",lf.fn.avg),lf.fn.count=function(e){var t=e||new lf.fn.StarColumn;return new lf.fn.AggregatedColumn(t,lf.fn.Type.COUNT)},goog.exportSymbol("lf.fn.count",lf.fn.count),lf.fn.distinct=function(e){return new lf.fn.AggregatedColumn(e,lf.fn.Type.DISTINCT)},goog.exportSymbol("lf.fn.distinct",lf.fn.distinct),lf.fn.max=function(e){return new lf.fn.AggregatedColumn(e,lf.fn.Type.MAX)},goog.exportSymbol("lf.fn.max",lf.fn.max),lf.fn.min=function(e){return new lf.fn.AggregatedColumn(e,lf.fn.Type.MIN)},goog.exportSymbol("lf.fn.min",lf.fn.min),lf.fn.stddev=function(e){return new lf.fn.AggregatedColumn(e,lf.fn.Type.STDDEV)},goog.exportSymbol("lf.fn.stddev",lf.fn.stddev),lf.fn.sum=function(e){return new lf.fn.AggregatedColumn(e,lf.fn.Type.SUM)},goog.exportSymbol("lf.fn.sum",lf.fn.sum),lf.fn.geomean=function(e){return new lf.fn.AggregatedColumn(e,lf.fn.Type.GEOMEAN)},goog.exportSymbol("lf.fn.geomean",lf.fn.geomean),lf.proc.PhysicalQueryPlanNode=function(e,t){lf.structs.TreeNode.call(this),this.execType_=t,this.numRelations_=e},goog.inherits(lf.proc.PhysicalQueryPlanNode,lf.structs.TreeNode),lf.proc.PhysicalQueryPlanNode.ExecType={NO_CHILD:-1,ALL:0,FIRST_CHILD:1},lf.proc.PhysicalQueryPlanNode.ANY=-1,lf.proc.PhysicalQueryPlanNode.prototype.exec=function(e,t){switch(this.execType_){case lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD:return this.execFirstChild_(e,t);case lf.proc.PhysicalQueryPlanNode.ExecType.ALL:return this.execAllChildren_(e,t);default:return this.execNoChild_(e,t)}},lf.proc.PhysicalQueryPlanNode.prototype.toString=function(){return"dummy_node"},lf.proc.PhysicalQueryPlanNode.prototype.toContextString=function(){return this.toString()},lf.proc.PhysicalQueryPlanNode.prototype.assertInput_=function(e){goog.asserts.assert(this.numRelations_==lf.proc.PhysicalQueryPlanNode.ANY||e.length==this.numRelations_)},lf.proc.PhysicalQueryPlanNode.prototype.execNoChild_=function(e,t){return new goog.Promise(function(r){r(this.execInternal([],e,t))}.bind(this))},lf.proc.PhysicalQueryPlanNode.prototype.execFirstChild_=function(e,t){return this.getChildAt(0).exec(e,t).then(function(r){return this.assertInput_(r),this.execInternal(r,e,t)}.bind(this))},lf.proc.PhysicalQueryPlanNode.prototype.execAllChildren_=function(e,t){var r=this.getChildren().map(function(r){return r.exec(e,t)});return goog.Promise.all(r).then(function(r){var o=[];return r.forEach(function(e){for(var t=0;t<e.length;++t)o.push(e[t])}),this.assertInput_(o),this.execInternal(o,e,t)}.bind(this))},lf.proc.AggregationStep=function(e){lf.proc.PhysicalQueryPlanNode.call(this,lf.proc.PhysicalQueryPlanNode.ANY,lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD),this.aggregatedColumns=e},goog.inherits(lf.proc.AggregationStep,lf.proc.PhysicalQueryPlanNode),lf.proc.AggregationStep.prototype.toString=function(){var e=this.aggregatedColumns.map(function(e){return e.getNormalizedName()});return"aggregation("+e.toString()+")"},lf.proc.AggregationStep.prototype.execInternal=function(e){return e.forEach(function(e){var t=new lf.proc.AggregationStep.Calculator_(e,this.aggregatedColumns);t.calculate()},this),e},lf.proc.AggregationStep.Calculator_=function(e,t){this.relation_=e,this.columns_=t},lf.proc.AggregationStep.Calculator_.prototype.calculate=function(){
this.columns_.forEach(function(e){for(var t=e.getColumnChain().reverse(),r=1;r<t.length;r++){var o=t[r],n=o.getColumnChain().slice(-1)[0],i=this.getInputRelationFor_(o);if(i.hasAggregationResult(o))break;var s=lf.proc.AggregationStep.Calculator_.evalAggregation_(o.aggregatorType,i,n);this.relation_.setAggregationResult(o,s)}},this)},lf.proc.AggregationStep.Calculator_.prototype.getInputRelationFor_=function(e){return e.child instanceof lf.fn.AggregatedColumn?this.relation_.getAggregationResult(e.child):this.relation_},lf.proc.AggregationStep.Calculator_.evalAggregation_=function(e,t,r){var o=null,n=lf.proc.AggregationStep.Calculator_;switch(e){case lf.fn.Type.MIN:o=n.reduce_(t,r,function(e,t){return t<e?t:e});break;case lf.fn.Type.MAX:o=n.reduce_(t,r,function(e,t){return t>e?t:e});break;case lf.fn.Type.DISTINCT:o=n.distinct_(t,r);break;case lf.fn.Type.COUNT:o=n.count_(t,r);break;case lf.fn.Type.SUM:o=n.sum_(t,r);break;case lf.fn.Type.AVG:var i=n.count_(t,r);0<i&&(o=n.sum_(t,r)/i);break;case lf.fn.Type.GEOMEAN:o=n.geomean_(t,r);break;default:o=n.stddev_(t,r)}return o},lf.proc.AggregationStep.Calculator_.reduce_=function(e,t,r){return e.entries.reduce(function(e,o){var n=o.getField(t);return goog.isNull(n)?e:goog.isNull(e)?n:r(e,n)},null)},lf.proc.AggregationStep.Calculator_.count_=function(e,t){return t instanceof lf.fn.StarColumn?e.entries.length:e.entries.reduce(function(e,r){return e+(goog.isNull(r.getField(t))?0:1)},0)},lf.proc.AggregationStep.Calculator_.sum_=function(e,t){return lf.proc.AggregationStep.Calculator_.reduce_(e,t,function(e,t){return t+e})},lf.proc.AggregationStep.Calculator_.stddev_=function(e,t){var r=[];return e.entries.forEach(function(e){var o=e.getField(t);goog.isNull(o)||r.push(o)}),0==r.length?null:goog.math.standardDeviation.apply(null,r)},lf.proc.AggregationStep.Calculator_.geomean_=function(e,t){var r=0,o=e.entries.reduce(function(e,o){var n=o.getField(t);return 0==n||goog.isNull(n)?e:(r++,e+Math.log(n))},0);return 0==r?null:Math.pow(Math.E,o/r)},lf.proc.AggregationStep.Calculator_.distinct_=function(e,t){var r=lf.structs.map.create();return e.entries.forEach(function(e){var o=e.getField(t);r.set(o,e)}),new lf.proc.Relation(lf.structs.map.values(r),e.getTables())},lf.proc.LogicalQueryPlan=function(e,t){this.rootNode_=e,this.scope_=t},lf.proc.LogicalQueryPlan.prototype.getRoot=function(){return this.rootNode_},lf.proc.LogicalQueryPlan.prototype.getScope=function(){return this.scope_},lf.proc.LogicalQueryPlanNode=function(){lf.structs.TreeNode.call(this)},goog.inherits(lf.proc.LogicalQueryPlanNode,lf.structs.TreeNode),lf.proc.InsertNode=function(e,t){lf.proc.LogicalQueryPlanNode.call(this),this.table=e,this.values=t},goog.inherits(lf.proc.InsertNode,lf.proc.LogicalQueryPlanNode),lf.proc.InsertOrReplaceNode=function(e,t){lf.proc.InsertNode.call(this,e,t)},goog.inherits(lf.proc.InsertOrReplaceNode,lf.proc.InsertNode),lf.proc.DeleteNode=function(e){lf.proc.LogicalQueryPlanNode.call(this),this.table=e},goog.inherits(lf.proc.DeleteNode,lf.proc.LogicalQueryPlanNode),lf.proc.DeleteNode.prototype.toString=function(){return"delete("+this.table.getName()+")"},lf.proc.UpdateNode=function(e){lf.proc.LogicalQueryPlanNode.call(this),this.table=e},goog.inherits(lf.proc.UpdateNode,lf.proc.LogicalQueryPlanNode),lf.proc.UpdateNode.prototype.toString=function(){return"update("+this.table.getName()+")"},lf.proc.SelectNode=function(e){lf.proc.LogicalQueryPlanNode.call(this),this.predicate=e},goog.inherits(lf.proc.SelectNode,lf.proc.LogicalQueryPlanNode),lf.proc.SelectNode.prototype.toString=function(){return"select("+this.predicate.toString()+")"},lf.proc.TableAccessNode=function(e){lf.proc.LogicalQueryPlanNode.call(this),this.table=e},goog.inherits(lf.proc.TableAccessNode,lf.proc.LogicalQueryPlanNode),lf.proc.TableAccessNode.prototype.toString=function(){var e="table_access("+this.table.getName();return goog.isNull(this.table.alias_)||(e+=" as "+this.table.alias_),e+=")"},lf.proc.CrossProductNode=function(){lf.proc.LogicalQueryPlanNode.call(this)},goog.inherits(lf.proc.CrossProductNode,lf.proc.LogicalQueryPlanNode),lf.proc.CrossProductNode.prototype.toString=function(){return"cross_product"},lf.proc.ProjectNode=function(e,t){lf.proc.LogicalQueryPlanNode.call(this),this.columns=e,this.groupByColumns=t},goog.inherits(lf.proc.ProjectNode,lf.proc.LogicalQueryPlanNode),lf.proc.ProjectNode.prototype.toString=function(){var e="project("+this.columns.toString();if(!goog.isNull(this.groupByColumns))var t=this.groupByColumns.map(function(e){return e.getNormalizedName()}).join(", "),e=e+(", groupBy("+t+")");return e+=")"},lf.proc.OrderByNode=function(e){lf.proc.LogicalQueryPlanNode.call(this),this.orderBy=e},goog.inherits(lf.proc.OrderByNode,lf.proc.LogicalQueryPlanNode),lf.proc.OrderByNode.prototype.toString=function(){return"order_by("+lf.query.SelectContext.orderByToString(this.orderBy)+")"},lf.proc.AggregationNode=function(e){lf.proc.LogicalQueryPlanNode.call(this),this.columns=e},goog.inherits(lf.proc.AggregationNode,lf.proc.LogicalQueryPlanNode),lf.proc.AggregationNode.prototype.toString=function(){return"aggregation("+this.columns.toString()+")"},lf.proc.GroupByNode=function(e){lf.proc.LogicalQueryPlanNode.call(this),this.columns=e},goog.inherits(lf.proc.GroupByNode,lf.proc.LogicalQueryPlanNode),lf.proc.GroupByNode.prototype.toString=function(){return"group_by("+this.columns.toString()+")"},lf.proc.LimitNode=function(e){lf.proc.LogicalQueryPlanNode.call(this),this.limit=e},goog.inherits(lf.proc.LimitNode,lf.proc.LogicalQueryPlanNode),lf.proc.LimitNode.prototype.toString=function(){return"limit("+this.limit+")"},lf.proc.SkipNode=function(e){lf.proc.LogicalQueryPlanNode.call(this),this.skip=e},goog.inherits(lf.proc.SkipNode,lf.proc.LogicalQueryPlanNode),lf.proc.SkipNode.prototype.toString=function(){return"skip("+this.skip+")"},lf.proc.JoinNode=function(e,t){lf.proc.LogicalQueryPlanNode.call(this),this.predicate=e,this.isOuterJoin=t},goog.inherits(lf.proc.JoinNode,lf.proc.LogicalQueryPlanNode),lf.proc.JoinNode.prototype.toString=function(){return"join(type: "+(this.isOuterJoin?"outer":"inner")+", "+this.predicate.toString()+")"},lf.proc.RewritePass=function(){},lf.proc.AndPredicatePass=function(){},goog.inherits(lf.proc.AndPredicatePass,lf.proc.RewritePass),lf.proc.AndPredicatePass.prototype.rewrite=function(e){return this.rootNode=e,this.traverse_(this.rootNode),this.rootNode},lf.proc.AndPredicatePass.prototype.traverse_=function(e){if(e instanceof lf.proc.SelectNode){goog.asserts.assert(1==e.getChildCount(),"SelectNode must have exactly one child.");var t=this.breakAndPredicate_(e.predicate),r=this.createSelectNodeChain_(t);lf.tree.replaceNodeWithChain(e,r[0],r[1]),e==this.rootNode&&(this.rootNode=r[0]),e=r[0]}e.getChildren().forEach(function(e){this.traverse_(e)},this)},lf.proc.AndPredicatePass.prototype.breakAndPredicate_=function(e){if(0==e.getChildCount())return[e];var t=e;if(t.operator!=lf.pred.Operator.AND)return[e];var r=t.getChildren().slice().map(function(e){return t.removeChild(e),this.breakAndPredicate_(e)},this);return goog.array.flatten(r)},lf.proc.AndPredicatePass.prototype.createSelectNodeChain_=function(e){var t=null,r=null;return e.map(function(e,o){var n=new lf.proc.SelectNode(e);0==o?t=n:r.addChild(n),r=n},this),[t,r]},lf.proc.CrossProductPass=function(){},goog.inherits(lf.proc.CrossProductPass,lf.proc.RewritePass),lf.proc.CrossProductPass.prototype.rewrite=function(e,t){return 3>t.from.length?e:(this.rootNode=e,this.traverse_(this.rootNode),this.rootNode)},lf.proc.CrossProductPass.prototype.traverse_=function(e){if(e instanceof lf.proc.CrossProductNode)for(;2<e.getChildCount();){for(var t=new lf.proc.CrossProductNode,r=0;2>r;r++){var o=e.removeChildAt(0);t.addChild(o)}e.addChildAt(t,0)}e.getChildren().forEach(function(e){this.traverse_(e)},this)},lf.proc.CrossProductStep=function(){lf.proc.PhysicalQueryPlanNode.call(this,2,lf.proc.PhysicalQueryPlanNode.ExecType.ALL)},goog.inherits(lf.proc.CrossProductStep,lf.proc.PhysicalQueryPlanNode),lf.proc.CrossProductStep.prototype.toString=function(){return"cross_product"},lf.proc.CrossProductStep.prototype.execInternal=function(e){return lf.proc.CrossProductStep.crossProduct_(e[0],e[1])},lf.proc.CrossProductStep.crossProduct_=function(e,t){for(var r=[],o=e.getTables(),n=t.getTables(),i=0;i<e.entries.length;i++)for(var s=0;s<t.entries.length;s++){var a=lf.proc.RelationEntry.combineEntries(e.entries[i],o,t.entries[s],n);r.push(a)}var l=e.getTables().concat(t.getTables());return[new lf.proc.Relation(r,l)]},lf.query.Builder=function(){},lf.query.Select=function(){},lf.query.Insert=function(){},lf.query.Update=function(){},lf.query.Delete=function(){},lf.proc.UserQueryTask=function(e,t){lf.proc.QueryTask.call(this,e,t),this.runner_=e.getService(lf.service.RUNNER),this.observerRegistry_=e.getService(lf.service.OBSERVER_REGISTRY)},goog.inherits(lf.proc.UserQueryTask,lf.proc.QueryTask),lf.proc.UserQueryTask.prototype.getPriority=function(){return lf.proc.TaskPriority.USER_QUERY_TASK},lf.proc.UserQueryTask.prototype.onSuccess=function(e){this.getType()==lf.TransactionType.READ_ONLY?this.notifyObserversDirectly_(e):this.scheduleObserverTask_()},lf.proc.UserQueryTask.prototype.notifyObserversDirectly_=function(e){this.queries.forEach(function(t,r){t instanceof lf.query.SelectContext&&this.observerRegistry_.updateResultsForQuery(t,e[r])},this)},lf.proc.UserQueryTask.prototype.scheduleObserverTask_=function(){var e=this.observerRegistry_.getTaskItemsForTables(this.getScope());if(0!=e.length){var t=new lf.proc.ObserverQueryTask(this.global,e);this.runner_.scheduleTask(t)}},lf.query.DeleteContext=function(e){lf.query.Context.call(this,e)},goog.inherits(lf.query.DeleteContext,lf.query.Context),lf.query.DeleteContext.prototype.getScope=function(){var e=lf.structs.set.create();return e.add(this.from),this.expandTableScope_(this.from.getName(),e),e},lf.query.DeleteContext.prototype.expandTableScope_=function(e,t){var r=this.schema.info().getChildTables(e,lf.ConstraintAction.CASCADE),o=this.schema.info().getChildTables(e);o.forEach(t.add.bind(t)),r.forEach(function(e){this.expandTableScope_(e.getName(),t)},this)},lf.query.DeleteContext.prototype.clone=function(){var e=new lf.query.DeleteContext(this.schema);return e.cloneBase(this),e.from=this.from,e},lf.query.DeleteContext.prototype.bind=function(e){return lf.query.DeleteContext.superClass_.bind.call(this,e),this.bindValuesInSearchCondition(e),this},lf.query.InsertContext=function(e){lf.query.Context.call(this,e)},goog.inherits(lf.query.InsertContext,lf.query.Context),lf.query.InsertContext.prototype.getScope=function(){var e=lf.structs.set.create();e.add(this.into);var t=this.schema.info();return t.getParentTables(this.into.getName()).forEach(e.add.bind(e)),this.allowReplace&&t.getChildTables(this.into.getName()).forEach(e.add.bind(e)),e},lf.query.InsertContext.prototype.clone=function(){var e=new lf.query.InsertContext(this.schema);return e.cloneBase(this),e.into=this.into,this.values&&(e.values=this.values instanceof lf.Binder?this.values:this.values.slice()),e.allowReplace=this.allowReplace,e.binder=this.binder,e},lf.query.InsertContext.prototype.bind=function(e){return lf.query.InsertContext.superClass_.bind.call(this,e),this.binder&&(this.values=this.binder instanceof lf.Binder?e[this.binder.getIndex()]:this.binder.map(function(t){return t instanceof lf.Binder?e[t.getIndex()]:t})),this},lf.query.UpdateContext=function(e){lf.query.Context.call(this,e)},goog.inherits(lf.query.UpdateContext,lf.query.Context),lf.query.UpdateContext.prototype.getScope=function(){var e=lf.structs.set.create();e.add(this.table);var t=this.set.map(function(e){return e.column.getNormalizedName()}),r=this.schema.info();return r.getParentTablesByColumns(t).forEach(e.add.bind(e)),r.getChildTablesByColumns(t).forEach(e.add.bind(e)),e},lf.query.UpdateContext.prototype.clone=function(){var e=new lf.query.UpdateContext(this.schema);return e.cloneBase(this),e.table=this.table,e.set=this.set?lf.query.UpdateContext.cloneSet_(this.set):this.set,e},lf.query.UpdateContext.prototype.bind=function(e){return lf.query.UpdateContext.superClass_.bind.call(this,e),this.set.forEach(function(t){-1!=t.binding&&(t.value=e[t.binding])}),this.bindValuesInSearchCondition(e),this},lf.query.UpdateContext.cloneSet_=function(e){return e.map(function(e){var t,r={};for(t in e)r[t]=e[t];return r})},lf.query.escapeSqlValue_=function(e,t){if(!goog.isDefAndNotNull(t))return"NULL";switch(e){case lf.Type.BOOLEAN:return t?1:0;case lf.Type.INTEGER:case lf.Type.NUMBER:return t;case lf.Type.ARRAY_BUFFER:return"'"+lf.Row.binToHex(t)+"'";default:return"'"+t.toString()+"'"}},lf.query.insertToSql_=function(e,t){var r=e.allowReplace?"INSERT OR REPLACE":"INSERT",o=e.into.getColumns(),r=r+(" INTO "+e.into.getName()+"("),r=r+o.map(function(e){return e.getName()}).join(", "),r=r+") VALUES (",n=e.values.map(function(e){var n=o.map(function(r){var o=e.payload_[r.getName()];return t?goog.isDefAndNotNull(o)?"#":"NULL":lf.query.escapeSqlValue_(r.getType(),o)});return r+n.join(", ")+");"});return n.join("\n")},lf.query.evaluatorToSql_=function(e){switch(e){case lf.eval.Type.BETWEEN:return"BETWEEN";case lf.eval.Type.EQ:return"=";case lf.eval.Type.GTE:return">=";case lf.eval.Type.GT:return">";case lf.eval.Type.IN:return"IN";case lf.eval.Type.LTE:return"<=";case lf.eval.Type.LT:return"<";case lf.eval.Type.MATCH:return"LIKE";case lf.eval.Type.NEQ:return"<>";default:return"UNKNOWN"}},lf.query.valueToSql_=function(e,t,r,o){if(e instanceof lf.Binder)return"?"+e.getIndex().toString();if(o)return goog.isDefAndNotNull(e)?"#":"NULL";if(t==lf.eval.Type.MATCH)return"'"+e.toString()+"'";if(t==lf.eval.Type.IN){var n=e,i=n.map(function(e){return lf.query.escapeSqlValue_(r,e)});return"("+i.join(", ")+")"}return t==lf.eval.Type.BETWEEN?lf.query.escapeSqlValue_(r,e[0])+" AND "+lf.query.escapeSqlValue_(r,e[1]):lf.query.escapeSqlValue_(r,e).toString()},lf.query.valuePredicateToSql_=function(e,t){var r=e.column.getNormalizedName(),o=lf.query.evaluatorToSql_(e.evaluatorType),n=lf.query.valueToSql_(e.value,e.evaluatorType,e.column.getType(),t);return"="==o&&"NULL"==n?[r,"IS NULL"].join(" "):"<>"==o&&"NULL"==n?[r,"IS NOT NULL"].join(" "):[r,o,n].join(" ")},lf.query.combinedPredicateToSql_=function(e,t){var r=e.getChildren().map(function(e){return"("+lf.query.parseSearchCondition_(e,t)+")"}),o=e.operator==lf.pred.Operator.AND?" AND ":" OR ";return r.join(o)},lf.query.joinPredicateToSql_=function(e){return[e.leftColumn.getNormalizedName(),lf.query.evaluatorToSql_(e.evaluatorType),e.rightColumn.getNormalizedName()].join(" ")},lf.query.parseSearchCondition_=function(e,t){if(e instanceof lf.pred.ValuePredicate)return lf.query.valuePredicateToSql_(e,t);if(e instanceof lf.pred.CombinedPredicate)return lf.query.combinedPredicateToSql_(e,t);if(e instanceof lf.pred.JoinPredicate)return lf.query.joinPredicateToSql_(e);throw new lf.Exception(357,(typeof e))},lf.query.predicateToSql_=function(e,t){var r=lf.query.parseSearchCondition_(e,t);return r?" WHERE "+r:""},lf.query.deleteToSql_=function(e,t){var r="DELETE FROM "+e.from.getName();return e.where&&(r+=lf.query.predicateToSql_(e.where,t)),r+=";"},lf.query.updateToSql_=function(e,t){var r="UPDATE "+e.table.getName()+" SET ",r=r+e.set.map(function(e){var t=e.column.getNormalizedName()+" = ";return-1!=e.binding?t+"?"+e.binding.toString():t+lf.query.escapeSqlValue_(e.column.getType(),e.value).toString()}).join(", ");return e.where&&(r+=lf.query.predicateToSql_(e.where,t)),r+=";"},lf.query.selectToSql_=function(e,t){var r="*";e.columns.length&&(r=e.columns.map(function(e){return e.alias_?e.getNormalizedName()+" AS "+e.alias_:e.getNormalizedName()}).join(", "));var o="SELECT "+r+" FROM ";if(goog.isDefAndNotNull(e.outerJoinPredicates)&&0!=e.outerJoinPredicates.size?o+=lf.query.getFromListForOuterJoin_(e,t):(o+=lf.query.getFromListForInnerJoin_(e,t),e.where&&(o+=lf.query.predicateToSql_(e.where,t))),e.orderBy)var n=e.orderBy.map(function(e){return e.column.getNormalizedName()+(e.order==lf.Order.DESC?" DESC":" ASC")}).join(", "),o=o+(" ORDER BY "+n);if(e.groupBy)var i=e.groupBy.map(function(e){return e.getNormalizedName()}).join(", "),o=o+(" GROUP BY "+i);return e.limit&&(o+=" LIMIT "+e.limit.toString()),e.skip&&(o+=" SKIP "+e.skip.toString()),o+=";"},lf.query.getTableNameToSql_=function(e){return e.getEffectiveName()!=e.getName()?e.getName()+" AS "+e.getEffectiveName():e.getName()},lf.query.getFromListForOuterJoin_=function(e,t){for(var r=lf.tree.find(e.where,function(e){return e instanceof lf.pred.JoinPredicate}),o=r.map(lf.query.joinPredicateToSql_),n=lf.query.getTableNameToSql_(e.from[0]),i=1;i<e.from.length;i++)var s=lf.query.getTableNameToSql_(e.from[i]),n=e.outerJoinPredicates.has(r[o.length-i].getId())?n+(" LEFT OUTER JOIN "+s):n+(" INNER JOIN "+s),n=n+(" ON ("+o[o.length-i]+")");var a=e.where.getChildAt(0);return a instanceof lf.pred.JoinPredicate||(n+=" WHERE "+lf.query.parseSearchCondition_(a,t)),n},lf.query.getFromListForInnerJoin_=function(e){return e.from.map(lf.query.getTableNameToSql_).join(", ")},lf.query.toSql=function(e,t){var r=t||!1,o=e.getQuery();if(o instanceof lf.query.InsertContext)return lf.query.insertToSql_(o,r);if(o instanceof lf.query.DeleteContext)return lf.query.deleteToSql_(o,r);if(o instanceof lf.query.UpdateContext)return lf.query.updateToSql_(o,r);if(o instanceof lf.query.SelectContext)return lf.query.selectToSql_(o,r);throw new lf.Exception(358,(typeof o))},lf.query.BaseBuilder=function(e,t){this.global=e,this.queryEngine_=e.getService(lf.service.QUERY_ENGINE),this.runner_=e.getService(lf.service.RUNNER),this.query=t},goog.exportSymbol("lf.query.BaseBuilder",lf.query.BaseBuilder),lf.query.BaseBuilder.prototype.exec=function(){try{this.assertExecPreconditions()}catch(e){return goog.Promise.reject(e)}return new goog.Promise(function(e,t){var r=new lf.proc.UserQueryTask(this.global,[this.getTaskItem()]);this.runner_.scheduleTask(r).then(function(t){e(t[0].getPayloads())},t)},this)},goog.exportProperty(lf.query.BaseBuilder.prototype,"exec",lf.query.BaseBuilder.prototype.exec),lf.query.BaseBuilder.prototype.explain=function(){var e=function(e){return e.toContextString(this.query)+"\n"}.bind(this);return lf.tree.toString(this.getPlan_().getRoot(),e)},goog.exportProperty(lf.query.BaseBuilder.prototype,"explain",lf.query.BaseBuilder.prototype.explain),lf.query.BaseBuilder.prototype.bind=function(e){return this.query.bind(e),this},goog.exportProperty(lf.query.BaseBuilder.prototype,"bind",lf.query.BaseBuilder.prototype.bind),lf.query.BaseBuilder.prototype.toSql=function(e){return lf.query.toSql(this,e)},goog.exportProperty(lf.query.BaseBuilder.prototype,"toSql",lf.query.BaseBuilder.prototype.toSql),lf.query.BaseBuilder.prototype.assertExecPreconditions=function(){},lf.query.BaseBuilder.prototype.getQuery=function(){return this.query.clone()},lf.query.BaseBuilder.prototype.getPlan_=function(){return goog.isDefAndNotNull(this.plan_)||(this.plan_=this.queryEngine_.getPlan(this.query)),this.plan_},lf.query.BaseBuilder.prototype.getTaskItem=function(){return{context:this.getQuery(),plan:this.getPlan_()}},lf.query.BaseBuilder.prototype.getObservableTaskItem=function(){return{context:this.query,plan:this.getPlan_()}},lf.query.DeleteBuilder=function(e){lf.query.BaseBuilder.call(this,e,new lf.query.DeleteContext(e.getService(lf.service.SCHEMA)))},goog.inherits(lf.query.DeleteBuilder,lf.query.BaseBuilder),goog.exportSymbol("lf.query.DeleteBuilder",lf.query.DeleteBuilder),lf.query.DeleteBuilder.prototype.from=function(e){return this.assertFromPreconditions_(),this.query.from=e,this},goog.exportProperty(lf.query.DeleteBuilder.prototype,"from",lf.query.DeleteBuilder.prototype.from),lf.query.DeleteBuilder.prototype.where=function(e){return this.assertWherePreconditions_(),this.query.where=e,this},goog.exportProperty(lf.query.DeleteBuilder.prototype,"where",lf.query.DeleteBuilder.prototype.where),lf.query.DeleteBuilder.prototype.assertFromPreconditions_=function(){if(goog.isDefAndNotNull(this.query.from))throw new lf.Exception(515)},lf.query.DeleteBuilder.prototype.assertWherePreconditions_=function(){if(!goog.isDefAndNotNull(this.query.from))throw new lf.Exception(548);if(goog.isDefAndNotNull(this.query.where))throw new lf.Exception(516)},lf.query.DeleteBuilder.prototype.assertExecPreconditions=function(){if(lf.query.DeleteBuilder.superClass_.assertExecPreconditions.call(this),!goog.isDefAndNotNull(this.query.from))throw new lf.Exception(517)},lf.query.InsertBuilder=function(e,t){lf.query.BaseBuilder.call(this,e,new lf.query.InsertContext(e.getService(lf.service.SCHEMA))),this.query.allowReplace=t||!1},goog.inherits(lf.query.InsertBuilder,lf.query.BaseBuilder),goog.exportSymbol("lf.query.InsertBuilder",lf.query.InsertBuilder),lf.query.InsertBuilder.prototype.assertExecPreconditions=function(){lf.query.InsertBuilder.superClass_.assertExecPreconditions.call(this);var e=this.query;if(!goog.isDefAndNotNull(e.into)||!goog.isDefAndNotNull(e.values))throw new lf.Exception(518);if(e.allowReplace&&goog.isNull(e.into.constraint_.primaryKey_))throw new lf.Exception(519)},lf.query.InsertBuilder.prototype.into=function(e){return this.assertIntoPreconditions_(),this.query.into=e,this},goog.exportProperty(lf.query.InsertBuilder.prototype,"into",lf.query.InsertBuilder.prototype.into),lf.query.InsertBuilder.prototype.values=function(e){return this.assertValuesPreconditions_(),e instanceof lf.Binder||e.some(function(e){return e instanceof lf.Binder})?this.query.binder=e:this.query.values=e,this},goog.exportProperty(lf.query.InsertBuilder.prototype,"values",lf.query.InsertBuilder.prototype.values),lf.query.InsertBuilder.prototype.assertIntoPreconditions_=function(){if(goog.isDefAndNotNull(this.query.into))throw new lf.Exception(520)},lf.query.InsertBuilder.prototype.assertValuesPreconditions_=function(){if(goog.isDefAndNotNull(this.query.values))throw new lf.Exception(521)},lf.op={},lf.op.and=function(e){var t=Array.prototype.slice.call(arguments);return lf.op.createPredicate_(lf.pred.Operator.AND,t)},goog.exportSymbol("lf.op.and",lf.op.and),lf.op.or=function(e){var t=Array.prototype.slice.call(arguments);return lf.op.createPredicate_(lf.pred.Operator.OR,t)},goog.exportSymbol("lf.op.or",lf.op.or),lf.op.createPredicate_=function(e,t){var r=new lf.pred.CombinedPredicate(e);return t.forEach(function(e){r.addChild(e)}),r},lf.op.not=function(e){return e.setComplement(!0),e},goog.exportSymbol("lf.op.not",lf.op.not),lf.query.SelectBuilder=function(e,t){lf.query.BaseBuilder.call(this,e,new lf.query.SelectContext(e.getService(lf.service.SCHEMA))),this.fromAlreadyCalled_=this.whereAlreadyCalled_=!1,this.query.columns=t,this.checkDistinctColumn_(),this.checkAggregations_()},goog.inherits(lf.query.SelectBuilder,lf.query.BaseBuilder),goog.exportSymbol("lf.query.SelectBuilder",lf.query.SelectBuilder),lf.query.SelectBuilder.prototype.assertExecPreconditions=function(){lf.query.SelectBuilder.superClass_.assertExecPreconditions.call(this);var e=this.query;if(!goog.isDefAndNotNull(e.from))throw new lf.Exception(522);if(goog.isDef(e.limitBinder)&&!goog.isDef(e.limit)||goog.isDef(e.skipBinder)&&!goog.isDef(e.skip))throw new lf.Exception(523);this.checkProjectionList_()},lf.query.SelectBuilder.prototype.checkDistinctColumn_=function(){var e=this.query.columns.filter(function(e){return e instanceof lf.fn.AggregatedColumn&&e.aggregatorType==lf.fn.Type.DISTINCT},this),t=0==e.length||1==e.length&&1==this.query.columns.length;if(!t)throw new lf.Exception(524)},lf.query.SelectBuilder.prototype.checkProjectionList_=function(){goog.isDefAndNotNull(this.query.groupBy)?this.checkGroupByColumns_():this.checkProjectionListNotMixed_()},lf.query.SelectBuilder.prototype.checkGroupByColumns_=function(){var e=this.query.groupBy.some(function(e){var t=e.getType();return t==lf.Type.OBJECT||t==lf.Type.ARRAY_BUFFER});if(e)throw new lf.Exception(525)},lf.query.SelectBuilder.prototype.checkProjectionListNotMixed_=function(){var e=this.query.columns.some(function(e){return e instanceof lf.fn.AggregatedColumn},this),t=this.query.columns.some(function(e){return!(e instanceof lf.fn.AggregatedColumn)},this)||0==this.query.columns.length;if(e&&t)throw new lf.Exception(526)},lf.query.SelectBuilder.prototype.checkAggregations_=function(){this.query.columns.forEach(function(e){var t=!(e instanceof lf.fn.AggregatedColumn)||lf.query.SelectBuilder.isAggregationValid_(e.aggregatorType,e.getType());if(!t)throw new lf.Exception(527,e.getNormalizedName())},this)},lf.query.SelectBuilder.prototype.checkFrom_=function(e){if(!goog.isDefAndNotNull(this.query.from))throw new lf.Exception(e)},lf.query.SelectBuilder.prototype.from=function(e){if(this.fromAlreadyCalled_)throw new lf.Exception(515);return this.fromAlreadyCalled_=!0,goog.isDefAndNotNull(this.query.from)||(this.query.from=[]),this.query.from.push.apply(this.query.from,Array.prototype.slice.call(arguments)),this},goog.exportProperty(lf.query.SelectBuilder.prototype,"from",lf.query.SelectBuilder.prototype.from),lf.query.SelectBuilder.prototype.where=function(e){if(this.checkFrom_(548),this.whereAlreadyCalled_)throw new lf.Exception(516);return this.whereAlreadyCalled_=!0,this.augmentWhereClause_(e),this},goog.exportProperty(lf.query.SelectBuilder.prototype,"where",lf.query.SelectBuilder.prototype.where),lf.query.SelectBuilder.prototype.augmentWhereClause_=function(e){if(goog.isDefAndNotNull(this.query.where)){var t=lf.op.and(e,this.query.where);this.query.where=t}else this.query.where=e},lf.query.SelectBuilder.prototype.innerJoin=function(e,t){if(this.checkFrom_(542),this.whereAlreadyCalled_)throw new lf.Exception(547);return this.query.from.push(e),this.augmentWhereClause_(t),this},goog.exportProperty(lf.query.SelectBuilder.prototype,"innerJoin",lf.query.SelectBuilder.prototype.innerJoin),lf.query.SelectBuilder.prototype.leftOuterJoin=function(e,t){if(this.checkFrom_(542),!(t instanceof lf.pred.JoinPredicate))throw new lf.Exception(541);if(this.whereAlreadyCalled_)throw new lf.Exception(547);this.query.from.push(e),goog.isDefAndNotNull(this.query.outerJoinPredicates)||(this.query.outerJoinPredicates=lf.structs.set.create());var r=t;return e.getEffectiveName()!=t.rightColumn.getTable().getEffectiveName()&&(r=t.reverse()),this.query.outerJoinPredicates.add(r.getId()),this.augmentWhereClause_(r),this},goog.exportProperty(lf.query.SelectBuilder.prototype,"leftOuterJoin",lf.query.SelectBuilder.prototype.leftOuterJoin),lf.query.SelectBuilder.prototype.limit=function(e){if(goog.isDefAndNotNull(this.query.limit||this.query.limitBinder))throw new lf.Exception(528);if(e instanceof lf.Binder)this.query.limitBinder=e;else{if(0>e)throw new lf.Exception(531);this.query.limit=e}return this},goog.exportProperty(lf.query.SelectBuilder.prototype,"limit",lf.query.SelectBuilder.prototype.limit),lf.query.SelectBuilder.prototype.skip=function(e){if(goog.isDefAndNotNull(this.query.skip||this.query.skipBinder))throw new lf.Exception(529);if(e instanceof lf.Binder)this.query.skipBinder=e;else{if(0>e)throw new lf.Exception(531);this.query.skip=e}return this},goog.exportProperty(lf.query.SelectBuilder.prototype,"skip",lf.query.SelectBuilder.prototype.skip),lf.query.SelectBuilder.prototype.orderBy=function(e,t){return this.checkFrom_(549),goog.isDefAndNotNull(this.query.orderBy)||(this.query.orderBy=[]),this.query.orderBy.push({column:e,order:goog.isDefAndNotNull(t)?t:lf.Order.ASC}),this},goog.exportProperty(lf.query.SelectBuilder.prototype,"orderBy",lf.query.SelectBuilder.prototype.orderBy),lf.query.SelectBuilder.prototype.groupBy=function(e){if(this.checkFrom_(549),goog.isDefAndNotNull(this.query.groupBy))throw new lf.Exception(530);return goog.isDefAndNotNull(this.query.groupBy)||(this.query.groupBy=[]),this.query.groupBy.push.apply(this.query.groupBy,Array.prototype.slice.call(arguments)),this},goog.exportProperty(lf.query.SelectBuilder.prototype,"groupBy",lf.query.SelectBuilder.prototype.groupBy),lf.query.SelectBuilder.isAggregationValid_=function(e,t){switch(e){case lf.fn.Type.COUNT:case lf.fn.Type.DISTINCT:return!0;case lf.fn.Type.AVG:case lf.fn.Type.GEOMEAN:case lf.fn.Type.STDDEV:case lf.fn.Type.SUM:return t==lf.Type.NUMBER||t==lf.Type.INTEGER;case lf.fn.Type.MAX:case lf.fn.Type.MIN:return t==lf.Type.NUMBER||t==lf.Type.INTEGER||t==lf.Type.STRING||t==lf.Type.DATE_TIME}return!1},lf.query.SelectBuilder.prototype.clone=function(){var e=new lf.query.SelectBuilder(this.global,this.query.columns);return e.query=this.query.clone(),e.query.clonedFrom=null,e},goog.exportProperty(lf.query.SelectBuilder.prototype,"clone",lf.query.SelectBuilder.prototype.clone),lf.query.UpdateBuilder=function(e,t){lf.query.BaseBuilder.call(this,e,new lf.query.UpdateContext(e.getService(lf.service.SCHEMA))),this.query.table=t},goog.inherits(lf.query.UpdateBuilder,lf.query.BaseBuilder),goog.exportSymbol("lf.query.UpdateBuilder",lf.query.UpdateBuilder),lf.query.UpdateBuilder.prototype.set=function(e,t){var r={binding:t instanceof lf.Binder?t.getIndex():-1,column:e,value:t};return goog.isDefAndNotNull(this.query.set)?this.query.set.push(r):this.query.set=[r],this},goog.exportProperty(lf.query.UpdateBuilder.prototype,"set",lf.query.UpdateBuilder.prototype.set),lf.query.UpdateBuilder.prototype.where=function(e){return this.assertWherePreconditions_(),this.query.where=e,this},goog.exportProperty(lf.query.UpdateBuilder.prototype,"where",lf.query.UpdateBuilder.prototype.where),lf.query.UpdateBuilder.prototype.assertWherePreconditions_=function(){if(goog.isDefAndNotNull(this.query.where))throw new lf.Exception(516)},lf.query.UpdateBuilder.prototype.assertExecPreconditions=function(){if(lf.query.UpdateBuilder.superClass_.assertExecPreconditions.call(this),!goog.isDefAndNotNull(this.query.set))throw new lf.Exception(532);var e=this.query.set.some(function(e){return e.value instanceof lf.Binder});if(e)throw new lf.Exception(501)},lf.proc.LogicalPlanGenerator=function(){},lf.proc.LogicalPlanGenerator.prototype.generate=function(){},lf.proc.BaseLogicalPlanGenerator=function(e){this.query=e,this.rootNode_=null},lf.proc.BaseLogicalPlanGenerator.prototype.generate=function(){return goog.isNull(this.rootNode_)&&(this.rootNode_=this.generateInternal()),this.rootNode_},lf.proc.InsertLogicalPlanGenerator=function(e){lf.proc.BaseLogicalPlanGenerator.call(this,e)},goog.inherits(lf.proc.InsertLogicalPlanGenerator,lf.proc.BaseLogicalPlanGenerator),lf.proc.InsertLogicalPlanGenerator.prototype.generateInternal=function(){return this.query.allowReplace?new lf.proc.InsertOrReplaceNode(this.query.into,this.query.values):new lf.proc.InsertNode(this.query.into,this.query.values)},lf.proc.UpdateLogicalPlanGenerator=function(e){lf.proc.BaseLogicalPlanGenerator.call(this,e)},goog.inherits(lf.proc.UpdateLogicalPlanGenerator,lf.proc.BaseLogicalPlanGenerator),lf.proc.UpdateLogicalPlanGenerator.prototype.generateInternal=function(){var e=new lf.proc.UpdateNode(this.query.table),t=goog.isDefAndNotNull(this.query.where)?new lf.proc.SelectNode(this.query.where.copy()):null,r=new lf.proc.TableAccessNode(this.query.table);return goog.isNull(t)?e.addChild(r):(t.addChild(r),e.addChild(t)),e},lf.proc.LogicalPlanRewriter=function(e,t,r){this.rootNode_=e,this.queryContext_=t,this.rewritePasses_=r},lf.proc.LogicalPlanRewriter.prototype.generate=function(){return this.rewritePasses_.forEach(function(e){this.rootNode_=e.rewrite(this.rootNode_,this.queryContext_)},this),this.rootNode_},lf.proc.DeleteLogicalPlanGenerator=function(e,t){lf.proc.BaseLogicalPlanGenerator.call(this,e),this.rewritePasses_=t},goog.inherits(lf.proc.DeleteLogicalPlanGenerator,lf.proc.BaseLogicalPlanGenerator),lf.proc.DeleteLogicalPlanGenerator.prototype.generateInternal=function(){var e=new lf.proc.DeleteNode(this.query.from),t=goog.isDefAndNotNull(this.query.where)?new lf.proc.SelectNode(this.query.where.copy()):null,r=new lf.proc.TableAccessNode(this.query.from);goog.isNull(t)?e.addChild(r):(t.addChild(r),e.addChild(t));var o=new lf.proc.LogicalPlanRewriter(e,this.query,this.rewritePasses_);return o.generate();
},lf.proc.ImplicitJoinsPass=function(){},goog.inherits(lf.proc.ImplicitJoinsPass,lf.proc.RewritePass),lf.proc.ImplicitJoinsPass.prototype.rewrite=function(e,t){return 2>t.from.length?e:(this.rootNode=e,this.traverse_(this.rootNode,t),this.rootNode)},lf.proc.ImplicitJoinsPass.prototype.traverse_=function(e,t){if(e instanceof lf.proc.SelectNode&&e.predicate instanceof lf.pred.JoinPredicate){goog.asserts.assert(1==e.getChildCount(),"SelectNode must have exactly one child.");var r=e.predicate.getId(),o=e.getChildAt(0);if(o instanceof lf.proc.CrossProductNode){var n=goog.isDefAndNotNull(t.outerJoinPredicates)&&t.outerJoinPredicates.has(r),i=new lf.proc.JoinNode(e.predicate,n);lf.tree.replaceChainWithNode(e,o,i),e==this.rootNode&&(this.rootNode=i),e=i}}e.getChildren().forEach(function(e){this.traverse_(e,t)},this)},lf.proc.PushDownSelectionsPass=function(){this.alreadyPushedDown_=lf.structs.set.create()},goog.inherits(lf.proc.PushDownSelectionsPass,lf.proc.RewritePass),lf.proc.PushDownSelectionsPass.prototype.clear_=function(){this.alreadyPushedDown_.clear()},lf.proc.PushDownSelectionsPass.prototype.rewrite=function(e,t){return goog.isDef(t.where)?(this.clear_(),this.rootNode=e,this.traverse_(this.rootNode,t),this.clear_(),this.rootNode):e},lf.proc.PushDownSelectionsPass.prototype.traverse_=function(e,t){var r=function(e){e.getChildren().forEach(o)}.bind(this),o=function(e){if(!this.alreadyPushedDown_.has(e))if(this.isCandidateNode_(e)){var n=e,i=n.predicate.getTables(),s=function(e){return this.doesReferToTables_(e,i)}.bind(this),a=this.pushDownNodeRec_(t,n,s);this.alreadyPushedDown_.add(n),a!=n&&(goog.isNull(a.getParent())&&(this.rootNode=a),o(a)),r(n)}else r(e)}.bind(this);o(e)},lf.proc.PushDownSelectionsPass.prototype.pushDownNodeRec_=function(e,t,r){var o=t;if(this.shouldSwapWithChild_(e,t))o=lf.tree.swapNodeWithChild(t),this.pushDownNodeRec_(e,t,r);else if(this.shouldPushBelowChild_(t)){var n=[],i=function(e){var t=new lf.proc.SelectNode(e.predicate);return n.push(t),t},o=lf.tree.pushNodeBelowChild(t,r,i);n.forEach(function(t){this.pushDownNodeRec_(e,t,r)},this)}return o},lf.proc.PushDownSelectionsPass.prototype.doesReferToTables_=function(e,t){var r=lf.structs.set.create();return lf.tree.getLeafNodes(e).forEach(function(e){r.add(e.table)},this),e instanceof lf.proc.TableAccessNode&&r.add(e.table),lf.structs.set.isSubset(r,t)},lf.proc.PushDownSelectionsPass.prototype.isCandidateNode_=function(e){return e instanceof lf.proc.SelectNode},lf.proc.PushDownSelectionsPass.prototype.shouldPushBelowChild_=function(e){var t=e.getChildAt(0);return t instanceof lf.proc.CrossProductNode||t instanceof lf.proc.JoinNode},lf.proc.PushDownSelectionsPass.prototype.shouldSwapWithChild_=function(e,t){var r=t.getChildAt(0);if(!(r instanceof lf.proc.SelectNode))return!1;if(!goog.isDefAndNotNull(e.outerJoinPredicates))return!0;var o=t.predicate instanceof lf.pred.JoinPredicate,n=e.outerJoinPredicates.has(r.predicate.getId());return o||!n},lf.proc.SelectLogicalPlanGenerator=function(e,t){lf.proc.BaseLogicalPlanGenerator.call(this,e),this.rewritePasses_=t,this.projectNode_=this.limitNode_=this.skipNode_=this.orderByNode_=this.aggregationNode_=this.groupByNode_=this.selectNode_=this.crossProductNode_=this.tableAccessNodes_=null},goog.inherits(lf.proc.SelectLogicalPlanGenerator,lf.proc.BaseLogicalPlanGenerator),lf.proc.SelectLogicalPlanGenerator.prototype.generateInternal=function(){this.generateNodes_();var e=this.connectNodes_(),t=new lf.proc.LogicalPlanRewriter(e,this.query,this.rewritePasses_);return t.generate()},lf.proc.SelectLogicalPlanGenerator.prototype.generateNodes_=function(){this.generateTableAccessNodes_(),this.generateCrossProductNode_(),this.generateSelectNode_(),this.generateOrderByNode_(),this.generateSkipNode_(),this.generateLimitNode_(),this.generateGroupByNode_(),this.generateAggregationNode_(),this.generateProjectNode_()},lf.proc.SelectLogicalPlanGenerator.prototype.connectNodes_=function(){for(var e=[this.limitNode_,this.skipNode_,this.projectNode_,this.orderByNode_,this.aggregationNode_,this.groupByNode_,this.selectNode_,this.crossProductNode_],t=-1,r=null,o=0;o<e.length;o++){var n=e[o];goog.isNull(n)||(goog.isNull(r)?r=n:e[t].addChild(n),t=o)}return this.tableAccessNodes_.forEach(function(r){e[t].addChild(r)}),r},lf.proc.SelectLogicalPlanGenerator.prototype.generateTableAccessNodes_=function(){this.tableAccessNodes_=this.query.from.map(function(e){return new lf.proc.TableAccessNode(e)},this)},lf.proc.SelectLogicalPlanGenerator.prototype.generateCrossProductNode_=function(){2<=this.query.from.length&&(this.crossProductNode_=new lf.proc.CrossProductNode)},lf.proc.SelectLogicalPlanGenerator.prototype.generateSelectNode_=function(){this.selectNode_=goog.isDefAndNotNull(this.query.where)?new lf.proc.SelectNode(this.query.where.copy()):null},lf.proc.SelectLogicalPlanGenerator.prototype.generateOrderByNode_=function(){this.query.orderBy&&(this.orderByNode_=new lf.proc.OrderByNode(this.query.orderBy))},lf.proc.SelectLogicalPlanGenerator.prototype.generateLimitNode_=function(){goog.isDefAndNotNull(this.query.limit)&&(this.limitNode_=new lf.proc.LimitNode(this.query.limit))},lf.proc.SelectLogicalPlanGenerator.prototype.generateSkipNode_=function(){goog.isDefAndNotNull(this.query.skip)&&0<this.query.skip&&(this.skipNode_=new lf.proc.SkipNode(this.query.skip))},lf.proc.SelectLogicalPlanGenerator.prototype.generateGroupByNode_=function(){goog.isDefAndNotNull(this.query.groupBy)&&(this.groupByNode_=new lf.proc.GroupByNode(this.query.groupBy))},lf.proc.SelectLogicalPlanGenerator.prototype.generateAggregationNode_=function(){var e=this.query.columns.filter(function(e){return e instanceof lf.fn.AggregatedColumn});goog.isDefAndNotNull(this.query.orderBy)&&this.query.orderBy.forEach(function(t){t.column instanceof lf.fn.AggregatedColumn&&e.push(t.column)}),0<e.length&&(this.aggregationNode_=new lf.proc.AggregationNode(e))},lf.proc.SelectLogicalPlanGenerator.prototype.generateProjectNode_=function(){this.projectNode_=new lf.proc.ProjectNode(this.query.columns||[],this.query.groupBy||null)},lf.proc.LogicalPlanFactory=function(){this.selectOptimizationPasses_=[new lf.proc.AndPredicatePass,new lf.proc.CrossProductPass,new lf.proc.PushDownSelectionsPass,new lf.proc.ImplicitJoinsPass],this.deleteOptimizationPasses_=[new lf.proc.AndPredicatePass]},lf.proc.LogicalPlanFactory.prototype.create=function(e){var t;if(e instanceof lf.query.InsertContext)t=new lf.proc.InsertLogicalPlanGenerator(e);else if(e instanceof lf.query.DeleteContext)t=new lf.proc.DeleteLogicalPlanGenerator(e,this.deleteOptimizationPasses_);else if(e instanceof lf.query.SelectContext)t=new lf.proc.SelectLogicalPlanGenerator(e,this.selectOptimizationPasses_);else{if(!(e instanceof lf.query.UpdateContext))throw new lf.Exception(513);t=new lf.proc.UpdateLogicalPlanGenerator(e)}var r=t.generate();return new lf.proc.LogicalQueryPlan(r,e.getScope())},lf.proc.DeleteStep=function(e){lf.proc.PhysicalQueryPlanNode.call(this,1,lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD),this.table_=e},goog.inherits(lf.proc.DeleteStep,lf.proc.PhysicalQueryPlanNode),lf.proc.DeleteStep.prototype.toString=function(){return"delete("+this.table_.getName()+")"},lf.proc.DeleteStep.prototype.execInternal=function(e,t){var r=e[0].entries.map(function(e){return e.row});return t.remove(this.table_,r),[lf.proc.Relation.createEmpty()]},lf.proc.GetRowCountStep=function(e,t){lf.proc.PhysicalQueryPlanNode.call(this,0,lf.proc.PhysicalQueryPlanNode.ExecType.NO_CHILD),this.table=t,this.indexStore_=e.getService(lf.service.INDEX_STORE)},goog.inherits(lf.proc.GetRowCountStep,lf.proc.PhysicalQueryPlanNode),lf.proc.GetRowCountStep.prototype.toString=function(){return"get_row_count("+this.table.getName()+")"},lf.proc.GetRowCountStep.prototype.execInternal=function(){var e=this.indexStore_.get(this.table.getRowIdIndexName()),t=new lf.proc.Relation([],[this.table.getName()]);return t.setAggregationResult(lf.fn.count(),e.stats().totalRows),[t]},lf.proc.TableAccessFullStep=function(e,t){lf.proc.PhysicalQueryPlanNode.call(this,0,lf.proc.PhysicalQueryPlanNode.ExecType.NO_CHILD),this.cache_=e.getService(lf.service.CACHE),this.indexStore_=e.getService(lf.service.INDEX_STORE),this.table=t},goog.inherits(lf.proc.TableAccessFullStep,lf.proc.PhysicalQueryPlanNode),lf.proc.TableAccessFullStep.prototype.toString=function(){var e="table_access("+this.table.getName();return goog.isNull(this.table.alias_)||(e+=" as "+this.table.alias_),e+=")"},lf.proc.TableAccessFullStep.prototype.execInternal=function(){var e=this.indexStore_.get(this.table.getRowIdIndexName()).getRange();return[lf.proc.Relation.fromRows(this.cache_.getMany(e),[this.table.getEffectiveName()])]},lf.proc.GetRowCountPass=function(e){this.global_=e},goog.inherits(lf.proc.GetRowCountPass,lf.proc.RewritePass),lf.proc.GetRowCountPass.prototype.rewrite=function(e,t){if(this.rootNode=e,!this.canOptimize_(t))return e;var r=lf.tree.find(e,function(e){return e instanceof lf.proc.TableAccessFullStep})[0],o=new lf.proc.GetRowCountStep(this.global_,r.table);return lf.tree.replaceNodeWithChain(r,o,o),this.rootNode},lf.proc.GetRowCountPass.prototype.canOptimize_=function(e){var t=!(1!=e.columns.length||1!=e.from.length||goog.isDefAndNotNull(e.where)||goog.isDefAndNotNull(e.limit)||goog.isDefAndNotNull(e.skip)||goog.isDefAndNotNull(e.groupBy));if(t){var r=e.columns[0];return r instanceof lf.fn.AggregatedColumn&&r.aggregatorType==lf.fn.Type.COUNT&&r.child instanceof lf.fn.StarColumn}return!1},lf.proc.GroupByStep=function(e){lf.proc.PhysicalQueryPlanNode.call(this,1,lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD),this.groupByColumns_=e},goog.inherits(lf.proc.GroupByStep,lf.proc.PhysicalQueryPlanNode),lf.proc.GroupByStep.prototype.toString=function(){var e=this.groupByColumns_.map(function(e){return e.getNormalizedName()});return"groupBy("+e.toString()+")"},lf.proc.GroupByStep.prototype.execInternal=function(e){return this.calculateGroupedRelations_(e[0])},lf.proc.GroupByStep.prototype.calculateGroupedRelations_=function(e){var t=new lf.structs.MapSet,r=function(e){var t=this.groupByColumns_.map(function(t){return e.getField(t)},this);return t.join(",")}.bind(this);return e.entries.forEach(function(e){t.set(r(e),e)},this),t.keys().map(function(r){return new lf.proc.Relation(t.get(r),e.getTables())},this)},lf.proc.JoinStep=function(e,t,r){lf.proc.PhysicalQueryPlanNode.call(this,2,lf.proc.PhysicalQueryPlanNode.ExecType.ALL),this.indexStore_=e.getService(lf.service.INDEX_STORE),this.cache_=e.getService(lf.service.CACHE),this.predicate=t,this.isOuterJoin=r,this.algorithm_=this.predicate.evaluatorType==lf.eval.Type.EQ?lf.proc.JoinStep.Algorithm_.HASH:lf.proc.JoinStep.Algorithm_.NESTED_LOOP,this.indexJoinInfo_=null},goog.inherits(lf.proc.JoinStep,lf.proc.PhysicalQueryPlanNode),lf.proc.JoinStep.Algorithm_={HASH:0,INDEX_NESTED_LOOP:1,NESTED_LOOP:2},lf.proc.JoinStep.AlgorithmToString_=["hash","index_nested_loop","nested_loop"],lf.proc.JoinStep.prototype.toString=function(){return"join(type: "+(this.isOuterJoin?"outer":"inner")+", impl: "+lf.proc.JoinStep.AlgorithmToString_[this.algorithm_]+", "+this.predicate.toString()+")"},lf.proc.JoinStep.prototype.execInternal=function(e){switch(this.algorithm_){case lf.proc.JoinStep.Algorithm_.HASH:return[this.predicate.evalRelationsHashJoin(e[0],e[1],this.isOuterJoin)];case lf.proc.JoinStep.Algorithm_.INDEX_NESTED_LOOP:return[this.predicate.evalRelationsIndexNestedLoopJoin(e[0],e[1],this.indexJoinInfo_,this.cache_)];default:return[this.predicate.evalRelationsNestedLoopJoin(e[0],e[1],this.isOuterJoin)]}},lf.proc.JoinStep.prototype.markAsIndexJoin=function(e){this.algorithm_=lf.proc.JoinStep.Algorithm_.INDEX_NESTED_LOOP;var t=this.indexStore_.get(e.getIndex().getNormalizedName());this.indexJoinInfo_={indexedColumn:e,nonIndexedColumn:e==this.predicate.leftColumn?this.predicate.rightColumn:this.predicate.leftColumn,index:t}},lf.proc.NoOpStep=function(e){lf.proc.PhysicalQueryPlanNode.call(this,lf.proc.PhysicalQueryPlanNode.ANY,lf.proc.PhysicalQueryPlanNode.ExecType.NO_CHILD),this.relations_=e},goog.inherits(lf.proc.NoOpStep,lf.proc.PhysicalQueryPlanNode),lf.proc.NoOpStep.prototype.toString=function(){return"no_op_step("+this.relations_[0].getTables().join(",")+")"},lf.proc.NoOpStep.prototype.execInternal=function(){return this.relations_},lf.proc.IndexJoinPass=function(){},goog.inherits(lf.proc.IndexJoinPass,lf.proc.RewritePass),lf.proc.IndexJoinPass.prototype.rewrite=function(e,t){if(this.rootNode=e,!this.canOptimize_(t))return e;var r=lf.tree.find(e,function(e){return e instanceof lf.proc.JoinStep});return r.forEach(this.processJoinStep_,this),this.rootNode},lf.proc.IndexJoinPass.prototype.canOptimize_=function(e){return 1<e.from.length},lf.proc.IndexJoinPass.prototype.processJoinStep_=function(e){if(e.predicate.evaluatorType==lf.eval.Type.EQ&&!e.isOuterJoin){var t=function(t){if(!(t instanceof lf.proc.TableAccessFullStep))return null;var r=t.table.getEffectiveName()==e.predicate.rightColumn.getTable().getEffectiveName()?e.predicate.rightColumn:e.predicate.leftColumn;return goog.isNull(r.getIndex())?null:r},r=t(e.getChildAt(0)),o=t(e.getChildAt(1));if(!goog.isNull(r)||!goog.isNull(o)){var n=goog.isNull(o)?r:o;e.markAsIndexJoin(n);var i=new lf.proc.Relation([],[n.getTable().getEffectiveName()]);e.replaceChildAt(new lf.proc.NoOpStep([i]),n==r?0:1)}}},$jscomp.scope.calculateCartesianProduct=function(e){goog.asserts.assert(1<e.length,"Should only be called for cross-column indices.");var t=e.map(function(e){return e.getValues()}),r=goog.iter.product.apply(null,t),o=[];return goog.iter.forEach(r,function(e){o.push(e)}),o},lf.proc.IndexKeyRangeCalculator=function(){},lf.proc.NotBoundKeyRangeCalculator=function(e){this.indexSchema_=e},lf.proc.NotBoundKeyRangeCalculator.prototype.getKeyRangeCombinations=function(){return 1==this.indexSchema_.columns.length?[lf.index.SingleKeyRange.all()]:[this.indexSchema_.columns.map(function(){return lf.index.SingleKeyRange.all()})]},lf.proc.BoundKeyRangeCalculator=function(e,t){this.indexSchema_=e,this.predicateMap_=t,this.combinations_=this.lastQueryContext_=null},lf.proc.BoundKeyRangeCalculator.prototype.calculateKeyRangeMap_=function(e){var t=lf.structs.map.create();return this.predicateMap_.keys().forEach(function(r){var o=this.predicateMap_.get(r),n=o.map(function(t){return e.getPredicate(t)},this),i=new lf.index.SingleKeyRangeSet([lf.index.SingleKeyRange.all()]);n.forEach(function(e){i=lf.index.SingleKeyRangeSet.intersect(i,e.toKeyRange())}),t.set(r,i)},this),t},lf.proc.BoundKeyRangeCalculator.prototype.fillMissingKeyRanges_=function(e){for(var t=this.indexSchema_.columns.length-1;0<=t;t--){var r=this.indexSchema_.columns[t],o=e.get(r.schema.getName())||null;if(!goog.isNull(o))break;e.set(r.schema.getName(),new lf.index.SingleKeyRangeSet([lf.index.SingleKeyRange.all()]))}},lf.proc.BoundKeyRangeCalculator.prototype.getKeyRangeCombinations=function(e){if(this.lastQueryContext_==e)return this.combinations_;var t=this.calculateKeyRangeMap_(e);return this.fillMissingKeyRanges_(t),this.combinations_=1==this.indexSchema_.columns.length?lf.structs.map.values(t)[0].getValues():(0,$jscomp.scope.calculateCartesianProduct)(this.getSortedKeyRangeSets_(t)),this.lastQueryContext_=e,this.combinations_},lf.proc.BoundKeyRangeCalculator.prototype.getSortedKeyRangeSets_=function(e){var t=lf.structs.map.create(),r=0;this.indexSchema_.columns.forEach(function(e){t.set(e.schema.getName(),r),r++});var o=lf.structs.map.keys(e).sort(function(e,r){return t.get(e)-t.get(r)});return o.map(function(t){return e.get(t)})},lf.proc.IndexCostEstimator=function(e,t){this.tableSchema_=t,this.indexStore_=e.getService(lf.service.INDEX_STORE)},$jscomp.scope.INDEX_QUERY_THRESHOLD_PERCENT=.02,lf.proc.IndexCostEstimator.prototype.getIndexQueryThreshold_=function(){var e=this.indexStore_.get(this.tableSchema_.getRowIdIndexName());return Math.floor(e.stats().totalRows*$jscomp.scope.INDEX_QUERY_THRESHOLD_PERCENT)},lf.proc.IndexCostEstimator.prototype.chooseIndexFor=function(e,t){var r=t.filter(this.isCandidate_,this);if(0==r.length)return null;var o=this.generateIndexRangeCandidates_(r);if(0==o.length)return null;if(1==o.length)return o[0];var n=Number.MAX_VALUE;return o.reduce(function(t,r){var o=r.calculateCost(e);return o<n?(n=o,r):t},null)},lf.proc.IndexCostEstimator.prototype.generateIndexRangeCandidates_=function(e){var t=this.tableSchema_.getIndices();return t.map(function(t){var r=new lf.proc.IndexRangeCandidate(this.indexStore_,t);return r.consumePredicates_(e),r},this).filter(function(e){return e.isUsable()})},lf.proc.IndexCostEstimator.prototype.isCandidate_=function(e){return e instanceof lf.pred.ValuePredicate?this.isCandidateValuePredicate_(e):e instanceof lf.pred.CombinedPredicate&&this.isCandidateCombinedPredicate_(e)},lf.proc.IndexCostEstimator.prototype.isCandidateCombinedPredicate_=function(e){if(!e.isKeyRangeCompatible())return!1;var t=e.getChildAt(0).column;return t.getTable()==this.tableSchema_&&e.getChildCount()<=this.getIndexQueryThreshold_()},lf.proc.IndexCostEstimator.prototype.isCandidateValuePredicate_=function(e){return!(!e.isKeyRangeCompatible()||e.column.getTable()!=this.tableSchema_||e.evaluatorType==lf.eval.Type.IN&&e.value.length>this.getIndexQueryThreshold_())},lf.proc.IndexRangeCandidate=function(e,t){this.indexStore_=e,this.indexSchema=t,this.indexedColumnNames_=lf.structs.set.create(this.indexSchema.columns.map(function(e){return e.schema.getName()})),this.keyRangeCalculator_=this.predicateMap_=null},lf.proc.IndexRangeCandidate.prototype.getPredicateIds=function(){return goog.isNull(this.predicateMap_)?[]:this.predicateMap_.values()},lf.proc.IndexRangeCandidate.prototype.getKeyRangeCalculator=function(){return goog.asserts.assert(this.predicateMap_),goog.isNull(this.keyRangeCalculator_)&&(this.keyRangeCalculator_=new lf.proc.BoundKeyRangeCalculator(this.indexSchema,this.predicateMap_)),this.keyRangeCalculator_},lf.proc.IndexRangeCandidate.prototype.consumePredicates_=function(e){e.forEach(function(e){var t=e.getColumns()[0].getName();this.indexedColumnNames_.has(t)&&(goog.isNull(this.predicateMap_)&&(this.predicateMap_=new lf.structs.MapSet),this.predicateMap_.set(t,e.getId()))},this)},lf.proc.IndexRangeCandidate.prototype.isUsable=function(){if(goog.isNull(this.predicateMap_))return!1;for(var e=!1,t=!0,r=0;r<this.indexSchema.columns.length;r++){var o=this.indexSchema.columns[r],n=this.predicateMap_.has(o.schema.getName());if(e&&n){t=!1;break}n||(e=!0)}return t},lf.proc.IndexRangeCandidate.prototype.calculateCost=function(e){var t=this.getKeyRangeCalculator().getKeyRangeCombinations(e),r=this.indexStore_.get(this.indexSchema.getNormalizedName());return t.reduce(function(e,t){return e+r.cost(t)},0)},lf.proc.IndexRangeScanStep=function(e,t,r,o){lf.proc.PhysicalQueryPlanNode.call(this,0,lf.proc.PhysicalQueryPlanNode.ExecType.NO_CHILD),this.indexStore_=e.getService(lf.service.INDEX_STORE),this.index=t,this.keyRangeCalculator=r,this.reverseOrder=o,this.useSkip=this.useLimit=!1},goog.inherits(lf.proc.IndexRangeScanStep,lf.proc.PhysicalQueryPlanNode),lf.proc.IndexRangeScanStep.prototype.toString=function(){return"index_range_scan("+this.index.getNormalizedName()+", ?, "+(this.reverseOrder?"reverse":"natural")+(this.useLimit?", limit:?":"")+(this.useSkip?", skip:?":"")+")"},lf.proc.IndexRangeScanStep.prototype.toContextString=function(e){var t=this.toString(),r=this.keyRangeCalculator.getKeyRangeCombinations(e),t=t.replace("?",r.toString());return this.useLimit&&(t=t.replace("?",e.limit.toString())),this.useSkip&&(t=t.replace("?",e.skip.toString())),t},lf.proc.IndexRangeScanStep.prototype.execInternal=function(e,t,r){var o,n=r,i=this.keyRangeCalculator.getKeyRangeCombinations(n),s=this.indexStore_.get(this.index.getNormalizedName());o=1==i.length&&i[0]instanceof lf.index.SingleKeyRange&&i[0].isOnly()?lf.index.slice(s.get(i[0].from),!1,this.useLimit?n.limit:void 0,this.useSkip?n.skip:void 0):s.getRange(i,this.reverseOrder,this.useLimit?n.limit:void 0,this.useSkip?n.skip:void 0);var a=o.map(function(e){return new lf.Row(e,{})},this);return[lf.proc.Relation.fromRows(a,[this.index.tableName])]},lf.proc.MultiIndexRangeScanStep=function(){lf.proc.PhysicalQueryPlanNode.call(this,lf.proc.PhysicalQueryPlanNode.ANY,lf.proc.PhysicalQueryPlanNode.ExecType.ALL)},goog.inherits(lf.proc.MultiIndexRangeScanStep,lf.proc.PhysicalQueryPlanNode),lf.proc.MultiIndexRangeScanStep.prototype.toString=function(){return"multi_index_range_scan()"},lf.proc.MultiIndexRangeScanStep.prototype.execInternal=function(e){var t=lf.structs.map.create();e.forEach(function(e){e.entries.forEach(function(e){t.set(e.row.id(),e)})});var r=lf.structs.map.values(t);return[new lf.proc.Relation(r,e[0].getTables())]},lf.proc.SelectStep=function(e){lf.proc.PhysicalQueryPlanNode.call(this,1,lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD),this.predicateId=e},goog.inherits(lf.proc.SelectStep,lf.proc.PhysicalQueryPlanNode),lf.proc.SelectStep.prototype.toString=function(){return"select(?)"},lf.proc.SelectStep.prototype.toContextString=function(e){var t=e.getPredicate(this.predicateId);return this.toString().replace("?",t.toString())},lf.proc.SelectStep.prototype.execInternal=function(e,t,r){var o=r,n=o.getPredicate(this.predicateId);return[n.eval(e[0])]},lf.proc.TableAccessByRowIdStep=function(e,t){lf.proc.PhysicalQueryPlanNode.call(this,1,lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD),this.cache_=e.getService(lf.service.CACHE),this.table_=t},goog.inherits(lf.proc.TableAccessByRowIdStep,lf.proc.PhysicalQueryPlanNode),lf.proc.TableAccessByRowIdStep.prototype.toString=function(){return"table_access_by_row_id("+this.table_.getName()+")"},lf.proc.TableAccessByRowIdStep.prototype.execInternal=function(e){return[lf.proc.Relation.fromRows(this.cache_.getMany(e[0].getRowIds()),[this.table_.getEffectiveName()])]},lf.proc.IndexRangeScanPass=function(e){this.global_=e},goog.inherits(lf.proc.IndexRangeScanPass,lf.proc.RewritePass),lf.proc.IndexRangeScanPass.prototype.rewrite=function(e,t){this.rootNode=e;var r=lf.tree.find(e,function(e){return e instanceof lf.proc.TableAccessFullStep});return r.forEach(function(e){var r=this.findSelectSteps_(e);if(0!=r.length){var o=new lf.proc.IndexCostEstimator(this.global_,e.table),n=o.chooseIndexFor(t,r.map(function(e){return t.getPredicate(e.predicateId)}));if(!goog.isNull(n)){var i=lf.structs.map.create();r.forEach(function(e){i.set(e.predicateId,e)},this),this.rootNode=this.replaceWithIndexRangeScanStep_(n,i,e,t)}}},this),this.rootNode},lf.proc.IndexRangeScanPass.prototype.findSelectSteps_=function(e){for(var t=[],r=e.getParent();r;){if(r instanceof lf.proc.SelectStep)t.push(r);else if(r instanceof lf.proc.JoinStep)break;r=r.getParent()}return t},lf.proc.IndexRangeScanPass.prototype.replaceWithIndexRangeScanStep_=function(e,t,r){var o=e.getPredicateIds(),n=o.map(function(e){return t.get(e)});n.forEach(lf.tree.removeNode);var i=new lf.proc.IndexRangeScanStep(this.global_,e.indexSchema,e.getKeyRangeCalculator(),(!1)),s=new lf.proc.TableAccessByRowIdStep(this.global_,r.table);return s.addChild(i),lf.tree.replaceNodeWithChain(r,s,i),i.getRoot()},lf.proc.InsertStep=function(e,t){lf.proc.PhysicalQueryPlanNode.call(this,0,lf.proc.PhysicalQueryPlanNode.ExecType.NO_CHILD),this.indexStore_=e.getService(lf.service.INDEX_STORE),this.table_=t},goog.inherits(lf.proc.InsertStep,lf.proc.PhysicalQueryPlanNode),lf.proc.InsertStep.prototype.toString=function(){return"insert("+this.table_.getName()+")"},lf.proc.InsertStep.prototype.execInternal=function(e,t,r){var o=r;return lf.proc.InsertStep.assignAutoIncrementPks_(this.table_,o.values,this.indexStore_),t.insert(this.table_,o.values),[lf.proc.Relation.fromRows(o.values,[this.table_.getName()])]},lf.proc.InsertStep.assignAutoIncrementPks_=function(e,t,r){var o=e.constraint_.primaryKey_,n=!goog.isNull(o)&&o.columns[0].autoIncrement;if(n){var i=o.columns[0].schema.getName(),s=r.get(o.getNormalizedName()),a=s.stats().maxKeyEncountered,l=goog.isNull(a)?0:a;t.forEach(function(e){0!=e.payload_[i]&&goog.isDefAndNotNull(e.payload_[i])||(l++,e.payload_[i]=l)})}},lf.proc.InsertOrReplaceStep=function(e,t){lf.proc.PhysicalQueryPlanNode.call(this,0,lf.proc.PhysicalQueryPlanNode.ExecType.NO_CHILD),this.indexStore_=e.getService(lf.service.INDEX_STORE),this.table_=t},goog.inherits(lf.proc.InsertOrReplaceStep,lf.proc.PhysicalQueryPlanNode),lf.proc.InsertOrReplaceStep.prototype.toString=function(){return"insert_replace("+this.table_.getName()+")"},lf.proc.InsertOrReplaceStep.prototype.execInternal=function(e,t,r){var o=r;return lf.proc.InsertStep.assignAutoIncrementPks_(this.table_,o.values,this.indexStore_),t.insertOrReplace(this.table_,o.values),[lf.proc.Relation.fromRows(o.values,[this.table_.getName()])]},lf.proc.LimitStep=function(){lf.proc.PhysicalQueryPlanNode.call(this,1,lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD)},goog.inherits(lf.proc.LimitStep,lf.proc.PhysicalQueryPlanNode),lf.proc.LimitStep.prototype.toString=function(){return"limit(?)"},lf.proc.LimitStep.prototype.toContextString=function(e){return this.toString().replace("?",e.limit.toString())},lf.proc.LimitStep.prototype.execInternal=function(e,t,r){var o=r;return e[0].entries.splice(o.limit),e},lf.proc.OrderByStep=function(e){lf.proc.PhysicalQueryPlanNode.call(this,lf.proc.PhysicalQueryPlanNode.ANY,lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD),this.orderBy=e},goog.inherits(lf.proc.OrderByStep,lf.proc.PhysicalQueryPlanNode),lf.proc.OrderByStep.prototype.toString=function(){return"order_by("+lf.query.SelectContext.orderByToString(this.orderBy)+")"},lf.proc.OrderByStep.prototype.execInternal=function(e){if(1==e.length){var t=this.findDistinctColumn_(e[0]),r=goog.isNull(t)?e[0]:e[0].getAggregationResult(t);r.entries.sort(this.entryComparatorFn_.bind(this))}else e.sort(this.relationComparatorFn_.bind(this));return e},lf.proc.OrderByStep.prototype.findDistinctColumn_=function(e){for(var t=null,r=0;r<this.orderBy.length;r++){var o=lf.fn.distinct(this.orderBy[r].column);if(e.hasAggregationResult(o)){t=o;break}}return t},lf.proc.OrderByStep.prototype.comparator_=function(e,t){var r,o,n,i=-1;do{i++;var s=this.orderBy[i].column;r=this.orderBy[i].order,o=e(s),n=t(s)}while(o==n&&i+1<this.orderBy.length);var a=o<n?-1:o>n?1:0;return a=r==lf.Order.ASC?a:-a},lf.proc.OrderByStep.prototype.relationComparatorFn_=function(e,t){return this.comparator_(function(t){return t instanceof lf.fn.AggregatedColumn?e.getAggregationResult(t):e.entries[e.entries.length-1].getField(t)},function(e){return e instanceof lf.fn.AggregatedColumn?t.getAggregationResult(e):t.entries[t.entries.length-1].getField(e)})},lf.proc.OrderByStep.prototype.entryComparatorFn_=function(e,t){return this.comparator_(function(t){return e.getField(t)},function(e){return t.getField(e)})},lf.proc.RelationTransformer=function(e,t){this.relation_=e,this.columns_=t},lf.proc.RelationTransformer.prototype.getTransformed=function(){var e=this.columns_.some(function(e){return e instanceof lf.fn.AggregatedColumn},this);return e?this.handleAggregatedColumns_():this.handleNonAggregatedColumns_()},lf.proc.RelationTransformer.prototype.handleAggregatedColumns_=function(){if(1==this.columns_.length&&this.columns_[0].aggregatorType==lf.fn.Type.DISTINCT){var e=this.relation_.getAggregationResult(this.columns_[0]),t=e.entries.map(function(e){var t=new lf.proc.RelationEntry(new lf.Row(lf.Row.DUMMY_ID,{}),this.relation_.isPrefixApplied());return t.setField(this.columns_[0],e.getField(this.columns_[0].child)),t},this);return new lf.proc.Relation(t,[])}var r=new lf.proc.RelationEntry(new lf.Row(lf.Row.DUMMY_ID,{}),this.relation_.isPrefixApplied());return this.columns_.forEach(function(e){var t=e instanceof lf.fn.AggregatedColumn?this.relation_.getAggregationResult(e):this.relation_.entries[0].getField(e);r.setField(e,t)},this),new lf.proc.Relation([r],this.relation_.getTables())},lf.proc.RelationTransformer.prototype.handleNonAggregatedColumns_=function(){var e=Array(this.relation_.entries.length),t=this.relation_.isPrefixApplied();return this.relation_.entries.forEach(function(r,o){e[o]=new lf.proc.RelationEntry(new lf.Row(r.row.id(),{}),t),this.columns_.forEach(function(t){e[o].setField(t,r.getField(t))},this)},this),new lf.proc.Relation(e,this.relation_.getTables())},lf.proc.RelationTransformer.transformMany=function(e,t){var r=e.map(function(e){var r=new lf.proc.RelationTransformer(e,t),o=r.getTransformed();return o.entries[0]});return new lf.proc.Relation(r,e[0].getTables())},lf.proc.ProjectStep=function(e,t){lf.proc.PhysicalQueryPlanNode.call(this,lf.proc.PhysicalQueryPlanNode.ANY,lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD),this.columns=e,this.groupByColumns=t},goog.inherits(lf.proc.ProjectStep,lf.proc.PhysicalQueryPlanNode),lf.proc.ProjectStep.prototype.toString=function(){var e="project("+this.columns.toString();if(!goog.isNull(this.groupByColumns))var t=this.groupByColumns.map(function(e){return e.getNormalizedName()}).join(", "),e=e+(", groupBy("+t+")");return e+=")"},lf.proc.ProjectStep.prototype.execInternal=function(e){return 0==e.length?[lf.proc.Relation.createEmpty()]:1==e.length?[this.execNonGroupByProjection_(e[0])]:[this.execGroupByProjection_(e)]},lf.proc.ProjectStep.prototype.hasAggregators=function(){var e=this.columns.some(function(e){return e instanceof lf.fn.AggregatedColumn});return e||!goog.isNull(this.groupByColumns)},lf.proc.ProjectStep.prototype.execGroupByProjection_=function(e){return lf.proc.RelationTransformer.transformMany(e,this.columns)},lf.proc.ProjectStep.prototype.execNonGroupByProjection_=function(e){if(0==this.columns.length)return e;var t=new lf.proc.RelationTransformer(e,this.columns);return t.getTransformed()},lf.proc.SkipStep=function(){lf.proc.PhysicalQueryPlanNode.call(this,1,lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD)},goog.inherits(lf.proc.SkipStep,lf.proc.PhysicalQueryPlanNode),lf.proc.SkipStep.prototype.toString=function(){return"skip(?)"},lf.proc.SkipStep.prototype.toContextString=function(e){return this.toString().replace("?",e.skip.toString())},lf.proc.SkipStep.prototype.execInternal=function(e,t,r){var o=r;return[new lf.proc.Relation(e[0].entries.slice(o.skip),e[0].getTables())]},lf.proc.LimitSkipByIndexPass=function(){},goog.inherits(lf.proc.LimitSkipByIndexPass,lf.proc.RewritePass),lf.proc.LimitSkipByIndexPass.prototype.rewrite=function(e,t){if(!goog.isDef(t.limit)&&!goog.isDef(t.skip))return e;var r=this.findIndexRangeScanStep_(e);if(goog.isNull(r))return e;var o=lf.tree.find(e,function(e){return e instanceof lf.proc.LimitStep||e instanceof lf.proc.SkipStep});return o.forEach(function(e){this.mergeToIndexRangeScanStep_(e,r)},this),r.getRoot()},lf.proc.LimitSkipByIndexPass.prototype.mergeToIndexRangeScanStep_=function(e,t){return e instanceof lf.proc.LimitStep?t.useLimit=!0:t.useSkip=!0,lf.tree.removeNode(e).parent},lf.proc.LimitSkipByIndexPass.prototype.findIndexRangeScanStep_=function(e){var t=function(e){return e instanceof lf.proc.IndexRangeScanStep},r=function(e){var t=e instanceof lf.proc.ProjectStep&&e.hasAggregators();return t||e instanceof lf.proc.OrderByStep||1!=e.getChildCount()||e instanceof lf.proc.SelectStep},o=lf.tree.find(e,t,r);return 0<o.length?o[0]:null},lf.proc.MultiColumnOrPass=function(e){this.global_=e},goog.inherits(lf.proc.MultiColumnOrPass,lf.proc.RewritePass),lf.proc.MultiColumnOrPass.prototype.rewrite=function(e,t){this.rootNode=e;var r=this.findOrPredicates_(t);if(0==r.length)return this.rootNode;var o,n,i=0;do n=r[i++],o=this.findIndexRangeCandidates_(n,t);while(goog.isNull(o)&&i<r.length);if(goog.isNull(o))return this.rootNode;var s=this.findTableAccessFullStep_(o[0].indexSchema.tableName);return goog.isNull(s)?this.rootNode:this.rootNode=this.replaceWithIndexRangeScan_(n,s,o)},lf.proc.MultiColumnOrPass.prototype.findOrPredicates_=function(e){var t=function(t){if(!(t instanceof lf.proc.SelectStep))return!1;var r=e.getPredicate(t.predicateId);return r instanceof lf.pred.CombinedPredicate&&r.operator==lf.pred.Operator.OR;
};return lf.tree.find(this.rootNode,t)},lf.proc.MultiColumnOrPass.prototype.findTableAccessFullStep_=function(e){return lf.tree.find(this.rootNode,function(t){return t instanceof lf.proc.TableAccessFullStep&&t.table.getName()==e})[0]||null},lf.proc.MultiColumnOrPass.prototype.findIndexRangeCandidates_=function(e,t){var r=t.getPredicate(e.predicateId),o=r.getTables();if(1!=o.size)return null;var n=lf.structs.set.values(o)[0],i=new lf.proc.IndexCostEstimator(this.global_,n),s=null,a=r.getChildren().every(function(e){var r=i.chooseIndexFor(t,[e]);return goog.isNull(r)||(goog.isNull(s)?s=[r]:s.push(r)),!goog.isNull(r)});return a?s:null},lf.proc.MultiColumnOrPass.prototype.replaceWithIndexRangeScan_=function(e,t,r){var o=new lf.proc.TableAccessByRowIdStep(this.global_,t.table),n=new lf.proc.MultiIndexRangeScanStep;return o.addChild(n),r.forEach(function(e){var t=new lf.proc.IndexRangeScanStep(this.global_,e.indexSchema,e.getKeyRangeCalculator(),(!1));n.addChild(t)},this),lf.tree.removeNode(e),lf.tree.replaceNodeWithChain(t,o,n),n.getRoot()},lf.proc.OrderByIndexPass=function(e){this.global_=e},goog.inherits(lf.proc.OrderByIndexPass,lf.proc.RewritePass),lf.proc.OrderByIndexPass.prototype.rewrite=function(e,t){var r=lf.proc.OrderByIndexPass.findOrderByStep_(e,t);if(goog.isNull(r))return e;var o=this.applyTableAccessFullOptimization_(r);return o==r&&(o=this.applyIndexRangeScanStepOptimization_(r)),o.getRoot()},lf.proc.OrderByIndexPass.prototype.applyTableAccessFullOptimization_=function(e){var t=e,r=lf.proc.OrderByIndexPass.findTableAccessFullStep_(e.getChildAt(0));if(!goog.isNull(r)){var o=lf.proc.OrderByIndexPass.findIndexCandidateForOrderBy_(r.table,e.orderBy);if(goog.isNull(o))return t;var n=new lf.proc.IndexRangeScanStep(this.global_,o.indexSchema,new lf.proc.NotBoundKeyRangeCalculator(o.indexSchema),o.isReverse),i=new lf.proc.TableAccessByRowIdStep(this.global_,r.table);i.addChild(n),lf.tree.removeNode(e),t=lf.tree.replaceNodeWithChain(r,i,n)}return t},lf.proc.OrderByIndexPass.prototype.applyIndexRangeScanStepOptimization_=function(e){var t=e,r=lf.proc.OrderByIndexPass.findIndexRangeScanStep_(e.getChildAt(0));if(!goog.isNull(r)){var o=lf.proc.OrderByIndexPass.getIndexCandidateForIndexSchema_(r.index,e.orderBy);if(goog.isNull(o))return t;r.reverseOrder=o.isReverse,t=lf.tree.removeNode(e).parent}return t},lf.proc.OrderByIndexPass.findIndexRangeScanStep_=function(e){var t=function(e){return e instanceof lf.proc.IndexRangeScanStep},r=function(e){return 1!=e.getChildCount()},o=lf.tree.find(e,t,r);return 0<o.length?o[0]:null},lf.proc.OrderByIndexPass.findTableAccessFullStep_=function(e){var t=function(e){return e instanceof lf.proc.TableAccessFullStep},r=function(e){return 1!=e.getChildCount()},o=lf.tree.find(e,t,r);return 0<o.length?o[0]:null},lf.proc.OrderByIndexPass.findOrderByStep_=function(e,t){return goog.isDef(t.orderBy)?lf.tree.find(e,function(e){return e instanceof lf.proc.OrderByStep})[0]:null},lf.proc.OrderByIndexPass.findIndexCandidateForOrderBy_=function(e,t){for(var r=null,o=e.getIndices(),n=0;n<o.length&&goog.isNull(r);n++)r=lf.proc.OrderByIndexPass.getIndexCandidateForIndexSchema_(o[n],t);return r},lf.proc.OrderByIndexPass.getIndexCandidateForIndexSchema_=function(e,t){var r=e.columns.length==t.length&&t.every(function(t,r){var o=e.columns[r];return t.column.getName()==o.schema.getName()});if(!r)return null;var o=lf.proc.OrderByIndexPass.checkOrder_(t,e);return o[0]||o[1]?{indexSchema:e,isReverse:o[1]}:null},lf.proc.OrderByIndexPass.checkOrder_=function(e,t){var r=e.reduce(function(e,t){return e<<1|(t.order==lf.Order.DESC?0:1)},0),o=t.columns.reduce(function(e,t){return e<<1|(t.order==lf.Order.DESC?0:1)},0),n=r^o,i=0==n,s=n==Math.pow(2,Math.max(e.length,t.columns.length))-1;return[i,s]},lf.proc.PhysicalPlanRewriter=function(e,t,r){this.rootNode_=e,this.queryContext_=t,this.rewritePasses_=r},lf.proc.PhysicalPlanRewriter.prototype.generate=function(){return this.rewritePasses_.forEach(function(e){this.rootNode_=e.rewrite(this.rootNode_,this.queryContext_)},this),this.rootNode_},lf.proc.UpdateStep=function(e){lf.proc.PhysicalQueryPlanNode.call(this,1,lf.proc.PhysicalQueryPlanNode.ExecType.FIRST_CHILD),this.table_=e},goog.inherits(lf.proc.UpdateStep,lf.proc.PhysicalQueryPlanNode),lf.proc.UpdateStep.prototype.toString=function(){return"update("+this.table_.getName()+")"},lf.proc.UpdateStep.prototype.execInternal=function(e,t,r){var o=e[0].entries.map(function(e){var t=this.table_.deserializeRow(e.row.serialize());return r.set.forEach(function(e){t.payload_[e.column.getName()]=e.value},this),t},this);return t.update(this.table_,o),[lf.proc.Relation.createEmpty()]},lf.proc.PhysicalPlanFactory=function(e){this.global_=e,this.selectOptimizationPasses_=[new lf.proc.IndexJoinPass,new lf.proc.IndexRangeScanPass(this.global_),new lf.proc.MultiColumnOrPass(this.global_),new lf.proc.OrderByIndexPass(this.global_),new lf.proc.LimitSkipByIndexPass,new lf.proc.GetRowCountPass(this.global_)],this.deleteOptimizationPasses_=[new lf.proc.IndexRangeScanPass(this.global_)]},lf.proc.PhysicalPlanFactory.prototype.create=function(e,t){var r=e.getRoot();if(r instanceof lf.proc.InsertOrReplaceNode||r instanceof lf.proc.InsertNode)return this.createPlan_(e,t);if(r instanceof lf.proc.ProjectNode||r instanceof lf.proc.LimitNode||r instanceof lf.proc.SkipNode)return this.createPlan_(e,t,this.selectOptimizationPasses_);if(r instanceof lf.proc.DeleteNode||r instanceof lf.proc.UpdateNode)return this.createPlan_(e,t,this.deleteOptimizationPasses_);throw new lf.Exception(8)},lf.proc.PhysicalPlanFactory.prototype.createPlan_=function(e,t,r){var o=lf.tree.map(e.getRoot(),this.mapFn_.bind(this));if(goog.isDefAndNotNull(r))var n=new lf.proc.PhysicalPlanRewriter(o,t,r),o=n.generate();return new lf.proc.PhysicalQueryPlan(o,e.getScope())},lf.proc.PhysicalPlanFactory.prototype.mapFn_=function(e){if(e instanceof lf.proc.ProjectNode)return new lf.proc.ProjectStep(e.columns,e.groupByColumns);if(e instanceof lf.proc.GroupByNode)return new lf.proc.GroupByStep(e.columns);if(e instanceof lf.proc.AggregationNode)return new lf.proc.AggregationStep(e.columns);if(e instanceof lf.proc.OrderByNode)return new lf.proc.OrderByStep(e.orderBy);if(e instanceof lf.proc.SkipNode)return new lf.proc.SkipStep;if(e instanceof lf.proc.LimitNode)return new lf.proc.LimitStep;if(e instanceof lf.proc.SelectNode)return new lf.proc.SelectStep(e.predicate.getId());if(e instanceof lf.proc.CrossProductNode)return new lf.proc.CrossProductStep;if(e instanceof lf.proc.JoinNode)return new lf.proc.JoinStep(this.global_,e.predicate,e.isOuterJoin);if(e instanceof lf.proc.TableAccessNode)return new lf.proc.TableAccessFullStep(this.global_,e.table);if(e instanceof lf.proc.DeleteNode)return new lf.proc.DeleteStep(e.table);if(e instanceof lf.proc.UpdateNode)return new lf.proc.UpdateStep(e.table);if(e instanceof lf.proc.InsertOrReplaceNode)return new lf.proc.InsertOrReplaceStep(this.global_,e.table);if(e instanceof lf.proc.InsertNode)return new lf.proc.InsertStep(this.global_,e.table);throw new lf.Exception(514)},lf.proc.QueryEngine=function(){},lf.proc.DefaultQueryEngine=function(e){this.logicalPlanFactory_=new lf.proc.LogicalPlanFactory,this.physicalPlanFactory_=new lf.proc.PhysicalPlanFactory(e)},lf.proc.DefaultQueryEngine.prototype.getPlan=function(e){var t=this.logicalPlanFactory_.create(e);return this.physicalPlanFactory_.create(t,e)},lf.proc.LockManager=function(){this.lockTable_=lf.structs.map.create()},lf.proc.LockType={EXCLUSIVE:0,RESERVED_READ_ONLY:1,RESERVED_READ_WRITE:2,SHARED:3},lf.proc.LockManager.prototype.getEntry_=function(e){var t=this.lockTable_.get(e.getName())||null;return goog.isNull(t)&&(t=new lf.proc.LockTableEntry_,this.lockTable_.set(e.getName(),t)),t},lf.proc.LockManager.prototype.grantLock_=function(e,t,r){t.forEach(function(t){var o=this.getEntry_(t);o.grantLock(e,r)},this)},lf.proc.LockManager.prototype.canAcquireLock_=function(e,t,r){var o=!0;return t.forEach(function(t){if(o){var n=this.getEntry_(t);o=n.canAcquireLock(e,r)}},this),o},lf.proc.LockManager.prototype.requestLock=function(e,t,r){var o=this.canAcquireLock_(e,t,r);return o&&this.grantLock_(e,t,r),o},lf.proc.LockManager.prototype.releaseLock=function(e,t){t.forEach(function(t){var r=this.getEntry_(t);r.releaseLock(e)},this)},lf.proc.LockManager.prototype.clearReservedLocks=function(e){e.forEach(function(e){var t=this.getEntry_(e);t.reservedReadWriteLock=null},this)},lf.proc.LockTableEntry_=function(){this.sharedLocks=this.reservedReadOnlyLocks=this.reservedReadWriteLock=this.exclusiveLock=null},lf.proc.LockTableEntry_.prototype.releaseLock=function(e){this.exclusiveLock==e&&(this.exclusiveLock=null),this.reservedReadWriteLock==e&&(this.reservedReadWriteLock=null),goog.isNull(this.reservedReadOnlyLocks)||this.reservedReadOnlyLocks["delete"](e),goog.isNull(this.sharedLocks)||this.sharedLocks["delete"](e)},lf.proc.LockTableEntry_.prototype.canAcquireLock=function(e,t){var r=goog.isNull(this.reservedReadOnlyLocks)||0==this.reservedReadOnlyLocks.size;if(t==lf.proc.LockType.EXCLUSIVE){var o=goog.isNull(this.sharedLocks)||0==this.sharedLocks.size;return o&&r&&goog.isNull(this.exclusiveLock)&&!goog.isNull(this.reservedReadWriteLock)&&this.reservedReadWriteLock==e}return t==lf.proc.LockType.SHARED?goog.isNull(this.exclusiveLock)&&goog.isNull(this.reservedReadWriteLock)&&!goog.isNull(this.reservedReadOnlyLocks)&&this.reservedReadOnlyLocks.has(e):t==lf.proc.LockType.RESERVED_READ_ONLY?goog.isNull(this.reservedReadWriteLock):r&&(goog.isNull(this.reservedReadWriteLock)||this.reservedReadWriteLock==e)},lf.proc.LockTableEntry_.prototype.grantLock=function(e,t){t==lf.proc.LockType.EXCLUSIVE?(this.reservedReadWriteLock=null,this.exclusiveLock=e):t==lf.proc.LockType.SHARED?(goog.isNull(this.sharedLocks)&&(this.sharedLocks=lf.structs.set.create()),this.sharedLocks.add(e),goog.isNull(this.reservedReadOnlyLocks)&&(this.reservedReadOnlyLocks=lf.structs.set.create()),this.reservedReadOnlyLocks["delete"](e)):t==lf.proc.LockType.RESERVED_READ_ONLY?(goog.isNull(this.reservedReadOnlyLocks)&&(this.reservedReadOnlyLocks=lf.structs.set.create()),this.reservedReadOnlyLocks.add(e)):t==lf.proc.LockType.RESERVED_READ_WRITE&&(this.reservedReadWriteLock=e)},lf.proc.Runner=function(){this.queue_=new lf.proc.Runner.TaskQueue_,this.lockManager_=new lf.proc.LockManager},lf.proc.Runner.prototype.scheduleTask=function(e){return(e.getPriority()<lf.proc.TaskPriority.USER_QUERY_TASK||e.getPriority()<lf.proc.TaskPriority.TRANSACTION_TASK)&&this.lockManager_.clearReservedLocks(e.getScope()),this.queue_.insert(e),this.consumePending_(),e.resolver_.promise},lf.proc.Runner.prototype.consumePending_=function(){for(var e=this.queue_.getValues(),t=0;t<e.length;t++){var r,o=e[t];(r=o.getType()==lf.TransactionType.READ_ONLY?this.requestTwoPhaseLock_(o,lf.proc.LockType.RESERVED_READ_ONLY,lf.proc.LockType.SHARED):this.requestTwoPhaseLock_(o,lf.proc.LockType.RESERVED_READ_WRITE,lf.proc.LockType.EXCLUSIVE))&&(this.queue_.remove(o),this.execTask_(o))}},lf.proc.Runner.prototype.requestTwoPhaseLock_=function(e,t,r){var o=!1,n=this.lockManager_.requestLock(e.getId(),e.getScope(),t);return n&&(o=this.lockManager_.requestLock(e.getId(),e.getScope(),r)),o},lf.proc.Runner.prototype.execTask_=function(e){e.exec().then(this.onTaskSuccess_.bind(this,e),this.onTaskError_.bind(this,e))},lf.proc.Runner.prototype.onTaskSuccess_=function(e,t){this.lockManager_.releaseLock(e.getId(),e.getScope()),e.resolver_.resolve(t),this.consumePending_()},lf.proc.Runner.prototype.onTaskError_=function(e,t){this.lockManager_.releaseLock(e.getId(),e.getScope()),e.resolver_.reject(t),this.consumePending_()},lf.proc.Runner.TaskQueue_=function(){this.queue_=[]},lf.proc.Runner.TaskQueue_.prototype.insert=function(e){lf.structs.array.binaryInsert(this.queue_,e,function(e,t){var r=e.getPriority()-t.getPriority();return 0==r?e.getId()-t.getId():r})},lf.proc.Runner.TaskQueue_.prototype.getValues=function(){return this.queue_.slice()},lf.proc.Runner.TaskQueue_.prototype.remove=function(e){return goog.array.remove(this.queue_,e)},lf.Global=function(){this.services_=lf.structs.map.create()},lf.Global.get=function(){return lf.Global.instance_||(lf.Global.instance_=new lf.Global),lf.Global.instance_},lf.Global.prototype.clear=function(){this.services_.clear()},goog.exportProperty(lf.Global.prototype,"clear",lf.Global.prototype.clear),lf.Global.prototype.registerService=function(e,t){return this.services_.set(e.toString(),t),t},goog.exportProperty(lf.Global.prototype,"registerService",lf.Global.prototype.registerService),lf.Global.prototype.getService=function(e){var t=this.services_.get(e.toString())||null;if(goog.isNull(t))throw new lf.Exception(7,e.toString());return t},goog.exportProperty(lf.Global.prototype,"getService",lf.Global.prototype.getService),lf.Global.prototype.isRegistered=function(e){return this.services_.has(e.toString())},goog.exportProperty(lf.Global.prototype,"isRegistered",lf.Global.prototype.isRegistered),lf.Global.prototype.listServices=function(){return lf.structs.map.keys(this.services_)},lf.debug={},lf.debug.inspect=function(e,t,r,o){return goog.isDefAndNotNull(e)?goog.isDefAndNotNull(t)?lf.debug.inspectTable_(e,t,r,o):lf.debug.listTables_(e):lf.debug.listDb_()},lf.debug.toString_=function(e){var t="";try{t=JSON.stringify(e)}catch(r){}return t},lf.debug.getGlobal_=function(e){var t=lf.Global.get(),r=new lf.service.ServiceId("ns_"+e);return t.isRegistered(r)?t.getService(r):null},lf.debug.listDb_=function(){var e=lf.Global.get(),t={};return e.listServices().forEach(function(e){if("ns_"==e.substring(0,3)){var r=e.substring(3);t[r]=lf.debug.getGlobal_(r).getService(lf.service.SCHEMA).version()}}),lf.debug.toString_(t)},lf.debug.listTables_=function(e){var t=lf.debug.getGlobal_(e),r={};if(goog.isDefAndNotNull(t)){var o=t.getService(lf.service.INDEX_STORE);t.getService(lf.service.SCHEMA).tables().forEach(function(e){r[e.getName()]=o.get(e.getRowIdIndexName()).stats().totalRows})}return lf.debug.toString_(r)},lf.debug.inspectTable_=function(e,t,r,o){var n=lf.debug.getGlobal_(e),i=[];if(goog.isDefAndNotNull(n)){var s=null;try{s=n.getService(lf.service.SCHEMA).table(t)}catch(a){}if(goog.isDefAndNotNull(s)){var l=n.getService(lf.service.INDEX_STORE),c=n.getService(lf.service.CACHE),u=l.get(s.getRowIdIndexName()).getRange(void 0,!1,r,o);u.length&&(i=c.getMany(u).map(function(e){return e.payload_}))}}return lf.debug.toString_(i)},lf.DiffCalculator=function(e,t){this.evalRegistry_=lf.eval.Registry.get(),this.query_=e,this.observableResults_=t,this.columns_=this.detectColumns_()},lf.DiffCalculator.prototype.detectColumns_=function(){if(0<this.query_.columns.length)return this.query_.columns;var e=[];return this.query_.from.forEach(function(t){t.getColumns().forEach(function(t){e.push(t)})}),e},lf.DiffCalculator.prototype.comparator_=function(e,t){return this.columns_.every(function(r){var o=this.evalRegistry_.getEvaluator(r.getType(),lf.eval.Type.EQ);return o(e.getField(r),t.getField(r))},this)},lf.DiffCalculator.prototype.applyDiff=function(e,t){for(var r=goog.isNull(e)?[]:e.entries,o=goog.math.longestCommonSubsequence(r,t.entries,this.comparator_.bind(this),function(e){return r[e]}),n=[],i=0,s=0;s<r.length;s++){var a=r[s];if(o[i]==a)i++;else{var l=this.observableResults_.splice(i,1),c=lf.DiffCalculator.createChangeRecord_(s,l,0,this.observableResults_);n.push(c)}}for(var u=goog.math.longestCommonSubsequence(r,t.entries,this.comparator_.bind(this),function(e,r){return t.entries[r]}),s=i=0;s<t.entries.length;s++)a=t.entries[s],u[i]==a?i++:(this.observableResults_.splice(s,0,a.row.payload_),c=lf.DiffCalculator.createChangeRecord_(s,[],1,this.observableResults_),n.push(c));return n},lf.DiffCalculator.createChangeRecord_=function(e,t,r,o){return{addedCount:r,index:e,object:o,removed:t,type:"splice"}},lf.ObserverRegistry=function(){this.entries_=lf.structs.map.create()},lf.ObserverRegistry.prototype.getQueryId_=function(e){return goog.getUid(e).toString()},lf.ObserverRegistry.prototype.addObserver=function(e,t){var r=e,o=this.getQueryId_(r.query),n=this.entries_.get(o)||null;goog.isNull(n)&&(n=new lf.ObserverRegistry.Entry_(r),this.entries_.set(o,n)),n.addObserver(t)},lf.ObserverRegistry.prototype.removeObserver=function(e,t){var r=e.query,o=this.getQueryId_(r),n=this.entries_.get(o)||null;goog.asserts.assert(goog.isDefAndNotNull(n),"Attempted to unobserve a query that was not observed.");var i=n.removeObserver(t);goog.asserts.assert(i,"removeObserver: Inconsistent state detected."),n.hasObservers()||this.entries_["delete"](o)},lf.ObserverRegistry.prototype.getTaskItemsForTables=function(e){var t=lf.structs.set.create();e.forEach(function(e){t.add(e.getName())});var r=[];return this.entries_.forEach(function(e){var o=e.getTaskItem(),n=o.context.from.some(function(e){return t.has(e.getName())});n&&r.push(o)}),r},lf.ObserverRegistry.prototype.updateResultsForQuery=function(e,t){var r=this.getQueryId_(goog.isDefAndNotNull(e.clonedFrom)?e.clonedFrom:e),o=this.entries_.get(r)||null;return!goog.isNull(o)&&(o.updateResults(t),!0)},lf.ObserverRegistry.Entry_=function(e){this.builder_=e,this.observers_=lf.structs.set.create(),this.observable_=[],this.lastResults_=null,this.diffCalculator_=new lf.DiffCalculator(e.query,this.observable_)},lf.ObserverRegistry.Entry_.prototype.addObserver=function(e){this.observers_.has(e)?goog.asserts.fail("Attempted to register observer twice."):this.observers_.add(e)},lf.ObserverRegistry.Entry_.prototype.removeObserver=function(e){return this.observers_["delete"](e)},lf.ObserverRegistry.Entry_.prototype.getTaskItem=function(){return this.builder_.getObservableTaskItem()},lf.ObserverRegistry.Entry_.prototype.hasObservers=function(){return 0<this.observers_.size},lf.ObserverRegistry.Entry_.prototype.updateResults=function(e){var t=this.diffCalculator_.applyDiff(this.lastResults_,e);this.lastResults_=e,0<t.length&&this.observers_.forEach(function(e){e(t)})},lf.base={},lf.base.init=function(e,t){var r=e.getService(lf.service.SCHEMA),o=t||{},n=new lf.cache.DefaultCache(r);e.registerService(lf.service.CACHE,n);var i=null,s=!1;if(lf.Flags.MEMORY_ONLY)i=new lf.backstore.Memory(r);else{var a;if(goog.isDefAndNotNull(o.storeType))a=o.storeType;else{var l=lf.Capability.get();a=l.indexedDb?lf.schema.DataStoreType.INDEXED_DB:l.webSql?lf.schema.DataStoreType.WEB_SQL:lf.schema.DataStoreType.MEMORY}switch(a){case lf.schema.DataStoreType.INDEXED_DB:i=new lf.backstore.IndexedDB(e,r);break;case lf.schema.DataStoreType.MEMORY:i=new lf.backstore.Memory(r);break;case lf.schema.DataStoreType.OBSERVABLE_STORE:i=new lf.backstore.ObservableStore(r);break;case lf.schema.DataStoreType.WEB_SQL:i=new lf.backstore.WebSql(e,r,o.webSqlDbSize);break;case lf.schema.DataStoreType.FIREBASE:i=new lf.backstore.Firebase(r,o.firebase),s=!0;break;default:throw new lf.Exception(300)}}e.registerService(lf.service.BACK_STORE,i);var c=new lf.index.MemoryIndexStore;return e.registerService(lf.service.INDEX_STORE,c),i.init(o.onUpgrade).then(function(){var t=new lf.proc.DefaultQueryEngine(e);e.registerService(lf.service.QUERY_ENGINE,t);var o=new lf.proc.Runner;e.registerService(lf.service.RUNNER,o);var n=new lf.ObserverRegistry;return e.registerService(lf.service.OBSERVER_REGISTRY,n),c.init(r)}).then(function(){if(s){var t=new lf.backstore.ExternalChangeObserver(e);t.startObserving()}o.enableInspector&&lf.base.enableInspector_(e);var n=new lf.cache.Prefetcher(e);return n.init(r)})},lf.base.enableInspector_=function(){window.top["#lfInspect"]=lf.debug.inspect},lf.base.closeDatabase=function(e){try{var t=e.getService(lf.service.BACK_STORE);t.close()}catch(r){}},lf.Database=function(){},lf.proc.ExportTask=function(e){this.global_=e,this.schema_=e.getService(lf.service.SCHEMA),this.scope_=lf.structs.set.create(this.schema_.tables()),this.resolver_=goog.Promise.withResolver()},lf.proc.ExportTask.prototype.execSync=function(){var e=this.global_.getService(lf.service.INDEX_STORE),t=this.global_.getService(lf.service.CACHE),r={};return this.schema_.tables().forEach(function(o){var n=e.get(o.getRowIdIndexName()).getRange(),i=t.getMany(n).map(function(e){return e.payload_});r[o.getName()]=i}),{name:this.schema_.name(),version:this.schema_.version(),tables:r}},lf.proc.ExportTask.prototype.exec=function(){var e=this.execSync(),t=new lf.proc.RelationEntry(new lf.Row(lf.Row.DUMMY_ID,e),(!0));return goog.Promise.resolve([new lf.proc.Relation([t],[])])},lf.proc.ExportTask.prototype.getType=function(){return lf.TransactionType.READ_ONLY},lf.proc.ExportTask.prototype.getScope=function(){return this.scope_},lf.proc.ExportTask.prototype.getId=function(){return goog.getUid(this)},lf.proc.ExportTask.prototype.getPriority=function(){return lf.proc.TaskPriority.EXPORT_TASK},lf.proc.ImportTask=function(e,t){this.global_=e,this.schema_=e.getService(lf.service.SCHEMA),this.scope_=lf.structs.set.create(this.schema_.tables()),this.resolver_=goog.Promise.withResolver(),this.data_=t,this.backStore_=e.getService(lf.service.BACK_STORE),this.cache_=e.getService(lf.service.CACHE),this.indexStore_=e.getService(lf.service.INDEX_STORE)},lf.proc.ImportTask.prototype.exec=function(){if(!(this.backStore_ instanceof lf.backstore.IndexedDB||this.backStore_ instanceof lf.backstore.Memory||this.backStore_ instanceof lf.backstore.WebSql))throw new lf.Exception(300);if(!this.isEmptyDB_())throw new lf.Exception(110);if(this.schema_.name()!=this.data_.name||this.schema_.version()!=this.data_.version)throw new lf.Exception(111);if(!goog.isDefAndNotNull(this.data_.tables))throw new lf.Exception(112);return this.import_()},lf.proc.ImportTask.prototype.getType=function(){return lf.TransactionType.READ_WRITE},lf.proc.ImportTask.prototype.getScope=function(){return this.scope_},lf.proc.ImportTask.prototype.getId=function(){return goog.getUid(this)},lf.proc.ImportTask.prototype.getPriority=function(){return lf.proc.TaskPriority.IMPORT_TASK},lf.proc.ImportTask.prototype.isEmptyDB_=function(){for(var e=this.schema_.tables(),t=0;t<e.length;++t){var r=this.indexStore_.get(e[t].getRowIdIndexName());if(0<r.stats().totalRows)return!1}return!0},lf.proc.ImportTask.prototype.import_=function(){var e,t=new lf.cache.Journal(this.global_,this.scope_),r=this.backStore_.createTx(this.getType(),lf.structs.set.values(this.scope_),t);for(e in this.data_.tables){var o=this.schema_.table(e),n=this.data_.tables[e],i=n.map(function(e){return o.createRow(e)}),s=r.getTable(e,o.deserializeRow,lf.backstore.TableType.DATA);this.cache_.setMany(e,i);var a=this.indexStore_.getTableIndices(e);i.forEach(function(e){a.forEach(function(t){var r=e.keyOfIndex(t.getName());t.add(r,e.id())})}),s.put(i)}return r.commit()},lf.proc.TransactionTask=function(e,t){this.global_=e,this.backStore_=e.getService(lf.service.BACK_STORE),this.runner_=e.getService(lf.service.RUNNER),this.observerRegistry_=e.getService(lf.service.OBSERVER_REGISTRY),this.scope_=lf.structs.set.create(t),this.journal_=new lf.cache.Journal(this.global_,this.scope_),this.resolver_=goog.Promise.withResolver(),this.execResolver_=goog.Promise.withResolver(),this.acquireScopeResolver_=goog.Promise.withResolver()},lf.proc.TransactionTask.prototype.exec=function(){return this.acquireScopeResolver_.resolve(),this.execResolver_.promise},lf.proc.TransactionTask.prototype.getType=function(){return lf.TransactionType.READ_WRITE},lf.proc.TransactionTask.prototype.getScope=function(){return this.scope_},lf.proc.TransactionTask.prototype.getId=function(){return goog.getUid(this)},lf.proc.TransactionTask.prototype.getPriority=function(){return lf.proc.TaskPriority.TRANSACTION_TASK},lf.proc.TransactionTask.prototype.acquireScope=function(){return this.runner_.scheduleTask(this),this.acquireScopeResolver_.promise},lf.proc.TransactionTask.prototype.attachQuery=function(e){var t=e.getTaskItem();return t.plan.getRoot().exec(this.journal_,t.context).then(function(e){return e[0].getPayloads()},function(e){this.journal_.rollback();var t=new goog.Promise.CancellationError(e.name);throw this.execResolver_.reject(t),e}.bind(this))},lf.proc.TransactionTask.prototype.commit=function(){return this.tx_=this.backStore_.createTx(this.getType(),lf.structs.set.values(this.scope_),this.journal_),this.tx_.commit().then(function(){this.scheduleObserverTask_(),this.execResolver_.resolve()}.bind(this),function(e){this.journal_.rollback(),this.execResolver_.reject(e)}.bind(this)),this.resolver_.promise},lf.proc.TransactionTask.prototype.rollback=function(){return this.journal_.rollback(),this.execResolver_.resolve(),this.resolver_.promise},lf.proc.TransactionTask.prototype.scheduleObserverTask_=function(){var e=this.observerRegistry_.getTaskItemsForTables(this.scope_);if(0!=e.length){var t=new lf.proc.ObserverQueryTask(this.global_,e);this.runner_.scheduleTask(t)}},lf.proc.TransactionTask.prototype.stats=function(){var e=null;return goog.isDefAndNotNull(this.tx_)&&(e=this.tx_.stats()),goog.isNull(e)?lf.TransactionStats.getDefault():e},lf.proc.Transaction=function(e){this.global_=e,this.runner_=e.getService(lf.service.RUNNER),this.task_=null,this.state_=lf.proc.TransactionState_.CREATED,0==lf.proc.StateTransitions_.size&&this.initStateTransitions_()},goog.exportSymbol("lf.proc.Transaction",lf.proc.Transaction),lf.proc.TransactionState_={CREATED:0,ACQUIRING_SCOPE:1,ACQUIRED_SCOPE:2,EXECUTING_QUERY:3,EXECUTING_AND_COMMITTING:4,COMMITTING:5,ROLLING_BACK:6,FINALIZED:7},lf.proc.StateTransitions_=lf.structs.map.create(),lf.proc.Transaction.prototype.initStateTransitions_=function(){lf.proc.StateTransitions_.set(lf.proc.TransactionState_.CREATED,lf.structs.set.create([lf.proc.TransactionState_.ACQUIRING_SCOPE,lf.proc.TransactionState_.EXECUTING_AND_COMMITTING])),lf.proc.StateTransitions_.set(lf.proc.TransactionState_.ACQUIRING_SCOPE,lf.structs.set.create([lf.proc.TransactionState_.ACQUIRED_SCOPE])),lf.proc.StateTransitions_.set(lf.proc.TransactionState_.ACQUIRED_SCOPE,lf.structs.set.create([lf.proc.TransactionState_.EXECUTING_QUERY,lf.proc.TransactionState_.COMMITTING,lf.proc.TransactionState_.ROLLING_BACK])),lf.proc.StateTransitions_.set(lf.proc.TransactionState_.EXECUTING_QUERY,lf.structs.set.create([lf.proc.TransactionState_.ACQUIRED_SCOPE,lf.proc.TransactionState_.FINALIZED])),lf.proc.StateTransitions_.set(lf.proc.TransactionState_.EXECUTING_AND_COMMITTING,lf.structs.set.create([lf.proc.TransactionState_.FINALIZED])),lf.proc.StateTransitions_.set(lf.proc.TransactionState_.COMMITTING,lf.structs.set.create([lf.proc.TransactionState_.FINALIZED])),lf.proc.StateTransitions_.set(lf.proc.TransactionState_.ROLLING_BACK,lf.structs.set.create([lf.proc.TransactionState_.FINALIZED]))},lf.proc.Transaction.prototype.stateTransition_=function(e){var t=lf.proc.StateTransitions_.get(this.state_)||null;if(goog.isNull(t)||!t.has(e))throw new lf.Exception(107,this.state_,e);this.state_=e},lf.proc.Transaction.prototype.exec=function(e){this.stateTransition_(lf.proc.TransactionState_.EXECUTING_AND_COMMITTING);var t=[];try{e.forEach(function(e){e.assertExecPreconditions(),t.push(e.getTaskItem())},this)}catch(r){return this.stateTransition_(lf.proc.TransactionState_.FINALIZED),goog.Promise.reject(r)}return this.task_=new lf.proc.UserQueryTask(this.global_,t),this.runner_.scheduleTask(this.task_).then(function(e){return this.stateTransition_(lf.proc.TransactionState_.FINALIZED),e.map(function(e){return e.getPayloads()})}.bind(this),function(e){throw this.stateTransition_(lf.proc.TransactionState_.FINALIZED),e}.bind(this))},goog.exportProperty(lf.proc.Transaction.prototype,"exec",lf.proc.Transaction.prototype.exec),lf.proc.Transaction.prototype.begin=function(e){return this.stateTransition_(lf.proc.TransactionState_.ACQUIRING_SCOPE),this.task_=new lf.proc.TransactionTask(this.global_,e),this.task_.acquireScope().then(function(){this.stateTransition_(lf.proc.TransactionState_.ACQUIRED_SCOPE)}.bind(this))},goog.exportProperty(lf.proc.Transaction.prototype,"begin",lf.proc.Transaction.prototype.begin),lf.proc.Transaction.prototype.attach=function(e){this.stateTransition_(lf.proc.TransactionState_.EXECUTING_QUERY);try{e.assertExecPreconditions()}catch(t){return this.stateTransition_(lf.proc.TransactionState_.FINALIZED),goog.Promise.reject(t)}return this.task_.attachQuery(e).then(function(e){return this.stateTransition_(lf.proc.TransactionState_.ACQUIRED_SCOPE),e}.bind(this),function(e){throw this.stateTransition_(lf.proc.TransactionState_.FINALIZED),e}.bind(this))},goog.exportProperty(lf.proc.Transaction.prototype,"attach",lf.proc.Transaction.prototype.attach),lf.proc.Transaction.prototype.commit=function(){return this.stateTransition_(lf.proc.TransactionState_.COMMITTING),this.task_.commit().then(function(){this.stateTransition_(lf.proc.TransactionState_.FINALIZED)}.bind(this))},goog.exportProperty(lf.proc.Transaction.prototype,"commit",lf.proc.Transaction.prototype.commit),lf.proc.Transaction.prototype.rollback=function(){return this.stateTransition_(lf.proc.TransactionState_.ROLLING_BACK),this.task_.rollback().then(function(){this.stateTransition_(lf.proc.TransactionState_.FINALIZED)}.bind(this))},goog.exportProperty(lf.proc.Transaction.prototype,"rollback",lf.proc.Transaction.prototype.rollback),lf.proc.Transaction.prototype.stats=function(){if(this.state_!=lf.proc.TransactionState_.FINALIZED)throw new lf.Exception(105);return this.task_.stats()},goog.exportProperty(lf.proc.Transaction.prototype,"stats",lf.proc.Transaction.prototype.stats),lf.proc.Database=function(e){this.global_=e,this.schema_=e.getService(lf.service.SCHEMA),this.isActive_=!1},goog.exportSymbol("lf.proc.Database",lf.proc.Database),lf.proc.Database.prototype.init=function(e){return this.global_.registerService(lf.service.SCHEMA,this.schema_),lf.base.init(this.global_,e).then(function(){return this.isActive_=!0,this.runner_=this.global_.getService(lf.service.RUNNER),this}.bind(this))},goog.exportProperty(lf.proc.Database.prototype,"init",lf.proc.Database.prototype.init),lf.proc.Database.prototype.getSchema=function(){return this.schema_},goog.exportProperty(lf.proc.Database.prototype,"getSchema",lf.proc.Database.prototype.getSchema),lf.proc.Database.prototype.checkActive_=function(){if(!this.isActive_)throw new lf.Exception(2)},lf.proc.Database.prototype.select=function(e){this.checkActive_();var t=1!=arguments.length||goog.isDefAndNotNull(arguments[0])?Array.prototype.slice.call(arguments):[];return new lf.query.SelectBuilder(this.global_,t)},goog.exportProperty(lf.proc.Database.prototype,"select",lf.proc.Database.prototype.select),lf.proc.Database.prototype.insert=function(){return this.checkActive_(),new lf.query.InsertBuilder(this.global_)},goog.exportProperty(lf.proc.Database.prototype,"insert",lf.proc.Database.prototype.insert),lf.proc.Database.prototype.insertOrReplace=function(){return this.checkActive_(),new lf.query.InsertBuilder(this.global_,(!0))},goog.exportProperty(lf.proc.Database.prototype,"insertOrReplace",lf.proc.Database.prototype.insertOrReplace),lf.proc.Database.prototype.update=function(e){return this.checkActive_(),new lf.query.UpdateBuilder(this.global_,e)},goog.exportProperty(lf.proc.Database.prototype,"update",lf.proc.Database.prototype.update),lf.proc.Database.prototype["delete"]=function(){return this.checkActive_(),new lf.query.DeleteBuilder(this.global_)},goog.exportProperty(lf.proc.Database.prototype,"delete",lf.proc.Database.prototype["delete"]),lf.proc.Database.prototype.observe=function(e,t){this.checkActive_();var r=this.global_.getService(lf.service.OBSERVER_REGISTRY);r.addObserver(e,t)},goog.exportProperty(lf.proc.Database.prototype,"observe",lf.proc.Database.prototype.observe),lf.proc.Database.prototype.unobserve=function(e,t){this.checkActive_();var r=this.global_.getService(lf.service.OBSERVER_REGISTRY);r.removeObserver(e,t)},goog.exportProperty(lf.proc.Database.prototype,"unobserve",lf.proc.Database.prototype.unobserve),lf.proc.Database.prototype.createTransaction=function(){return this.checkActive_(),new lf.proc.Transaction(this.global_)},goog.exportProperty(lf.proc.Database.prototype,"createTransaction",lf.proc.Database.prototype.createTransaction),
lf.proc.Database.prototype.close=function(){lf.base.closeDatabase(this.global_),this.global_.clear(),this.isActive_=!1},goog.exportProperty(lf.proc.Database.prototype,"close",lf.proc.Database.prototype.close),lf.proc.Database.prototype["export"]=function(){this.checkActive_();var e=new lf.proc.ExportTask(this.global_);return this.runner_.scheduleTask(e).then(function(e){return e[0].getPayloads()[0]})},goog.exportProperty(lf.proc.Database.prototype,"export",lf.proc.Database.prototype["export"]),lf.proc.Database.prototype["import"]=function(e){this.checkActive_();var t=new lf.proc.ImportTask(this.global_,e);return this.runner_.scheduleTask(t).then(function(){return null})},goog.exportProperty(lf.proc.Database.prototype,"import",lf.proc.Database.prototype["import"]),lf.schema.BaseColumn=function(e,t,r,o,n,i){this.table_=e,this.name_=t,this.isUnique_=r,this.isNullable_=o,this.type_=n,this.alias_=i||null},goog.exportSymbol("lf.schema.BaseColumn",lf.schema.BaseColumn),lf.schema.BaseColumn.prototype.getName=function(){return this.name_},lf.schema.BaseColumn.prototype.getNormalizedName=function(){return this.table_.getEffectiveName()+"."+this.name_},lf.schema.BaseColumn.prototype.toString=function(){return this.getNormalizedName()},lf.schema.BaseColumn.prototype.getTable=function(){return this.table_},lf.schema.BaseColumn.prototype.getType=function(){return this.type_},goog.exportProperty(lf.schema.BaseColumn.prototype,"getType",lf.schema.BaseColumn.prototype.getType),lf.schema.BaseColumn.prototype.getIndices=function(){return goog.isDefAndNotNull(this.indices_)||(this.indices_=[],this.getTable().getIndices().forEach(function(e){var t=e.columns.map(function(e){return e.schema.getName()});-1!=t.indexOf(this.name_)&&this.indices_.push(e)},this)),this.indices_},lf.schema.BaseColumn.prototype.getIndex=function(){if(!goog.isDef(this.index_)){var e=this.getIndices().filter(function(e){return 1==e.columns.length&&e.columns[0].schema.getName()==this.getName()},this);this.index_=0<e.length?e[0]:null}return this.index_},lf.schema.BaseColumn.prototype.isNullable=function(){return this.isNullable_},goog.exportProperty(lf.schema.BaseColumn.prototype,"isNullable",lf.schema.BaseColumn.prototype.isNullable),lf.schema.BaseColumn.prototype.isUnique=function(){return this.isUnique_},lf.schema.BaseColumn.prototype.eq=function(e){return lf.pred.createPredicate(this,e,lf.eval.Type.EQ)},goog.exportProperty(lf.schema.BaseColumn.prototype,"eq",lf.schema.BaseColumn.prototype.eq),lf.schema.BaseColumn.prototype.neq=function(e){return lf.pred.createPredicate(this,e,lf.eval.Type.NEQ)},goog.exportProperty(lf.schema.BaseColumn.prototype,"neq",lf.schema.BaseColumn.prototype.neq),lf.schema.BaseColumn.prototype.lt=function(e){return lf.pred.createPredicate(this,e,lf.eval.Type.LT)},goog.exportProperty(lf.schema.BaseColumn.prototype,"lt",lf.schema.BaseColumn.prototype.lt),lf.schema.BaseColumn.prototype.lte=function(e){return lf.pred.createPredicate(this,e,lf.eval.Type.LTE)},goog.exportProperty(lf.schema.BaseColumn.prototype,"lte",lf.schema.BaseColumn.prototype.lte),lf.schema.BaseColumn.prototype.gt=function(e){return lf.pred.createPredicate(this,e,lf.eval.Type.GT)},goog.exportProperty(lf.schema.BaseColumn.prototype,"gt",lf.schema.BaseColumn.prototype.gt),lf.schema.BaseColumn.prototype.gte=function(e){return lf.pred.createPredicate(this,e,lf.eval.Type.GTE)},goog.exportProperty(lf.schema.BaseColumn.prototype,"gte",lf.schema.BaseColumn.prototype.gte),lf.schema.BaseColumn.prototype.match=function(e){return lf.pred.createPredicate(this,e,lf.eval.Type.MATCH)},goog.exportProperty(lf.schema.BaseColumn.prototype,"match",lf.schema.BaseColumn.prototype.match),lf.schema.BaseColumn.prototype.between=function(e,t){return lf.pred.createPredicate(this,[e,t],lf.eval.Type.BETWEEN)},goog.exportProperty(lf.schema.BaseColumn.prototype,"between",lf.schema.BaseColumn.prototype.between),lf.schema.BaseColumn.prototype["in"]=function(e){return lf.pred.createPredicate(this,e,lf.eval.Type.IN)},goog.exportProperty(lf.schema.BaseColumn.prototype,"in",lf.schema.BaseColumn.prototype["in"]),lf.schema.BaseColumn.prototype.isNull=function(){return this.eq(null)},goog.exportProperty(lf.schema.BaseColumn.prototype,"isNull",lf.schema.BaseColumn.prototype.isNull),lf.schema.BaseColumn.prototype.isNotNull=function(){return this.neq(null)},goog.exportProperty(lf.schema.BaseColumn.prototype,"isNotNull",lf.schema.BaseColumn.prototype.isNotNull),lf.schema.BaseColumn.prototype.as=function(e){return new lf.schema.BaseColumn(this.table_,this.name_,this.isUnique_,this.isNullable_,this.type_,e)},goog.exportProperty(lf.schema.BaseColumn.prototype,"as",lf.schema.BaseColumn.prototype.as),lf.schema.Info=function(e){this.schema_=e,this.cascadeReferringFk_=new lf.structs.MapSet,this.restrictReferringFk_=new lf.structs.MapSet,this.parents_=new lf.structs.MapSet,this.colParent_=lf.structs.map.create(),this.children_=new lf.structs.MapSet,this.cascadeChildren_=new lf.structs.MapSet,this.restrictChildren_=new lf.structs.MapSet,this.colChild_=new lf.structs.MapSet,this.init_()},lf.schema.Info.prototype.init_=function(){this.schema_.tables().forEach(function(e){var t=e.getName();e.constraint_.foreignKeys_.forEach(function(r){this.parents_.set(t,this.schema_.table(r.parentTable)),this.children_.set(r.parentTable,e),r.action==lf.ConstraintAction.RESTRICT?(this.restrictReferringFk_.set(r.parentTable,r),this.restrictChildren_.set(r.parentTable,e)):(this.cascadeReferringFk_.set(r.parentTable,r),this.cascadeChildren_.set(r.parentTable,e)),this.colParent_.set(e.getName()+"."+r.childColumn,r.parentTable);var o=r.parentTable+"."+r.parentColumn;this.colChild_.set(o,e.getName())},this)},this)},lf.schema.Info.prototype.getReferencingForeignKeys=function(e,t){if(goog.isDefAndNotNull(t))return t==lf.ConstraintAction.CASCADE?this.cascadeReferringFk_.get(e):this.restrictReferringFk_.get(e);var r=this.cascadeReferringFk_.get(e),o=this.restrictReferringFk_.get(e);return goog.isNull(r)&&goog.isNull(o)?null:(r||[]).concat(o||[])},lf.schema.Info.prototype.expandScope_=function(e,t){var r=t.get(e);return goog.isNull(r)?[]:r},lf.schema.Info.prototype.getParentTables=function(e){return this.expandScope_(e,this.parents_)},lf.schema.Info.prototype.getParentTablesByColumns=function(e){var t=lf.structs.set.create();e.forEach(function(e){var r=this.colParent_.get(e);r&&t.add(r)},this);var r=lf.structs.set.values(t);return r.map(function(e){return this.schema_.table(e)},this)},lf.schema.Info.prototype.getChildTables=function(e,t){return goog.isDefAndNotNull(t)?t==lf.ConstraintAction.RESTRICT?this.expandScope_(e,this.restrictChildren_):this.expandScope_(e,this.cascadeChildren_):this.expandScope_(e,this.children_)},lf.schema.Info.prototype.getChildTablesByColumns=function(e){var t=lf.structs.set.create();e.forEach(function(e){var r=this.colChild_.get(e);r&&r.forEach(function(e){t.add(e)})},this);var r=lf.structs.set.values(t);return r.map(function(e){return this.schema_.table(e)},this)},lf.schema.Constraint=function(e,t,r){this.primaryKey_=e,this.notNullable_=t,this.foreignKeys_=r},goog.exportSymbol("lf.schema.Constraint",lf.schema.Constraint),lf.schema.Constraint.prototype.getPrimaryKey=function(){return this.primaryKey_},goog.exportProperty(lf.schema.Constraint.prototype,"getPrimaryKey",lf.schema.Constraint.prototype.getPrimaryKey),lf.schema.Constraint.prototype.getForeignKeys=function(){return this.foreignKeys_},goog.exportProperty(lf.schema.Constraint.prototype,"getForeignKeys",lf.schema.Constraint.prototype.getForeignKeys),lf.schema.ForeignKeySpec=function(e,t,r){var o=e.ref.split(".");if(2!=o.length)throw new lf.Exception(540,r);this.childTable=t,this.childColumn=e.local,this.parentTable=o[0],this.parentColumn=o[1],this.name=t+"."+r,this.action=e.action,this.timing=e.timing},lf.schema.TableBuilder=function(e){this.checkNamingRules_(e),this.evalRegistry_=lf.eval.Registry.get(),this.name_=e,this.columns_=lf.structs.map.create(),this.uniqueColumns_=lf.structs.set.create(),this.uniqueIndices_=lf.structs.set.create(),this.nullable_=lf.structs.set.create(),this.pkName_=null,this.indices_=lf.structs.map.create(),this.persistentIndex_=!1,this.fkSpecs_=[]},goog.exportSymbol("lf.schema.TableBuilder",lf.schema.TableBuilder),lf.schema.TableBuilder.IndexedColumn_=function(e){this.name=e.name,this.order=e.order,this.autoIncrement=e.autoIncrement},lf.schema.TableBuilder.NULLABLE_TYPES_BY_DEFAULT=lf.structs.set.create([lf.Type.ARRAY_BUFFER,lf.Type.OBJECT]),lf.schema.TableBuilder.toPascal_=function(e){return e[0].toUpperCase()+e.substring(1)},lf.schema.TableBuilder.prototype.checkNamingRules_=function(e){if(!/^[A-Za-z_][A-Za-z0-9_]*$/.test(e))throw new lf.Exception(502,e)},lf.schema.TableBuilder.prototype.checkNameConflicts_=function(e){if(e==this.name_)throw new lf.Exception(546,e);if(this.columns_.has(e)||this.indices_.has(e)||this.uniqueIndices_.has(e))throw new lf.Exception(503,this.name_+"."+e)},lf.schema.TableBuilder.prototype.checkPrimaryKey_=function(e){var t=!1;if(e.forEach(function(e){var r=this.columns_.get(e.name);if(t=t||e.autoIncrement,e.autoIncrement&&r!=lf.Type.INTEGER)throw new lf.Exception(504)},this),t&&1<e.length)throw new lf.Exception(505)},lf.schema.TableBuilder.prototype.checkPrimaryKeyNotForeignKey_=function(){if(!goog.isNull(this.pkName_)){var e=this.indices_.get(this.pkName_).map(function(e){return e.name}),t=0,r=this.fkSpecs_.some(function(r,o){return t=o,-1!=e.indexOf(r.childColumn)},this);if(r)throw new lf.Exception(543,this.fkSpecs_[t].name)}},lf.schema.TableBuilder.prototype.checkPrimaryKeyDuplicateIndex_=function(){if(!goog.isNull(this.pkName_)){var e=function(e){return e.name},t=JSON.stringify(this.indices_.get(this.pkName_).map(e));this.indices_.forEach(function(r,o){if(o!=this.pkName_){var n=r.map(e);if(JSON.stringify(n)==t)throw new lf.Exception(544,this.name_+"."+o)}},this)}},lf.schema.TableBuilder.prototype.checkPrimaryKeyNotNullable_=function(){goog.isNull(this.pkName_)||this.indices_.get(this.pkName_).forEach(function(e){if(this.nullable_.has(e.name))throw new lf.Exception(545,this.name_+"."+e.name)},this)},lf.schema.TableBuilder.prototype.addColumn=function(e,t){return this.checkNamingRules_(e),this.checkNameConflicts_(e),this.columns_.set(e,t),lf.schema.TableBuilder.NULLABLE_TYPES_BY_DEFAULT.has(t)&&this.addNullable([e]),this},goog.exportProperty(lf.schema.TableBuilder.prototype,"addColumn",lf.schema.TableBuilder.prototype.addColumn),lf.schema.TableBuilder.prototype.addPrimaryKey=function(e,t){this.pkName_="pk"+lf.schema.TableBuilder.toPascal_(this.name_),this.checkNamingRules_(this.pkName_),this.checkNameConflicts_(this.pkName_);var r=this.normalizeColumns_(e,!0,void 0,t);return this.checkPrimaryKey_(r),1==r.length&&this.uniqueColumns_.add(r[0].name),this.uniqueIndices_.add(this.pkName_),this.indices_.set(this.pkName_,r),this},goog.exportProperty(lf.schema.TableBuilder.prototype,"addPrimaryKey",lf.schema.TableBuilder.prototype.addPrimaryKey),lf.schema.TableBuilder.prototype.addForeignKey=function(e,t){this.checkNamingRules_(e),this.checkNameConflicts_(e);var r=new lf.schema.ForeignKeySpec(t,this.name_,e);if(goog.isDef(r.action)||(r.action=lf.ConstraintAction.RESTRICT),goog.isDef(r.timing)||(r.timing=lf.ConstraintTiming.IMMEDIATE),r.action==lf.ConstraintAction.CASCADE&&r.timing==lf.ConstraintTiming.DEFERRABLE)throw new lf.Exception(506);if(!this.columns_.has(r.childColumn))throw new lf.Exception(540,e);return this.fkSpecs_.push(r),this.addIndex(e,[r.childColumn],this.uniqueColumns_.has(r.childColumn)),this},goog.exportProperty(lf.schema.TableBuilder.prototype,"addForeignKey",lf.schema.TableBuilder.prototype.addForeignKey),lf.schema.TableBuilder.prototype.addUnique=function(e,t){this.checkNamingRules_(e),this.checkNameConflicts_(e);var r=this.normalizeColumns_(t,!0);return 1==r.length&&(this.uniqueColumns_.add(r[0].name),this.markFkIndexForColumnUnique_(r[0].name)),this.indices_.set(e,r),this.uniqueIndices_.add(e),this},goog.exportProperty(lf.schema.TableBuilder.prototype,"addUnique",lf.schema.TableBuilder.prototype.addUnique),lf.schema.TableBuilder.prototype.markFkIndexForColumnUnique_=function(e){this.fkSpecs_.forEach(function(t){if(t.childColumn==e){var r=t.name.split(".")[1];this.uniqueIndices_.add(r)}},this)},lf.schema.TableBuilder.prototype.addNullable=function(e){var t=this.normalizeColumns_(e,!1);return t.forEach(function(e){this.nullable_.add(e.name)},this),this},goog.exportProperty(lf.schema.TableBuilder.prototype,"addNullable",lf.schema.TableBuilder.prototype.addNullable),lf.schema.TableBuilder.prototype.addIndex=function(e,t,r,o){this.checkNamingRules_(e),this.checkNameConflicts_(e);var n=this.normalizeColumns_(t,!0,o);return r&&this.uniqueIndices_.add(e),this.indices_.set(e,n),this},goog.exportProperty(lf.schema.TableBuilder.prototype,"addIndex",lf.schema.TableBuilder.prototype.addIndex),lf.schema.TableBuilder.prototype.persistentIndex=function(e){this.persistentIndex_=e},goog.exportProperty(lf.schema.TableBuilder.prototype,"persistentIndex",lf.schema.TableBuilder.prototype.persistentIndex),lf.schema.TableBuilder.prototype.getSchema=function(){this.checkPrimaryKeyNotForeignKey_(),this.checkPrimaryKeyDuplicateIndex_(),this.checkPrimaryKeyNotNullable_();var e=this.generateTableClass_();return new e},goog.exportProperty(lf.schema.TableBuilder.prototype,"getSchema",lf.schema.TableBuilder.prototype.getSchema),lf.schema.TableBuilder.prototype.normalizeColumns_=function(e,t,r,o){var n=e,n="string"==typeof e[0]?e.map(function(e){return new lf.schema.TableBuilder.IndexedColumn_({name:e,order:goog.isDefAndNotNull(r)?r:lf.Order.ASC,autoIncrement:o||!1})}):e.map(function(e){return new lf.schema.TableBuilder.IndexedColumn_(e)});return n.forEach(function(e){if(!this.columns_.has(e.name))throw new lf.Exception(508,this.name_,e.name);if(t){var r=this.columns_.get(e.name);if(r==lf.Type.ARRAY_BUFFER||r==lf.Type.OBJECT)throw new lf.Exception(509,this.name_,e.name)}},this),n},lf.schema.TableBuilder.prototype.generateTableClass_=function(){var e=this,t=function(){var t=lf.structs.map.keys(e.columns_).map(function(t){return this[t]=new lf.schema.BaseColumn(this,t,e.uniqueColumns_.has(t),e.nullable_.has(t),e.columns_.get(t)),this[t]},this),r=function(t){return e.indices_.get(t).map(function(e){return{schema:this[e.name],order:e.order,autoIncrement:e.autoIncrement}},this)},o=lf.structs.map.keys(e.indices_).map(function(t){return new lf.schema.Index(e.name_,t,e.uniqueIndices_.has(t),r.call(this,t))},this);lf.schema.Table.call(this,e.name_,t,o,e.persistentIndex_);var n=goog.isNull(e.pkName_)?null:new lf.schema.Index(e.name_,e.pkName_,(!0),r.call(this,e.pkName_)),i=t.filter(function(t){return!e.nullable_.has(t.getName())});this.constraint_=new lf.schema.Constraint(n,i,e.fkSpecs_),this.rowClass_=e.generateRowClass_(t,o)};return goog.inherits(t,lf.schema.Table),t.prototype.createRow=function(e){return new this.rowClass_(lf.Row.getNextId(),e)},goog.exportProperty(t.prototype,"createRow",t.prototype.createRow),t.prototype.deserializeRow=function(e){var t={};return this.getColumns().forEach(function(r){var o=r.getName(),n=r.getType(),i=e.value[o];t[o]=n==lf.Type.ARRAY_BUFFER?lf.Row.hexToBin(i):n==lf.Type.DATE_TIME?goog.isDefAndNotNull(i)?new Date(i):null:i},this),new this.rowClass_(e.id,t)},goog.exportProperty(t.prototype,"deserializeRow",t.prototype.deserializeRow),t.prototype.getConstraint=function(){return this.constraint_},goog.exportProperty(t.prototype,"getConstraint",t.prototype.getConstraint),t},lf.schema.TableBuilder.prototype.generateRowClass_=function(e,t){var r=function(r,o){this.columns_=e,this.indices_=t,lf.Row.call(this,r,o)};goog.inherits(r,lf.Row),r.prototype.defaultPayload=function(){var e={};return this.columns_.forEach(function(t){e[t.getName()]=t.isNullable()?null:lf.type.DEFAULT_VALUES[t.getType()]}),e},r.prototype.toDbPayload=function(){var e={};return this.columns_.forEach(function(t){var r=t.getName(),o=t.getType(),n=this.payload_[r];e[r]=o==lf.Type.ARRAY_BUFFER?goog.isDefAndNotNull(n)?lf.Row.binToHex(n):null:o==lf.Type.DATE_TIME?goog.isDefAndNotNull(n)?n.getTime():null:o==lf.Type.OBJECT?goog.isDefAndNotNull(n)?n:null:n},this),e};var o=function(e){var t=this.columns_.get(e.getName()),r=this.evalRegistry_.getKeyOfIndexEvaluator(t);return function(t){return r(t[e.getName()])}}.bind(this),n=function(e){var t=e.map(function(e){return o(e.schema)});return function(e){return t.map(function(t){return t(e)})}}.bind(this),i={};return t.forEach(function(e){var t,r=e.getNormalizedName(),s=e;t=1==s.columns.length?o(s.columns[0].schema):n(s.columns),i[r]=t}),r.prototype.keyOfIndex=function(e){return-1!=e.indexOf("#")?this.id():i.hasOwnProperty(e)?i[e](this.payload_):null},r},lf.schema.Builder=function(e,t){this.schema_=new lf.schema.DatabaseSchema(e,t),this.tableBuilders_=lf.structs.map.create(),this.finalized_=!1,this.db_=null},goog.exportSymbol("lf.schema.Builder",lf.schema.Builder),lf.schema.Builder.prototype.checkForeignKeyValidity_=function(e){var t=e.fkSpecs_;t.forEach(function(t){var r=t.parentTable;if(!this.tableBuilders_.has(r))throw new lf.Exception(536,t.name);var o=this.tableBuilders_.get(r),n=o.getSchema(),i=t.parentColumn;if(!n.hasOwnProperty(i))throw new lf.Exception(537,t.name);var s=e.getSchema(),a=t.childColumn;if(s[a].getType()!=n[i].getType())throw new lf.Exception(538,t.name);if(!n[i].isUnique())throw new lf.Exception(539,t.name)},this)},lf.schema.Builder.prototype.checkForeignKeyChain_=function(e){var t=e.fkSpecs_;t.forEach(function(e){var t=this.tableBuilders_.get(e.parentTable);t.fkSpecs_.forEach(function(t){if(t.childColumn==e.parentColumn)throw new lf.Exception(534,e.name)},this)},this)},lf.schema.Builder.prototype.finalize_=function(){this.finalized_||(this.tableBuilders_.forEach(function(e){this.checkForeignKeyValidity_(e),this.schema_.setTable(e.getSchema())},this),lf.structs.map.values(this.tableBuilders_).forEach(this.checkForeignKeyChain_,this),this.checkFkCycle_(),this.tableBuilders_.clear(),this.finalized_=!0)},lf.schema.Builder.prototype.checkCycleUtil_=function(e,t){e.visited||(e.visited=!0,e.onStack=!0,e.edges.forEach(function(r){var o=t.get(r);if(o.visited){if(o.onStack&&e!=o)throw new lf.Exception(533)}else this.checkCycleUtil_(o,t)},this)),e.onStack=!1},lf.schema.Builder.prototype.checkFkCycle_=function(){var e=lf.structs.map.create();this.schema_.tables_.forEach(function(t,r){e.set(r,new lf.schema.GraphNode_(r))},this),this.tableBuilders_.forEach(function(t,r){t.fkSpecs_.forEach(function(t){var o=e.get(t.parentTable);o.edges.add(r)})}),lf.structs.map.values(e).forEach(function(t){this.checkCycleUtil_(t,e)},this)},lf.schema.GraphNode_=function(e){this.onStack=this.visited=!1,this.edges=lf.structs.set.create(),this.tableName=e},lf.schema.Builder.prototype.getSchema=function(){return this.finalized_||this.finalize_(),this.schema_},goog.exportProperty(lf.schema.Builder.prototype,"getSchema",lf.schema.Builder.prototype.getSchema),lf.schema.Builder.prototype.getGlobal=function(){var e,t=new lf.service.ServiceId("ns_"+this.schema_.name()),r=lf.Global.get();return r.isRegistered(t)?e=r.getService(t):(e=new lf.Global,r.registerService(t,e)),e},goog.exportProperty(lf.schema.Builder.prototype,"getGlobal",lf.schema.Builder.prototype.getGlobal),lf.schema.Builder.prototype.connect=function(e){if(!goog.isNull(this.db_)&&this.db_.isActive_)throw new lf.Exception(113);if(goog.isNull(this.db_)){var t=this.getGlobal();t.isRegistered(lf.service.SCHEMA)||t.registerService(lf.service.SCHEMA,this.getSchema()),this.db_=new lf.proc.Database(t)}return this.db_.init(e)},goog.exportProperty(lf.schema.Builder.prototype,"connect",lf.schema.Builder.prototype.connect),lf.schema.Builder.prototype.createTable=function(e){if(this.tableBuilders_.has(e))throw new lf.Exception(503,e);if(this.finalized_)throw new lf.Exception(535);return this.tableBuilders_.set(e,new lf.schema.TableBuilder(e)),this.tableBuilders_.get(e)},goog.exportProperty(lf.schema.Builder.prototype,"createTable",lf.schema.Builder.prototype.createTable),lf.schema.Builder.prototype.setPragma=function(e){if(this.finalized_)throw new lf.Exception(535);return this.schema_.setPragma(e),this},goog.exportProperty(lf.schema.Builder.prototype,"setPragma",lf.schema.Builder.prototype.setPragma),lf.schema.DatabaseSchema=function(e,t){this.name_=e,this.version_=t,this.tables_=lf.structs.map.create(),this.pragma_={enableBundledMode:!1}},goog.exportSymbol("lf.schema.DatabaseSchema",lf.schema.DatabaseSchema),lf.schema.DatabaseSchema.prototype.name=function(){return this.name_},goog.exportProperty(lf.schema.DatabaseSchema.prototype,"name",lf.schema.DatabaseSchema.prototype.name),lf.schema.DatabaseSchema.prototype.version=function(){return this.version_},goog.exportProperty(lf.schema.DatabaseSchema.prototype,"version",lf.schema.DatabaseSchema.prototype.version),lf.schema.DatabaseSchema.prototype.tables=function(){return lf.structs.map.values(this.tables_)},goog.exportProperty(lf.schema.DatabaseSchema.prototype,"tables",lf.schema.DatabaseSchema.prototype.tables),lf.schema.DatabaseSchema.prototype.table=function(e){if(!this.tables_.has(e))throw new lf.Exception(101,e);return this.tables_.get(e)},goog.exportProperty(lf.schema.DatabaseSchema.prototype,"table",lf.schema.DatabaseSchema.prototype.table),lf.schema.DatabaseSchema.prototype.info=function(){return this.info_||(this.info_=new lf.schema.Info(this)),this.info_},lf.schema.DatabaseSchema.prototype.setTable=function(e){this.tables_.set(e.getName(),e)},lf.schema.DatabaseSchema.prototype.pragma=function(){return this.pragma_},goog.exportProperty(lf.schema.DatabaseSchema.prototype,"pragma",lf.schema.DatabaseSchema.prototype.pragma),lf.schema.DatabaseSchema.prototype.setPragma=function(e){this.pragma_=e},lf.schema.create=function(e,t){return new lf.schema.Builder(e,t)},goog.exportSymbol("lf.schema.create",lf.schema.create),goog.Promise.prototype["catch"]=goog.Promise.prototype.thenCatch,goog.exportProperty(goog.Promise.prototype,"catch",goog.Promise.prototype["catch"]);try{module&&(module.exports=lf)}catch(e){}}.bind(window)(),Schema.prototype.importSchema=function(e){return e.createTable("calendar").addColumn("id",lf.Type.INTEGER).addColumn("service_id",lf.Type.STRING).addColumn("monday",lf.Type.INTEGER).addColumn("tuesday",lf.Type.INTEGER).addColumn("wednesday",lf.Type.INTEGER).addColumn("thursday",lf.Type.INTEGER).addColumn("friday",lf.Type.INTEGER).addColumn("saturday",lf.Type.INTEGER).addColumn("sunday",lf.Type.INTEGER).addColumn("start_date",lf.Type.INTEGER).addColumn("end_date",lf.Type.INTEGER).addPrimaryKey(["service_id"]),e.createTable("calendar_dates").addColumn("id",lf.Type.INTEGER).addColumn("service_id",lf.Type.STRING).addColumn("date",lf.Type.INTEGER).addColumn("exception_type",lf.Type.INTEGER).addPrimaryKey(["service_id"]),e.createTable("routes").addColumn("id",lf.Type.INTEGER).addColumn("route_id",lf.Type.STRING).addColumn("route_short_name",lf.Type.STRING).addColumn("route_long_name",lf.Type.STRING).addColumn("route_type",lf.Type.INTEGER).addColumn("route_color",lf.Type.STRING).addPrimaryKey(["route_id"]),e.createTable("stop_times").addColumn("id",lf.Type.INTEGER).addColumn("trip_id",lf.Type.STRING).addColumn("arrival_time",lf.Type.STRING).addColumn("departure_time",lf.Type.STRING).addColumn("stop_id",lf.Type.INTEGER).addColumn("stop_sequence",lf.Type.INTEGER).addColumn("pickup_type",lf.Type.INTEGER).addColumn("drop_off_type",lf.Type.INTEGER).addPrimaryKey(["stop_id","trip_id"]),e.createTable("stops").addColumn("id",lf.Type.INTEGER).addColumn("stop_id",lf.Type.INTEGER).addColumn("stop_code",lf.Type.INTEGER).addColumn("stop_name",lf.Type.STRING).addColumn("stop_lat",lf.Type.INTEGER).addColumn("stop_lon",lf.Type.INTEGER).addColumn("zone_id",lf.Type.INTEGER).addColumn("stop_url",lf.Type.STRING).addColumn("location_type",lf.Type.INTEGER).addColumn("parent_station",lf.Type.STRING).addColumn("platform_code",lf.Type.STRING).addColumn("wheelchair_boarding",lf.Type.INTEGER).addPrimaryKey(["stop_id"]),e.createTable("trips").addColumn("id",lf.Type.INTEGER).addColumn("route_id",lf.Type.STRING).addColumn("service_id",lf.Type.STRING).addColumn("trip_id",lf.Type.STRING).addColumn("trip_headsign",lf.Type.STRING).addColumn("trip_short_name",lf.Type.STRING).addColumn("direction_id",lf.Type.INTEGER).addColumn("shape_id",lf.Type.STRING).addColumn("wheelchair_accessible",lf.Type.INTEGER).addColumn("bikes_allowed",lf.Type.INTEGER).addPrimaryKey(["trip_id"]),e},DB.prototype.connect=function(){return this.schema.connect().then(function(e){this.db=e}.bind(this)).then(this.hasTableData.bind(this)).then(function(e){return console.log("DB Cached:",e),e?Promise.reject():Promise.resolve()}.bind(this)).then(this.importData.bind(this))["catch"](function(){})},DB.prototype.tablePromises=function(e){for(var t=[],r=0;r<e.length;r++)t.push(this.importCSV("static/"+this.name+"/"+e[r]+".txt",e[r]));return t},DB.prototype.importCSV=function(e,t){var r=this.db.getSchema().table(t);return this.loadFile(e).then(function(e){var t=[],o=e.split("\n");if(o.length>=1){for(var n=o[0].split(","),i=1;i<o.length;i++){var s=o[i].split(",");if(s.length>0){for(var a={id:i-1},l=0;l<s.length;l++)a[n[l].trim()]=this.nonNull(s[l].trim());t.push(r.createRow(a))}}t.length>0&&this.db.insertOrReplace().into(r).values(t).exec()}}.bind(this))},DB.prototype.nonNull=function(e){return e?e:""},DB.prototype.loadFile=function(e){return new Promise(function(t,r){var o=new XMLHttpRequest;o.open("GET",e),o.onload=function(){this.status>=200&&this.status<300?t(o.response):r()},o.onerror=r,o.send()})},DB.prototype.importData=function(){return Promise.all(this.tablePromises(this.tables))},DB.prototype.hasTableData=function(){var e=this.db.getSchema().table("stops");return this.db.select(lf.fn.count(e.id)).from(e).exec().then(function(e){return e[0]["COUNT(id)"]>0})},DB.prototype.service=function(e){var t=this.db.getSchema().table("calendar");return this.db.select().from(t).where(t.id.eq(e)).exec()},DB.prototype.departTrips=function(e,t,r){var o=this.db.getSchema().table("stops"),n=this.db.getSchema().table("stop_times"),i=this.db.getSchema().table("trips"),s=lf.op.and.apply(null,[n.trip_id.eq(i.trip_id),n.stop_id.eq(o.stop_id),o.stop_name.eq(t),n.departure_time.gt(r),i.service_id.eq(e)]);return this.db.select(n.trip_id.as("trip_id"),n.departure_time.as("departure_time"),o.stop_name.as("stop_name")).from(n,i,o).limit(20).where(s).orderBy(n.trip_id).orderBy(n.departure_time).exec()},DB.prototype.arriveTrips=function(e,t,r,o){var n=this.db.getSchema().table("stops"),i=this.db.getSchema().table("stop_times"),s=this.db.getSchema().table("trips"),a=lf.op.and.apply(null,[i.trip_id.eq(s.trip_id),i.stop_id.eq(n.stop_id),i.trip_id["in"](e),n.stop_name.eq(r),i.departure_time.gt(o),s.service_id.eq(t)]);return this.db.select(i.trip_id.as("trip_id"),i.departure_time.as("departure_time")).from(i,s,n).where(a).orderBy(i.trip_id).orderBy(i.departure_time).exec()},DB.prototype.tripInfo=function(e,t,r,o,n){var i=this.db.getSchema().table("stops"),s=this.db.getSchema().table("stop_times"),a=this.db.getSchema().table("trips"),l=lf.op.and.apply(null,[s.trip_id.eq(a.trip_id),s.stop_id.eq(i.stop_id),i.stop_name["in"]([r,o]),s.trip_id["in"](e),a.service_id.eq(t)]);return this.db.select(s.trip_id.as("trip_id"),s.stop_id.as("stop_id"),s.departure_time.as("departure_time"),s.arrival_time.as("arrival_time"),i.stop_name.as("stop_name")).from(s,a,i).where(l).orderBy(s.trip_id).orderBy(s.departure_time).exec()},DB.prototype.stations=function(){var e=this.db.getSchema().table("stops");return this.db.select(e.stop_name,e.stop_lat,e.stop_lon).from(e).orderBy(e.stop_name).groupBy(e.stop_name).exec()},DB.prototype.findRoutes=function(e,t,r,o){var n,i,s,a="Weekday"===o?0:"Saturday"===o?1:2;return e===t||null==this.db?new Promise(function(e,t){e([])}):this.service(a).then(function(t){return t.length>0?(n=t[0].service_id,this.departTrips(n,e,r)):Promise.reject()}.bind(this)).then(function(e){return i=e.map(function(e){return e.trip_id}),this.arriveTrips(i,n,t,r)}.bind(this)).then(function(o){return s=o.map(function(e){return e.trip_id}),this.tripInfo(s,n,e,t,r)}.bind(this)).then(function(r){for(var o=[],n=0;n<r.length;n+=2)r[n].stop_name===e&&o.push({trip_id:r[n].trip_id,depart:e,arrive:t,departure_time:r[n].departure_time,arrival_time:r[n+1].arrival_time});return o})["catch"](function(){return[]})},Polymer({is:"app-main",properties:{dayIndex:{type:Number,value:0,observer:"_dayIndexChanged"},route:{type:Object},data:{type:Object,value:function(){return{}}},subrouteData:{type:Object},departStation:{type:String,value:"Belmont Caltrain"},departIndex:{type:Number,observer:"_departIndexChanged"},departCoord:{type:Array,value:function(){return[0,0]}},arriveStation:{type:String,value:"Mt View Caltrain"},arriveIndex:{type:Number,observer:"_arriveIndexChanged"},arriveCoord:{type:Array,value:function(){return[0,0]}},time:{type:String,value:"01:00:00"},trainRoutes:{type:Array,value:function(){return[]}},stations:{type:Array,value:function(){return[]}},ready:{type:Boolean,value:!1},registerURI:{String:Array,value:function(){return window.location.href+"bower_components/platinum-sw/"}}},ready:function(){document.getElementById("skeleton").remove(),Polymer.dom(this).removeAttribute("unresolved");var e=document.querySelector("platinum-sw-register");console.log("SW: ",null!==e),e&&e.register(),this.db=new DB("caltrain",["calendar","calendar_dates","routes","stop_times","stops","trips"]),this.db.connect().then(this._updateStations.bind(this)).then(this._updateTrainList.bind(this)).then(function(){this.set("ready",!0)}.bind(this))},_dayLabel:function(e){var t=["Weekday","Saturday","Sunday"];return t[e]},_updateStations:function(){return this.db.stations().then(function(e){this.set("stations",e),this.set("departIndex",_.findIndex(e,{stop_name:this.departStation})),this.set("arriveIndex",_.findIndex(e,{stop_name:this.arriveStation})),this._updateStationCoord("departCoord",this.departIndex),this._updateStationCoord("arriveCoord",this.arriveIndex)}.bind(this))},_updateTrainList:function(){this.db&&this.db.findRoutes(this.departStation,this.arriveStation,this.time,this._dayLabel(this.dayIndex)).then(function(e){this.set("trainRoutes",e)}.bind(this))},_updateStationCoord:function(e,t){var r=this.stations[t];this.set(e,[r.stop_lat,r.stop_lon]),window.dispatchEvent(new Event("resize"))},_dayIndexChanged:function(e,t){this.ready&&this._updateTrainList()},_handleClick:function(e){var t=e.currentTarget.getAttribute("data-dialog"),r=document.getElementById(t);r&&r.firstElementChild.open()},_arriveIndexChanged:function(e,t){void 0!==this.stations&&this.stations.length>0&&this.stations[e]&&(this.set("arriveStation",this.stations[e].stop_name),this._updateStationCoord("arriveCoord",e),this.ready&&this._updateTrainList())},_departIndexChanged:function(e,t){void 0!==this.stations&&this.stations.length>0&&this.stations[e]&&(this.set("departStation",this.stations[e].stop_name),this._updateStationCoord("departCoord",e),this.ready&&this._updateTrainList())},_handleSWError:function(e){console.log("_handleSWError",e)},_handleSWUpdated:function(e){console.log("_handleSWUpdated",e)},_handleSWInstalled:function(e){console.log("_handleSWInstalled",e)}});